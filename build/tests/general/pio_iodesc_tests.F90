! DON'T MODIFY THIS FILE, ALL YOUR CHANGES WILL BE LOST
! This file is generated by ../../../tests/general/util/pio_tf_f90gen.pl
! from /home/tkurc/codar/e3sm/pio_adios1/ParallelIO/tests/general/pio_iodesc_tests.F90.in

SUBROUTINE init_decomp_1d_get_loc_sz
  USE pio_tutil
   ! pio_iodesc_tests.F90.in:1
  implicit none   ! pio_iodesc_tests.F90.in:2
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_iodesc_tests.F90.in:3
  integer, dimension(:), allocatable :: data_types   ! pio_iodesc_tests.F90.in:4
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: data_type_descs   ! pio_iodesc_tests.F90.in:5
  type(io_desc_t) :: iodesc   ! pio_iodesc_tests.F90.in:6
  integer, dimension(VEC_LOCAL_SZ) :: compdof, compdof_rel_disps   ! pio_iodesc_tests.F90.in:7
  integer, dimension(1) :: dims   ! pio_iodesc_tests.F90.in:8
  integer :: i, ntypes, lsz   ! pio_iodesc_tests.F90.in:9


  do i=1,VEC_LOCAL_SZ   ! pio_iodesc_tests.F90.in:11
    compdof_rel_disps(i) = i   ! pio_iodesc_tests.F90.in:12
  end do   ! pio_iodesc_tests.F90.in:13
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_iodesc_tests.F90.in:14
  compdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_iodesc_tests.F90.in:15


  call PIO_TF_Get_data_types(data_types, data_type_descs, ntypes)   ! pio_iodesc_tests.F90.in:17
  do i=1,ntypes   ! pio_iodesc_tests.F90.in:18

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type : ", data_type_descs(i)
      END IF
    END IF   ! pio_iodesc_tests.F90.in:19
    call PIO_initdecomp(pio_tf_iosystem_, data_types(i), dims, compdof, iodesc)   ! pio_iodesc_tests.F90.in:20
    lsz = PIO_get_local_array_size(iodesc)   ! pio_iodesc_tests.F90.in:21
    
    IF (.NOT. (PIO_TF_Passert_(lsz == VEC_LOCAL_SZ, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: Assertion failed :",&
           "Checking the local array size",&
           ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:22)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:22
    call PIO_freedecomp(pio_tf_iosystem_, iodesc)   ! pio_iodesc_tests.F90.in:23
  end do   ! pio_iodesc_tests.F90.in:24


  if(allocated(data_types)) then   ! pio_iodesc_tests.F90.in:26
    deallocate(data_types)   ! pio_iodesc_tests.F90.in:27
    deallocate(data_type_descs)   ! pio_iodesc_tests.F90.in:28
  end if   ! pio_iodesc_tests.F90.in:29
END SUBROUTINE init_decomp_1d_get_loc_sz   ! pio_iodesc_tests.F90.in:30


! Decomp shifted left "shift" positions, each rank contains VEC_LOCAL_SZ
! elements. The shift is a global "cyclic left shift"
! For VEC_LOCAL_SZ = 3,
! e.g. For shift = 0
! e.g. 1) [1, 2, 3] [4, 5, 6] 
! e.g. 2) [1, 2, 3] [4, 5, 6] [6, 7, 8]
! e.g. For shift = 1
! e.g. 1) [2, 3, 4] [5, 6, 1] 
! e.g. 1) [2, 3, 4] [5, 6, 7] [8, 9, 1]
! e.g. For shift = 3
! e.g. 1) [4, 5, 6] [1, 2, 3]  
! e.g. 1) [4, 5, 6] [7, 8, 9] [1, 2, 3]  
SUBROUTINE get_1d_bc_shift_decomp_info(rank, sz, dims, start, count, nlshift)   ! pio_iodesc_tests.F90.in:44
  integer, intent(in) :: rank   ! pio_iodesc_tests.F90.in:45
  integer, intent(in) :: sz   ! pio_iodesc_tests.F90.in:46
  integer, dimension(1), intent(out) :: dims   ! pio_iodesc_tests.F90.in:47
  integer, dimension(:), allocatable, intent(out) :: start   ! pio_iodesc_tests.F90.in:48
  integer, dimension(:), allocatable, intent(out) :: count   ! pio_iodesc_tests.F90.in:49
  integer, intent(in) :: nlshift   ! pio_iodesc_tests.F90.in:50


  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_iodesc_tests.F90.in:52
  integer :: start_idx, last_idx, i   ! pio_iodesc_tests.F90.in:53
  ! Number of regions
  integer :: nregs   ! pio_iodesc_tests.F90.in:55


  dims(1) = VEC_LOCAL_SZ * sz   ! pio_iodesc_tests.F90.in:57
  start_idx = MOD((VEC_LOCAL_SZ * rank + 1) + nlshift, dims(1))   ! pio_iodesc_tests.F90.in:58
  last_idx = start_idx + VEC_LOCAL_SZ - 1   ! pio_iodesc_tests.F90.in:59
  if(last_idx <= dims(1)) then   ! pio_iodesc_tests.F90.in:60
    nregs = 1   ! pio_iodesc_tests.F90.in:61
  else   ! pio_iodesc_tests.F90.in:62
    nregs = 2   ! pio_iodesc_tests.F90.in:63
  end if   ! pio_iodesc_tests.F90.in:64
  allocate(start(nregs))   ! pio_iodesc_tests.F90.in:65
  allocate(count(nregs))   ! pio_iodesc_tests.F90.in:66
  if(nregs == 1) then   ! pio_iodesc_tests.F90.in:67
    start(1) = start_idx   ! pio_iodesc_tests.F90.in:68
    count(1) = VEC_LOCAL_SZ   ! pio_iodesc_tests.F90.in:69
  else   ! pio_iodesc_tests.F90.in:70
    ! Two regions
    start(1) = start_idx   ! pio_iodesc_tests.F90.in:72
    count(1) = dims(1) - start(1) + 1   ! pio_iodesc_tests.F90.in:73


    start(2) = 1   ! pio_iodesc_tests.F90.in:75
    count(2) = last_idx - dims(1)   ! pio_iodesc_tests.F90.in:76
  end if   ! pio_iodesc_tests.F90.in:77


END SUBROUTINE   ! pio_iodesc_tests.F90.in:79


! Get a block cyclic decomposition with multiple regions to write
! from a single proc
! # All procs have VEC_LOCAL_SZ elements starting at offset
!   (sz * VEC_LOCAL_SZ) * iregion + VEC_LOCAL_SZ * rank + 1
!   where iregion  is the current region,
!         iregion = 0 => first region
!         iregion = 1 => second region and so on
! e.g. For VEC_LOCAL_SZ = 2, NUM_REGIONS=2
! e.g. 1)    [1,2,7,8] [3,4,9,10] [5,6,11,12]
SUBROUTINE get_1d_bc_mureg_info(rank, sz, dims, start, count)   ! pio_iodesc_tests.F90.in:90
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_iodesc_tests.F90.in:91
  integer, parameter :: NUM_REGIONS = 3   ! pio_iodesc_tests.F90.in:92
  integer, intent(in) :: rank   ! pio_iodesc_tests.F90.in:93
  integer, intent(in) :: sz   ! pio_iodesc_tests.F90.in:94
  integer, dimension(1), intent(out) :: dims   ! pio_iodesc_tests.F90.in:95
  integer, dimension(:), allocatable, intent(out) :: start   ! pio_iodesc_tests.F90.in:96
  integer, dimension(:), allocatable, intent(out) :: count   ! pio_iodesc_tests.F90.in:97
  integer :: i   ! pio_iodesc_tests.F90.in:98


  dims(1) = sz * VEC_LOCAL_SZ * NUM_REGIONS   ! pio_iodesc_tests.F90.in:100
  allocate(start(NUM_REGIONS))   ! pio_iodesc_tests.F90.in:101
  allocate(count(NUM_REGIONS))   ! pio_iodesc_tests.F90.in:102


  do i=1,NUM_REGIONS   ! pio_iodesc_tests.F90.in:104
    count(i) = VEC_LOCAL_SZ   ! pio_iodesc_tests.F90.in:105
    start(i) = rank * VEC_LOCAL_SZ + (i-1) * (sz * VEC_LOCAL_SZ) + 1   ! pio_iodesc_tests.F90.in:106
  end do   ! pio_iodesc_tests.F90.in:107


END SUBROUTINE get_1d_bc_mureg_info   ! pio_iodesc_tests.F90.in:109


! Get a block cyclic decomposition with multiple regions to write
! from a single proc, the number of regions written out by odd
! and even procs are different (not uniform).
! # All procs write regions of size VEC_LOCAL_SZ elements
! # Odd procs write NUM_REGIONS_ODD and even procs write
!   NUM_REGIONS_EVEN number of regions
! e.g. For VEC_LOCAL_SZ = 2, NUM_REGIONS_ODD=2, NUM_REGIONS_EVEN=1
! e.g. 1)    [1,2] [3,4,9,10] [5,6] [7,8,11,12]
SUBROUTINE get_1d_bc_mnureg_info(rank, sz, dims, start, count)   ! pio_iodesc_tests.F90.in:119
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_iodesc_tests.F90.in:120
  integer, parameter :: NUM_REGIONS_ODD = 3   ! pio_iodesc_tests.F90.in:121
  integer, parameter :: NUM_REGIONS_EVEN = 2   ! pio_iodesc_tests.F90.in:122
  integer, intent(in) :: rank   ! pio_iodesc_tests.F90.in:123
  integer, intent(in) :: sz   ! pio_iodesc_tests.F90.in:124
  integer, dimension(1), intent(out) :: dims   ! pio_iodesc_tests.F90.in:125
  integer, dimension(:), allocatable, intent(out) :: start   ! pio_iodesc_tests.F90.in:126
  integer, dimension(:), allocatable, intent(out) :: count   ! pio_iodesc_tests.F90.in:127


  integer :: num_regions, num_odd_procs, num_even_procs   ! pio_iodesc_tests.F90.in:129
  integer :: num_odd_procs_bfr_rank, num_even_procs_bfr_rank   ! pio_iodesc_tests.F90.in:130
  integer :: i, gcount   ! pio_iodesc_tests.F90.in:131
  logical :: is_even   ! pio_iodesc_tests.F90.in:132


  is_even = .false.   ! pio_iodesc_tests.F90.in:134
  if(mod(rank, 2) == 0) then   ! pio_iodesc_tests.F90.in:135
    is_even = .true.   ! pio_iodesc_tests.F90.in:136
  end if   ! pio_iodesc_tests.F90.in:137
  num_odd_procs = sz / 2   ! pio_iodesc_tests.F90.in:138
  num_even_procs = sz - num_odd_procs   ! pio_iodesc_tests.F90.in:139
  num_odd_procs_bfr_rank = rank/2   ! pio_iodesc_tests.F90.in:140
  num_even_procs_bfr_rank = (rank+1)/2   ! pio_iodesc_tests.F90.in:141


  if(is_even) then   ! pio_iodesc_tests.F90.in:143
    num_regions = NUM_REGIONS_EVEN   ! pio_iodesc_tests.F90.in:144
  else   ! pio_iodesc_tests.F90.in:145
    num_regions = NUM_REGIONS_ODD   ! pio_iodesc_tests.F90.in:146
  end if   ! pio_iodesc_tests.F90.in:147


  dims(1) = num_odd_procs * VEC_LOCAL_SZ * NUM_REGIONS_ODD +&
            num_even_procs * VEC_LOCAL_SZ * NUM_REGIONS_EVEN   ! pio_iodesc_tests.F90.in:150


  allocate(start(num_regions))   ! pio_iodesc_tests.F90.in:152
  allocate(count(num_regions))   ! pio_iodesc_tests.F90.in:153


  ! The number of values already written out globally
  gcount = 0   ! pio_iodesc_tests.F90.in:156
  do i=1,num_regions   ! pio_iodesc_tests.F90.in:157
    count(i) = VEC_LOCAL_SZ   ! pio_iodesc_tests.F90.in:158
    start(i) = gcount + 1   ! pio_iodesc_tests.F90.in:159
    if(i <= NUM_REGIONS_ODD) then   ! pio_iodesc_tests.F90.in:160
      start(i) = start(i) + num_odd_procs_bfr_rank * VEC_LOCAL_SZ   ! pio_iodesc_tests.F90.in:161
      gcount = gcount + num_odd_procs * VEC_LOCAL_SZ   ! pio_iodesc_tests.F90.in:162
    endif   ! pio_iodesc_tests.F90.in:163
    if(i <= NUM_REGIONS_EVEN) then   ! pio_iodesc_tests.F90.in:164
      start(i) = start(i) + num_even_procs_bfr_rank * VEC_LOCAL_SZ   ! pio_iodesc_tests.F90.in:165
      gcount = gcount + num_even_procs * VEC_LOCAL_SZ   ! pio_iodesc_tests.F90.in:166
    endif   ! pio_iodesc_tests.F90.in:167
  end do   ! pio_iodesc_tests.F90.in:168


END SUBROUTINE get_1d_bc_mnureg_info   ! pio_iodesc_tests.F90.in:170


! Write multiple frames of data, even frames with no shift - evenly
! divided across all procs, and odd frames with data evenly divided
! across all procs but with a global cyclic left shift


SUBROUTINE nc_wr_2d_two_iodescs_PIO_int_integer__
USE pio_tutil
   ! pio_iodesc_tests.F90.in:176
  implicit none   ! pio_iodesc_tests.F90.in:177
  interface   ! pio_iodesc_tests.F90.in:178
    subroutine get_1d_bc_shift_decomp_info(rank, sz, dims, start, count, nlshift)   ! pio_iodesc_tests.F90.in:179
      integer, intent(in) :: rank   ! pio_iodesc_tests.F90.in:180
      integer, intent(in) :: sz   ! pio_iodesc_tests.F90.in:181
      integer, dimension(1), intent(out) :: dims   ! pio_iodesc_tests.F90.in:182
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_iodesc_tests.F90.in:183
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_iodesc_tests.F90.in:184
      integer, intent(in) :: nlshift   ! pio_iodesc_tests.F90.in:185
    end subroutine get_1d_bc_shift_decomp_info   ! pio_iodesc_tests.F90.in:186
  end interface   ! pio_iodesc_tests.F90.in:187
  integer, parameter :: NDIMS = 2   ! pio_iodesc_tests.F90.in:188
  integer, parameter :: NFRAMES = 6   ! pio_iodesc_tests.F90.in:189
  integer, parameter :: NLSHIFT = 3   ! pio_iodesc_tests.F90.in:190
  integer, parameter :: NOSHIFT = 0   ! pio_iodesc_tests.F90.in:191
  type(var_desc_t)  :: pio_var   ! pio_iodesc_tests.F90.in:192
  type(file_desc_t) :: pio_file   ! pio_iodesc_tests.F90.in:193
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_iodesc_tests.F90.in:194
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_iodesc_tests.F90.in:195
  type(io_desc_t) :: wr_iodesc, rd_iodesc, wr_iodesc_shifted   ! pio_iodesc_tests.F90.in:196
  integer, dimension(:), allocatable :: compdof   ! pio_iodesc_tests.F90.in:197
  integer, dimension(:), allocatable :: start, count   ! pio_iodesc_tests.F90.in:198
  integer :: tot_count   ! pio_iodesc_tests.F90.in:199
  integer, dimension(:,:), allocatable :: rbuf, wbuf, exp_val   ! pio_iodesc_tests.F90.in:200
  integer, dimension(:,:), allocatable :: wbuf_shifted   ! pio_iodesc_tests.F90.in:201
  integer, dimension(NDIMS-1) :: dims   ! pio_iodesc_tests.F90.in:202
  integer, dimension(NDIMS) :: pio_dims   ! pio_iodesc_tests.F90.in:203
  integer :: i, j, k, nrows, ierr, lsz   ! pio_iodesc_tests.F90.in:204
  integer(kind=pio_offset_kind) :: f   ! pio_iodesc_tests.F90.in:205
  logical :: is_even_frame   ! pio_iodesc_tests.F90.in:206
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_iodesc_tests.F90.in:208
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_iodesc_tests.F90.in:209
  integer :: num_iotypes   ! pio_iodesc_tests.F90.in:210
   ! pio_iodesc_tests.F90.in:211
  ! No left shift - data evenly distributed across all procs
  ! even frames written out with no left shift
  call get_1d_bc_shift_decomp_info(pio_tf_world_rank_, pio_tf_world_sz_,&   ! pio_iodesc_tests.F90.in:214
        dims, start, count, NOSHIFT)   ! pio_iodesc_tests.F90.in:215
   ! pio_iodesc_tests.F90.in:216
  tot_count = 0   ! pio_iodesc_tests.F90.in:217
  do i=1,size(count)   ! pio_iodesc_tests.F90.in:218
    tot_count = tot_count + count(i)   ! pio_iodesc_tests.F90.in:219
  end do   ! pio_iodesc_tests.F90.in:220
   ! pio_iodesc_tests.F90.in:221
  nrows = tot_count   ! pio_iodesc_tests.F90.in:222
   ! pio_iodesc_tests.F90.in:223
  allocate(wbuf(nrows, NFRAMES))   ! pio_iodesc_tests.F90.in:224
  allocate(rbuf(nrows, NFRAMES))   ! pio_iodesc_tests.F90.in:225
  rbuf = 0   ! pio_iodesc_tests.F90.in:226
  allocate(exp_val(nrows, NFRAMES))   ! pio_iodesc_tests.F90.in:227
  allocate(compdof(nrows))   ! pio_iodesc_tests.F90.in:228
  k = 1   ! pio_iodesc_tests.F90.in:229
  do i=1, size(start)   ! pio_iodesc_tests.F90.in:230
    do j=0, count(i)-1   ! pio_iodesc_tests.F90.in:231
      compdof(k) = start(i) + j   ! pio_iodesc_tests.F90.in:232
      k = k + 1   ! pio_iodesc_tests.F90.in:233
    end do   ! pio_iodesc_tests.F90.in:234
  end do   ! pio_iodesc_tests.F90.in:235
   ! pio_iodesc_tests.F90.in:236
  if(allocated(start)) then   ! pio_iodesc_tests.F90.in:237
    deallocate(start)   ! pio_iodesc_tests.F90.in:238
  end if   ! pio_iodesc_tests.F90.in:239
  if(allocated(count)) then   ! pio_iodesc_tests.F90.in:240
    deallocate(count)   ! pio_iodesc_tests.F90.in:241
  end if   ! pio_iodesc_tests.F90.in:242
   ! pio_iodesc_tests.F90.in:243
  do f=1,NFRAMES   ! pio_iodesc_tests.F90.in:244
    do i=1,nrows   ! pio_iodesc_tests.F90.in:245
      wbuf(i,f) = compdof(i) + (f-1) * dims(1)   ! pio_iodesc_tests.F90.in:246
      exp_val(i,f) = wbuf(i,f)   ! pio_iodesc_tests.F90.in:247
    end do   ! pio_iodesc_tests.F90.in:248
  end do   ! pio_iodesc_tests.F90.in:249
   ! pio_iodesc_tests.F90.in:250
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof, wr_iodesc)   ! pio_iodesc_tests.F90.in:251
   ! pio_iodesc_tests.F90.in:252
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof, rd_iodesc)   ! pio_iodesc_tests.F90.in:253
  deallocate(compdof)   ! pio_iodesc_tests.F90.in:254
   ! pio_iodesc_tests.F90.in:255
  ! Decomp with left shift of NLSHIFT - used to write odd frames
  ! Note: dims is same irrespective of the shift
  call get_1d_bc_shift_decomp_info(pio_tf_world_rank_, pio_tf_world_sz_,&   ! pio_iodesc_tests.F90.in:258
        dims, start, count, NLSHIFT)   ! pio_iodesc_tests.F90.in:259
   ! pio_iodesc_tests.F90.in:260
  tot_count = 0   ! pio_iodesc_tests.F90.in:261
  do i=1,size(count)   ! pio_iodesc_tests.F90.in:262
    tot_count = tot_count + count(i)   ! pio_iodesc_tests.F90.in:263
  end do   ! pio_iodesc_tests.F90.in:264
   ! pio_iodesc_tests.F90.in:265
  nrows = tot_count   ! pio_iodesc_tests.F90.in:266
   ! pio_iodesc_tests.F90.in:267
  allocate(wbuf_shifted(nrows, NFRAMES))   ! pio_iodesc_tests.F90.in:268
  allocate(compdof(nrows))   ! pio_iodesc_tests.F90.in:269
   ! pio_iodesc_tests.F90.in:270
  k = 1   ! pio_iodesc_tests.F90.in:271
  do i=1, size(start)   ! pio_iodesc_tests.F90.in:272
    do j=0, count(i)-1   ! pio_iodesc_tests.F90.in:273
      compdof(k) = start(i) + j   ! pio_iodesc_tests.F90.in:274
      k = k + 1   ! pio_iodesc_tests.F90.in:275
    end do   ! pio_iodesc_tests.F90.in:276
  end do   ! pio_iodesc_tests.F90.in:277
   ! pio_iodesc_tests.F90.in:278
  if(allocated(start)) then   ! pio_iodesc_tests.F90.in:279
    deallocate(start)   ! pio_iodesc_tests.F90.in:280
  end if   ! pio_iodesc_tests.F90.in:281
  if(allocated(count)) then   ! pio_iodesc_tests.F90.in:282
    deallocate(count)   ! pio_iodesc_tests.F90.in:283
  end if   ! pio_iodesc_tests.F90.in:284
   ! pio_iodesc_tests.F90.in:285
  do f=1,NFRAMES   ! pio_iodesc_tests.F90.in:286
    do i=1,nrows   ! pio_iodesc_tests.F90.in:287
      wbuf_shifted(i,f) = compdof(i) + (f-1) * dims(1)   ! pio_iodesc_tests.F90.in:288
    end do   ! pio_iodesc_tests.F90.in:289
  end do   ! pio_iodesc_tests.F90.in:290
   ! pio_iodesc_tests.F90.in:291
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof,&   ! pio_iodesc_tests.F90.in:292
        wr_iodesc_shifted)   ! pio_iodesc_tests.F90.in:293
  deallocate(compdof)   ! pio_iodesc_tests.F90.in:294
   ! pio_iodesc_tests.F90.in:295
  num_iotypes = 0   ! pio_iodesc_tests.F90.in:296
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_iodesc_tests.F90.in:297
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_iodesc_tests.F90.in:298
  do i=1,num_iotypes   ! pio_iodesc_tests.F90.in:299

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_iodesc_tests.F90.in:300
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_iodesc_tests.F90.in:301
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:302)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:302
   ! pio_iodesc_tests.F90.in:303
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim_row', dims(1), pio_dims(1))   ! pio_iodesc_tests.F90.in:304
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:305)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:305
   ! pio_iodesc_tests.F90.in:306
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim_time', pio_unlimited, pio_dims(2))   ! pio_iodesc_tests.F90.in:307
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:308)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:308
   ! pio_iodesc_tests.F90.in:309
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_int, pio_dims, pio_var)   ! pio_iodesc_tests.F90.in:310
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:311)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:311
   ! pio_iodesc_tests.F90.in:312
    ierr = PIO_enddef(pio_file)   ! pio_iodesc_tests.F90.in:313
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:314)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:314
   ! pio_iodesc_tests.F90.in:315
    do f=1,NFRAMES   ! pio_iodesc_tests.F90.in:316
      if(mod(INT(f),2) == 0) then   ! pio_iodesc_tests.F90.in:317
        is_even_frame = .true.   ! pio_iodesc_tests.F90.in:318
      else   ! pio_iodesc_tests.F90.in:319
        is_even_frame = .false.   ! pio_iodesc_tests.F90.in:320
      end if   ! pio_iodesc_tests.F90.in:321
   ! pio_iodesc_tests.F90.in:322
      call PIO_setframe(pio_file, pio_var, f)   ! pio_iodesc_tests.F90.in:323
      ! Write the current frame - even frames have no shift, odd frames are
      ! left shifted by NLSHIFT elements
      if(is_even_frame) then   ! pio_iodesc_tests.F90.in:326
        call PIO_write_darray(pio_file, pio_var, wr_iodesc, wbuf(:,f), ierr)   ! pio_iodesc_tests.F90.in:327
      else   ! pio_iodesc_tests.F90.in:328
        call PIO_write_darray(pio_file, pio_var, wr_iodesc_shifted,&   ! pio_iodesc_tests.F90.in:329
               wbuf_shifted(:,f), ierr)   ! pio_iodesc_tests.F90.in:330
      end if   ! pio_iodesc_tests.F90.in:331
      
      IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to write darray : " // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(pio_iodesc_tests.F90.in:332)"
        END IF
        RETURN
      END IF   ! pio_iodesc_tests.F90.in:332
    end do   ! pio_iodesc_tests.F90.in:333
   ! pio_iodesc_tests.F90.in:334
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_iodesc_tests.F90.in:336
   ! pio_iodesc_tests.F90.in:337
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_iodesc_tests.F90.in:338
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:339)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:339
   ! pio_iodesc_tests.F90.in:340
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_iodesc_tests.F90.in:341
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:342)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:342
#else
    call PIO_syncfile(pio_file)   ! pio_iodesc_tests.F90.in:344
#endif
   ! pio_iodesc_tests.F90.in:346
    ! Read data - with no shift
    do f=1,NFRAMES   ! pio_iodesc_tests.F90.in:348
      call PIO_setframe(pio_file, pio_var, f)   ! pio_iodesc_tests.F90.in:349
      call PIO_read_darray(pio_file, pio_var, rd_iodesc, rbuf(:,f), ierr)   ! pio_iodesc_tests.F90.in:350
      
      IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to read darray : " // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(pio_iodesc_tests.F90.in:351)"
        END IF
        RETURN
      END IF   ! pio_iodesc_tests.F90.in:351
    end do   ! pio_iodesc_tests.F90.in:352
   ! pio_iodesc_tests.F90.in:353
    do f=1,NFRAMES   ! pio_iodesc_tests.F90.in:354
      
      IF (.NOT. PIO_TF_Check_val_(rbuf(:,f), exp_val(:,f))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Check failed:",&
             "Got wrong val, frame=", f,&
            ":", __FILE__, ":", __LINE__,&
            "(pio_iodesc_tests.F90.in:355)"
        END IF
        RETURN
      END IF   ! pio_iodesc_tests.F90.in:355
    end do   ! pio_iodesc_tests.F90.in:356
   ! pio_iodesc_tests.F90.in:357
    call PIO_closefile(pio_file)   ! pio_iodesc_tests.F90.in:358
       ! pio_iodesc_tests.F90.in:359
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_iodesc_tests.F90.in:360
  end do   ! pio_iodesc_tests.F90.in:361
   ! pio_iodesc_tests.F90.in:362
  if(allocated(iotypes)) then   ! pio_iodesc_tests.F90.in:363
    deallocate(iotypes)   ! pio_iodesc_tests.F90.in:364
    deallocate(iotype_descs)   ! pio_iodesc_tests.F90.in:365
  end if   ! pio_iodesc_tests.F90.in:366
   ! pio_iodesc_tests.F90.in:367
  call PIO_freedecomp(pio_tf_iosystem_, rd_iodesc)   ! pio_iodesc_tests.F90.in:368
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_iodesc_tests.F90.in:369
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc_shifted)   ! pio_iodesc_tests.F90.in:370
  deallocate(exp_val)   ! pio_iodesc_tests.F90.in:371
  deallocate(rbuf)   ! pio_iodesc_tests.F90.in:372
  deallocate(wbuf)   ! pio_iodesc_tests.F90.in:373
  deallocate(wbuf_shifted)   ! pio_iodesc_tests.F90.in:374
END SUBROUTINE nc_wr_2d_two_iodescs_PIO_int_integer__   ! pio_iodesc_tests.F90.in:375


SUBROUTINE nc_wr_2d_two_iodescs_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_iodesc_tests.F90.in:176
  implicit none   ! pio_iodesc_tests.F90.in:177
  interface   ! pio_iodesc_tests.F90.in:178
    subroutine get_1d_bc_shift_decomp_info(rank, sz, dims, start, count, nlshift)   ! pio_iodesc_tests.F90.in:179
      integer, intent(in) :: rank   ! pio_iodesc_tests.F90.in:180
      integer, intent(in) :: sz   ! pio_iodesc_tests.F90.in:181
      integer, dimension(1), intent(out) :: dims   ! pio_iodesc_tests.F90.in:182
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_iodesc_tests.F90.in:183
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_iodesc_tests.F90.in:184
      integer, intent(in) :: nlshift   ! pio_iodesc_tests.F90.in:185
    end subroutine get_1d_bc_shift_decomp_info   ! pio_iodesc_tests.F90.in:186
  end interface   ! pio_iodesc_tests.F90.in:187
  integer, parameter :: NDIMS = 2   ! pio_iodesc_tests.F90.in:188
  integer, parameter :: NFRAMES = 6   ! pio_iodesc_tests.F90.in:189
  integer, parameter :: NLSHIFT = 3   ! pio_iodesc_tests.F90.in:190
  integer, parameter :: NOSHIFT = 0   ! pio_iodesc_tests.F90.in:191
  type(var_desc_t)  :: pio_var   ! pio_iodesc_tests.F90.in:192
  type(file_desc_t) :: pio_file   ! pio_iodesc_tests.F90.in:193
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_iodesc_tests.F90.in:194
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_iodesc_tests.F90.in:195
  type(io_desc_t) :: wr_iodesc, rd_iodesc, wr_iodesc_shifted   ! pio_iodesc_tests.F90.in:196
  integer, dimension(:), allocatable :: compdof   ! pio_iodesc_tests.F90.in:197
  integer, dimension(:), allocatable :: start, count   ! pio_iodesc_tests.F90.in:198
  integer :: tot_count   ! pio_iodesc_tests.F90.in:199
  real(kind=fc_real), dimension(:,:), allocatable :: rbuf, wbuf, exp_val   ! pio_iodesc_tests.F90.in:200
  real(kind=fc_real), dimension(:,:), allocatable :: wbuf_shifted   ! pio_iodesc_tests.F90.in:201
  integer, dimension(NDIMS-1) :: dims   ! pio_iodesc_tests.F90.in:202
  integer, dimension(NDIMS) :: pio_dims   ! pio_iodesc_tests.F90.in:203
  integer :: i, j, k, nrows, ierr, lsz   ! pio_iodesc_tests.F90.in:204
  integer(kind=pio_offset_kind) :: f   ! pio_iodesc_tests.F90.in:205
  logical :: is_even_frame   ! pio_iodesc_tests.F90.in:206
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_iodesc_tests.F90.in:208
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_iodesc_tests.F90.in:209
  integer :: num_iotypes   ! pio_iodesc_tests.F90.in:210
   ! pio_iodesc_tests.F90.in:211
  ! No left shift - data evenly distributed across all procs
  ! even frames written out with no left shift
  call get_1d_bc_shift_decomp_info(pio_tf_world_rank_, pio_tf_world_sz_,&   ! pio_iodesc_tests.F90.in:214
        dims, start, count, NOSHIFT)   ! pio_iodesc_tests.F90.in:215
   ! pio_iodesc_tests.F90.in:216
  tot_count = 0   ! pio_iodesc_tests.F90.in:217
  do i=1,size(count)   ! pio_iodesc_tests.F90.in:218
    tot_count = tot_count + count(i)   ! pio_iodesc_tests.F90.in:219
  end do   ! pio_iodesc_tests.F90.in:220
   ! pio_iodesc_tests.F90.in:221
  nrows = tot_count   ! pio_iodesc_tests.F90.in:222
   ! pio_iodesc_tests.F90.in:223
  allocate(wbuf(nrows, NFRAMES))   ! pio_iodesc_tests.F90.in:224
  allocate(rbuf(nrows, NFRAMES))   ! pio_iodesc_tests.F90.in:225
  rbuf = 0   ! pio_iodesc_tests.F90.in:226
  allocate(exp_val(nrows, NFRAMES))   ! pio_iodesc_tests.F90.in:227
  allocate(compdof(nrows))   ! pio_iodesc_tests.F90.in:228
  k = 1   ! pio_iodesc_tests.F90.in:229
  do i=1, size(start)   ! pio_iodesc_tests.F90.in:230
    do j=0, count(i)-1   ! pio_iodesc_tests.F90.in:231
      compdof(k) = start(i) + j   ! pio_iodesc_tests.F90.in:232
      k = k + 1   ! pio_iodesc_tests.F90.in:233
    end do   ! pio_iodesc_tests.F90.in:234
  end do   ! pio_iodesc_tests.F90.in:235
   ! pio_iodesc_tests.F90.in:236
  if(allocated(start)) then   ! pio_iodesc_tests.F90.in:237
    deallocate(start)   ! pio_iodesc_tests.F90.in:238
  end if   ! pio_iodesc_tests.F90.in:239
  if(allocated(count)) then   ! pio_iodesc_tests.F90.in:240
    deallocate(count)   ! pio_iodesc_tests.F90.in:241
  end if   ! pio_iodesc_tests.F90.in:242
   ! pio_iodesc_tests.F90.in:243
  do f=1,NFRAMES   ! pio_iodesc_tests.F90.in:244
    do i=1,nrows   ! pio_iodesc_tests.F90.in:245
      wbuf(i,f) = compdof(i) + (f-1) * dims(1)   ! pio_iodesc_tests.F90.in:246
      exp_val(i,f) = wbuf(i,f)   ! pio_iodesc_tests.F90.in:247
    end do   ! pio_iodesc_tests.F90.in:248
  end do   ! pio_iodesc_tests.F90.in:249
   ! pio_iodesc_tests.F90.in:250
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof, wr_iodesc)   ! pio_iodesc_tests.F90.in:251
   ! pio_iodesc_tests.F90.in:252
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof, rd_iodesc)   ! pio_iodesc_tests.F90.in:253
  deallocate(compdof)   ! pio_iodesc_tests.F90.in:254
   ! pio_iodesc_tests.F90.in:255
  ! Decomp with left shift of NLSHIFT - used to write odd frames
  ! Note: dims is same irrespective of the shift
  call get_1d_bc_shift_decomp_info(pio_tf_world_rank_, pio_tf_world_sz_,&   ! pio_iodesc_tests.F90.in:258
        dims, start, count, NLSHIFT)   ! pio_iodesc_tests.F90.in:259
   ! pio_iodesc_tests.F90.in:260
  tot_count = 0   ! pio_iodesc_tests.F90.in:261
  do i=1,size(count)   ! pio_iodesc_tests.F90.in:262
    tot_count = tot_count + count(i)   ! pio_iodesc_tests.F90.in:263
  end do   ! pio_iodesc_tests.F90.in:264
   ! pio_iodesc_tests.F90.in:265
  nrows = tot_count   ! pio_iodesc_tests.F90.in:266
   ! pio_iodesc_tests.F90.in:267
  allocate(wbuf_shifted(nrows, NFRAMES))   ! pio_iodesc_tests.F90.in:268
  allocate(compdof(nrows))   ! pio_iodesc_tests.F90.in:269
   ! pio_iodesc_tests.F90.in:270
  k = 1   ! pio_iodesc_tests.F90.in:271
  do i=1, size(start)   ! pio_iodesc_tests.F90.in:272
    do j=0, count(i)-1   ! pio_iodesc_tests.F90.in:273
      compdof(k) = start(i) + j   ! pio_iodesc_tests.F90.in:274
      k = k + 1   ! pio_iodesc_tests.F90.in:275
    end do   ! pio_iodesc_tests.F90.in:276
  end do   ! pio_iodesc_tests.F90.in:277
   ! pio_iodesc_tests.F90.in:278
  if(allocated(start)) then   ! pio_iodesc_tests.F90.in:279
    deallocate(start)   ! pio_iodesc_tests.F90.in:280
  end if   ! pio_iodesc_tests.F90.in:281
  if(allocated(count)) then   ! pio_iodesc_tests.F90.in:282
    deallocate(count)   ! pio_iodesc_tests.F90.in:283
  end if   ! pio_iodesc_tests.F90.in:284
   ! pio_iodesc_tests.F90.in:285
  do f=1,NFRAMES   ! pio_iodesc_tests.F90.in:286
    do i=1,nrows   ! pio_iodesc_tests.F90.in:287
      wbuf_shifted(i,f) = compdof(i) + (f-1) * dims(1)   ! pio_iodesc_tests.F90.in:288
    end do   ! pio_iodesc_tests.F90.in:289
  end do   ! pio_iodesc_tests.F90.in:290
   ! pio_iodesc_tests.F90.in:291
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof,&   ! pio_iodesc_tests.F90.in:292
        wr_iodesc_shifted)   ! pio_iodesc_tests.F90.in:293
  deallocate(compdof)   ! pio_iodesc_tests.F90.in:294
   ! pio_iodesc_tests.F90.in:295
  num_iotypes = 0   ! pio_iodesc_tests.F90.in:296
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_iodesc_tests.F90.in:297
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_iodesc_tests.F90.in:298
  do i=1,num_iotypes   ! pio_iodesc_tests.F90.in:299

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_iodesc_tests.F90.in:300
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_iodesc_tests.F90.in:301
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:302)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:302
   ! pio_iodesc_tests.F90.in:303
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim_row', dims(1), pio_dims(1))   ! pio_iodesc_tests.F90.in:304
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:305)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:305
   ! pio_iodesc_tests.F90.in:306
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim_time', pio_unlimited, pio_dims(2))   ! pio_iodesc_tests.F90.in:307
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:308)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:308
   ! pio_iodesc_tests.F90.in:309
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_real, pio_dims, pio_var)   ! pio_iodesc_tests.F90.in:310
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:311)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:311
   ! pio_iodesc_tests.F90.in:312
    ierr = PIO_enddef(pio_file)   ! pio_iodesc_tests.F90.in:313
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:314)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:314
   ! pio_iodesc_tests.F90.in:315
    do f=1,NFRAMES   ! pio_iodesc_tests.F90.in:316
      if(mod(INT(f),2) == 0) then   ! pio_iodesc_tests.F90.in:317
        is_even_frame = .true.   ! pio_iodesc_tests.F90.in:318
      else   ! pio_iodesc_tests.F90.in:319
        is_even_frame = .false.   ! pio_iodesc_tests.F90.in:320
      end if   ! pio_iodesc_tests.F90.in:321
   ! pio_iodesc_tests.F90.in:322
      call PIO_setframe(pio_file, pio_var, f)   ! pio_iodesc_tests.F90.in:323
      ! Write the current frame - even frames have no shift, odd frames are
      ! left shifted by NLSHIFT elements
      if(is_even_frame) then   ! pio_iodesc_tests.F90.in:326
        call PIO_write_darray(pio_file, pio_var, wr_iodesc, wbuf(:,f), ierr)   ! pio_iodesc_tests.F90.in:327
      else   ! pio_iodesc_tests.F90.in:328
        call PIO_write_darray(pio_file, pio_var, wr_iodesc_shifted,&   ! pio_iodesc_tests.F90.in:329
               wbuf_shifted(:,f), ierr)   ! pio_iodesc_tests.F90.in:330
      end if   ! pio_iodesc_tests.F90.in:331
      
      IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to write darray : " // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(pio_iodesc_tests.F90.in:332)"
        END IF
        RETURN
      END IF   ! pio_iodesc_tests.F90.in:332
    end do   ! pio_iodesc_tests.F90.in:333
   ! pio_iodesc_tests.F90.in:334
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_iodesc_tests.F90.in:336
   ! pio_iodesc_tests.F90.in:337
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_iodesc_tests.F90.in:338
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:339)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:339
   ! pio_iodesc_tests.F90.in:340
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_iodesc_tests.F90.in:341
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:342)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:342
#else
    call PIO_syncfile(pio_file)   ! pio_iodesc_tests.F90.in:344
#endif
   ! pio_iodesc_tests.F90.in:346
    ! Read data - with no shift
    do f=1,NFRAMES   ! pio_iodesc_tests.F90.in:348
      call PIO_setframe(pio_file, pio_var, f)   ! pio_iodesc_tests.F90.in:349
      call PIO_read_darray(pio_file, pio_var, rd_iodesc, rbuf(:,f), ierr)   ! pio_iodesc_tests.F90.in:350
      
      IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to read darray : " // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(pio_iodesc_tests.F90.in:351)"
        END IF
        RETURN
      END IF   ! pio_iodesc_tests.F90.in:351
    end do   ! pio_iodesc_tests.F90.in:352
   ! pio_iodesc_tests.F90.in:353
    do f=1,NFRAMES   ! pio_iodesc_tests.F90.in:354
      
      IF (.NOT. PIO_TF_Check_val_(rbuf(:,f), exp_val(:,f))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Check failed:",&
             "Got wrong val, frame=", f,&
            ":", __FILE__, ":", __LINE__,&
            "(pio_iodesc_tests.F90.in:355)"
        END IF
        RETURN
      END IF   ! pio_iodesc_tests.F90.in:355
    end do   ! pio_iodesc_tests.F90.in:356
   ! pio_iodesc_tests.F90.in:357
    call PIO_closefile(pio_file)   ! pio_iodesc_tests.F90.in:358
       ! pio_iodesc_tests.F90.in:359
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_iodesc_tests.F90.in:360
  end do   ! pio_iodesc_tests.F90.in:361
   ! pio_iodesc_tests.F90.in:362
  if(allocated(iotypes)) then   ! pio_iodesc_tests.F90.in:363
    deallocate(iotypes)   ! pio_iodesc_tests.F90.in:364
    deallocate(iotype_descs)   ! pio_iodesc_tests.F90.in:365
  end if   ! pio_iodesc_tests.F90.in:366
   ! pio_iodesc_tests.F90.in:367
  call PIO_freedecomp(pio_tf_iosystem_, rd_iodesc)   ! pio_iodesc_tests.F90.in:368
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_iodesc_tests.F90.in:369
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc_shifted)   ! pio_iodesc_tests.F90.in:370
  deallocate(exp_val)   ! pio_iodesc_tests.F90.in:371
  deallocate(rbuf)   ! pio_iodesc_tests.F90.in:372
  deallocate(wbuf)   ! pio_iodesc_tests.F90.in:373
  deallocate(wbuf_shifted)   ! pio_iodesc_tests.F90.in:374
END SUBROUTINE nc_wr_2d_two_iodescs_PIO_real_real_kind_fc_real___   ! pio_iodesc_tests.F90.in:375


SUBROUTINE nc_wr_2d_two_iodescs_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_iodesc_tests.F90.in:176
  implicit none   ! pio_iodesc_tests.F90.in:177
  interface   ! pio_iodesc_tests.F90.in:178
    subroutine get_1d_bc_shift_decomp_info(rank, sz, dims, start, count, nlshift)   ! pio_iodesc_tests.F90.in:179
      integer, intent(in) :: rank   ! pio_iodesc_tests.F90.in:180
      integer, intent(in) :: sz   ! pio_iodesc_tests.F90.in:181
      integer, dimension(1), intent(out) :: dims   ! pio_iodesc_tests.F90.in:182
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_iodesc_tests.F90.in:183
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_iodesc_tests.F90.in:184
      integer, intent(in) :: nlshift   ! pio_iodesc_tests.F90.in:185
    end subroutine get_1d_bc_shift_decomp_info   ! pio_iodesc_tests.F90.in:186
  end interface   ! pio_iodesc_tests.F90.in:187
  integer, parameter :: NDIMS = 2   ! pio_iodesc_tests.F90.in:188
  integer, parameter :: NFRAMES = 6   ! pio_iodesc_tests.F90.in:189
  integer, parameter :: NLSHIFT = 3   ! pio_iodesc_tests.F90.in:190
  integer, parameter :: NOSHIFT = 0   ! pio_iodesc_tests.F90.in:191
  type(var_desc_t)  :: pio_var   ! pio_iodesc_tests.F90.in:192
  type(file_desc_t) :: pio_file   ! pio_iodesc_tests.F90.in:193
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_iodesc_tests.F90.in:194
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_iodesc_tests.F90.in:195
  type(io_desc_t) :: wr_iodesc, rd_iodesc, wr_iodesc_shifted   ! pio_iodesc_tests.F90.in:196
  integer, dimension(:), allocatable :: compdof   ! pio_iodesc_tests.F90.in:197
  integer, dimension(:), allocatable :: start, count   ! pio_iodesc_tests.F90.in:198
  integer :: tot_count   ! pio_iodesc_tests.F90.in:199
  real(kind=fc_double), dimension(:,:), allocatable :: rbuf, wbuf, exp_val   ! pio_iodesc_tests.F90.in:200
  real(kind=fc_double), dimension(:,:), allocatable :: wbuf_shifted   ! pio_iodesc_tests.F90.in:201
  integer, dimension(NDIMS-1) :: dims   ! pio_iodesc_tests.F90.in:202
  integer, dimension(NDIMS) :: pio_dims   ! pio_iodesc_tests.F90.in:203
  integer :: i, j, k, nrows, ierr, lsz   ! pio_iodesc_tests.F90.in:204
  integer(kind=pio_offset_kind) :: f   ! pio_iodesc_tests.F90.in:205
  logical :: is_even_frame   ! pio_iodesc_tests.F90.in:206
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_iodesc_tests.F90.in:208
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_iodesc_tests.F90.in:209
  integer :: num_iotypes   ! pio_iodesc_tests.F90.in:210
   ! pio_iodesc_tests.F90.in:211
  ! No left shift - data evenly distributed across all procs
  ! even frames written out with no left shift
  call get_1d_bc_shift_decomp_info(pio_tf_world_rank_, pio_tf_world_sz_,&   ! pio_iodesc_tests.F90.in:214
        dims, start, count, NOSHIFT)   ! pio_iodesc_tests.F90.in:215
   ! pio_iodesc_tests.F90.in:216
  tot_count = 0   ! pio_iodesc_tests.F90.in:217
  do i=1,size(count)   ! pio_iodesc_tests.F90.in:218
    tot_count = tot_count + count(i)   ! pio_iodesc_tests.F90.in:219
  end do   ! pio_iodesc_tests.F90.in:220
   ! pio_iodesc_tests.F90.in:221
  nrows = tot_count   ! pio_iodesc_tests.F90.in:222
   ! pio_iodesc_tests.F90.in:223
  allocate(wbuf(nrows, NFRAMES))   ! pio_iodesc_tests.F90.in:224
  allocate(rbuf(nrows, NFRAMES))   ! pio_iodesc_tests.F90.in:225
  rbuf = 0   ! pio_iodesc_tests.F90.in:226
  allocate(exp_val(nrows, NFRAMES))   ! pio_iodesc_tests.F90.in:227
  allocate(compdof(nrows))   ! pio_iodesc_tests.F90.in:228
  k = 1   ! pio_iodesc_tests.F90.in:229
  do i=1, size(start)   ! pio_iodesc_tests.F90.in:230
    do j=0, count(i)-1   ! pio_iodesc_tests.F90.in:231
      compdof(k) = start(i) + j   ! pio_iodesc_tests.F90.in:232
      k = k + 1   ! pio_iodesc_tests.F90.in:233
    end do   ! pio_iodesc_tests.F90.in:234
  end do   ! pio_iodesc_tests.F90.in:235
   ! pio_iodesc_tests.F90.in:236
  if(allocated(start)) then   ! pio_iodesc_tests.F90.in:237
    deallocate(start)   ! pio_iodesc_tests.F90.in:238
  end if   ! pio_iodesc_tests.F90.in:239
  if(allocated(count)) then   ! pio_iodesc_tests.F90.in:240
    deallocate(count)   ! pio_iodesc_tests.F90.in:241
  end if   ! pio_iodesc_tests.F90.in:242
   ! pio_iodesc_tests.F90.in:243
  do f=1,NFRAMES   ! pio_iodesc_tests.F90.in:244
    do i=1,nrows   ! pio_iodesc_tests.F90.in:245
      wbuf(i,f) = compdof(i) + (f-1) * dims(1)   ! pio_iodesc_tests.F90.in:246
      exp_val(i,f) = wbuf(i,f)   ! pio_iodesc_tests.F90.in:247
    end do   ! pio_iodesc_tests.F90.in:248
  end do   ! pio_iodesc_tests.F90.in:249
   ! pio_iodesc_tests.F90.in:250
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof, wr_iodesc)   ! pio_iodesc_tests.F90.in:251
   ! pio_iodesc_tests.F90.in:252
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof, rd_iodesc)   ! pio_iodesc_tests.F90.in:253
  deallocate(compdof)   ! pio_iodesc_tests.F90.in:254
   ! pio_iodesc_tests.F90.in:255
  ! Decomp with left shift of NLSHIFT - used to write odd frames
  ! Note: dims is same irrespective of the shift
  call get_1d_bc_shift_decomp_info(pio_tf_world_rank_, pio_tf_world_sz_,&   ! pio_iodesc_tests.F90.in:258
        dims, start, count, NLSHIFT)   ! pio_iodesc_tests.F90.in:259
   ! pio_iodesc_tests.F90.in:260
  tot_count = 0   ! pio_iodesc_tests.F90.in:261
  do i=1,size(count)   ! pio_iodesc_tests.F90.in:262
    tot_count = tot_count + count(i)   ! pio_iodesc_tests.F90.in:263
  end do   ! pio_iodesc_tests.F90.in:264
   ! pio_iodesc_tests.F90.in:265
  nrows = tot_count   ! pio_iodesc_tests.F90.in:266
   ! pio_iodesc_tests.F90.in:267
  allocate(wbuf_shifted(nrows, NFRAMES))   ! pio_iodesc_tests.F90.in:268
  allocate(compdof(nrows))   ! pio_iodesc_tests.F90.in:269
   ! pio_iodesc_tests.F90.in:270
  k = 1   ! pio_iodesc_tests.F90.in:271
  do i=1, size(start)   ! pio_iodesc_tests.F90.in:272
    do j=0, count(i)-1   ! pio_iodesc_tests.F90.in:273
      compdof(k) = start(i) + j   ! pio_iodesc_tests.F90.in:274
      k = k + 1   ! pio_iodesc_tests.F90.in:275
    end do   ! pio_iodesc_tests.F90.in:276
  end do   ! pio_iodesc_tests.F90.in:277
   ! pio_iodesc_tests.F90.in:278
  if(allocated(start)) then   ! pio_iodesc_tests.F90.in:279
    deallocate(start)   ! pio_iodesc_tests.F90.in:280
  end if   ! pio_iodesc_tests.F90.in:281
  if(allocated(count)) then   ! pio_iodesc_tests.F90.in:282
    deallocate(count)   ! pio_iodesc_tests.F90.in:283
  end if   ! pio_iodesc_tests.F90.in:284
   ! pio_iodesc_tests.F90.in:285
  do f=1,NFRAMES   ! pio_iodesc_tests.F90.in:286
    do i=1,nrows   ! pio_iodesc_tests.F90.in:287
      wbuf_shifted(i,f) = compdof(i) + (f-1) * dims(1)   ! pio_iodesc_tests.F90.in:288
    end do   ! pio_iodesc_tests.F90.in:289
  end do   ! pio_iodesc_tests.F90.in:290
   ! pio_iodesc_tests.F90.in:291
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof,&   ! pio_iodesc_tests.F90.in:292
        wr_iodesc_shifted)   ! pio_iodesc_tests.F90.in:293
  deallocate(compdof)   ! pio_iodesc_tests.F90.in:294
   ! pio_iodesc_tests.F90.in:295
  num_iotypes = 0   ! pio_iodesc_tests.F90.in:296
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_iodesc_tests.F90.in:297
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_iodesc_tests.F90.in:298
  do i=1,num_iotypes   ! pio_iodesc_tests.F90.in:299

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_iodesc_tests.F90.in:300
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_iodesc_tests.F90.in:301
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:302)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:302
   ! pio_iodesc_tests.F90.in:303
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim_row', dims(1), pio_dims(1))   ! pio_iodesc_tests.F90.in:304
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:305)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:305
   ! pio_iodesc_tests.F90.in:306
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim_time', pio_unlimited, pio_dims(2))   ! pio_iodesc_tests.F90.in:307
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:308)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:308
   ! pio_iodesc_tests.F90.in:309
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_double, pio_dims, pio_var)   ! pio_iodesc_tests.F90.in:310
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:311)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:311
   ! pio_iodesc_tests.F90.in:312
    ierr = PIO_enddef(pio_file)   ! pio_iodesc_tests.F90.in:313
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:314)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:314
   ! pio_iodesc_tests.F90.in:315
    do f=1,NFRAMES   ! pio_iodesc_tests.F90.in:316
      if(mod(INT(f),2) == 0) then   ! pio_iodesc_tests.F90.in:317
        is_even_frame = .true.   ! pio_iodesc_tests.F90.in:318
      else   ! pio_iodesc_tests.F90.in:319
        is_even_frame = .false.   ! pio_iodesc_tests.F90.in:320
      end if   ! pio_iodesc_tests.F90.in:321
   ! pio_iodesc_tests.F90.in:322
      call PIO_setframe(pio_file, pio_var, f)   ! pio_iodesc_tests.F90.in:323
      ! Write the current frame - even frames have no shift, odd frames are
      ! left shifted by NLSHIFT elements
      if(is_even_frame) then   ! pio_iodesc_tests.F90.in:326
        call PIO_write_darray(pio_file, pio_var, wr_iodesc, wbuf(:,f), ierr)   ! pio_iodesc_tests.F90.in:327
      else   ! pio_iodesc_tests.F90.in:328
        call PIO_write_darray(pio_file, pio_var, wr_iodesc_shifted,&   ! pio_iodesc_tests.F90.in:329
               wbuf_shifted(:,f), ierr)   ! pio_iodesc_tests.F90.in:330
      end if   ! pio_iodesc_tests.F90.in:331
      
      IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to write darray : " // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(pio_iodesc_tests.F90.in:332)"
        END IF
        RETURN
      END IF   ! pio_iodesc_tests.F90.in:332
    end do   ! pio_iodesc_tests.F90.in:333
   ! pio_iodesc_tests.F90.in:334
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_iodesc_tests.F90.in:336
   ! pio_iodesc_tests.F90.in:337
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_iodesc_tests.F90.in:338
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:339)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:339
   ! pio_iodesc_tests.F90.in:340
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_iodesc_tests.F90.in:341
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:342)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:342
#else
    call PIO_syncfile(pio_file)   ! pio_iodesc_tests.F90.in:344
#endif
   ! pio_iodesc_tests.F90.in:346
    ! Read data - with no shift
    do f=1,NFRAMES   ! pio_iodesc_tests.F90.in:348
      call PIO_setframe(pio_file, pio_var, f)   ! pio_iodesc_tests.F90.in:349
      call PIO_read_darray(pio_file, pio_var, rd_iodesc, rbuf(:,f), ierr)   ! pio_iodesc_tests.F90.in:350
      
      IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to read darray : " // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(pio_iodesc_tests.F90.in:351)"
        END IF
        RETURN
      END IF   ! pio_iodesc_tests.F90.in:351
    end do   ! pio_iodesc_tests.F90.in:352
   ! pio_iodesc_tests.F90.in:353
    do f=1,NFRAMES   ! pio_iodesc_tests.F90.in:354
      
      IF (.NOT. PIO_TF_Check_val_(rbuf(:,f), exp_val(:,f))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Check failed:",&
             "Got wrong val, frame=", f,&
            ":", __FILE__, ":", __LINE__,&
            "(pio_iodesc_tests.F90.in:355)"
        END IF
        RETURN
      END IF   ! pio_iodesc_tests.F90.in:355
    end do   ! pio_iodesc_tests.F90.in:356
   ! pio_iodesc_tests.F90.in:357
    call PIO_closefile(pio_file)   ! pio_iodesc_tests.F90.in:358
       ! pio_iodesc_tests.F90.in:359
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_iodesc_tests.F90.in:360
  end do   ! pio_iodesc_tests.F90.in:361
   ! pio_iodesc_tests.F90.in:362
  if(allocated(iotypes)) then   ! pio_iodesc_tests.F90.in:363
    deallocate(iotypes)   ! pio_iodesc_tests.F90.in:364
    deallocate(iotype_descs)   ! pio_iodesc_tests.F90.in:365
  end if   ! pio_iodesc_tests.F90.in:366
   ! pio_iodesc_tests.F90.in:367
  call PIO_freedecomp(pio_tf_iosystem_, rd_iodesc)   ! pio_iodesc_tests.F90.in:368
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_iodesc_tests.F90.in:369
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc_shifted)   ! pio_iodesc_tests.F90.in:370
  deallocate(exp_val)   ! pio_iodesc_tests.F90.in:371
  deallocate(rbuf)   ! pio_iodesc_tests.F90.in:372
  deallocate(wbuf)   ! pio_iodesc_tests.F90.in:373
  deallocate(wbuf_shifted)   ! pio_iodesc_tests.F90.in:374
END SUBROUTINE nc_wr_2d_two_iodescs_PIO_double_real_kind_fc_double___   ! pio_iodesc_tests.F90.in:375
   ! pio_iodesc_tests.F90.in:375


! Write two variables with multiple contiguous regions of data
! The regions are uniform (same number of regions) across all
! procs


SUBROUTINE nc_mureg_wr_rd_1d_bc_PIO_int_integer__
USE pio_tutil
   ! pio_iodesc_tests.F90.in:381
  implicit none   ! pio_iodesc_tests.F90.in:382
  interface   ! pio_iodesc_tests.F90.in:383
    subroutine get_1d_bc_mureg_info(rank, sz, dims, start, count)   ! pio_iodesc_tests.F90.in:384
      integer, intent(in) :: rank   ! pio_iodesc_tests.F90.in:385
      integer, intent(in) :: sz   ! pio_iodesc_tests.F90.in:386
      integer, dimension(1), intent(out) :: dims   ! pio_iodesc_tests.F90.in:387
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_iodesc_tests.F90.in:388
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_iodesc_tests.F90.in:389
    end subroutine get_1d_bc_mureg_info   ! pio_iodesc_tests.F90.in:390
  end interface   ! pio_iodesc_tests.F90.in:391
  type(var_desc_t)  :: pio_var1, pio_var2   ! pio_iodesc_tests.F90.in:392
  type(file_desc_t) :: pio_file   ! pio_iodesc_tests.F90.in:393
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_iodesc_tests.F90.in:394
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1_mureg'   ! pio_iodesc_tests.F90.in:395
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2_mureg'   ! pio_iodesc_tests.F90.in:396
  type(io_desc_t) :: iodesc_mureg   ! pio_iodesc_tests.F90.in:397
  integer, dimension(:), allocatable :: compdof   ! pio_iodesc_tests.F90.in:398
  integer, dimension(:), allocatable :: start, count   ! pio_iodesc_tests.F90.in:399
  integer :: total_count   ! pio_iodesc_tests.F90.in:400
  integer, dimension(:), allocatable :: rbuf_mureg, wbuf_mureg   ! pio_iodesc_tests.F90.in:401
  integer, dimension(1) :: dims_mureg   ! pio_iodesc_tests.F90.in:402
  integer :: pio_dim_mureg   ! pio_iodesc_tests.F90.in:403
  integer :: i, j, idx, ierr, lsz   ! pio_iodesc_tests.F90.in:404
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_iodesc_tests.F90.in:406
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_iodesc_tests.F90.in:407
  integer :: num_iotypes   ! pio_iodesc_tests.F90.in:408
   ! pio_iodesc_tests.F90.in:409
  call get_1d_bc_mureg_info(pio_tf_world_rank_, pio_tf_world_sz_,&   ! pio_iodesc_tests.F90.in:410
         dims_mureg, start, count)   ! pio_iodesc_tests.F90.in:411
  total_count = 0   ! pio_iodesc_tests.F90.in:412
  do i=1,size(count)   ! pio_iodesc_tests.F90.in:413
    total_count = total_count + count(i)   ! pio_iodesc_tests.F90.in:414
  end do   ! pio_iodesc_tests.F90.in:415
  allocate(wbuf_mureg(total_count))   ! pio_iodesc_tests.F90.in:416
  allocate(rbuf_mureg(total_count))   ! pio_iodesc_tests.F90.in:417
  allocate(compdof(total_count))   ! pio_iodesc_tests.F90.in:418
  do i=1,size(count)   ! pio_iodesc_tests.F90.in:419
    do j=1,count(i)   ! pio_iodesc_tests.F90.in:420
      idx = (i-1)*count(i) + j   ! pio_iodesc_tests.F90.in:421
      compdof(idx) = start(i) + j - 1   ! pio_iodesc_tests.F90.in:422
      wbuf_mureg(idx) = compdof(idx)   ! pio_iodesc_tests.F90.in:423
      rbuf_mureg(idx) = compdof(idx)   ! pio_iodesc_tests.F90.in:424
    end do   ! pio_iodesc_tests.F90.in:425
  end do   ! pio_iodesc_tests.F90.in:426
  if(allocated(start)) then   ! pio_iodesc_tests.F90.in:427
    deallocate(start)   ! pio_iodesc_tests.F90.in:428
  end if   ! pio_iodesc_tests.F90.in:429
  if(allocated(count)) then   ! pio_iodesc_tests.F90.in:430
    deallocate(count)   ! pio_iodesc_tests.F90.in:431
  end if   ! pio_iodesc_tests.F90.in:432
   ! pio_iodesc_tests.F90.in:433
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims_mureg, compdof, iodesc_mureg)   ! pio_iodesc_tests.F90.in:434
  deallocate(compdof)   ! pio_iodesc_tests.F90.in:435
   ! pio_iodesc_tests.F90.in:436
  num_iotypes = 0   ! pio_iodesc_tests.F90.in:437
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_iodesc_tests.F90.in:438
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_iodesc_tests.F90.in:439
  do i=1,num_iotypes   ! pio_iodesc_tests.F90.in:440

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_iodesc_tests.F90.in:441
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! pio_iodesc_tests.F90.in:442
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:443)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:443
   ! pio_iodesc_tests.F90.in:444
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim_mureg', dims_mureg(1), pio_dim_mureg)   ! pio_iodesc_tests.F90.in:445
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim (mureg) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:446)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:446
   ! pio_iodesc_tests.F90.in:447
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_int, (/pio_dim_mureg/), pio_var1)   ! pio_iodesc_tests.F90.in:448
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:449)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:449
   ! pio_iodesc_tests.F90.in:450
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_int, (/pio_dim_mureg/), pio_var2)   ! pio_iodesc_tests.F90.in:451
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:452)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:452
   ! pio_iodesc_tests.F90.in:453
    ierr = PIO_enddef(pio_file)   ! pio_iodesc_tests.F90.in:454
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:455)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:455
   ! pio_iodesc_tests.F90.in:456
    ! Write the variables out
    call PIO_write_darray(pio_file, pio_var1, iodesc_mureg, wbuf_mureg, ierr)   ! pio_iodesc_tests.F90.in:458
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:459)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:459
   ! pio_iodesc_tests.F90.in:460
    call PIO_write_darray(pio_file, pio_var2, iodesc_mureg, wbuf_mureg, ierr)   ! pio_iodesc_tests.F90.in:461
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:462)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:462
   ! pio_iodesc_tests.F90.in:463
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_iodesc_tests.F90.in:465
   ! pio_iodesc_tests.F90.in:466
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_iodesc_tests.F90.in:467
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:468)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:468
   ! pio_iodesc_tests.F90.in:469
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_iodesc_tests.F90.in:470
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:471)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:471
   ! pio_iodesc_tests.F90.in:472
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_iodesc_tests.F90.in:473
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:474)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:474
#else
    call PIO_syncfile(pio_file)   ! pio_iodesc_tests.F90.in:476
#endif
   ! pio_iodesc_tests.F90.in:478
    rbuf_mureg = 0   ! pio_iodesc_tests.F90.in:479
    call PIO_read_darray(pio_file, pio_var1, iodesc_mureg, rbuf_mureg, ierr)   ! pio_iodesc_tests.F90.in:480
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var1): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:481)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:481
   ! pio_iodesc_tests.F90.in:482
    
    IF (.NOT. PIO_TF_Check_val_(rbuf_mureg, wbuf_mureg)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var1)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:483)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:483
   ! pio_iodesc_tests.F90.in:484
    rbuf_mureg = 0   ! pio_iodesc_tests.F90.in:485
    call PIO_read_darray(pio_file, pio_var2, iodesc_mureg, rbuf_mureg, ierr)   ! pio_iodesc_tests.F90.in:486
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var2): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:487)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:487
   ! pio_iodesc_tests.F90.in:488
    
    IF (.NOT. PIO_TF_Check_val_(rbuf_mureg, wbuf_mureg)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var2)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:489)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:489
   ! pio_iodesc_tests.F90.in:490
    call PIO_closefile(pio_file)   ! pio_iodesc_tests.F90.in:491
   ! pio_iodesc_tests.F90.in:492
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_iodesc_tests.F90.in:493
  end do   ! pio_iodesc_tests.F90.in:494
   ! pio_iodesc_tests.F90.in:495
  if(allocated(iotypes)) then   ! pio_iodesc_tests.F90.in:496
    deallocate(iotypes)   ! pio_iodesc_tests.F90.in:497
    deallocate(iotype_descs)   ! pio_iodesc_tests.F90.in:498
  end if   ! pio_iodesc_tests.F90.in:499
   ! pio_iodesc_tests.F90.in:500
  call PIO_freedecomp(pio_tf_iosystem_, iodesc_mureg)   ! pio_iodesc_tests.F90.in:501
  deallocate(rbuf_mureg)   ! pio_iodesc_tests.F90.in:502
  deallocate(wbuf_mureg)   ! pio_iodesc_tests.F90.in:503
END SUBROUTINE nc_mureg_wr_rd_1d_bc_PIO_int_integer__   ! pio_iodesc_tests.F90.in:504


SUBROUTINE nc_mureg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_iodesc_tests.F90.in:381
  implicit none   ! pio_iodesc_tests.F90.in:382
  interface   ! pio_iodesc_tests.F90.in:383
    subroutine get_1d_bc_mureg_info(rank, sz, dims, start, count)   ! pio_iodesc_tests.F90.in:384
      integer, intent(in) :: rank   ! pio_iodesc_tests.F90.in:385
      integer, intent(in) :: sz   ! pio_iodesc_tests.F90.in:386
      integer, dimension(1), intent(out) :: dims   ! pio_iodesc_tests.F90.in:387
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_iodesc_tests.F90.in:388
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_iodesc_tests.F90.in:389
    end subroutine get_1d_bc_mureg_info   ! pio_iodesc_tests.F90.in:390
  end interface   ! pio_iodesc_tests.F90.in:391
  type(var_desc_t)  :: pio_var1, pio_var2   ! pio_iodesc_tests.F90.in:392
  type(file_desc_t) :: pio_file   ! pio_iodesc_tests.F90.in:393
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_iodesc_tests.F90.in:394
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1_mureg'   ! pio_iodesc_tests.F90.in:395
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2_mureg'   ! pio_iodesc_tests.F90.in:396
  type(io_desc_t) :: iodesc_mureg   ! pio_iodesc_tests.F90.in:397
  integer, dimension(:), allocatable :: compdof   ! pio_iodesc_tests.F90.in:398
  integer, dimension(:), allocatable :: start, count   ! pio_iodesc_tests.F90.in:399
  integer :: total_count   ! pio_iodesc_tests.F90.in:400
  real(kind=fc_real), dimension(:), allocatable :: rbuf_mureg, wbuf_mureg   ! pio_iodesc_tests.F90.in:401
  integer, dimension(1) :: dims_mureg   ! pio_iodesc_tests.F90.in:402
  integer :: pio_dim_mureg   ! pio_iodesc_tests.F90.in:403
  integer :: i, j, idx, ierr, lsz   ! pio_iodesc_tests.F90.in:404
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_iodesc_tests.F90.in:406
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_iodesc_tests.F90.in:407
  integer :: num_iotypes   ! pio_iodesc_tests.F90.in:408
   ! pio_iodesc_tests.F90.in:409
  call get_1d_bc_mureg_info(pio_tf_world_rank_, pio_tf_world_sz_,&   ! pio_iodesc_tests.F90.in:410
         dims_mureg, start, count)   ! pio_iodesc_tests.F90.in:411
  total_count = 0   ! pio_iodesc_tests.F90.in:412
  do i=1,size(count)   ! pio_iodesc_tests.F90.in:413
    total_count = total_count + count(i)   ! pio_iodesc_tests.F90.in:414
  end do   ! pio_iodesc_tests.F90.in:415
  allocate(wbuf_mureg(total_count))   ! pio_iodesc_tests.F90.in:416
  allocate(rbuf_mureg(total_count))   ! pio_iodesc_tests.F90.in:417
  allocate(compdof(total_count))   ! pio_iodesc_tests.F90.in:418
  do i=1,size(count)   ! pio_iodesc_tests.F90.in:419
    do j=1,count(i)   ! pio_iodesc_tests.F90.in:420
      idx = (i-1)*count(i) + j   ! pio_iodesc_tests.F90.in:421
      compdof(idx) = start(i) + j - 1   ! pio_iodesc_tests.F90.in:422
      wbuf_mureg(idx) = compdof(idx)   ! pio_iodesc_tests.F90.in:423
      rbuf_mureg(idx) = compdof(idx)   ! pio_iodesc_tests.F90.in:424
    end do   ! pio_iodesc_tests.F90.in:425
  end do   ! pio_iodesc_tests.F90.in:426
  if(allocated(start)) then   ! pio_iodesc_tests.F90.in:427
    deallocate(start)   ! pio_iodesc_tests.F90.in:428
  end if   ! pio_iodesc_tests.F90.in:429
  if(allocated(count)) then   ! pio_iodesc_tests.F90.in:430
    deallocate(count)   ! pio_iodesc_tests.F90.in:431
  end if   ! pio_iodesc_tests.F90.in:432
   ! pio_iodesc_tests.F90.in:433
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims_mureg, compdof, iodesc_mureg)   ! pio_iodesc_tests.F90.in:434
  deallocate(compdof)   ! pio_iodesc_tests.F90.in:435
   ! pio_iodesc_tests.F90.in:436
  num_iotypes = 0   ! pio_iodesc_tests.F90.in:437
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_iodesc_tests.F90.in:438
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_iodesc_tests.F90.in:439
  do i=1,num_iotypes   ! pio_iodesc_tests.F90.in:440

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_iodesc_tests.F90.in:441
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! pio_iodesc_tests.F90.in:442
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:443)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:443
   ! pio_iodesc_tests.F90.in:444
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim_mureg', dims_mureg(1), pio_dim_mureg)   ! pio_iodesc_tests.F90.in:445
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim (mureg) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:446)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:446
   ! pio_iodesc_tests.F90.in:447
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_real, (/pio_dim_mureg/), pio_var1)   ! pio_iodesc_tests.F90.in:448
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:449)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:449
   ! pio_iodesc_tests.F90.in:450
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_real, (/pio_dim_mureg/), pio_var2)   ! pio_iodesc_tests.F90.in:451
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:452)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:452
   ! pio_iodesc_tests.F90.in:453
    ierr = PIO_enddef(pio_file)   ! pio_iodesc_tests.F90.in:454
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:455)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:455
   ! pio_iodesc_tests.F90.in:456
    ! Write the variables out
    call PIO_write_darray(pio_file, pio_var1, iodesc_mureg, wbuf_mureg, ierr)   ! pio_iodesc_tests.F90.in:458
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:459)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:459
   ! pio_iodesc_tests.F90.in:460
    call PIO_write_darray(pio_file, pio_var2, iodesc_mureg, wbuf_mureg, ierr)   ! pio_iodesc_tests.F90.in:461
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:462)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:462
   ! pio_iodesc_tests.F90.in:463
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_iodesc_tests.F90.in:465
   ! pio_iodesc_tests.F90.in:466
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_iodesc_tests.F90.in:467
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:468)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:468
   ! pio_iodesc_tests.F90.in:469
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_iodesc_tests.F90.in:470
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:471)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:471
   ! pio_iodesc_tests.F90.in:472
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_iodesc_tests.F90.in:473
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:474)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:474
#else
    call PIO_syncfile(pio_file)   ! pio_iodesc_tests.F90.in:476
#endif
   ! pio_iodesc_tests.F90.in:478
    rbuf_mureg = 0   ! pio_iodesc_tests.F90.in:479
    call PIO_read_darray(pio_file, pio_var1, iodesc_mureg, rbuf_mureg, ierr)   ! pio_iodesc_tests.F90.in:480
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var1): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:481)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:481
   ! pio_iodesc_tests.F90.in:482
    
    IF (.NOT. PIO_TF_Check_val_(rbuf_mureg, wbuf_mureg)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var1)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:483)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:483
   ! pio_iodesc_tests.F90.in:484
    rbuf_mureg = 0   ! pio_iodesc_tests.F90.in:485
    call PIO_read_darray(pio_file, pio_var2, iodesc_mureg, rbuf_mureg, ierr)   ! pio_iodesc_tests.F90.in:486
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var2): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:487)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:487
   ! pio_iodesc_tests.F90.in:488
    
    IF (.NOT. PIO_TF_Check_val_(rbuf_mureg, wbuf_mureg)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var2)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:489)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:489
   ! pio_iodesc_tests.F90.in:490
    call PIO_closefile(pio_file)   ! pio_iodesc_tests.F90.in:491
   ! pio_iodesc_tests.F90.in:492
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_iodesc_tests.F90.in:493
  end do   ! pio_iodesc_tests.F90.in:494
   ! pio_iodesc_tests.F90.in:495
  if(allocated(iotypes)) then   ! pio_iodesc_tests.F90.in:496
    deallocate(iotypes)   ! pio_iodesc_tests.F90.in:497
    deallocate(iotype_descs)   ! pio_iodesc_tests.F90.in:498
  end if   ! pio_iodesc_tests.F90.in:499
   ! pio_iodesc_tests.F90.in:500
  call PIO_freedecomp(pio_tf_iosystem_, iodesc_mureg)   ! pio_iodesc_tests.F90.in:501
  deallocate(rbuf_mureg)   ! pio_iodesc_tests.F90.in:502
  deallocate(wbuf_mureg)   ! pio_iodesc_tests.F90.in:503
END SUBROUTINE nc_mureg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___   ! pio_iodesc_tests.F90.in:504


SUBROUTINE nc_mureg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_iodesc_tests.F90.in:381
  implicit none   ! pio_iodesc_tests.F90.in:382
  interface   ! pio_iodesc_tests.F90.in:383
    subroutine get_1d_bc_mureg_info(rank, sz, dims, start, count)   ! pio_iodesc_tests.F90.in:384
      integer, intent(in) :: rank   ! pio_iodesc_tests.F90.in:385
      integer, intent(in) :: sz   ! pio_iodesc_tests.F90.in:386
      integer, dimension(1), intent(out) :: dims   ! pio_iodesc_tests.F90.in:387
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_iodesc_tests.F90.in:388
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_iodesc_tests.F90.in:389
    end subroutine get_1d_bc_mureg_info   ! pio_iodesc_tests.F90.in:390
  end interface   ! pio_iodesc_tests.F90.in:391
  type(var_desc_t)  :: pio_var1, pio_var2   ! pio_iodesc_tests.F90.in:392
  type(file_desc_t) :: pio_file   ! pio_iodesc_tests.F90.in:393
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_iodesc_tests.F90.in:394
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1_mureg'   ! pio_iodesc_tests.F90.in:395
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2_mureg'   ! pio_iodesc_tests.F90.in:396
  type(io_desc_t) :: iodesc_mureg   ! pio_iodesc_tests.F90.in:397
  integer, dimension(:), allocatable :: compdof   ! pio_iodesc_tests.F90.in:398
  integer, dimension(:), allocatable :: start, count   ! pio_iodesc_tests.F90.in:399
  integer :: total_count   ! pio_iodesc_tests.F90.in:400
  real(kind=fc_double), dimension(:), allocatable :: rbuf_mureg, wbuf_mureg   ! pio_iodesc_tests.F90.in:401
  integer, dimension(1) :: dims_mureg   ! pio_iodesc_tests.F90.in:402
  integer :: pio_dim_mureg   ! pio_iodesc_tests.F90.in:403
  integer :: i, j, idx, ierr, lsz   ! pio_iodesc_tests.F90.in:404
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_iodesc_tests.F90.in:406
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_iodesc_tests.F90.in:407
  integer :: num_iotypes   ! pio_iodesc_tests.F90.in:408
   ! pio_iodesc_tests.F90.in:409
  call get_1d_bc_mureg_info(pio_tf_world_rank_, pio_tf_world_sz_,&   ! pio_iodesc_tests.F90.in:410
         dims_mureg, start, count)   ! pio_iodesc_tests.F90.in:411
  total_count = 0   ! pio_iodesc_tests.F90.in:412
  do i=1,size(count)   ! pio_iodesc_tests.F90.in:413
    total_count = total_count + count(i)   ! pio_iodesc_tests.F90.in:414
  end do   ! pio_iodesc_tests.F90.in:415
  allocate(wbuf_mureg(total_count))   ! pio_iodesc_tests.F90.in:416
  allocate(rbuf_mureg(total_count))   ! pio_iodesc_tests.F90.in:417
  allocate(compdof(total_count))   ! pio_iodesc_tests.F90.in:418
  do i=1,size(count)   ! pio_iodesc_tests.F90.in:419
    do j=1,count(i)   ! pio_iodesc_tests.F90.in:420
      idx = (i-1)*count(i) + j   ! pio_iodesc_tests.F90.in:421
      compdof(idx) = start(i) + j - 1   ! pio_iodesc_tests.F90.in:422
      wbuf_mureg(idx) = compdof(idx)   ! pio_iodesc_tests.F90.in:423
      rbuf_mureg(idx) = compdof(idx)   ! pio_iodesc_tests.F90.in:424
    end do   ! pio_iodesc_tests.F90.in:425
  end do   ! pio_iodesc_tests.F90.in:426
  if(allocated(start)) then   ! pio_iodesc_tests.F90.in:427
    deallocate(start)   ! pio_iodesc_tests.F90.in:428
  end if   ! pio_iodesc_tests.F90.in:429
  if(allocated(count)) then   ! pio_iodesc_tests.F90.in:430
    deallocate(count)   ! pio_iodesc_tests.F90.in:431
  end if   ! pio_iodesc_tests.F90.in:432
   ! pio_iodesc_tests.F90.in:433
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims_mureg, compdof, iodesc_mureg)   ! pio_iodesc_tests.F90.in:434
  deallocate(compdof)   ! pio_iodesc_tests.F90.in:435
   ! pio_iodesc_tests.F90.in:436
  num_iotypes = 0   ! pio_iodesc_tests.F90.in:437
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_iodesc_tests.F90.in:438
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_iodesc_tests.F90.in:439
  do i=1,num_iotypes   ! pio_iodesc_tests.F90.in:440

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_iodesc_tests.F90.in:441
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! pio_iodesc_tests.F90.in:442
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:443)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:443
   ! pio_iodesc_tests.F90.in:444
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim_mureg', dims_mureg(1), pio_dim_mureg)   ! pio_iodesc_tests.F90.in:445
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim (mureg) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:446)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:446
   ! pio_iodesc_tests.F90.in:447
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_double, (/pio_dim_mureg/), pio_var1)   ! pio_iodesc_tests.F90.in:448
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:449)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:449
   ! pio_iodesc_tests.F90.in:450
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_double, (/pio_dim_mureg/), pio_var2)   ! pio_iodesc_tests.F90.in:451
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:452)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:452
   ! pio_iodesc_tests.F90.in:453
    ierr = PIO_enddef(pio_file)   ! pio_iodesc_tests.F90.in:454
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:455)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:455
   ! pio_iodesc_tests.F90.in:456
    ! Write the variables out
    call PIO_write_darray(pio_file, pio_var1, iodesc_mureg, wbuf_mureg, ierr)   ! pio_iodesc_tests.F90.in:458
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:459)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:459
   ! pio_iodesc_tests.F90.in:460
    call PIO_write_darray(pio_file, pio_var2, iodesc_mureg, wbuf_mureg, ierr)   ! pio_iodesc_tests.F90.in:461
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:462)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:462
   ! pio_iodesc_tests.F90.in:463
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_iodesc_tests.F90.in:465
   ! pio_iodesc_tests.F90.in:466
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_iodesc_tests.F90.in:467
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:468)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:468
   ! pio_iodesc_tests.F90.in:469
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_iodesc_tests.F90.in:470
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:471)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:471
   ! pio_iodesc_tests.F90.in:472
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_iodesc_tests.F90.in:473
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:474)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:474
#else
    call PIO_syncfile(pio_file)   ! pio_iodesc_tests.F90.in:476
#endif
   ! pio_iodesc_tests.F90.in:478
    rbuf_mureg = 0   ! pio_iodesc_tests.F90.in:479
    call PIO_read_darray(pio_file, pio_var1, iodesc_mureg, rbuf_mureg, ierr)   ! pio_iodesc_tests.F90.in:480
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var1): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:481)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:481
   ! pio_iodesc_tests.F90.in:482
    
    IF (.NOT. PIO_TF_Check_val_(rbuf_mureg, wbuf_mureg)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var1)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:483)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:483
   ! pio_iodesc_tests.F90.in:484
    rbuf_mureg = 0   ! pio_iodesc_tests.F90.in:485
    call PIO_read_darray(pio_file, pio_var2, iodesc_mureg, rbuf_mureg, ierr)   ! pio_iodesc_tests.F90.in:486
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var2): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:487)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:487
   ! pio_iodesc_tests.F90.in:488
    
    IF (.NOT. PIO_TF_Check_val_(rbuf_mureg, wbuf_mureg)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var2)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:489)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:489
   ! pio_iodesc_tests.F90.in:490
    call PIO_closefile(pio_file)   ! pio_iodesc_tests.F90.in:491
   ! pio_iodesc_tests.F90.in:492
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_iodesc_tests.F90.in:493
  end do   ! pio_iodesc_tests.F90.in:494
   ! pio_iodesc_tests.F90.in:495
  if(allocated(iotypes)) then   ! pio_iodesc_tests.F90.in:496
    deallocate(iotypes)   ! pio_iodesc_tests.F90.in:497
    deallocate(iotype_descs)   ! pio_iodesc_tests.F90.in:498
  end if   ! pio_iodesc_tests.F90.in:499
   ! pio_iodesc_tests.F90.in:500
  call PIO_freedecomp(pio_tf_iosystem_, iodesc_mureg)   ! pio_iodesc_tests.F90.in:501
  deallocate(rbuf_mureg)   ! pio_iodesc_tests.F90.in:502
  deallocate(wbuf_mureg)   ! pio_iodesc_tests.F90.in:503
END SUBROUTINE nc_mureg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___   ! pio_iodesc_tests.F90.in:504
   ! pio_iodesc_tests.F90.in:504


! Write two variables with multiple contiguous regions of data
! The regions are non-uniform (Odd and even procs write out different
! number of regions)


SUBROUTINE nc_mnureg_wr_rd_1d_bc_PIO_int_integer__
USE pio_tutil
   ! pio_iodesc_tests.F90.in:510
  implicit none   ! pio_iodesc_tests.F90.in:511
  interface   ! pio_iodesc_tests.F90.in:512
    subroutine get_1d_bc_mnureg_info(rank, sz, dims, start, count)   ! pio_iodesc_tests.F90.in:513
      integer, intent(in) :: rank   ! pio_iodesc_tests.F90.in:514
      integer, intent(in) :: sz   ! pio_iodesc_tests.F90.in:515
      integer, dimension(1), intent(out) :: dims   ! pio_iodesc_tests.F90.in:516
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_iodesc_tests.F90.in:517
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_iodesc_tests.F90.in:518
    end subroutine get_1d_bc_mnureg_info   ! pio_iodesc_tests.F90.in:519
  end interface   ! pio_iodesc_tests.F90.in:520
  type(var_desc_t)  :: pio_var1, pio_var2   ! pio_iodesc_tests.F90.in:521
  type(file_desc_t) :: pio_file   ! pio_iodesc_tests.F90.in:522
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_iodesc_tests.F90.in:523
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1_mnureg'   ! pio_iodesc_tests.F90.in:524
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2_mnureg'   ! pio_iodesc_tests.F90.in:525
  type(io_desc_t) :: iodesc_mnureg   ! pio_iodesc_tests.F90.in:526
  integer, dimension(:), allocatable :: compdof   ! pio_iodesc_tests.F90.in:527
  integer, dimension(:), allocatable :: start, count   ! pio_iodesc_tests.F90.in:528
  integer :: total_count   ! pio_iodesc_tests.F90.in:529
  integer, dimension(:), allocatable :: rbuf_mnureg, wbuf_mnureg   ! pio_iodesc_tests.F90.in:530
  integer, dimension(1) :: dims_mnureg   ! pio_iodesc_tests.F90.in:531
  integer :: pio_dim_mnureg   ! pio_iodesc_tests.F90.in:532
  integer :: i, j, idx, ierr, lsz   ! pio_iodesc_tests.F90.in:533
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_iodesc_tests.F90.in:535
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_iodesc_tests.F90.in:536
  integer :: num_iotypes   ! pio_iodesc_tests.F90.in:537
   ! pio_iodesc_tests.F90.in:538
  call get_1d_bc_mnureg_info(pio_tf_world_rank_, pio_tf_world_sz_,&   ! pio_iodesc_tests.F90.in:539
         dims_mnureg, start, count)   ! pio_iodesc_tests.F90.in:540
  total_count = 0   ! pio_iodesc_tests.F90.in:541
  do i=1,size(count)   ! pio_iodesc_tests.F90.in:542
    total_count = total_count + count(i)   ! pio_iodesc_tests.F90.in:543
  end do   ! pio_iodesc_tests.F90.in:544
  allocate(wbuf_mnureg(total_count))   ! pio_iodesc_tests.F90.in:545
  allocate(rbuf_mnureg(total_count))   ! pio_iodesc_tests.F90.in:546
  allocate(compdof(total_count))   ! pio_iodesc_tests.F90.in:547
  do i=1,size(count)   ! pio_iodesc_tests.F90.in:548
    do j=1,count(i)   ! pio_iodesc_tests.F90.in:549
      idx = (i-1)*count(i) + j   ! pio_iodesc_tests.F90.in:550
      compdof(idx) = start(i) + j - 1   ! pio_iodesc_tests.F90.in:551
      wbuf_mnureg(idx) = compdof(idx)   ! pio_iodesc_tests.F90.in:552
      rbuf_mnureg(idx) = compdof(idx)   ! pio_iodesc_tests.F90.in:553
    end do   ! pio_iodesc_tests.F90.in:554
  end do   ! pio_iodesc_tests.F90.in:555
  if(allocated(start)) then   ! pio_iodesc_tests.F90.in:556
    deallocate(start)   ! pio_iodesc_tests.F90.in:557
  end if   ! pio_iodesc_tests.F90.in:558
  if(allocated(count)) then   ! pio_iodesc_tests.F90.in:559
    deallocate(count)   ! pio_iodesc_tests.F90.in:560
  end if   ! pio_iodesc_tests.F90.in:561
   ! pio_iodesc_tests.F90.in:562
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims_mnureg, compdof, iodesc_mnureg)   ! pio_iodesc_tests.F90.in:563
  deallocate(compdof)   ! pio_iodesc_tests.F90.in:564
   ! pio_iodesc_tests.F90.in:565
  num_iotypes = 0   ! pio_iodesc_tests.F90.in:566
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_iodesc_tests.F90.in:567
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_iodesc_tests.F90.in:568
  do i=1,num_iotypes   ! pio_iodesc_tests.F90.in:569

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_iodesc_tests.F90.in:570
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! pio_iodesc_tests.F90.in:571
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:572)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:572
   ! pio_iodesc_tests.F90.in:573
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim_mnureg', dims_mnureg(1), pio_dim_mnureg)   ! pio_iodesc_tests.F90.in:574
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim (mnureg) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:575)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:575
   ! pio_iodesc_tests.F90.in:576
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_int, (/pio_dim_mnureg/), pio_var1)   ! pio_iodesc_tests.F90.in:577
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:578)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:578
   ! pio_iodesc_tests.F90.in:579
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_int, (/pio_dim_mnureg/), pio_var2)   ! pio_iodesc_tests.F90.in:580
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:581)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:581
   ! pio_iodesc_tests.F90.in:582
    ierr = PIO_enddef(pio_file)   ! pio_iodesc_tests.F90.in:583
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:584)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:584
   ! pio_iodesc_tests.F90.in:585
    ! Write the variables out
    call PIO_write_darray(pio_file, pio_var1, iodesc_mnureg, wbuf_mnureg, ierr)   ! pio_iodesc_tests.F90.in:587
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:588)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:588
   ! pio_iodesc_tests.F90.in:589
    call PIO_write_darray(pio_file, pio_var2, iodesc_mnureg, wbuf_mnureg, ierr)   ! pio_iodesc_tests.F90.in:590
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:591)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:591
   ! pio_iodesc_tests.F90.in:592
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_iodesc_tests.F90.in:594
   ! pio_iodesc_tests.F90.in:595
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_iodesc_tests.F90.in:596
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:597)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:597
   ! pio_iodesc_tests.F90.in:598
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_iodesc_tests.F90.in:599
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:600)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:600
   ! pio_iodesc_tests.F90.in:601
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_iodesc_tests.F90.in:602
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:603)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:603
#else
    call PIO_syncfile(pio_file)   ! pio_iodesc_tests.F90.in:605
#endif
   ! pio_iodesc_tests.F90.in:607
    rbuf_mnureg = 0   ! pio_iodesc_tests.F90.in:608
    call PIO_read_darray(pio_file, pio_var1, iodesc_mnureg, rbuf_mnureg, ierr)   ! pio_iodesc_tests.F90.in:609
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var1): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:610)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:610
   ! pio_iodesc_tests.F90.in:611
    
    IF (.NOT. PIO_TF_Check_val_(rbuf_mnureg, wbuf_mnureg)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var1)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:612)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:612
   ! pio_iodesc_tests.F90.in:613
    rbuf_mnureg = 0   ! pio_iodesc_tests.F90.in:614
    call PIO_read_darray(pio_file, pio_var2, iodesc_mnureg, rbuf_mnureg, ierr)   ! pio_iodesc_tests.F90.in:615
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var2): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:616)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:616
   ! pio_iodesc_tests.F90.in:617
    
    IF (.NOT. PIO_TF_Check_val_(rbuf_mnureg, wbuf_mnureg)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var2)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:618)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:618
   ! pio_iodesc_tests.F90.in:619
    call PIO_closefile(pio_file)   ! pio_iodesc_tests.F90.in:620
   ! pio_iodesc_tests.F90.in:621
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_iodesc_tests.F90.in:622
  end do   ! pio_iodesc_tests.F90.in:623
   ! pio_iodesc_tests.F90.in:624
  if(allocated(iotypes)) then   ! pio_iodesc_tests.F90.in:625
    deallocate(iotypes)   ! pio_iodesc_tests.F90.in:626
    deallocate(iotype_descs)   ! pio_iodesc_tests.F90.in:627
  end if   ! pio_iodesc_tests.F90.in:628
   ! pio_iodesc_tests.F90.in:629
  call PIO_freedecomp(pio_tf_iosystem_, iodesc_mnureg)   ! pio_iodesc_tests.F90.in:630
  deallocate(rbuf_mnureg)   ! pio_iodesc_tests.F90.in:631
  deallocate(wbuf_mnureg)   ! pio_iodesc_tests.F90.in:632
END SUBROUTINE nc_mnureg_wr_rd_1d_bc_PIO_int_integer__   ! pio_iodesc_tests.F90.in:633


SUBROUTINE nc_mnureg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_iodesc_tests.F90.in:510
  implicit none   ! pio_iodesc_tests.F90.in:511
  interface   ! pio_iodesc_tests.F90.in:512
    subroutine get_1d_bc_mnureg_info(rank, sz, dims, start, count)   ! pio_iodesc_tests.F90.in:513
      integer, intent(in) :: rank   ! pio_iodesc_tests.F90.in:514
      integer, intent(in) :: sz   ! pio_iodesc_tests.F90.in:515
      integer, dimension(1), intent(out) :: dims   ! pio_iodesc_tests.F90.in:516
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_iodesc_tests.F90.in:517
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_iodesc_tests.F90.in:518
    end subroutine get_1d_bc_mnureg_info   ! pio_iodesc_tests.F90.in:519
  end interface   ! pio_iodesc_tests.F90.in:520
  type(var_desc_t)  :: pio_var1, pio_var2   ! pio_iodesc_tests.F90.in:521
  type(file_desc_t) :: pio_file   ! pio_iodesc_tests.F90.in:522
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_iodesc_tests.F90.in:523
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1_mnureg'   ! pio_iodesc_tests.F90.in:524
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2_mnureg'   ! pio_iodesc_tests.F90.in:525
  type(io_desc_t) :: iodesc_mnureg   ! pio_iodesc_tests.F90.in:526
  integer, dimension(:), allocatable :: compdof   ! pio_iodesc_tests.F90.in:527
  integer, dimension(:), allocatable :: start, count   ! pio_iodesc_tests.F90.in:528
  integer :: total_count   ! pio_iodesc_tests.F90.in:529
  real(kind=fc_real), dimension(:), allocatable :: rbuf_mnureg, wbuf_mnureg   ! pio_iodesc_tests.F90.in:530
  integer, dimension(1) :: dims_mnureg   ! pio_iodesc_tests.F90.in:531
  integer :: pio_dim_mnureg   ! pio_iodesc_tests.F90.in:532
  integer :: i, j, idx, ierr, lsz   ! pio_iodesc_tests.F90.in:533
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_iodesc_tests.F90.in:535
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_iodesc_tests.F90.in:536
  integer :: num_iotypes   ! pio_iodesc_tests.F90.in:537
   ! pio_iodesc_tests.F90.in:538
  call get_1d_bc_mnureg_info(pio_tf_world_rank_, pio_tf_world_sz_,&   ! pio_iodesc_tests.F90.in:539
         dims_mnureg, start, count)   ! pio_iodesc_tests.F90.in:540
  total_count = 0   ! pio_iodesc_tests.F90.in:541
  do i=1,size(count)   ! pio_iodesc_tests.F90.in:542
    total_count = total_count + count(i)   ! pio_iodesc_tests.F90.in:543
  end do   ! pio_iodesc_tests.F90.in:544
  allocate(wbuf_mnureg(total_count))   ! pio_iodesc_tests.F90.in:545
  allocate(rbuf_mnureg(total_count))   ! pio_iodesc_tests.F90.in:546
  allocate(compdof(total_count))   ! pio_iodesc_tests.F90.in:547
  do i=1,size(count)   ! pio_iodesc_tests.F90.in:548
    do j=1,count(i)   ! pio_iodesc_tests.F90.in:549
      idx = (i-1)*count(i) + j   ! pio_iodesc_tests.F90.in:550
      compdof(idx) = start(i) + j - 1   ! pio_iodesc_tests.F90.in:551
      wbuf_mnureg(idx) = compdof(idx)   ! pio_iodesc_tests.F90.in:552
      rbuf_mnureg(idx) = compdof(idx)   ! pio_iodesc_tests.F90.in:553
    end do   ! pio_iodesc_tests.F90.in:554
  end do   ! pio_iodesc_tests.F90.in:555
  if(allocated(start)) then   ! pio_iodesc_tests.F90.in:556
    deallocate(start)   ! pio_iodesc_tests.F90.in:557
  end if   ! pio_iodesc_tests.F90.in:558
  if(allocated(count)) then   ! pio_iodesc_tests.F90.in:559
    deallocate(count)   ! pio_iodesc_tests.F90.in:560
  end if   ! pio_iodesc_tests.F90.in:561
   ! pio_iodesc_tests.F90.in:562
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims_mnureg, compdof, iodesc_mnureg)   ! pio_iodesc_tests.F90.in:563
  deallocate(compdof)   ! pio_iodesc_tests.F90.in:564
   ! pio_iodesc_tests.F90.in:565
  num_iotypes = 0   ! pio_iodesc_tests.F90.in:566
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_iodesc_tests.F90.in:567
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_iodesc_tests.F90.in:568
  do i=1,num_iotypes   ! pio_iodesc_tests.F90.in:569

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_iodesc_tests.F90.in:570
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! pio_iodesc_tests.F90.in:571
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:572)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:572
   ! pio_iodesc_tests.F90.in:573
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim_mnureg', dims_mnureg(1), pio_dim_mnureg)   ! pio_iodesc_tests.F90.in:574
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim (mnureg) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:575)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:575
   ! pio_iodesc_tests.F90.in:576
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_real, (/pio_dim_mnureg/), pio_var1)   ! pio_iodesc_tests.F90.in:577
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:578)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:578
   ! pio_iodesc_tests.F90.in:579
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_real, (/pio_dim_mnureg/), pio_var2)   ! pio_iodesc_tests.F90.in:580
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:581)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:581
   ! pio_iodesc_tests.F90.in:582
    ierr = PIO_enddef(pio_file)   ! pio_iodesc_tests.F90.in:583
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:584)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:584
   ! pio_iodesc_tests.F90.in:585
    ! Write the variables out
    call PIO_write_darray(pio_file, pio_var1, iodesc_mnureg, wbuf_mnureg, ierr)   ! pio_iodesc_tests.F90.in:587
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:588)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:588
   ! pio_iodesc_tests.F90.in:589
    call PIO_write_darray(pio_file, pio_var2, iodesc_mnureg, wbuf_mnureg, ierr)   ! pio_iodesc_tests.F90.in:590
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:591)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:591
   ! pio_iodesc_tests.F90.in:592
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_iodesc_tests.F90.in:594
   ! pio_iodesc_tests.F90.in:595
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_iodesc_tests.F90.in:596
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:597)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:597
   ! pio_iodesc_tests.F90.in:598
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_iodesc_tests.F90.in:599
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:600)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:600
   ! pio_iodesc_tests.F90.in:601
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_iodesc_tests.F90.in:602
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:603)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:603
#else
    call PIO_syncfile(pio_file)   ! pio_iodesc_tests.F90.in:605
#endif
   ! pio_iodesc_tests.F90.in:607
    rbuf_mnureg = 0   ! pio_iodesc_tests.F90.in:608
    call PIO_read_darray(pio_file, pio_var1, iodesc_mnureg, rbuf_mnureg, ierr)   ! pio_iodesc_tests.F90.in:609
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var1): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:610)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:610
   ! pio_iodesc_tests.F90.in:611
    
    IF (.NOT. PIO_TF_Check_val_(rbuf_mnureg, wbuf_mnureg)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var1)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:612)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:612
   ! pio_iodesc_tests.F90.in:613
    rbuf_mnureg = 0   ! pio_iodesc_tests.F90.in:614
    call PIO_read_darray(pio_file, pio_var2, iodesc_mnureg, rbuf_mnureg, ierr)   ! pio_iodesc_tests.F90.in:615
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var2): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:616)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:616
   ! pio_iodesc_tests.F90.in:617
    
    IF (.NOT. PIO_TF_Check_val_(rbuf_mnureg, wbuf_mnureg)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var2)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:618)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:618
   ! pio_iodesc_tests.F90.in:619
    call PIO_closefile(pio_file)   ! pio_iodesc_tests.F90.in:620
   ! pio_iodesc_tests.F90.in:621
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_iodesc_tests.F90.in:622
  end do   ! pio_iodesc_tests.F90.in:623
   ! pio_iodesc_tests.F90.in:624
  if(allocated(iotypes)) then   ! pio_iodesc_tests.F90.in:625
    deallocate(iotypes)   ! pio_iodesc_tests.F90.in:626
    deallocate(iotype_descs)   ! pio_iodesc_tests.F90.in:627
  end if   ! pio_iodesc_tests.F90.in:628
   ! pio_iodesc_tests.F90.in:629
  call PIO_freedecomp(pio_tf_iosystem_, iodesc_mnureg)   ! pio_iodesc_tests.F90.in:630
  deallocate(rbuf_mnureg)   ! pio_iodesc_tests.F90.in:631
  deallocate(wbuf_mnureg)   ! pio_iodesc_tests.F90.in:632
END SUBROUTINE nc_mnureg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___   ! pio_iodesc_tests.F90.in:633


SUBROUTINE nc_mnureg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_iodesc_tests.F90.in:510
  implicit none   ! pio_iodesc_tests.F90.in:511
  interface   ! pio_iodesc_tests.F90.in:512
    subroutine get_1d_bc_mnureg_info(rank, sz, dims, start, count)   ! pio_iodesc_tests.F90.in:513
      integer, intent(in) :: rank   ! pio_iodesc_tests.F90.in:514
      integer, intent(in) :: sz   ! pio_iodesc_tests.F90.in:515
      integer, dimension(1), intent(out) :: dims   ! pio_iodesc_tests.F90.in:516
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_iodesc_tests.F90.in:517
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_iodesc_tests.F90.in:518
    end subroutine get_1d_bc_mnureg_info   ! pio_iodesc_tests.F90.in:519
  end interface   ! pio_iodesc_tests.F90.in:520
  type(var_desc_t)  :: pio_var1, pio_var2   ! pio_iodesc_tests.F90.in:521
  type(file_desc_t) :: pio_file   ! pio_iodesc_tests.F90.in:522
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_iodesc_tests.F90.in:523
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1_mnureg'   ! pio_iodesc_tests.F90.in:524
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2_mnureg'   ! pio_iodesc_tests.F90.in:525
  type(io_desc_t) :: iodesc_mnureg   ! pio_iodesc_tests.F90.in:526
  integer, dimension(:), allocatable :: compdof   ! pio_iodesc_tests.F90.in:527
  integer, dimension(:), allocatable :: start, count   ! pio_iodesc_tests.F90.in:528
  integer :: total_count   ! pio_iodesc_tests.F90.in:529
  real(kind=fc_double), dimension(:), allocatable :: rbuf_mnureg, wbuf_mnureg   ! pio_iodesc_tests.F90.in:530
  integer, dimension(1) :: dims_mnureg   ! pio_iodesc_tests.F90.in:531
  integer :: pio_dim_mnureg   ! pio_iodesc_tests.F90.in:532
  integer :: i, j, idx, ierr, lsz   ! pio_iodesc_tests.F90.in:533
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_iodesc_tests.F90.in:535
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_iodesc_tests.F90.in:536
  integer :: num_iotypes   ! pio_iodesc_tests.F90.in:537
   ! pio_iodesc_tests.F90.in:538
  call get_1d_bc_mnureg_info(pio_tf_world_rank_, pio_tf_world_sz_,&   ! pio_iodesc_tests.F90.in:539
         dims_mnureg, start, count)   ! pio_iodesc_tests.F90.in:540
  total_count = 0   ! pio_iodesc_tests.F90.in:541
  do i=1,size(count)   ! pio_iodesc_tests.F90.in:542
    total_count = total_count + count(i)   ! pio_iodesc_tests.F90.in:543
  end do   ! pio_iodesc_tests.F90.in:544
  allocate(wbuf_mnureg(total_count))   ! pio_iodesc_tests.F90.in:545
  allocate(rbuf_mnureg(total_count))   ! pio_iodesc_tests.F90.in:546
  allocate(compdof(total_count))   ! pio_iodesc_tests.F90.in:547
  do i=1,size(count)   ! pio_iodesc_tests.F90.in:548
    do j=1,count(i)   ! pio_iodesc_tests.F90.in:549
      idx = (i-1)*count(i) + j   ! pio_iodesc_tests.F90.in:550
      compdof(idx) = start(i) + j - 1   ! pio_iodesc_tests.F90.in:551
      wbuf_mnureg(idx) = compdof(idx)   ! pio_iodesc_tests.F90.in:552
      rbuf_mnureg(idx) = compdof(idx)   ! pio_iodesc_tests.F90.in:553
    end do   ! pio_iodesc_tests.F90.in:554
  end do   ! pio_iodesc_tests.F90.in:555
  if(allocated(start)) then   ! pio_iodesc_tests.F90.in:556
    deallocate(start)   ! pio_iodesc_tests.F90.in:557
  end if   ! pio_iodesc_tests.F90.in:558
  if(allocated(count)) then   ! pio_iodesc_tests.F90.in:559
    deallocate(count)   ! pio_iodesc_tests.F90.in:560
  end if   ! pio_iodesc_tests.F90.in:561
   ! pio_iodesc_tests.F90.in:562
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims_mnureg, compdof, iodesc_mnureg)   ! pio_iodesc_tests.F90.in:563
  deallocate(compdof)   ! pio_iodesc_tests.F90.in:564
   ! pio_iodesc_tests.F90.in:565
  num_iotypes = 0   ! pio_iodesc_tests.F90.in:566
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_iodesc_tests.F90.in:567
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_iodesc_tests.F90.in:568
  do i=1,num_iotypes   ! pio_iodesc_tests.F90.in:569

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_iodesc_tests.F90.in:570
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! pio_iodesc_tests.F90.in:571
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:572)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:572
   ! pio_iodesc_tests.F90.in:573
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim_mnureg', dims_mnureg(1), pio_dim_mnureg)   ! pio_iodesc_tests.F90.in:574
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim (mnureg) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:575)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:575
   ! pio_iodesc_tests.F90.in:576
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_double, (/pio_dim_mnureg/), pio_var1)   ! pio_iodesc_tests.F90.in:577
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:578)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:578
   ! pio_iodesc_tests.F90.in:579
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_double, (/pio_dim_mnureg/), pio_var2)   ! pio_iodesc_tests.F90.in:580
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:581)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:581
   ! pio_iodesc_tests.F90.in:582
    ierr = PIO_enddef(pio_file)   ! pio_iodesc_tests.F90.in:583
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:584)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:584
   ! pio_iodesc_tests.F90.in:585
    ! Write the variables out
    call PIO_write_darray(pio_file, pio_var1, iodesc_mnureg, wbuf_mnureg, ierr)   ! pio_iodesc_tests.F90.in:587
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:588)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:588
   ! pio_iodesc_tests.F90.in:589
    call PIO_write_darray(pio_file, pio_var2, iodesc_mnureg, wbuf_mnureg, ierr)   ! pio_iodesc_tests.F90.in:590
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:591)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:591
   ! pio_iodesc_tests.F90.in:592
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_iodesc_tests.F90.in:594
   ! pio_iodesc_tests.F90.in:595
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_iodesc_tests.F90.in:596
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:597)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:597
   ! pio_iodesc_tests.F90.in:598
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_iodesc_tests.F90.in:599
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:600)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:600
   ! pio_iodesc_tests.F90.in:601
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_iodesc_tests.F90.in:602
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:603)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:603
#else
    call PIO_syncfile(pio_file)   ! pio_iodesc_tests.F90.in:605
#endif
   ! pio_iodesc_tests.F90.in:607
    rbuf_mnureg = 0   ! pio_iodesc_tests.F90.in:608
    call PIO_read_darray(pio_file, pio_var1, iodesc_mnureg, rbuf_mnureg, ierr)   ! pio_iodesc_tests.F90.in:609
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var1): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:610)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:610
   ! pio_iodesc_tests.F90.in:611
    
    IF (.NOT. PIO_TF_Check_val_(rbuf_mnureg, wbuf_mnureg)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var1)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:612)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:612
   ! pio_iodesc_tests.F90.in:613
    rbuf_mnureg = 0   ! pio_iodesc_tests.F90.in:614
    call PIO_read_darray(pio_file, pio_var2, iodesc_mnureg, rbuf_mnureg, ierr)   ! pio_iodesc_tests.F90.in:615
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var2): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:616)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:616
   ! pio_iodesc_tests.F90.in:617
    
    IF (.NOT. PIO_TF_Check_val_(rbuf_mnureg, wbuf_mnureg)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var2)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_iodesc_tests.F90.in:618)"
      END IF
      RETURN
    END IF   ! pio_iodesc_tests.F90.in:618
   ! pio_iodesc_tests.F90.in:619
    call PIO_closefile(pio_file)   ! pio_iodesc_tests.F90.in:620
   ! pio_iodesc_tests.F90.in:621
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_iodesc_tests.F90.in:622
  end do   ! pio_iodesc_tests.F90.in:623
   ! pio_iodesc_tests.F90.in:624
  if(allocated(iotypes)) then   ! pio_iodesc_tests.F90.in:625
    deallocate(iotypes)   ! pio_iodesc_tests.F90.in:626
    deallocate(iotype_descs)   ! pio_iodesc_tests.F90.in:627
  end if   ! pio_iodesc_tests.F90.in:628
   ! pio_iodesc_tests.F90.in:629
  call PIO_freedecomp(pio_tf_iosystem_, iodesc_mnureg)   ! pio_iodesc_tests.F90.in:630
  deallocate(rbuf_mnureg)   ! pio_iodesc_tests.F90.in:631
  deallocate(wbuf_mnureg)   ! pio_iodesc_tests.F90.in:632
END SUBROUTINE nc_mnureg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___   ! pio_iodesc_tests.F90.in:633
   ! pio_iodesc_tests.F90.in:633


  SUBROUTINE PIO_TF_Test_driver_
    USE pio_tutil
    IMPLICIT NONE
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_2d_two_iodescs_PIO_int_integer__"
    END IF
    CALL nc_wr_2d_two_iodescs_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 1:",&
          "nc_wr_2d_two_iodescs_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 1:",&
          "nc_wr_2d_two_iodescs_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_2d_two_iodescs_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_2d_two_iodescs_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 2:",&
          "nc_wr_2d_two_iodescs_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 2:",&
          "nc_wr_2d_two_iodescs_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_2d_two_iodescs_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_2d_two_iodescs_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 3:",&
          "nc_wr_2d_two_iodescs_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 3:",&
          "nc_wr_2d_two_iodescs_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_2d_two_iodescs_PIO_int_integer__"
    END IF
    CALL nc_wr_2d_two_iodescs_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 4:",&
          "nc_wr_2d_two_iodescs_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 4:",&
          "nc_wr_2d_two_iodescs_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_2d_two_iodescs_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_2d_two_iodescs_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 5:",&
          "nc_wr_2d_two_iodescs_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 5:",&
          "nc_wr_2d_two_iodescs_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_2d_two_iodescs_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_2d_two_iodescs_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 6:",&
          "nc_wr_2d_two_iodescs_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 6:",&
          "nc_wr_2d_two_iodescs_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mureg_wr_rd_1d_bc_PIO_int_integer__"
    END IF
    CALL nc_mureg_wr_rd_1d_bc_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 7:",&
          "nc_mureg_wr_rd_1d_bc_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 7:",&
          "nc_mureg_wr_rd_1d_bc_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mureg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_mureg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 8:",&
          "nc_mureg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 8:",&
          "nc_mureg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mureg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_mureg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 9:",&
          "nc_mureg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 9:",&
          "nc_mureg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_2d_two_iodescs_PIO_int_integer__"
    END IF
    CALL nc_wr_2d_two_iodescs_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 10:",&
          "nc_wr_2d_two_iodescs_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 10:",&
          "nc_wr_2d_two_iodescs_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_2d_two_iodescs_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_2d_two_iodescs_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 11:",&
          "nc_wr_2d_two_iodescs_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 11:",&
          "nc_wr_2d_two_iodescs_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_2d_two_iodescs_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_2d_two_iodescs_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 12:",&
          "nc_wr_2d_two_iodescs_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 12:",&
          "nc_wr_2d_two_iodescs_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mureg_wr_rd_1d_bc_PIO_int_integer__"
    END IF
    CALL nc_mureg_wr_rd_1d_bc_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 13:",&
          "nc_mureg_wr_rd_1d_bc_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 13:",&
          "nc_mureg_wr_rd_1d_bc_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mureg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_mureg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 14:",&
          "nc_mureg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 14:",&
          "nc_mureg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mureg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_mureg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 15:",&
          "nc_mureg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 15:",&
          "nc_mureg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mnureg_wr_rd_1d_bc_PIO_int_integer__"
    END IF
    CALL nc_mnureg_wr_rd_1d_bc_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 16:",&
          "nc_mnureg_wr_rd_1d_bc_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 16:",&
          "nc_mnureg_wr_rd_1d_bc_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mnureg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_mnureg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 17:",&
          "nc_mnureg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 17:",&
          "nc_mnureg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mnureg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_mnureg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 18:",&
          "nc_mnureg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 18:",&
          "nc_mnureg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting init_decomp_1d_get_loc_sz"
    END IF
    CALL init_decomp_1d_get_loc_sz()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 19:",&
          "init_decomp_1d_get_loc_sz","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 19:",&
          "init_decomp_1d_get_loc_sz","-----------", "FAILED"
      END IF
    END IF
  END SUBROUTINE PIO_TF_Test_driver_


  PROGRAM PIO_TF_Test_main_
    USE pio_tutil
    IMPLICIT NONE
    INTEGER, PARAMETER :: NREARRS = 2
    INTEGER :: rearrs(NREARRS) = (/pio_rearr_subset,pio_rearr_box/)
    CHARACTER(LEN=PIO_TF_MAX_STR_LEN) :: rearrs_info(NREARRS) = (/"PIO_REARR_SUBSET","PIO_REARR_BOX   "/)
    INTEGER i, ierr

    pio_tf_nerrs_total_=0
    pio_tf_retval_utest_=0
    CALL MPI_Init(ierr)
    DO i=1,SIZE(rearrs)
      CALL PIO_TF_Init_(rearrs(i))
      IF (pio_tf_world_rank_ == 0) THEN
        WRITE(*,*) "PIO_TF: Testing : ", trim(rearrs_info(i))
      END IF
      CALL PIO_TF_Test_driver_()
      CALL PIO_TF_Finalize_()
    END DO
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_nerrs_total_ == 0) THEN
        IF (pio_tf_retval_utest_ == 0) THEN
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF: ",&
           "All tests", "---------", "PASSED"
        ELSE
          pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF: ",&
           "Test driver", "---------", "FAILED"
        END IF
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT2) "PIO_TF:[",&
          pio_tf_nerrs_total_,"] Tests",&
          "----- FAILED"
      END IF
    END IF
    CALL MPI_Finalize(ierr)
    IF (pio_tf_nerrs_total_ /= 0) THEN
      STOP 99
    END IF
  END PROGRAM
