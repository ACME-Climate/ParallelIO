! DON'T MODIFY THIS FILE, ALL YOUR CHANGES WILL BE LOST
! This file is generated by ../../../tests/general/util/pio_tf_f90gen.pl
! from /home/tkurc/codar/e3sm/pio_adios1/ParallelIO/tests/general/pio_decomp_fillval.F90.in

! nc write 1d array with fillvalues (the holes are explicitly specified)


SUBROUTINE nc_write_1d_explicit_fval_PIO_int_integer__
USE pio_tutil
   ! pio_decomp_fillval.F90.in:3
  implicit none   ! pio_decomp_fillval.F90.in:4
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_fillval.F90.in:5
  type(var_desc_t)  :: pio_var   ! pio_decomp_fillval.F90.in:6
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval.F90.in:7
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval.F90.in:8
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_fillval.F90.in:9
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval.F90.in:10
  integer, dimension(VEC_LOCAL_SZ) :: wcompdof, rcompdof, compdof_rel_disps   ! pio_decomp_fillval.F90.in:11
  ! Compdof value to suggest that data point is a hole, this hole
  ! is usually filled with a fillvalue
  integer, parameter :: PIO_COMPDOF_FILLVAL = 0   ! pio_decomp_fillval.F90.in:14
  integer, dimension(VEC_LOCAL_SZ) :: wbuf, rbuf, exp_val   ! pio_decomp_fillval.F90.in:15
  ! The buffer fillvalue to be used when writing data
  integer, PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval.F90.in:17
  integer, dimension(1) :: dims   ! pio_decomp_fillval.F90.in:18
  integer :: pio_dim   ! pio_decomp_fillval.F90.in:19
  integer :: i, ierr, lsz   ! pio_decomp_fillval.F90.in:20
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval.F90.in:22
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval.F90.in:23
  integer :: num_iotypes   ! pio_decomp_fillval.F90.in:24
   ! pio_decomp_fillval.F90.in:25
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval.F90.in:26
    compdof_rel_disps(i) = i   ! pio_decomp_fillval.F90.in:27
  end do   ! pio_decomp_fillval.F90.in:28
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_fillval.F90.in:29
  rcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval.F90.in:30
  wcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval.F90.in:31
   ! pio_decomp_fillval.F90.in:32
  wbuf = wcompdof   ! pio_decomp_fillval.F90.in:33
  exp_val = wcompdof   ! pio_decomp_fillval.F90.in:34
  rbuf = 0   ! pio_decomp_fillval.F90.in:35
   ! pio_decomp_fillval.F90.in:36
  ! Even indices need to be filled with (BUF_FILLVAL == -2)
  do i=1,VEC_LOCAL_SZ,2   ! pio_decomp_fillval.F90.in:38
    wcompdof(i) = PIO_COMPDOF_FILLVAL   ! pio_decomp_fillval.F90.in:39
    exp_val(i) = BUF_FILLVAL   ! pio_decomp_fillval.F90.in:40
  end do   ! pio_decomp_fillval.F90.in:41
   ! pio_decomp_fillval.F90.in:42
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, wcompdof, wiodesc)   ! pio_decomp_fillval.F90.in:43
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, rcompdof, riodesc)   ! pio_decomp_fillval.F90.in:44
   ! pio_decomp_fillval.F90.in:45
  num_iotypes = 0   ! pio_decomp_fillval.F90.in:46
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval.F90.in:47
  do i=1,num_iotypes   ! pio_decomp_fillval.F90.in:48
   ! pio_decomp_fillval.F90.in:49
    write(filename,'(a,i1)') "test_pio_decomp_fillval_tests.testfile",i   ! pio_decomp_fillval.F90.in:50
   ! pio_decomp_fillval.F90.in:51

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval.F90.in:52
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval.F90.in:53
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:54)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:54
   ! pio_decomp_fillval.F90.in:55
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval.F90.in:56
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:57)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:57
   ! pio_decomp_fillval.F90.in:58
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_int, (/pio_dim/), pio_var)   ! pio_decomp_fillval.F90.in:59
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:60)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:60
   ! pio_decomp_fillval.F90.in:61
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval.F90.in:62
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:63)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:63
   ! pio_decomp_fillval.F90.in:64
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval.F90.in:66
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:67)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:67
   ! pio_decomp_fillval.F90.in:68
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:70
   ! pio_decomp_fillval.F90.in:71
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval.F90.in:72
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:73)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:73
   ! pio_decomp_fillval.F90.in:74
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_fillval.F90.in:75
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:76)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:76
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval.F90.in:78
#endif
   ! pio_decomp_fillval.F90.in:80
    call PIO_read_darray(pio_file, pio_var, riodesc, rbuf, ierr)   ! pio_decomp_fillval.F90.in:81
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:82)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:82
   ! pio_decomp_fillval.F90.in:83
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:84)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:84
   ! pio_decomp_fillval.F90.in:85
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:86
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval.F90.in:87
  end do   ! pio_decomp_fillval.F90.in:88
  if(allocated(iotypes)) then   ! pio_decomp_fillval.F90.in:89
    deallocate(iotypes)   ! pio_decomp_fillval.F90.in:90
    deallocate(iotype_descs)   ! pio_decomp_fillval.F90.in:91
  end if   ! pio_decomp_fillval.F90.in:92
   ! pio_decomp_fillval.F90.in:93
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval.F90.in:94
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval.F90.in:95
END SUBROUTINE nc_write_1d_explicit_fval_PIO_int_integer__   ! pio_decomp_fillval.F90.in:96


SUBROUTINE nc_write_1d_explicit_fval_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_decomp_fillval.F90.in:3
  implicit none   ! pio_decomp_fillval.F90.in:4
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_fillval.F90.in:5
  type(var_desc_t)  :: pio_var   ! pio_decomp_fillval.F90.in:6
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval.F90.in:7
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval.F90.in:8
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_fillval.F90.in:9
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval.F90.in:10
  integer, dimension(VEC_LOCAL_SZ) :: wcompdof, rcompdof, compdof_rel_disps   ! pio_decomp_fillval.F90.in:11
  ! Compdof value to suggest that data point is a hole, this hole
  ! is usually filled with a fillvalue
  integer, parameter :: PIO_COMPDOF_FILLVAL = 0   ! pio_decomp_fillval.F90.in:14
  real(kind=fc_real), dimension(VEC_LOCAL_SZ) :: wbuf, rbuf, exp_val   ! pio_decomp_fillval.F90.in:15
  ! The buffer fillvalue to be used when writing data
  real(kind=fc_real), PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval.F90.in:17
  integer, dimension(1) :: dims   ! pio_decomp_fillval.F90.in:18
  integer :: pio_dim   ! pio_decomp_fillval.F90.in:19
  integer :: i, ierr, lsz   ! pio_decomp_fillval.F90.in:20
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval.F90.in:22
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval.F90.in:23
  integer :: num_iotypes   ! pio_decomp_fillval.F90.in:24
   ! pio_decomp_fillval.F90.in:25
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval.F90.in:26
    compdof_rel_disps(i) = i   ! pio_decomp_fillval.F90.in:27
  end do   ! pio_decomp_fillval.F90.in:28
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_fillval.F90.in:29
  rcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval.F90.in:30
  wcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval.F90.in:31
   ! pio_decomp_fillval.F90.in:32
  wbuf = wcompdof   ! pio_decomp_fillval.F90.in:33
  exp_val = wcompdof   ! pio_decomp_fillval.F90.in:34
  rbuf = 0   ! pio_decomp_fillval.F90.in:35
   ! pio_decomp_fillval.F90.in:36
  ! Even indices need to be filled with (BUF_FILLVAL == -2)
  do i=1,VEC_LOCAL_SZ,2   ! pio_decomp_fillval.F90.in:38
    wcompdof(i) = PIO_COMPDOF_FILLVAL   ! pio_decomp_fillval.F90.in:39
    exp_val(i) = BUF_FILLVAL   ! pio_decomp_fillval.F90.in:40
  end do   ! pio_decomp_fillval.F90.in:41
   ! pio_decomp_fillval.F90.in:42
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, wcompdof, wiodesc)   ! pio_decomp_fillval.F90.in:43
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, rcompdof, riodesc)   ! pio_decomp_fillval.F90.in:44
   ! pio_decomp_fillval.F90.in:45
  num_iotypes = 0   ! pio_decomp_fillval.F90.in:46
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval.F90.in:47
  do i=1,num_iotypes   ! pio_decomp_fillval.F90.in:48
   ! pio_decomp_fillval.F90.in:49
    write(filename,'(a,i1)') "test_pio_decomp_fillval_tests.testfile",i   ! pio_decomp_fillval.F90.in:50
   ! pio_decomp_fillval.F90.in:51

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval.F90.in:52
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval.F90.in:53
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:54)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:54
   ! pio_decomp_fillval.F90.in:55
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval.F90.in:56
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:57)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:57
   ! pio_decomp_fillval.F90.in:58
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_real, (/pio_dim/), pio_var)   ! pio_decomp_fillval.F90.in:59
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:60)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:60
   ! pio_decomp_fillval.F90.in:61
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval.F90.in:62
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:63)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:63
   ! pio_decomp_fillval.F90.in:64
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval.F90.in:66
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:67)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:67
   ! pio_decomp_fillval.F90.in:68
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:70
   ! pio_decomp_fillval.F90.in:71
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval.F90.in:72
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:73)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:73
   ! pio_decomp_fillval.F90.in:74
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_fillval.F90.in:75
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:76)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:76
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval.F90.in:78
#endif
   ! pio_decomp_fillval.F90.in:80
    call PIO_read_darray(pio_file, pio_var, riodesc, rbuf, ierr)   ! pio_decomp_fillval.F90.in:81
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:82)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:82
   ! pio_decomp_fillval.F90.in:83
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:84)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:84
   ! pio_decomp_fillval.F90.in:85
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:86
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval.F90.in:87
  end do   ! pio_decomp_fillval.F90.in:88
  if(allocated(iotypes)) then   ! pio_decomp_fillval.F90.in:89
    deallocate(iotypes)   ! pio_decomp_fillval.F90.in:90
    deallocate(iotype_descs)   ! pio_decomp_fillval.F90.in:91
  end if   ! pio_decomp_fillval.F90.in:92
   ! pio_decomp_fillval.F90.in:93
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval.F90.in:94
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval.F90.in:95
END SUBROUTINE nc_write_1d_explicit_fval_PIO_real_real_kind_fc_real___   ! pio_decomp_fillval.F90.in:96


SUBROUTINE nc_write_1d_explicit_fval_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_decomp_fillval.F90.in:3
  implicit none   ! pio_decomp_fillval.F90.in:4
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_fillval.F90.in:5
  type(var_desc_t)  :: pio_var   ! pio_decomp_fillval.F90.in:6
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval.F90.in:7
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval.F90.in:8
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_fillval.F90.in:9
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval.F90.in:10
  integer, dimension(VEC_LOCAL_SZ) :: wcompdof, rcompdof, compdof_rel_disps   ! pio_decomp_fillval.F90.in:11
  ! Compdof value to suggest that data point is a hole, this hole
  ! is usually filled with a fillvalue
  integer, parameter :: PIO_COMPDOF_FILLVAL = 0   ! pio_decomp_fillval.F90.in:14
  real(kind=fc_double), dimension(VEC_LOCAL_SZ) :: wbuf, rbuf, exp_val   ! pio_decomp_fillval.F90.in:15
  ! The buffer fillvalue to be used when writing data
  real(kind=fc_double), PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval.F90.in:17
  integer, dimension(1) :: dims   ! pio_decomp_fillval.F90.in:18
  integer :: pio_dim   ! pio_decomp_fillval.F90.in:19
  integer :: i, ierr, lsz   ! pio_decomp_fillval.F90.in:20
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval.F90.in:22
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval.F90.in:23
  integer :: num_iotypes   ! pio_decomp_fillval.F90.in:24
   ! pio_decomp_fillval.F90.in:25
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval.F90.in:26
    compdof_rel_disps(i) = i   ! pio_decomp_fillval.F90.in:27
  end do   ! pio_decomp_fillval.F90.in:28
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_fillval.F90.in:29
  rcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval.F90.in:30
  wcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval.F90.in:31
   ! pio_decomp_fillval.F90.in:32
  wbuf = wcompdof   ! pio_decomp_fillval.F90.in:33
  exp_val = wcompdof   ! pio_decomp_fillval.F90.in:34
  rbuf = 0   ! pio_decomp_fillval.F90.in:35
   ! pio_decomp_fillval.F90.in:36
  ! Even indices need to be filled with (BUF_FILLVAL == -2)
  do i=1,VEC_LOCAL_SZ,2   ! pio_decomp_fillval.F90.in:38
    wcompdof(i) = PIO_COMPDOF_FILLVAL   ! pio_decomp_fillval.F90.in:39
    exp_val(i) = BUF_FILLVAL   ! pio_decomp_fillval.F90.in:40
  end do   ! pio_decomp_fillval.F90.in:41
   ! pio_decomp_fillval.F90.in:42
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, wcompdof, wiodesc)   ! pio_decomp_fillval.F90.in:43
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, rcompdof, riodesc)   ! pio_decomp_fillval.F90.in:44
   ! pio_decomp_fillval.F90.in:45
  num_iotypes = 0   ! pio_decomp_fillval.F90.in:46
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval.F90.in:47
  do i=1,num_iotypes   ! pio_decomp_fillval.F90.in:48
   ! pio_decomp_fillval.F90.in:49
    write(filename,'(a,i1)') "test_pio_decomp_fillval_tests.testfile",i   ! pio_decomp_fillval.F90.in:50
   ! pio_decomp_fillval.F90.in:51

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval.F90.in:52
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval.F90.in:53
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:54)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:54
   ! pio_decomp_fillval.F90.in:55
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval.F90.in:56
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:57)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:57
   ! pio_decomp_fillval.F90.in:58
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_double, (/pio_dim/), pio_var)   ! pio_decomp_fillval.F90.in:59
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:60)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:60
   ! pio_decomp_fillval.F90.in:61
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval.F90.in:62
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:63)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:63
   ! pio_decomp_fillval.F90.in:64
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval.F90.in:66
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:67)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:67
   ! pio_decomp_fillval.F90.in:68
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:70
   ! pio_decomp_fillval.F90.in:71
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval.F90.in:72
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:73)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:73
   ! pio_decomp_fillval.F90.in:74
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_fillval.F90.in:75
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:76)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:76
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval.F90.in:78
#endif
   ! pio_decomp_fillval.F90.in:80
    call PIO_read_darray(pio_file, pio_var, riodesc, rbuf, ierr)   ! pio_decomp_fillval.F90.in:81
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:82)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:82
   ! pio_decomp_fillval.F90.in:83
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:84)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:84
   ! pio_decomp_fillval.F90.in:85
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:86
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval.F90.in:87
  end do   ! pio_decomp_fillval.F90.in:88
  if(allocated(iotypes)) then   ! pio_decomp_fillval.F90.in:89
    deallocate(iotypes)   ! pio_decomp_fillval.F90.in:90
    deallocate(iotype_descs)   ! pio_decomp_fillval.F90.in:91
  end if   ! pio_decomp_fillval.F90.in:92
   ! pio_decomp_fillval.F90.in:93
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval.F90.in:94
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval.F90.in:95
END SUBROUTINE nc_write_1d_explicit_fval_PIO_double_real_kind_fc_double___   ! pio_decomp_fillval.F90.in:96
   ! pio_decomp_fillval.F90.in:96


! nc write 1d array with fillvalues (the holes are implicit)


SUBROUTINE nc_write_1d_implicit_fval_PIO_int_integer__
USE pio_tutil
   ! pio_decomp_fillval.F90.in:100
  implicit none   ! pio_decomp_fillval.F90.in:101
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_fillval.F90.in:102
  type(var_desc_t)  :: pio_var   ! pio_decomp_fillval.F90.in:103
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval.F90.in:104
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval.F90.in:105
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_fillval.F90.in:106
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval.F90.in:107
  integer, dimension(:), allocatable :: wcompdof   ! pio_decomp_fillval.F90.in:108
  integer :: wcompdof_sz   ! pio_decomp_fillval.F90.in:109
  integer, dimension(VEC_LOCAL_SZ) :: rcompdof, compdof_rel_disps   ! pio_decomp_fillval.F90.in:110
  integer, dimension(:), allocatable :: wbuf   ! pio_decomp_fillval.F90.in:111
  integer, dimension(VEC_LOCAL_SZ) :: rbuf, exp_val   ! pio_decomp_fillval.F90.in:112
  ! The buffer fillvalue to be used when writing data
  integer, PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval.F90.in:114
  integer, dimension(1) :: dims   ! pio_decomp_fillval.F90.in:115
  integer :: pio_dim   ! pio_decomp_fillval.F90.in:116
  integer :: i, ierr, lsz   ! pio_decomp_fillval.F90.in:117
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval.F90.in:119
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval.F90.in:120
  integer :: num_iotypes   ! pio_decomp_fillval.F90.in:121
   ! pio_decomp_fillval.F90.in:122
  ! compdof is only specified for valid data values, the data holes are
  ! implicitly stated (by not specifying them rather than filling it with 0s)
  wcompdof_sz = min(pio_tf_world_rank_+1, VEC_LOCAL_SZ)    ! pio_decomp_fillval.F90.in:125
  allocate(wcompdof(wcompdof_sz))   ! pio_decomp_fillval.F90.in:126
  allocate(wbuf(wcompdof_sz))   ! pio_decomp_fillval.F90.in:127
   ! pio_decomp_fillval.F90.in:128
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval.F90.in:129
    compdof_rel_disps(i) = i   ! pio_decomp_fillval.F90.in:130
  end do   ! pio_decomp_fillval.F90.in:131
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_fillval.F90.in:132
  ! rank 0 has 1 valid data value, rank 2 has 2 data values and so on...
  do i=1,wcompdof_sz   ! pio_decomp_fillval.F90.in:134
    wcompdof(i) = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps(i)   ! pio_decomp_fillval.F90.in:135
  end do   ! pio_decomp_fillval.F90.in:136
  ! Read everything - including fillvalues that should have been 
  ! written for locations unspecified in wcompdof(:) i.e.,
  ! wcompdof(wcompdof_sz:VEC_LOCAL_SZ]
  rcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval.F90.in:140
   ! pio_decomp_fillval.F90.in:141
  wbuf = 0   ! pio_decomp_fillval.F90.in:142
  ! The first wcompdof_sz values, wbuf[1:wcompdof_sz], are valid in wbuf
  do i=1,wcompdof_sz   ! pio_decomp_fillval.F90.in:144
    wbuf(i) = wcompdof(i)   ! pio_decomp_fillval.F90.in:145
    exp_val(i) = wbuf(i)   ! pio_decomp_fillval.F90.in:146
  end do   ! pio_decomp_fillval.F90.in:147
  ! We expect the values (wcompdof_sz:VEC_LOCAL_SZ] to be read as 
  ! user specified fill values
  do i=wcompdof_sz+1,VEC_LOCAL_SZ   ! pio_decomp_fillval.F90.in:150
    exp_val(i) = BUF_FILLVAL   ! pio_decomp_fillval.F90.in:151
  end do   ! pio_decomp_fillval.F90.in:152
  rbuf = 0   ! pio_decomp_fillval.F90.in:153
   ! pio_decomp_fillval.F90.in:154
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, wcompdof, wiodesc)   ! pio_decomp_fillval.F90.in:155
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, rcompdof, riodesc)   ! pio_decomp_fillval.F90.in:156
   ! pio_decomp_fillval.F90.in:157
  num_iotypes = 0   ! pio_decomp_fillval.F90.in:158
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval.F90.in:159
  filename = "test_pio_decomp_fillval_tests.testfile"   ! pio_decomp_fillval.F90.in:160
  do i=1,num_iotypes   ! pio_decomp_fillval.F90.in:161

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval.F90.in:162
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval.F90.in:163
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:164)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:164
   ! pio_decomp_fillval.F90.in:165
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval.F90.in:166
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:167)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:167
   ! pio_decomp_fillval.F90.in:168
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_int, (/pio_dim/), pio_var)   ! pio_decomp_fillval.F90.in:169
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:170)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:170
   ! pio_decomp_fillval.F90.in:171
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval.F90.in:172
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:173)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:173
   ! pio_decomp_fillval.F90.in:174
    ! Write the variable out, user specified fillvalue = BUF_FILLVAL
    call PIO_write_darray(pio_file, pio_var, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval.F90.in:176
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:177)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:177
   ! pio_decomp_fillval.F90.in:178
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:180
   ! pio_decomp_fillval.F90.in:181
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval.F90.in:182
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:183)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:183
   ! pio_decomp_fillval.F90.in:184
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_fillval.F90.in:185
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:186)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:186
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval.F90.in:188
#endif
   ! pio_decomp_fillval.F90.in:190
    call PIO_read_darray(pio_file, pio_var, riodesc, rbuf, ierr)   ! pio_decomp_fillval.F90.in:191
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:192)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:192
   ! pio_decomp_fillval.F90.in:193
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:194)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:194
   ! pio_decomp_fillval.F90.in:195
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:196
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval.F90.in:197
  end do   ! pio_decomp_fillval.F90.in:198
  if(allocated(iotypes)) then   ! pio_decomp_fillval.F90.in:199
    deallocate(iotypes)   ! pio_decomp_fillval.F90.in:200
    deallocate(iotype_descs)   ! pio_decomp_fillval.F90.in:201
  end if   ! pio_decomp_fillval.F90.in:202
   ! pio_decomp_fillval.F90.in:203
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval.F90.in:204
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval.F90.in:205
  deallocate(wbuf)   ! pio_decomp_fillval.F90.in:206
  deallocate(wcompdof)   ! pio_decomp_fillval.F90.in:207
END SUBROUTINE nc_write_1d_implicit_fval_PIO_int_integer__   ! pio_decomp_fillval.F90.in:208


SUBROUTINE nc_write_1d_implicit_fval_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_decomp_fillval.F90.in:100
  implicit none   ! pio_decomp_fillval.F90.in:101
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_fillval.F90.in:102
  type(var_desc_t)  :: pio_var   ! pio_decomp_fillval.F90.in:103
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval.F90.in:104
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval.F90.in:105
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_fillval.F90.in:106
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval.F90.in:107
  integer, dimension(:), allocatable :: wcompdof   ! pio_decomp_fillval.F90.in:108
  integer :: wcompdof_sz   ! pio_decomp_fillval.F90.in:109
  integer, dimension(VEC_LOCAL_SZ) :: rcompdof, compdof_rel_disps   ! pio_decomp_fillval.F90.in:110
  real(kind=fc_real), dimension(:), allocatable :: wbuf   ! pio_decomp_fillval.F90.in:111
  real(kind=fc_real), dimension(VEC_LOCAL_SZ) :: rbuf, exp_val   ! pio_decomp_fillval.F90.in:112
  ! The buffer fillvalue to be used when writing data
  real(kind=fc_real), PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval.F90.in:114
  integer, dimension(1) :: dims   ! pio_decomp_fillval.F90.in:115
  integer :: pio_dim   ! pio_decomp_fillval.F90.in:116
  integer :: i, ierr, lsz   ! pio_decomp_fillval.F90.in:117
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval.F90.in:119
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval.F90.in:120
  integer :: num_iotypes   ! pio_decomp_fillval.F90.in:121
   ! pio_decomp_fillval.F90.in:122
  ! compdof is only specified for valid data values, the data holes are
  ! implicitly stated (by not specifying them rather than filling it with 0s)
  wcompdof_sz = min(pio_tf_world_rank_+1, VEC_LOCAL_SZ)    ! pio_decomp_fillval.F90.in:125
  allocate(wcompdof(wcompdof_sz))   ! pio_decomp_fillval.F90.in:126
  allocate(wbuf(wcompdof_sz))   ! pio_decomp_fillval.F90.in:127
   ! pio_decomp_fillval.F90.in:128
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval.F90.in:129
    compdof_rel_disps(i) = i   ! pio_decomp_fillval.F90.in:130
  end do   ! pio_decomp_fillval.F90.in:131
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_fillval.F90.in:132
  ! rank 0 has 1 valid data value, rank 2 has 2 data values and so on...
  do i=1,wcompdof_sz   ! pio_decomp_fillval.F90.in:134
    wcompdof(i) = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps(i)   ! pio_decomp_fillval.F90.in:135
  end do   ! pio_decomp_fillval.F90.in:136
  ! Read everything - including fillvalues that should have been 
  ! written for locations unspecified in wcompdof(:) i.e.,
  ! wcompdof(wcompdof_sz:VEC_LOCAL_SZ]
  rcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval.F90.in:140
   ! pio_decomp_fillval.F90.in:141
  wbuf = 0   ! pio_decomp_fillval.F90.in:142
  ! The first wcompdof_sz values, wbuf[1:wcompdof_sz], are valid in wbuf
  do i=1,wcompdof_sz   ! pio_decomp_fillval.F90.in:144
    wbuf(i) = wcompdof(i)   ! pio_decomp_fillval.F90.in:145
    exp_val(i) = wbuf(i)   ! pio_decomp_fillval.F90.in:146
  end do   ! pio_decomp_fillval.F90.in:147
  ! We expect the values (wcompdof_sz:VEC_LOCAL_SZ] to be read as 
  ! user specified fill values
  do i=wcompdof_sz+1,VEC_LOCAL_SZ   ! pio_decomp_fillval.F90.in:150
    exp_val(i) = BUF_FILLVAL   ! pio_decomp_fillval.F90.in:151
  end do   ! pio_decomp_fillval.F90.in:152
  rbuf = 0   ! pio_decomp_fillval.F90.in:153
   ! pio_decomp_fillval.F90.in:154
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, wcompdof, wiodesc)   ! pio_decomp_fillval.F90.in:155
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, rcompdof, riodesc)   ! pio_decomp_fillval.F90.in:156
   ! pio_decomp_fillval.F90.in:157
  num_iotypes = 0   ! pio_decomp_fillval.F90.in:158
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval.F90.in:159
  filename = "test_pio_decomp_fillval_tests.testfile"   ! pio_decomp_fillval.F90.in:160
  do i=1,num_iotypes   ! pio_decomp_fillval.F90.in:161

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval.F90.in:162
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval.F90.in:163
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:164)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:164
   ! pio_decomp_fillval.F90.in:165
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval.F90.in:166
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:167)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:167
   ! pio_decomp_fillval.F90.in:168
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_real, (/pio_dim/), pio_var)   ! pio_decomp_fillval.F90.in:169
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:170)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:170
   ! pio_decomp_fillval.F90.in:171
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval.F90.in:172
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:173)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:173
   ! pio_decomp_fillval.F90.in:174
    ! Write the variable out, user specified fillvalue = BUF_FILLVAL
    call PIO_write_darray(pio_file, pio_var, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval.F90.in:176
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:177)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:177
   ! pio_decomp_fillval.F90.in:178
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:180
   ! pio_decomp_fillval.F90.in:181
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval.F90.in:182
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:183)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:183
   ! pio_decomp_fillval.F90.in:184
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_fillval.F90.in:185
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:186)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:186
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval.F90.in:188
#endif
   ! pio_decomp_fillval.F90.in:190
    call PIO_read_darray(pio_file, pio_var, riodesc, rbuf, ierr)   ! pio_decomp_fillval.F90.in:191
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:192)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:192
   ! pio_decomp_fillval.F90.in:193
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:194)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:194
   ! pio_decomp_fillval.F90.in:195
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:196
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval.F90.in:197
  end do   ! pio_decomp_fillval.F90.in:198
  if(allocated(iotypes)) then   ! pio_decomp_fillval.F90.in:199
    deallocate(iotypes)   ! pio_decomp_fillval.F90.in:200
    deallocate(iotype_descs)   ! pio_decomp_fillval.F90.in:201
  end if   ! pio_decomp_fillval.F90.in:202
   ! pio_decomp_fillval.F90.in:203
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval.F90.in:204
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval.F90.in:205
  deallocate(wbuf)   ! pio_decomp_fillval.F90.in:206
  deallocate(wcompdof)   ! pio_decomp_fillval.F90.in:207
END SUBROUTINE nc_write_1d_implicit_fval_PIO_real_real_kind_fc_real___   ! pio_decomp_fillval.F90.in:208


SUBROUTINE nc_write_1d_implicit_fval_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_decomp_fillval.F90.in:100
  implicit none   ! pio_decomp_fillval.F90.in:101
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_fillval.F90.in:102
  type(var_desc_t)  :: pio_var   ! pio_decomp_fillval.F90.in:103
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval.F90.in:104
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval.F90.in:105
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_fillval.F90.in:106
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval.F90.in:107
  integer, dimension(:), allocatable :: wcompdof   ! pio_decomp_fillval.F90.in:108
  integer :: wcompdof_sz   ! pio_decomp_fillval.F90.in:109
  integer, dimension(VEC_LOCAL_SZ) :: rcompdof, compdof_rel_disps   ! pio_decomp_fillval.F90.in:110
  real(kind=fc_double), dimension(:), allocatable :: wbuf   ! pio_decomp_fillval.F90.in:111
  real(kind=fc_double), dimension(VEC_LOCAL_SZ) :: rbuf, exp_val   ! pio_decomp_fillval.F90.in:112
  ! The buffer fillvalue to be used when writing data
  real(kind=fc_double), PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval.F90.in:114
  integer, dimension(1) :: dims   ! pio_decomp_fillval.F90.in:115
  integer :: pio_dim   ! pio_decomp_fillval.F90.in:116
  integer :: i, ierr, lsz   ! pio_decomp_fillval.F90.in:117
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval.F90.in:119
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval.F90.in:120
  integer :: num_iotypes   ! pio_decomp_fillval.F90.in:121
   ! pio_decomp_fillval.F90.in:122
  ! compdof is only specified for valid data values, the data holes are
  ! implicitly stated (by not specifying them rather than filling it with 0s)
  wcompdof_sz = min(pio_tf_world_rank_+1, VEC_LOCAL_SZ)    ! pio_decomp_fillval.F90.in:125
  allocate(wcompdof(wcompdof_sz))   ! pio_decomp_fillval.F90.in:126
  allocate(wbuf(wcompdof_sz))   ! pio_decomp_fillval.F90.in:127
   ! pio_decomp_fillval.F90.in:128
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval.F90.in:129
    compdof_rel_disps(i) = i   ! pio_decomp_fillval.F90.in:130
  end do   ! pio_decomp_fillval.F90.in:131
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_fillval.F90.in:132
  ! rank 0 has 1 valid data value, rank 2 has 2 data values and so on...
  do i=1,wcompdof_sz   ! pio_decomp_fillval.F90.in:134
    wcompdof(i) = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps(i)   ! pio_decomp_fillval.F90.in:135
  end do   ! pio_decomp_fillval.F90.in:136
  ! Read everything - including fillvalues that should have been 
  ! written for locations unspecified in wcompdof(:) i.e.,
  ! wcompdof(wcompdof_sz:VEC_LOCAL_SZ]
  rcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval.F90.in:140
   ! pio_decomp_fillval.F90.in:141
  wbuf = 0   ! pio_decomp_fillval.F90.in:142
  ! The first wcompdof_sz values, wbuf[1:wcompdof_sz], are valid in wbuf
  do i=1,wcompdof_sz   ! pio_decomp_fillval.F90.in:144
    wbuf(i) = wcompdof(i)   ! pio_decomp_fillval.F90.in:145
    exp_val(i) = wbuf(i)   ! pio_decomp_fillval.F90.in:146
  end do   ! pio_decomp_fillval.F90.in:147
  ! We expect the values (wcompdof_sz:VEC_LOCAL_SZ] to be read as 
  ! user specified fill values
  do i=wcompdof_sz+1,VEC_LOCAL_SZ   ! pio_decomp_fillval.F90.in:150
    exp_val(i) = BUF_FILLVAL   ! pio_decomp_fillval.F90.in:151
  end do   ! pio_decomp_fillval.F90.in:152
  rbuf = 0   ! pio_decomp_fillval.F90.in:153
   ! pio_decomp_fillval.F90.in:154
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, wcompdof, wiodesc)   ! pio_decomp_fillval.F90.in:155
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, rcompdof, riodesc)   ! pio_decomp_fillval.F90.in:156
   ! pio_decomp_fillval.F90.in:157
  num_iotypes = 0   ! pio_decomp_fillval.F90.in:158
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval.F90.in:159
  filename = "test_pio_decomp_fillval_tests.testfile"   ! pio_decomp_fillval.F90.in:160
  do i=1,num_iotypes   ! pio_decomp_fillval.F90.in:161

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval.F90.in:162
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval.F90.in:163
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:164)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:164
   ! pio_decomp_fillval.F90.in:165
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval.F90.in:166
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:167)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:167
   ! pio_decomp_fillval.F90.in:168
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_double, (/pio_dim/), pio_var)   ! pio_decomp_fillval.F90.in:169
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:170)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:170
   ! pio_decomp_fillval.F90.in:171
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval.F90.in:172
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:173)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:173
   ! pio_decomp_fillval.F90.in:174
    ! Write the variable out, user specified fillvalue = BUF_FILLVAL
    call PIO_write_darray(pio_file, pio_var, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval.F90.in:176
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:177)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:177
   ! pio_decomp_fillval.F90.in:178
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:180
   ! pio_decomp_fillval.F90.in:181
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval.F90.in:182
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:183)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:183
   ! pio_decomp_fillval.F90.in:184
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_fillval.F90.in:185
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:186)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:186
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval.F90.in:188
#endif
   ! pio_decomp_fillval.F90.in:190
    call PIO_read_darray(pio_file, pio_var, riodesc, rbuf, ierr)   ! pio_decomp_fillval.F90.in:191
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:192)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:192
   ! pio_decomp_fillval.F90.in:193
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:194)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:194
   ! pio_decomp_fillval.F90.in:195
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:196
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval.F90.in:197
  end do   ! pio_decomp_fillval.F90.in:198
  if(allocated(iotypes)) then   ! pio_decomp_fillval.F90.in:199
    deallocate(iotypes)   ! pio_decomp_fillval.F90.in:200
    deallocate(iotype_descs)   ! pio_decomp_fillval.F90.in:201
  end if   ! pio_decomp_fillval.F90.in:202
   ! pio_decomp_fillval.F90.in:203
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval.F90.in:204
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval.F90.in:205
  deallocate(wbuf)   ! pio_decomp_fillval.F90.in:206
  deallocate(wcompdof)   ! pio_decomp_fillval.F90.in:207
END SUBROUTINE nc_write_1d_implicit_fval_PIO_double_real_kind_fc_double___   ! pio_decomp_fillval.F90.in:208
   ! pio_decomp_fillval.F90.in:208


! nc read 1d array with fillvalues (the holes are explicitly specified)


SUBROUTINE nc_read_1d_explicit_fval_PIO_int_integer__
USE pio_tutil
   ! pio_decomp_fillval.F90.in:212
  implicit none   ! pio_decomp_fillval.F90.in:213
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_fillval.F90.in:214
  type(var_desc_t)  :: pio_var   ! pio_decomp_fillval.F90.in:215
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval.F90.in:216
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval.F90.in:217
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_fillval.F90.in:218
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval.F90.in:219
  integer, dimension(VEC_LOCAL_SZ) :: wcompdof, rcompdof, compdof_rel_disps   ! pio_decomp_fillval.F90.in:220
  ! Compdof value to suggest that data point is a hole 
  integer, parameter :: PIO_COMPDOF_FILLVAL = 0   ! pio_decomp_fillval.F90.in:222
  integer, dimension(VEC_LOCAL_SZ) :: wbuf, rbuf, exp_val   ! pio_decomp_fillval.F90.in:223
  ! The buffer fillvalue used to initialize data
  integer, PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval.F90.in:225
  integer, dimension(1) :: dims   ! pio_decomp_fillval.F90.in:226
  integer :: pio_dim   ! pio_decomp_fillval.F90.in:227
  integer :: i, ierr, lsz   ! pio_decomp_fillval.F90.in:228
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval.F90.in:230
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval.F90.in:231
  integer :: num_iotypes   ! pio_decomp_fillval.F90.in:232
   ! pio_decomp_fillval.F90.in:233
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval.F90.in:234
    compdof_rel_disps(i) = i   ! pio_decomp_fillval.F90.in:235
  end do   ! pio_decomp_fillval.F90.in:236
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_fillval.F90.in:237
  rcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval.F90.in:238
  wcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval.F90.in:239
   ! pio_decomp_fillval.F90.in:240
  wbuf = wcompdof   ! pio_decomp_fillval.F90.in:241
  exp_val = wcompdof   ! pio_decomp_fillval.F90.in:242
  rbuf = BUF_FILLVAL   ! pio_decomp_fillval.F90.in:243
   ! pio_decomp_fillval.F90.in:244
  ! We don't want to read even indices (BUF_FILLVAL == -2)
  do i=1,VEC_LOCAL_SZ,2   ! pio_decomp_fillval.F90.in:246
    rcompdof(i) = PIO_COMPDOF_FILLVAL   ! pio_decomp_fillval.F90.in:247
    exp_val(i) = BUF_FILLVAL   ! pio_decomp_fillval.F90.in:248
  end do   ! pio_decomp_fillval.F90.in:249
   ! pio_decomp_fillval.F90.in:250
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, wcompdof, wiodesc)   ! pio_decomp_fillval.F90.in:251
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, rcompdof, riodesc)   ! pio_decomp_fillval.F90.in:252
   ! pio_decomp_fillval.F90.in:253
  num_iotypes = 0   ! pio_decomp_fillval.F90.in:254
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval.F90.in:255
   ! pio_decomp_fillval.F90.in:256
  filename = "test_pio_decomp_fillval_tests.testfile"   ! pio_decomp_fillval.F90.in:257
  do i=1,num_iotypes   ! pio_decomp_fillval.F90.in:258

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval.F90.in:259
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval.F90.in:260
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:261)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:261
   ! pio_decomp_fillval.F90.in:262
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval.F90.in:263
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:264)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:264
   ! pio_decomp_fillval.F90.in:265
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_int, (/pio_dim/), pio_var)   ! pio_decomp_fillval.F90.in:266
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:267)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:267
   ! pio_decomp_fillval.F90.in:268
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval.F90.in:269
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:270)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:270
   ! pio_decomp_fillval.F90.in:271
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval.F90.in:273
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:274)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:274
   ! pio_decomp_fillval.F90.in:275
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:277
   ! pio_decomp_fillval.F90.in:278
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval.F90.in:279
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:280)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:280
   ! pio_decomp_fillval.F90.in:281
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_fillval.F90.in:282
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:283)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:283
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval.F90.in:285
#endif
   ! pio_decomp_fillval.F90.in:287
    call PIO_read_darray(pio_file, pio_var, riodesc, rbuf, ierr)   ! pio_decomp_fillval.F90.in:288
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:289)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:289
   ! pio_decomp_fillval.F90.in:290
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:291)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:291
   ! pio_decomp_fillval.F90.in:292
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:293
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval.F90.in:294
  end do   ! pio_decomp_fillval.F90.in:295
  if(allocated(iotypes)) then   ! pio_decomp_fillval.F90.in:296
    deallocate(iotypes)   ! pio_decomp_fillval.F90.in:297
    deallocate(iotype_descs)   ! pio_decomp_fillval.F90.in:298
  end if   ! pio_decomp_fillval.F90.in:299
   ! pio_decomp_fillval.F90.in:300
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval.F90.in:301
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval.F90.in:302
END SUBROUTINE nc_read_1d_explicit_fval_PIO_int_integer__   ! pio_decomp_fillval.F90.in:303


SUBROUTINE nc_read_1d_explicit_fval_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_decomp_fillval.F90.in:212
  implicit none   ! pio_decomp_fillval.F90.in:213
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_fillval.F90.in:214
  type(var_desc_t)  :: pio_var   ! pio_decomp_fillval.F90.in:215
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval.F90.in:216
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval.F90.in:217
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_fillval.F90.in:218
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval.F90.in:219
  integer, dimension(VEC_LOCAL_SZ) :: wcompdof, rcompdof, compdof_rel_disps   ! pio_decomp_fillval.F90.in:220
  ! Compdof value to suggest that data point is a hole 
  integer, parameter :: PIO_COMPDOF_FILLVAL = 0   ! pio_decomp_fillval.F90.in:222
  real(kind=fc_real), dimension(VEC_LOCAL_SZ) :: wbuf, rbuf, exp_val   ! pio_decomp_fillval.F90.in:223
  ! The buffer fillvalue used to initialize data
  real(kind=fc_real), PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval.F90.in:225
  integer, dimension(1) :: dims   ! pio_decomp_fillval.F90.in:226
  integer :: pio_dim   ! pio_decomp_fillval.F90.in:227
  integer :: i, ierr, lsz   ! pio_decomp_fillval.F90.in:228
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval.F90.in:230
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval.F90.in:231
  integer :: num_iotypes   ! pio_decomp_fillval.F90.in:232
   ! pio_decomp_fillval.F90.in:233
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval.F90.in:234
    compdof_rel_disps(i) = i   ! pio_decomp_fillval.F90.in:235
  end do   ! pio_decomp_fillval.F90.in:236
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_fillval.F90.in:237
  rcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval.F90.in:238
  wcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval.F90.in:239
   ! pio_decomp_fillval.F90.in:240
  wbuf = wcompdof   ! pio_decomp_fillval.F90.in:241
  exp_val = wcompdof   ! pio_decomp_fillval.F90.in:242
  rbuf = BUF_FILLVAL   ! pio_decomp_fillval.F90.in:243
   ! pio_decomp_fillval.F90.in:244
  ! We don't want to read even indices (BUF_FILLVAL == -2)
  do i=1,VEC_LOCAL_SZ,2   ! pio_decomp_fillval.F90.in:246
    rcompdof(i) = PIO_COMPDOF_FILLVAL   ! pio_decomp_fillval.F90.in:247
    exp_val(i) = BUF_FILLVAL   ! pio_decomp_fillval.F90.in:248
  end do   ! pio_decomp_fillval.F90.in:249
   ! pio_decomp_fillval.F90.in:250
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, wcompdof, wiodesc)   ! pio_decomp_fillval.F90.in:251
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, rcompdof, riodesc)   ! pio_decomp_fillval.F90.in:252
   ! pio_decomp_fillval.F90.in:253
  num_iotypes = 0   ! pio_decomp_fillval.F90.in:254
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval.F90.in:255
   ! pio_decomp_fillval.F90.in:256
  filename = "test_pio_decomp_fillval_tests.testfile"   ! pio_decomp_fillval.F90.in:257
  do i=1,num_iotypes   ! pio_decomp_fillval.F90.in:258

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval.F90.in:259
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval.F90.in:260
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:261)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:261
   ! pio_decomp_fillval.F90.in:262
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval.F90.in:263
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:264)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:264
   ! pio_decomp_fillval.F90.in:265
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_real, (/pio_dim/), pio_var)   ! pio_decomp_fillval.F90.in:266
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:267)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:267
   ! pio_decomp_fillval.F90.in:268
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval.F90.in:269
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:270)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:270
   ! pio_decomp_fillval.F90.in:271
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval.F90.in:273
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:274)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:274
   ! pio_decomp_fillval.F90.in:275
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:277
   ! pio_decomp_fillval.F90.in:278
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval.F90.in:279
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:280)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:280
   ! pio_decomp_fillval.F90.in:281
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_fillval.F90.in:282
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:283)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:283
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval.F90.in:285
#endif
   ! pio_decomp_fillval.F90.in:287
    call PIO_read_darray(pio_file, pio_var, riodesc, rbuf, ierr)   ! pio_decomp_fillval.F90.in:288
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:289)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:289
   ! pio_decomp_fillval.F90.in:290
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:291)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:291
   ! pio_decomp_fillval.F90.in:292
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:293
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval.F90.in:294
  end do   ! pio_decomp_fillval.F90.in:295
  if(allocated(iotypes)) then   ! pio_decomp_fillval.F90.in:296
    deallocate(iotypes)   ! pio_decomp_fillval.F90.in:297
    deallocate(iotype_descs)   ! pio_decomp_fillval.F90.in:298
  end if   ! pio_decomp_fillval.F90.in:299
   ! pio_decomp_fillval.F90.in:300
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval.F90.in:301
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval.F90.in:302
END SUBROUTINE nc_read_1d_explicit_fval_PIO_real_real_kind_fc_real___   ! pio_decomp_fillval.F90.in:303


SUBROUTINE nc_read_1d_explicit_fval_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_decomp_fillval.F90.in:212
  implicit none   ! pio_decomp_fillval.F90.in:213
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_fillval.F90.in:214
  type(var_desc_t)  :: pio_var   ! pio_decomp_fillval.F90.in:215
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval.F90.in:216
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval.F90.in:217
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_fillval.F90.in:218
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval.F90.in:219
  integer, dimension(VEC_LOCAL_SZ) :: wcompdof, rcompdof, compdof_rel_disps   ! pio_decomp_fillval.F90.in:220
  ! Compdof value to suggest that data point is a hole 
  integer, parameter :: PIO_COMPDOF_FILLVAL = 0   ! pio_decomp_fillval.F90.in:222
  real(kind=fc_double), dimension(VEC_LOCAL_SZ) :: wbuf, rbuf, exp_val   ! pio_decomp_fillval.F90.in:223
  ! The buffer fillvalue used to initialize data
  real(kind=fc_double), PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval.F90.in:225
  integer, dimension(1) :: dims   ! pio_decomp_fillval.F90.in:226
  integer :: pio_dim   ! pio_decomp_fillval.F90.in:227
  integer :: i, ierr, lsz   ! pio_decomp_fillval.F90.in:228
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval.F90.in:230
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval.F90.in:231
  integer :: num_iotypes   ! pio_decomp_fillval.F90.in:232
   ! pio_decomp_fillval.F90.in:233
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval.F90.in:234
    compdof_rel_disps(i) = i   ! pio_decomp_fillval.F90.in:235
  end do   ! pio_decomp_fillval.F90.in:236
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_fillval.F90.in:237
  rcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval.F90.in:238
  wcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval.F90.in:239
   ! pio_decomp_fillval.F90.in:240
  wbuf = wcompdof   ! pio_decomp_fillval.F90.in:241
  exp_val = wcompdof   ! pio_decomp_fillval.F90.in:242
  rbuf = BUF_FILLVAL   ! pio_decomp_fillval.F90.in:243
   ! pio_decomp_fillval.F90.in:244
  ! We don't want to read even indices (BUF_FILLVAL == -2)
  do i=1,VEC_LOCAL_SZ,2   ! pio_decomp_fillval.F90.in:246
    rcompdof(i) = PIO_COMPDOF_FILLVAL   ! pio_decomp_fillval.F90.in:247
    exp_val(i) = BUF_FILLVAL   ! pio_decomp_fillval.F90.in:248
  end do   ! pio_decomp_fillval.F90.in:249
   ! pio_decomp_fillval.F90.in:250
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, wcompdof, wiodesc)   ! pio_decomp_fillval.F90.in:251
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, rcompdof, riodesc)   ! pio_decomp_fillval.F90.in:252
   ! pio_decomp_fillval.F90.in:253
  num_iotypes = 0   ! pio_decomp_fillval.F90.in:254
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval.F90.in:255
   ! pio_decomp_fillval.F90.in:256
  filename = "test_pio_decomp_fillval_tests.testfile"   ! pio_decomp_fillval.F90.in:257
  do i=1,num_iotypes   ! pio_decomp_fillval.F90.in:258

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval.F90.in:259
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval.F90.in:260
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:261)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:261
   ! pio_decomp_fillval.F90.in:262
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval.F90.in:263
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:264)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:264
   ! pio_decomp_fillval.F90.in:265
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_double, (/pio_dim/), pio_var)   ! pio_decomp_fillval.F90.in:266
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:267)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:267
   ! pio_decomp_fillval.F90.in:268
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval.F90.in:269
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:270)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:270
   ! pio_decomp_fillval.F90.in:271
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval.F90.in:273
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:274)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:274
   ! pio_decomp_fillval.F90.in:275
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:277
   ! pio_decomp_fillval.F90.in:278
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval.F90.in:279
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:280)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:280
   ! pio_decomp_fillval.F90.in:281
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_fillval.F90.in:282
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:283)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:283
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval.F90.in:285
#endif
   ! pio_decomp_fillval.F90.in:287
    call PIO_read_darray(pio_file, pio_var, riodesc, rbuf, ierr)   ! pio_decomp_fillval.F90.in:288
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:289)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:289
   ! pio_decomp_fillval.F90.in:290
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:291)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:291
   ! pio_decomp_fillval.F90.in:292
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:293
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval.F90.in:294
  end do   ! pio_decomp_fillval.F90.in:295
  if(allocated(iotypes)) then   ! pio_decomp_fillval.F90.in:296
    deallocate(iotypes)   ! pio_decomp_fillval.F90.in:297
    deallocate(iotype_descs)   ! pio_decomp_fillval.F90.in:298
  end if   ! pio_decomp_fillval.F90.in:299
   ! pio_decomp_fillval.F90.in:300
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval.F90.in:301
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval.F90.in:302
END SUBROUTINE nc_read_1d_explicit_fval_PIO_double_real_kind_fc_double___   ! pio_decomp_fillval.F90.in:303
   ! pio_decomp_fillval.F90.in:303


! nc read 1d array with fillvalues (the holes are implicit)


SUBROUTINE nc_read_1d_implicit_fval_PIO_int_integer__
USE pio_tutil
   ! pio_decomp_fillval.F90.in:307
  implicit none   ! pio_decomp_fillval.F90.in:308
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_fillval.F90.in:309
  type(var_desc_t)  :: pio_var   ! pio_decomp_fillval.F90.in:310
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval.F90.in:311
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval.F90.in:312
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_fillval.F90.in:313
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval.F90.in:314
  integer, dimension(:), allocatable :: rcompdof   ! pio_decomp_fillval.F90.in:315
  integer :: rcompdof_sz   ! pio_decomp_fillval.F90.in:316
  integer, dimension(VEC_LOCAL_SZ) :: wcompdof, compdof_rel_disps   ! pio_decomp_fillval.F90.in:317
  integer, dimension(:), allocatable :: rbuf, exp_val   ! pio_decomp_fillval.F90.in:318
  integer, dimension(VEC_LOCAL_SZ) :: wbuf   ! pio_decomp_fillval.F90.in:319
  integer, parameter :: BUF_FILLVAL = -2   ! pio_decomp_fillval.F90.in:320
  integer, dimension(1) :: dims   ! pio_decomp_fillval.F90.in:321
  integer :: pio_dim   ! pio_decomp_fillval.F90.in:322
  integer :: i, ierr, lsz   ! pio_decomp_fillval.F90.in:323
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval.F90.in:325
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval.F90.in:326
  integer :: num_iotypes   ! pio_decomp_fillval.F90.in:327
   ! pio_decomp_fillval.F90.in:328
  ! compdof is only specified for valid data values, the data holes are
  ! implicitly stated (by not specifying them rather than filling it with 0s)
  rcompdof_sz = min(pio_tf_world_rank_+1, VEC_LOCAL_SZ)    ! pio_decomp_fillval.F90.in:331
  allocate(rcompdof(rcompdof_sz))   ! pio_decomp_fillval.F90.in:332
  allocate(rbuf(rcompdof_sz))   ! pio_decomp_fillval.F90.in:333
  allocate(exp_val(rcompdof_sz))   ! pio_decomp_fillval.F90.in:334
   ! pio_decomp_fillval.F90.in:335
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval.F90.in:336
    compdof_rel_disps(i) = i   ! pio_decomp_fillval.F90.in:337
  end do   ! pio_decomp_fillval.F90.in:338
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_fillval.F90.in:339
  ! We only read 1 value on rank0, 2 values on rank1, ...
  do i=1,rcompdof_sz   ! pio_decomp_fillval.F90.in:341
    rcompdof(i) = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps(i)   ! pio_decomp_fillval.F90.in:342
  end do   ! pio_decomp_fillval.F90.in:343
  ! Write everything - we only read some of these values
  wcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval.F90.in:345
  wbuf = wcompdof   ! pio_decomp_fillval.F90.in:346
   ! pio_decomp_fillval.F90.in:347
  rbuf = BUF_FILLVAL   ! pio_decomp_fillval.F90.in:348
  do i=1,rcompdof_sz   ! pio_decomp_fillval.F90.in:349
    exp_val(i) = wbuf(i)   ! pio_decomp_fillval.F90.in:350
  end do   ! pio_decomp_fillval.F90.in:351
   ! pio_decomp_fillval.F90.in:352
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, wcompdof, wiodesc)   ! pio_decomp_fillval.F90.in:353
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, rcompdof, riodesc)   ! pio_decomp_fillval.F90.in:354
   ! pio_decomp_fillval.F90.in:355
  num_iotypes = 0   ! pio_decomp_fillval.F90.in:356
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval.F90.in:357
  filename = "test_pio_decomp_fillval_tests.testfile"   ! pio_decomp_fillval.F90.in:358
  do i=1,num_iotypes   ! pio_decomp_fillval.F90.in:359

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval.F90.in:360
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval.F90.in:361
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:362)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:362
   ! pio_decomp_fillval.F90.in:363
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval.F90.in:364
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:365)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:365
   ! pio_decomp_fillval.F90.in:366
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_int, (/pio_dim/), pio_var)   ! pio_decomp_fillval.F90.in:367
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:368)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:368
   ! pio_decomp_fillval.F90.in:369
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval.F90.in:370
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:371)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:371
   ! pio_decomp_fillval.F90.in:372
    call PIO_write_darray(pio_file, pio_var, wiodesc, wbuf, ierr)   ! pio_decomp_fillval.F90.in:373
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:374)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:374
   ! pio_decomp_fillval.F90.in:375
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:377
   ! pio_decomp_fillval.F90.in:378
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval.F90.in:379
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:380)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:380
   ! pio_decomp_fillval.F90.in:381
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_fillval.F90.in:382
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:383)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:383
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval.F90.in:385
#endif
   ! pio_decomp_fillval.F90.in:387
    ! Read only part of the written data
    call PIO_read_darray(pio_file, pio_var, riodesc, rbuf, ierr)   ! pio_decomp_fillval.F90.in:389
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:390)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:390
   ! pio_decomp_fillval.F90.in:391
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:392)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:392
   ! pio_decomp_fillval.F90.in:393
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:394
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval.F90.in:395
  end do   ! pio_decomp_fillval.F90.in:396
  if(allocated(iotypes)) then   ! pio_decomp_fillval.F90.in:397
    deallocate(iotypes)   ! pio_decomp_fillval.F90.in:398
    deallocate(iotype_descs)   ! pio_decomp_fillval.F90.in:399
  end if   ! pio_decomp_fillval.F90.in:400
   ! pio_decomp_fillval.F90.in:401
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval.F90.in:402
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval.F90.in:403
  deallocate(exp_val)   ! pio_decomp_fillval.F90.in:404
  deallocate(rbuf)   ! pio_decomp_fillval.F90.in:405
  deallocate(rcompdof)   ! pio_decomp_fillval.F90.in:406
END SUBROUTINE nc_read_1d_implicit_fval_PIO_int_integer__   ! pio_decomp_fillval.F90.in:407


SUBROUTINE nc_read_1d_implicit_fval_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_decomp_fillval.F90.in:307
  implicit none   ! pio_decomp_fillval.F90.in:308
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_fillval.F90.in:309
  type(var_desc_t)  :: pio_var   ! pio_decomp_fillval.F90.in:310
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval.F90.in:311
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval.F90.in:312
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_fillval.F90.in:313
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval.F90.in:314
  integer, dimension(:), allocatable :: rcompdof   ! pio_decomp_fillval.F90.in:315
  integer :: rcompdof_sz   ! pio_decomp_fillval.F90.in:316
  integer, dimension(VEC_LOCAL_SZ) :: wcompdof, compdof_rel_disps   ! pio_decomp_fillval.F90.in:317
  real(kind=fc_real), dimension(:), allocatable :: rbuf, exp_val   ! pio_decomp_fillval.F90.in:318
  real(kind=fc_real), dimension(VEC_LOCAL_SZ) :: wbuf   ! pio_decomp_fillval.F90.in:319
  integer, parameter :: BUF_FILLVAL = -2   ! pio_decomp_fillval.F90.in:320
  integer, dimension(1) :: dims   ! pio_decomp_fillval.F90.in:321
  integer :: pio_dim   ! pio_decomp_fillval.F90.in:322
  integer :: i, ierr, lsz   ! pio_decomp_fillval.F90.in:323
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval.F90.in:325
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval.F90.in:326
  integer :: num_iotypes   ! pio_decomp_fillval.F90.in:327
   ! pio_decomp_fillval.F90.in:328
  ! compdof is only specified for valid data values, the data holes are
  ! implicitly stated (by not specifying them rather than filling it with 0s)
  rcompdof_sz = min(pio_tf_world_rank_+1, VEC_LOCAL_SZ)    ! pio_decomp_fillval.F90.in:331
  allocate(rcompdof(rcompdof_sz))   ! pio_decomp_fillval.F90.in:332
  allocate(rbuf(rcompdof_sz))   ! pio_decomp_fillval.F90.in:333
  allocate(exp_val(rcompdof_sz))   ! pio_decomp_fillval.F90.in:334
   ! pio_decomp_fillval.F90.in:335
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval.F90.in:336
    compdof_rel_disps(i) = i   ! pio_decomp_fillval.F90.in:337
  end do   ! pio_decomp_fillval.F90.in:338
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_fillval.F90.in:339
  ! We only read 1 value on rank0, 2 values on rank1, ...
  do i=1,rcompdof_sz   ! pio_decomp_fillval.F90.in:341
    rcompdof(i) = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps(i)   ! pio_decomp_fillval.F90.in:342
  end do   ! pio_decomp_fillval.F90.in:343
  ! Write everything - we only read some of these values
  wcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval.F90.in:345
  wbuf = wcompdof   ! pio_decomp_fillval.F90.in:346
   ! pio_decomp_fillval.F90.in:347
  rbuf = BUF_FILLVAL   ! pio_decomp_fillval.F90.in:348
  do i=1,rcompdof_sz   ! pio_decomp_fillval.F90.in:349
    exp_val(i) = wbuf(i)   ! pio_decomp_fillval.F90.in:350
  end do   ! pio_decomp_fillval.F90.in:351
   ! pio_decomp_fillval.F90.in:352
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, wcompdof, wiodesc)   ! pio_decomp_fillval.F90.in:353
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, rcompdof, riodesc)   ! pio_decomp_fillval.F90.in:354
   ! pio_decomp_fillval.F90.in:355
  num_iotypes = 0   ! pio_decomp_fillval.F90.in:356
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval.F90.in:357
  filename = "test_pio_decomp_fillval_tests.testfile"   ! pio_decomp_fillval.F90.in:358
  do i=1,num_iotypes   ! pio_decomp_fillval.F90.in:359

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval.F90.in:360
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval.F90.in:361
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:362)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:362
   ! pio_decomp_fillval.F90.in:363
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval.F90.in:364
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:365)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:365
   ! pio_decomp_fillval.F90.in:366
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_real, (/pio_dim/), pio_var)   ! pio_decomp_fillval.F90.in:367
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:368)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:368
   ! pio_decomp_fillval.F90.in:369
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval.F90.in:370
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:371)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:371
   ! pio_decomp_fillval.F90.in:372
    call PIO_write_darray(pio_file, pio_var, wiodesc, wbuf, ierr)   ! pio_decomp_fillval.F90.in:373
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:374)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:374
   ! pio_decomp_fillval.F90.in:375
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:377
   ! pio_decomp_fillval.F90.in:378
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval.F90.in:379
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:380)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:380
   ! pio_decomp_fillval.F90.in:381
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_fillval.F90.in:382
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:383)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:383
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval.F90.in:385
#endif
   ! pio_decomp_fillval.F90.in:387
    ! Read only part of the written data
    call PIO_read_darray(pio_file, pio_var, riodesc, rbuf, ierr)   ! pio_decomp_fillval.F90.in:389
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:390)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:390
   ! pio_decomp_fillval.F90.in:391
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:392)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:392
   ! pio_decomp_fillval.F90.in:393
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:394
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval.F90.in:395
  end do   ! pio_decomp_fillval.F90.in:396
  if(allocated(iotypes)) then   ! pio_decomp_fillval.F90.in:397
    deallocate(iotypes)   ! pio_decomp_fillval.F90.in:398
    deallocate(iotype_descs)   ! pio_decomp_fillval.F90.in:399
  end if   ! pio_decomp_fillval.F90.in:400
   ! pio_decomp_fillval.F90.in:401
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval.F90.in:402
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval.F90.in:403
  deallocate(exp_val)   ! pio_decomp_fillval.F90.in:404
  deallocate(rbuf)   ! pio_decomp_fillval.F90.in:405
  deallocate(rcompdof)   ! pio_decomp_fillval.F90.in:406
END SUBROUTINE nc_read_1d_implicit_fval_PIO_real_real_kind_fc_real___   ! pio_decomp_fillval.F90.in:407


SUBROUTINE nc_read_1d_implicit_fval_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_decomp_fillval.F90.in:307
  implicit none   ! pio_decomp_fillval.F90.in:308
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_fillval.F90.in:309
  type(var_desc_t)  :: pio_var   ! pio_decomp_fillval.F90.in:310
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval.F90.in:311
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval.F90.in:312
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_fillval.F90.in:313
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval.F90.in:314
  integer, dimension(:), allocatable :: rcompdof   ! pio_decomp_fillval.F90.in:315
  integer :: rcompdof_sz   ! pio_decomp_fillval.F90.in:316
  integer, dimension(VEC_LOCAL_SZ) :: wcompdof, compdof_rel_disps   ! pio_decomp_fillval.F90.in:317
  real(kind=fc_double), dimension(:), allocatable :: rbuf, exp_val   ! pio_decomp_fillval.F90.in:318
  real(kind=fc_double), dimension(VEC_LOCAL_SZ) :: wbuf   ! pio_decomp_fillval.F90.in:319
  integer, parameter :: BUF_FILLVAL = -2   ! pio_decomp_fillval.F90.in:320
  integer, dimension(1) :: dims   ! pio_decomp_fillval.F90.in:321
  integer :: pio_dim   ! pio_decomp_fillval.F90.in:322
  integer :: i, ierr, lsz   ! pio_decomp_fillval.F90.in:323
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval.F90.in:325
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval.F90.in:326
  integer :: num_iotypes   ! pio_decomp_fillval.F90.in:327
   ! pio_decomp_fillval.F90.in:328
  ! compdof is only specified for valid data values, the data holes are
  ! implicitly stated (by not specifying them rather than filling it with 0s)
  rcompdof_sz = min(pio_tf_world_rank_+1, VEC_LOCAL_SZ)    ! pio_decomp_fillval.F90.in:331
  allocate(rcompdof(rcompdof_sz))   ! pio_decomp_fillval.F90.in:332
  allocate(rbuf(rcompdof_sz))   ! pio_decomp_fillval.F90.in:333
  allocate(exp_val(rcompdof_sz))   ! pio_decomp_fillval.F90.in:334
   ! pio_decomp_fillval.F90.in:335
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval.F90.in:336
    compdof_rel_disps(i) = i   ! pio_decomp_fillval.F90.in:337
  end do   ! pio_decomp_fillval.F90.in:338
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_fillval.F90.in:339
  ! We only read 1 value on rank0, 2 values on rank1, ...
  do i=1,rcompdof_sz   ! pio_decomp_fillval.F90.in:341
    rcompdof(i) = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps(i)   ! pio_decomp_fillval.F90.in:342
  end do   ! pio_decomp_fillval.F90.in:343
  ! Write everything - we only read some of these values
  wcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval.F90.in:345
  wbuf = wcompdof   ! pio_decomp_fillval.F90.in:346
   ! pio_decomp_fillval.F90.in:347
  rbuf = BUF_FILLVAL   ! pio_decomp_fillval.F90.in:348
  do i=1,rcompdof_sz   ! pio_decomp_fillval.F90.in:349
    exp_val(i) = wbuf(i)   ! pio_decomp_fillval.F90.in:350
  end do   ! pio_decomp_fillval.F90.in:351
   ! pio_decomp_fillval.F90.in:352
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, wcompdof, wiodesc)   ! pio_decomp_fillval.F90.in:353
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, rcompdof, riodesc)   ! pio_decomp_fillval.F90.in:354
   ! pio_decomp_fillval.F90.in:355
  num_iotypes = 0   ! pio_decomp_fillval.F90.in:356
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval.F90.in:357
  filename = "test_pio_decomp_fillval_tests.testfile"   ! pio_decomp_fillval.F90.in:358
  do i=1,num_iotypes   ! pio_decomp_fillval.F90.in:359

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval.F90.in:360
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval.F90.in:361
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:362)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:362
   ! pio_decomp_fillval.F90.in:363
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval.F90.in:364
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:365)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:365
   ! pio_decomp_fillval.F90.in:366
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_double, (/pio_dim/), pio_var)   ! pio_decomp_fillval.F90.in:367
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:368)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:368
   ! pio_decomp_fillval.F90.in:369
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval.F90.in:370
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:371)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:371
   ! pio_decomp_fillval.F90.in:372
    call PIO_write_darray(pio_file, pio_var, wiodesc, wbuf, ierr)   ! pio_decomp_fillval.F90.in:373
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:374)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:374
   ! pio_decomp_fillval.F90.in:375
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:377
   ! pio_decomp_fillval.F90.in:378
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval.F90.in:379
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:380)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:380
   ! pio_decomp_fillval.F90.in:381
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_fillval.F90.in:382
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:383)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:383
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval.F90.in:385
#endif
   ! pio_decomp_fillval.F90.in:387
    ! Read only part of the written data
    call PIO_read_darray(pio_file, pio_var, riodesc, rbuf, ierr)   ! pio_decomp_fillval.F90.in:389
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:390)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:390
   ! pio_decomp_fillval.F90.in:391
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval.F90.in:392)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval.F90.in:392
   ! pio_decomp_fillval.F90.in:393
    call PIO_closefile(pio_file)   ! pio_decomp_fillval.F90.in:394
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval.F90.in:395
  end do   ! pio_decomp_fillval.F90.in:396
  if(allocated(iotypes)) then   ! pio_decomp_fillval.F90.in:397
    deallocate(iotypes)   ! pio_decomp_fillval.F90.in:398
    deallocate(iotype_descs)   ! pio_decomp_fillval.F90.in:399
  end if   ! pio_decomp_fillval.F90.in:400
   ! pio_decomp_fillval.F90.in:401
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval.F90.in:402
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval.F90.in:403
  deallocate(exp_val)   ! pio_decomp_fillval.F90.in:404
  deallocate(rbuf)   ! pio_decomp_fillval.F90.in:405
  deallocate(rcompdof)   ! pio_decomp_fillval.F90.in:406
END SUBROUTINE nc_read_1d_implicit_fval_PIO_double_real_kind_fc_double___   ! pio_decomp_fillval.F90.in:407
   ! pio_decomp_fillval.F90.in:407


  SUBROUTINE PIO_TF_Test_driver_
    USE pio_tutil
    IMPLICIT NONE
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_explicit_fval_PIO_int_integer__"
    END IF
    CALL nc_write_1d_explicit_fval_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 1:",&
          "nc_write_1d_explicit_fval_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 1:",&
          "nc_write_1d_explicit_fval_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_explicit_fval_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_write_1d_explicit_fval_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 2:",&
          "nc_write_1d_explicit_fval_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 2:",&
          "nc_write_1d_explicit_fval_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_explicit_fval_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_write_1d_explicit_fval_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 3:",&
          "nc_write_1d_explicit_fval_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 3:",&
          "nc_write_1d_explicit_fval_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_explicit_fval_PIO_int_integer__"
    END IF
    CALL nc_write_1d_explicit_fval_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 4:",&
          "nc_write_1d_explicit_fval_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 4:",&
          "nc_write_1d_explicit_fval_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_explicit_fval_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_write_1d_explicit_fval_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 5:",&
          "nc_write_1d_explicit_fval_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 5:",&
          "nc_write_1d_explicit_fval_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_explicit_fval_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_write_1d_explicit_fval_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 6:",&
          "nc_write_1d_explicit_fval_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 6:",&
          "nc_write_1d_explicit_fval_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_implicit_fval_PIO_int_integer__"
    END IF
    CALL nc_write_1d_implicit_fval_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 7:",&
          "nc_write_1d_implicit_fval_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 7:",&
          "nc_write_1d_implicit_fval_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_implicit_fval_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_write_1d_implicit_fval_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 8:",&
          "nc_write_1d_implicit_fval_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 8:",&
          "nc_write_1d_implicit_fval_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_implicit_fval_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_write_1d_implicit_fval_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 9:",&
          "nc_write_1d_implicit_fval_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 9:",&
          "nc_write_1d_implicit_fval_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_explicit_fval_PIO_int_integer__"
    END IF
    CALL nc_write_1d_explicit_fval_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 10:",&
          "nc_write_1d_explicit_fval_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 10:",&
          "nc_write_1d_explicit_fval_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_explicit_fval_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_write_1d_explicit_fval_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 11:",&
          "nc_write_1d_explicit_fval_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 11:",&
          "nc_write_1d_explicit_fval_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_explicit_fval_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_write_1d_explicit_fval_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 12:",&
          "nc_write_1d_explicit_fval_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 12:",&
          "nc_write_1d_explicit_fval_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_implicit_fval_PIO_int_integer__"
    END IF
    CALL nc_write_1d_implicit_fval_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 13:",&
          "nc_write_1d_implicit_fval_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 13:",&
          "nc_write_1d_implicit_fval_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_implicit_fval_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_write_1d_implicit_fval_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 14:",&
          "nc_write_1d_implicit_fval_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 14:",&
          "nc_write_1d_implicit_fval_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_implicit_fval_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_write_1d_implicit_fval_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 15:",&
          "nc_write_1d_implicit_fval_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 15:",&
          "nc_write_1d_implicit_fval_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_read_1d_explicit_fval_PIO_int_integer__"
    END IF
    CALL nc_read_1d_explicit_fval_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 16:",&
          "nc_read_1d_explicit_fval_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 16:",&
          "nc_read_1d_explicit_fval_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_read_1d_explicit_fval_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_read_1d_explicit_fval_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 17:",&
          "nc_read_1d_explicit_fval_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 17:",&
          "nc_read_1d_explicit_fval_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_read_1d_explicit_fval_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_read_1d_explicit_fval_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 18:",&
          "nc_read_1d_explicit_fval_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 18:",&
          "nc_read_1d_explicit_fval_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_explicit_fval_PIO_int_integer__"
    END IF
    CALL nc_write_1d_explicit_fval_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 19:",&
          "nc_write_1d_explicit_fval_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 19:",&
          "nc_write_1d_explicit_fval_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_explicit_fval_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_write_1d_explicit_fval_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 20:",&
          "nc_write_1d_explicit_fval_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 20:",&
          "nc_write_1d_explicit_fval_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_explicit_fval_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_write_1d_explicit_fval_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 21:",&
          "nc_write_1d_explicit_fval_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 21:",&
          "nc_write_1d_explicit_fval_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_implicit_fval_PIO_int_integer__"
    END IF
    CALL nc_write_1d_implicit_fval_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 22:",&
          "nc_write_1d_implicit_fval_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 22:",&
          "nc_write_1d_implicit_fval_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_implicit_fval_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_write_1d_implicit_fval_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 23:",&
          "nc_write_1d_implicit_fval_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 23:",&
          "nc_write_1d_implicit_fval_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_implicit_fval_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_write_1d_implicit_fval_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 24:",&
          "nc_write_1d_implicit_fval_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 24:",&
          "nc_write_1d_implicit_fval_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_read_1d_explicit_fval_PIO_int_integer__"
    END IF
    CALL nc_read_1d_explicit_fval_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 25:",&
          "nc_read_1d_explicit_fval_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 25:",&
          "nc_read_1d_explicit_fval_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_read_1d_explicit_fval_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_read_1d_explicit_fval_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 26:",&
          "nc_read_1d_explicit_fval_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 26:",&
          "nc_read_1d_explicit_fval_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_read_1d_explicit_fval_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_read_1d_explicit_fval_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 27:",&
          "nc_read_1d_explicit_fval_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 27:",&
          "nc_read_1d_explicit_fval_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_read_1d_implicit_fval_PIO_int_integer__"
    END IF
    CALL nc_read_1d_implicit_fval_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 28:",&
          "nc_read_1d_implicit_fval_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 28:",&
          "nc_read_1d_implicit_fval_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_read_1d_implicit_fval_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_read_1d_implicit_fval_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 29:",&
          "nc_read_1d_implicit_fval_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 29:",&
          "nc_read_1d_implicit_fval_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_read_1d_implicit_fval_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_read_1d_implicit_fval_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 30:",&
          "nc_read_1d_implicit_fval_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 30:",&
          "nc_read_1d_implicit_fval_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
  END SUBROUTINE PIO_TF_Test_driver_


  PROGRAM PIO_TF_Test_main_
    USE pio_tutil
    IMPLICIT NONE
    INTEGER, PARAMETER :: NREARRS = 2
    INTEGER :: rearrs(NREARRS) = (/pio_rearr_subset,pio_rearr_box/)
    CHARACTER(LEN=PIO_TF_MAX_STR_LEN) :: rearrs_info(NREARRS) = (/"PIO_REARR_SUBSET","PIO_REARR_BOX   "/)
    INTEGER i, ierr

    pio_tf_nerrs_total_=0
    pio_tf_retval_utest_=0
    CALL MPI_Init(ierr)
    DO i=1,SIZE(rearrs)
      CALL PIO_TF_Init_(rearrs(i))
      IF (pio_tf_world_rank_ == 0) THEN
        WRITE(*,*) "PIO_TF: Testing : ", trim(rearrs_info(i))
      END IF
      CALL PIO_TF_Test_driver_()
      CALL PIO_TF_Finalize_()
    END DO
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_nerrs_total_ == 0) THEN
        IF (pio_tf_retval_utest_ == 0) THEN
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF: ",&
           "All tests", "---------", "PASSED"
        ELSE
          pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF: ",&
           "Test driver", "---------", "FAILED"
        END IF
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT2) "PIO_TF:[",&
          pio_tf_nerrs_total_,"] Tests",&
          "----- FAILED"
      END IF
    END IF
    CALL MPI_Finalize(ierr)
    IF (pio_tf_nerrs_total_ /= 0) THEN
      STOP 99
    END IF
  END PROGRAM
