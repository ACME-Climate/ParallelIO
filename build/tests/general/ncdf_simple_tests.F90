! DON'T MODIFY THIS FILE, ALL YOUR CHANGES WILL BE LOST
! This file is generated by ../../../tests/general/util/pio_tf_f90gen.pl
! from /home/tkurc/codar/e3sm/pio_adios1/ParallelIO/tests/general/ncdf_simple_tests.F90.in

MODULE ncdf_simple_tests_tgv   ! ncdf_simple_tests.F90.in:1
  use pio_tutil   ! ncdf_simple_tests.F90.in:2
  ! tgv in prefix corresponds to module name (ncdf_simple_tests_tgv)
  character(len=PIO_TF_MAX_STR_LEN), parameter :: tgv_fname = "pio_ncdf_test_file.nc"   ! ncdf_simple_tests.F90.in:4
  integer :: tgv_iotype   ! ncdf_simple_tests.F90.in:5
END MODULE ncdf_simple_tests_tgv   ! ncdf_simple_tests.F90.in:6


SUBROUTINE test_create
  USE pio_tutil
   ! ncdf_simple_tests.F90.in:8
  use ncdf_simple_tests_tgv   ! ncdf_simple_tests.F90.in:9
  Implicit none   ! ncdf_simple_tests.F90.in:10
  type(file_desc_t) :: pio_file   ! ncdf_simple_tests.F90.in:11
  character(len=PIO_TF_MAX_STR_LEN), parameter :: fname = "pio_test_create.nc"   ! ncdf_simple_tests.F90.in:12
  integer, parameter :: MAX_FLAGS = 3   ! ncdf_simple_tests.F90.in:13
  integer :: flags(MAX_FLAGS) = (/PIO_CLOBBER,&
                                  IOR(PIO_CLOBBER,PIO_64BIT_OFFSET),&
                                  IOR(PIO_CLOBBER,PIO_64BIT_DATA)&
                                  /)   ! ncdf_simple_tests.F90.in:17
  integer :: i   ! ncdf_simple_tests.F90.in:18
  integer :: ret   ! ncdf_simple_tests.F90.in:19


  do i=1,MAX_FLAGS   ! ncdf_simple_tests.F90.in:21

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Trying to create a file: type = ", tgv_iotype, ": flags = ", flags(i)
      END IF
    END IF   ! ncdf_simple_tests.F90.in:22


    ret = PIO_createfile(pio_tf_iosystem_, pio_file, tgv_iotype, fname, flags(i))   ! ncdf_simple_tests.F90.in:24
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to create:" // trim(fname),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_simple_tests.F90.in:25)"
      END IF
      RETURN
    END IF   ! ncdf_simple_tests.F90.in:25


    call PIO_closefile(pio_file)   ! ncdf_simple_tests.F90.in:27


    call PIO_deletefile(pio_tf_iosystem_, fname)   ! ncdf_simple_tests.F90.in:29
  end do   ! ncdf_simple_tests.F90.in:30


END SUBROUTINE test_create   ! ncdf_simple_tests.F90.in:32


SUBROUTINE test_clobber
  USE pio_tutil
   ! ncdf_simple_tests.F90.in:34
  use ncdf_simple_tests_tgv   ! ncdf_simple_tests.F90.in:35
  Implicit none   ! ncdf_simple_tests.F90.in:36
  type(file_desc_t) :: pio_file   ! ncdf_simple_tests.F90.in:37
  character(len=PIO_TF_MAX_STR_LEN), parameter :: clob_fname = "pio_test_clobber.nc"   ! ncdf_simple_tests.F90.in:38
  integer :: ret   ! ncdf_simple_tests.F90.in:39


  ! Default is NOCLOBBER
  ret = PIO_createfile(pio_tf_iosystem_, pio_file, tgv_iotype, clob_fname)   ! ncdf_simple_tests.F90.in:42
  
  IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to create:" // trim(clob_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:43)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:43


  call PIO_closefile(pio_file)   ! ncdf_simple_tests.F90.in:45


  ! Recrate with CLOBBER option - should erase existing file and create new one
  ret = PIO_createfile(pio_tf_iosystem_, pio_file, tgv_iotype, clob_fname, PIO_CLOBBER)   ! ncdf_simple_tests.F90.in:48
  
  IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to create (with CLOBBER):" // trim(clob_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:49)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:49


  call PIO_closefile(pio_file)   ! ncdf_simple_tests.F90.in:51
  call PIO_deletefile(pio_tf_iosystem_, clob_fname)   ! ncdf_simple_tests.F90.in:52


END SUBROUTINE test_clobber   ! ncdf_simple_tests.F90.in:54


SUBROUTINE test_redef_enddef
  USE pio_tutil
   ! ncdf_simple_tests.F90.in:56
  use ncdf_simple_tests_tgv   ! ncdf_simple_tests.F90.in:57
  Implicit none   ! ncdf_simple_tests.F90.in:58
  type(file_desc_t) :: pio_file   ! ncdf_simple_tests.F90.in:59
  integer :: ret   ! ncdf_simple_tests.F90.in:60


  ret = PIO_openfile(pio_tf_iosystem_, pio_file, tgv_iotype, tgv_fname, PIO_write)   ! ncdf_simple_tests.F90.in:62
  
  IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to open:" // trim(tgv_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:63)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:63


  ! A simple redef and then enddef
  ret = PIO_redef(pio_file)   ! ncdf_simple_tests.F90.in:66
  
  IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to redef:" // trim(tgv_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:67)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:67


  ret = PIO_enddef(pio_file)   ! ncdf_simple_tests.F90.in:69
  
  IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to enddef:" // trim(tgv_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:70)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:70


  call PIO_closefile(pio_file)   ! ncdf_simple_tests.F90.in:72


END SUBROUTINE test_redef_enddef   ! ncdf_simple_tests.F90.in:74


SUBROUTINE test_def_dim
  USE pio_tutil
   ! ncdf_simple_tests.F90.in:76
  use ncdf_simple_tests_tgv   ! ncdf_simple_tests.F90.in:77
  Implicit none   ! ncdf_simple_tests.F90.in:78
  type(file_desc_t) :: pio_file   ! ncdf_simple_tests.F90.in:79
  integer :: pio_dim   ! ncdf_simple_tests.F90.in:80
  integer :: ret   ! ncdf_simple_tests.F90.in:81


  ret = PIO_openfile(pio_tf_iosystem_, pio_file, tgv_iotype, tgv_fname, PIO_write)   ! ncdf_simple_tests.F90.in:83
  
  IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to open:" // trim(tgv_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:84)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:84


  ! A simple redef and then enddef
  ret = PIO_redef(pio_file)   ! ncdf_simple_tests.F90.in:87
  
  IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to redef:" // trim(tgv_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:88)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:88


  ret = PIO_def_dim(pio_file, 'dummy_dim_def_dim', 100, pio_dim)   ! ncdf_simple_tests.F90.in:90
  
  IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to define dim:" // trim(tgv_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:91)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:91


  ret = PIO_enddef(pio_file)   ! ncdf_simple_tests.F90.in:93
  
  IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to enddef:" // trim(tgv_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:94)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:94


  call PIO_closefile(pio_file)   ! ncdf_simple_tests.F90.in:96


END SUBROUTINE test_def_dim   ! ncdf_simple_tests.F90.in:98


SUBROUTINE test_def_var
  USE pio_tutil
   ! ncdf_simple_tests.F90.in:100
  use ncdf_simple_tests_tgv   ! ncdf_simple_tests.F90.in:101
  Implicit none   ! ncdf_simple_tests.F90.in:102
  type(file_desc_t) :: pio_file   ! ncdf_simple_tests.F90.in:103
  type(var_desc_t)  :: pio_var   ! ncdf_simple_tests.F90.in:104
  integer :: pio_dim   ! ncdf_simple_tests.F90.in:105
  integer :: ret   ! ncdf_simple_tests.F90.in:106


  ret = PIO_openfile(pio_tf_iosystem_, pio_file, tgv_iotype, tgv_fname, PIO_write)   ! ncdf_simple_tests.F90.in:108
  
  IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to open:" // trim(tgv_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:109)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:109


  ! A simple redef and then enddef
  ret = PIO_redef(pio_file)   ! ncdf_simple_tests.F90.in:112
  
  IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to redef:" // trim(tgv_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:113)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:113


  ret = PIO_def_dim(pio_file, 'dummy_dim_def_var', 100, pio_dim)   ! ncdf_simple_tests.F90.in:115
  
  IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to define dim:" // trim(tgv_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:116)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:116


  ret = PIO_def_var(pio_file, 'dummy_var_def_var', PIO_int, (/pio_dim/), pio_var)   ! ncdf_simple_tests.F90.in:118
  
  IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to define var:" // trim(tgv_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:119)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:119


  ret = PIO_enddef(pio_file)   ! ncdf_simple_tests.F90.in:121
  
  IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to enddef:" // trim(tgv_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:122)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:122


  call PIO_closefile(pio_file)   ! ncdf_simple_tests.F90.in:124


END SUBROUTINE test_def_var   ! ncdf_simple_tests.F90.in:126




SUBROUTINE test_data_conversion_PIO_int_integer__
USE pio_tutil
   ! ncdf_simple_tests.F90.in:129
  use ncdf_simple_tests_tgv   ! ncdf_simple_tests.F90.in:130
  implicit none   ! ncdf_simple_tests.F90.in:131
  integer, parameter :: VEC_LOCAL_SZ = 7   ! ncdf_simple_tests.F90.in:132
  type(var_desc_t)  :: pio_var_int, pio_var_real, pio_var_double   ! ncdf_simple_tests.F90.in:133
  type(file_desc_t) :: pio_file   ! ncdf_simple_tests.F90.in:134
  character(len=PIO_TF_MAX_STR_LEN) :: data_fname = "pio_test_data_conversion_PIO_int_integer__.nc"   ! ncdf_simple_tests.F90.in:135
  character(len=*), parameter :: PIO_VAR_INT_NAME = 'PIO_TF_test_var_int'   ! ncdf_simple_tests.F90.in:136
  character(len=*), parameter :: PIO_VAR_REAL_NAME = 'PIO_TF_test_var_real'   ! ncdf_simple_tests.F90.in:137
  character(len=*), parameter :: PIO_VAR_DBL_NAME = 'PIO_TF_test_var_dbl'   ! ncdf_simple_tests.F90.in:138
  type(io_desc_t) :: wiodesc, riodesc   ! ncdf_simple_tests.F90.in:139
  integer, dimension(VEC_LOCAL_SZ) :: compdof, compdof_rel_disps   ! ncdf_simple_tests.F90.in:140
  integer, dimension(VEC_LOCAL_SZ) :: wbuf, rbuf   ! ncdf_simple_tests.F90.in:141
  integer, dimension(1) :: dims   ! ncdf_simple_tests.F90.in:142
  integer :: pio_dim   ! ncdf_simple_tests.F90.in:143
  integer :: i, ierr   ! ncdf_simple_tests.F90.in:144
   ! ncdf_simple_tests.F90.in:145
  do i=1,VEC_LOCAL_SZ   ! ncdf_simple_tests.F90.in:146
    compdof_rel_disps(i) = i   ! ncdf_simple_tests.F90.in:147
  end do   ! ncdf_simple_tests.F90.in:148
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! ncdf_simple_tests.F90.in:149
  compdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! ncdf_simple_tests.F90.in:150
  wbuf = pio_tf_world_rank_   ! ncdf_simple_tests.F90.in:151
   ! ncdf_simple_tests.F90.in:152
  ! Set the decomposition for writing data
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof, wiodesc)   ! ncdf_simple_tests.F90.in:154
   ! ncdf_simple_tests.F90.in:155
  ! Set the decomposition for reading data
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof, riodesc)   ! ncdf_simple_tests.F90.in:157
   ! ncdf_simple_tests.F90.in:158
  ierr = PIO_createfile(pio_tf_iosystem_, pio_file, tgv_iotype, data_fname, PIO_CLOBBER)    ! ncdf_simple_tests.F90.in:159
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Could not create file " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:160)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:160
   ! ncdf_simple_tests.F90.in:161
  ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! ncdf_simple_tests.F90.in:162
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to define a dim : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:163)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:163
   ! ncdf_simple_tests.F90.in:164
  ierr = PIO_def_var(pio_file, PIO_VAR_INT_NAME, PIO_int, (/pio_dim/), pio_var_int)   ! ncdf_simple_tests.F90.in:165
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to define a var of int type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:166)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:166
   ! ncdf_simple_tests.F90.in:167
  ierr = PIO_def_var(pio_file, PIO_VAR_REAL_NAME, PIO_real, (/pio_dim/), pio_var_real)   ! ncdf_simple_tests.F90.in:168
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to define a var of real type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:169)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:169
   ! ncdf_simple_tests.F90.in:170
  ierr = PIO_def_var(pio_file, PIO_VAR_DBL_NAME, PIO_double, (/pio_dim/), pio_var_double)   ! ncdf_simple_tests.F90.in:171
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to define a var of double type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:172)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:172
   ! ncdf_simple_tests.F90.in:173
  ierr = PIO_enddef(pio_file)   ! ncdf_simple_tests.F90.in:174
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to end redef mode : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:175)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:175
   ! ncdf_simple_tests.F90.in:176
  ! Write the int type variable out (data conversion might occur: real => int, double => int)
  call PIO_write_darray(pio_file, pio_var_int, wiodesc, wbuf, ierr)   ! ncdf_simple_tests.F90.in:178
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to write darray on a var of int type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:179)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:179
   ! ncdf_simple_tests.F90.in:180
  ! Write the real type variable out (data conversion might occur: int => real, double => real)
  call PIO_write_darray(pio_file, pio_var_real, wiodesc, wbuf, ierr)   ! ncdf_simple_tests.F90.in:182
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to write darray on a var of real type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:183)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:183
   ! ncdf_simple_tests.F90.in:184
  ! Write the double type variable out (data conversion might occur: int => double, real => double)
  call PIO_write_darray(pio_file, pio_var_double, wiodesc, wbuf, ierr)   ! ncdf_simple_tests.F90.in:186
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to write darray on a var of double type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:187)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:187
   ! ncdf_simple_tests.F90.in:188
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
  call PIO_closefile(pio_file)   ! ncdf_simple_tests.F90.in:190
   ! ncdf_simple_tests.F90.in:191
  ierr = PIO_openfile(pio_tf_iosystem_, pio_file, tgv_iotype, data_fname, PIO_nowrite)   ! ncdf_simple_tests.F90.in:192
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Could not reopen file " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:193)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:193
   ! ncdf_simple_tests.F90.in:194
  ierr = PIO_inq_varid(pio_file, PIO_VAR_INT_NAME, pio_var_int)   ! ncdf_simple_tests.F90.in:195
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Cannot inq int var " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:196)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:196
   ! ncdf_simple_tests.F90.in:197
  ierr = PIO_inq_varid(pio_file, PIO_VAR_REAL_NAME, pio_var_real)   ! ncdf_simple_tests.F90.in:198
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Cannot inq real var " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:199)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:199
   ! ncdf_simple_tests.F90.in:200
  ierr = PIO_inq_varid(pio_file, PIO_VAR_DBL_NAME, pio_var_double)   ! ncdf_simple_tests.F90.in:201
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Cannot inq double var " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:202)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:202
#else
  call PIO_syncfile(pio_file)   ! ncdf_simple_tests.F90.in:204
#endif
   ! ncdf_simple_tests.F90.in:206
  ! Read the int type variable back (data conversion might occur: int => real, int => double)
  rbuf = 0   ! ncdf_simple_tests.F90.in:208
  call PIO_read_darray(pio_file, pio_var_int, riodesc, rbuf, ierr)   ! ncdf_simple_tests.F90.in:209
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to read darray on a var of int type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:210)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:210
   ! ncdf_simple_tests.F90.in:211
  
  IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Check failed:",&
         "Got wrong val",&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:212)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:212
   ! ncdf_simple_tests.F90.in:213
  ! Read the real type variable back (data conversion might occur: real => int, real => double)
  rbuf = 0   ! ncdf_simple_tests.F90.in:215
  call PIO_read_darray(pio_file, pio_var_real, riodesc, rbuf, ierr)   ! ncdf_simple_tests.F90.in:216
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to read darray on a var of real type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:217)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:217
   ! ncdf_simple_tests.F90.in:218
  
  IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Check failed:",&
         "Got wrong val",&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:219)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:219
   ! ncdf_simple_tests.F90.in:220
  ! Read the double type variable back (data conversion might occur: double => int, double => real)
  rbuf = 0   ! ncdf_simple_tests.F90.in:222
  call PIO_read_darray(pio_file, pio_var_double, riodesc, rbuf, ierr)   ! ncdf_simple_tests.F90.in:223
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to read darray on a var of double type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:224)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:224
   ! ncdf_simple_tests.F90.in:225
  
  IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Check failed:",&
         "Got wrong val",&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:226)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:226
   ! ncdf_simple_tests.F90.in:227
  call PIO_closefile(pio_file)   ! ncdf_simple_tests.F90.in:228
  call PIO_deletefile(pio_tf_iosystem_, data_fname);   ! ncdf_simple_tests.F90.in:229
   ! ncdf_simple_tests.F90.in:230
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! ncdf_simple_tests.F90.in:231
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! ncdf_simple_tests.F90.in:232
   ! ncdf_simple_tests.F90.in:233
END SUBROUTINE test_data_conversion_PIO_int_integer__   ! ncdf_simple_tests.F90.in:234


SUBROUTINE test_data_conversion_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! ncdf_simple_tests.F90.in:129
  use ncdf_simple_tests_tgv   ! ncdf_simple_tests.F90.in:130
  implicit none   ! ncdf_simple_tests.F90.in:131
  integer, parameter :: VEC_LOCAL_SZ = 7   ! ncdf_simple_tests.F90.in:132
  type(var_desc_t)  :: pio_var_int, pio_var_real, pio_var_double   ! ncdf_simple_tests.F90.in:133
  type(file_desc_t) :: pio_file   ! ncdf_simple_tests.F90.in:134
  character(len=PIO_TF_MAX_STR_LEN) :: data_fname = "pio_test_data_conversion_PIO_real_real_kind_fc_real___.nc"   ! ncdf_simple_tests.F90.in:135
  character(len=*), parameter :: PIO_VAR_INT_NAME = 'PIO_TF_test_var_int'   ! ncdf_simple_tests.F90.in:136
  character(len=*), parameter :: PIO_VAR_REAL_NAME = 'PIO_TF_test_var_real'   ! ncdf_simple_tests.F90.in:137
  character(len=*), parameter :: PIO_VAR_DBL_NAME = 'PIO_TF_test_var_dbl'   ! ncdf_simple_tests.F90.in:138
  type(io_desc_t) :: wiodesc, riodesc   ! ncdf_simple_tests.F90.in:139
  integer, dimension(VEC_LOCAL_SZ) :: compdof, compdof_rel_disps   ! ncdf_simple_tests.F90.in:140
  real(kind=fc_real), dimension(VEC_LOCAL_SZ) :: wbuf, rbuf   ! ncdf_simple_tests.F90.in:141
  integer, dimension(1) :: dims   ! ncdf_simple_tests.F90.in:142
  integer :: pio_dim   ! ncdf_simple_tests.F90.in:143
  integer :: i, ierr   ! ncdf_simple_tests.F90.in:144
   ! ncdf_simple_tests.F90.in:145
  do i=1,VEC_LOCAL_SZ   ! ncdf_simple_tests.F90.in:146
    compdof_rel_disps(i) = i   ! ncdf_simple_tests.F90.in:147
  end do   ! ncdf_simple_tests.F90.in:148
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! ncdf_simple_tests.F90.in:149
  compdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! ncdf_simple_tests.F90.in:150
  wbuf = pio_tf_world_rank_   ! ncdf_simple_tests.F90.in:151
   ! ncdf_simple_tests.F90.in:152
  ! Set the decomposition for writing data
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof, wiodesc)   ! ncdf_simple_tests.F90.in:154
   ! ncdf_simple_tests.F90.in:155
  ! Set the decomposition for reading data
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof, riodesc)   ! ncdf_simple_tests.F90.in:157
   ! ncdf_simple_tests.F90.in:158
  ierr = PIO_createfile(pio_tf_iosystem_, pio_file, tgv_iotype, data_fname, PIO_CLOBBER)    ! ncdf_simple_tests.F90.in:159
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Could not create file " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:160)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:160
   ! ncdf_simple_tests.F90.in:161
  ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! ncdf_simple_tests.F90.in:162
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to define a dim : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:163)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:163
   ! ncdf_simple_tests.F90.in:164
  ierr = PIO_def_var(pio_file, PIO_VAR_INT_NAME, PIO_int, (/pio_dim/), pio_var_int)   ! ncdf_simple_tests.F90.in:165
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to define a var of int type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:166)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:166
   ! ncdf_simple_tests.F90.in:167
  ierr = PIO_def_var(pio_file, PIO_VAR_REAL_NAME, PIO_real, (/pio_dim/), pio_var_real)   ! ncdf_simple_tests.F90.in:168
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to define a var of real type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:169)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:169
   ! ncdf_simple_tests.F90.in:170
  ierr = PIO_def_var(pio_file, PIO_VAR_DBL_NAME, PIO_double, (/pio_dim/), pio_var_double)   ! ncdf_simple_tests.F90.in:171
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to define a var of double type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:172)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:172
   ! ncdf_simple_tests.F90.in:173
  ierr = PIO_enddef(pio_file)   ! ncdf_simple_tests.F90.in:174
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to end redef mode : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:175)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:175
   ! ncdf_simple_tests.F90.in:176
  ! Write the int type variable out (data conversion might occur: real => int, double => int)
  call PIO_write_darray(pio_file, pio_var_int, wiodesc, wbuf, ierr)   ! ncdf_simple_tests.F90.in:178
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to write darray on a var of int type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:179)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:179
   ! ncdf_simple_tests.F90.in:180
  ! Write the real type variable out (data conversion might occur: int => real, double => real)
  call PIO_write_darray(pio_file, pio_var_real, wiodesc, wbuf, ierr)   ! ncdf_simple_tests.F90.in:182
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to write darray on a var of real type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:183)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:183
   ! ncdf_simple_tests.F90.in:184
  ! Write the double type variable out (data conversion might occur: int => double, real => double)
  call PIO_write_darray(pio_file, pio_var_double, wiodesc, wbuf, ierr)   ! ncdf_simple_tests.F90.in:186
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to write darray on a var of double type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:187)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:187
   ! ncdf_simple_tests.F90.in:188
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
  call PIO_closefile(pio_file)   ! ncdf_simple_tests.F90.in:190
   ! ncdf_simple_tests.F90.in:191
  ierr = PIO_openfile(pio_tf_iosystem_, pio_file, tgv_iotype, data_fname, PIO_nowrite)   ! ncdf_simple_tests.F90.in:192
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Could not reopen file " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:193)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:193
   ! ncdf_simple_tests.F90.in:194
  ierr = PIO_inq_varid(pio_file, PIO_VAR_INT_NAME, pio_var_int)   ! ncdf_simple_tests.F90.in:195
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Cannot inq int var " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:196)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:196
   ! ncdf_simple_tests.F90.in:197
  ierr = PIO_inq_varid(pio_file, PIO_VAR_REAL_NAME, pio_var_real)   ! ncdf_simple_tests.F90.in:198
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Cannot inq real var " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:199)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:199
   ! ncdf_simple_tests.F90.in:200
  ierr = PIO_inq_varid(pio_file, PIO_VAR_DBL_NAME, pio_var_double)   ! ncdf_simple_tests.F90.in:201
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Cannot inq double var " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:202)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:202
#else
  call PIO_syncfile(pio_file)   ! ncdf_simple_tests.F90.in:204
#endif
   ! ncdf_simple_tests.F90.in:206
  ! Read the int type variable back (data conversion might occur: int => real, int => double)
  rbuf = 0   ! ncdf_simple_tests.F90.in:208
  call PIO_read_darray(pio_file, pio_var_int, riodesc, rbuf, ierr)   ! ncdf_simple_tests.F90.in:209
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to read darray on a var of int type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:210)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:210
   ! ncdf_simple_tests.F90.in:211
  
  IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Check failed:",&
         "Got wrong val",&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:212)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:212
   ! ncdf_simple_tests.F90.in:213
  ! Read the real type variable back (data conversion might occur: real => int, real => double)
  rbuf = 0   ! ncdf_simple_tests.F90.in:215
  call PIO_read_darray(pio_file, pio_var_real, riodesc, rbuf, ierr)   ! ncdf_simple_tests.F90.in:216
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to read darray on a var of real type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:217)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:217
   ! ncdf_simple_tests.F90.in:218
  
  IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Check failed:",&
         "Got wrong val",&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:219)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:219
   ! ncdf_simple_tests.F90.in:220
  ! Read the double type variable back (data conversion might occur: double => int, double => real)
  rbuf = 0   ! ncdf_simple_tests.F90.in:222
  call PIO_read_darray(pio_file, pio_var_double, riodesc, rbuf, ierr)   ! ncdf_simple_tests.F90.in:223
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to read darray on a var of double type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:224)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:224
   ! ncdf_simple_tests.F90.in:225
  
  IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Check failed:",&
         "Got wrong val",&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:226)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:226
   ! ncdf_simple_tests.F90.in:227
  call PIO_closefile(pio_file)   ! ncdf_simple_tests.F90.in:228
  call PIO_deletefile(pio_tf_iosystem_, data_fname);   ! ncdf_simple_tests.F90.in:229
   ! ncdf_simple_tests.F90.in:230
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! ncdf_simple_tests.F90.in:231
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! ncdf_simple_tests.F90.in:232
   ! ncdf_simple_tests.F90.in:233
END SUBROUTINE test_data_conversion_PIO_real_real_kind_fc_real___   ! ncdf_simple_tests.F90.in:234


SUBROUTINE test_data_conversion_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! ncdf_simple_tests.F90.in:129
  use ncdf_simple_tests_tgv   ! ncdf_simple_tests.F90.in:130
  implicit none   ! ncdf_simple_tests.F90.in:131
  integer, parameter :: VEC_LOCAL_SZ = 7   ! ncdf_simple_tests.F90.in:132
  type(var_desc_t)  :: pio_var_int, pio_var_real, pio_var_double   ! ncdf_simple_tests.F90.in:133
  type(file_desc_t) :: pio_file   ! ncdf_simple_tests.F90.in:134
  character(len=PIO_TF_MAX_STR_LEN) :: data_fname = "pio_test_data_conversion_PIO_double_real_kind_fc_double___.nc"   ! ncdf_simple_tests.F90.in:135
  character(len=*), parameter :: PIO_VAR_INT_NAME = 'PIO_TF_test_var_int'   ! ncdf_simple_tests.F90.in:136
  character(len=*), parameter :: PIO_VAR_REAL_NAME = 'PIO_TF_test_var_real'   ! ncdf_simple_tests.F90.in:137
  character(len=*), parameter :: PIO_VAR_DBL_NAME = 'PIO_TF_test_var_dbl'   ! ncdf_simple_tests.F90.in:138
  type(io_desc_t) :: wiodesc, riodesc   ! ncdf_simple_tests.F90.in:139
  integer, dimension(VEC_LOCAL_SZ) :: compdof, compdof_rel_disps   ! ncdf_simple_tests.F90.in:140
  real(kind=fc_double), dimension(VEC_LOCAL_SZ) :: wbuf, rbuf   ! ncdf_simple_tests.F90.in:141
  integer, dimension(1) :: dims   ! ncdf_simple_tests.F90.in:142
  integer :: pio_dim   ! ncdf_simple_tests.F90.in:143
  integer :: i, ierr   ! ncdf_simple_tests.F90.in:144
   ! ncdf_simple_tests.F90.in:145
  do i=1,VEC_LOCAL_SZ   ! ncdf_simple_tests.F90.in:146
    compdof_rel_disps(i) = i   ! ncdf_simple_tests.F90.in:147
  end do   ! ncdf_simple_tests.F90.in:148
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! ncdf_simple_tests.F90.in:149
  compdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! ncdf_simple_tests.F90.in:150
  wbuf = pio_tf_world_rank_   ! ncdf_simple_tests.F90.in:151
   ! ncdf_simple_tests.F90.in:152
  ! Set the decomposition for writing data
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof, wiodesc)   ! ncdf_simple_tests.F90.in:154
   ! ncdf_simple_tests.F90.in:155
  ! Set the decomposition for reading data
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof, riodesc)   ! ncdf_simple_tests.F90.in:157
   ! ncdf_simple_tests.F90.in:158
  ierr = PIO_createfile(pio_tf_iosystem_, pio_file, tgv_iotype, data_fname, PIO_CLOBBER)    ! ncdf_simple_tests.F90.in:159
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Could not create file " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:160)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:160
   ! ncdf_simple_tests.F90.in:161
  ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! ncdf_simple_tests.F90.in:162
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to define a dim : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:163)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:163
   ! ncdf_simple_tests.F90.in:164
  ierr = PIO_def_var(pio_file, PIO_VAR_INT_NAME, PIO_int, (/pio_dim/), pio_var_int)   ! ncdf_simple_tests.F90.in:165
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to define a var of int type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:166)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:166
   ! ncdf_simple_tests.F90.in:167
  ierr = PIO_def_var(pio_file, PIO_VAR_REAL_NAME, PIO_real, (/pio_dim/), pio_var_real)   ! ncdf_simple_tests.F90.in:168
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to define a var of real type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:169)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:169
   ! ncdf_simple_tests.F90.in:170
  ierr = PIO_def_var(pio_file, PIO_VAR_DBL_NAME, PIO_double, (/pio_dim/), pio_var_double)   ! ncdf_simple_tests.F90.in:171
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to define a var of double type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:172)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:172
   ! ncdf_simple_tests.F90.in:173
  ierr = PIO_enddef(pio_file)   ! ncdf_simple_tests.F90.in:174
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to end redef mode : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:175)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:175
   ! ncdf_simple_tests.F90.in:176
  ! Write the int type variable out (data conversion might occur: real => int, double => int)
  call PIO_write_darray(pio_file, pio_var_int, wiodesc, wbuf, ierr)   ! ncdf_simple_tests.F90.in:178
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to write darray on a var of int type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:179)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:179
   ! ncdf_simple_tests.F90.in:180
  ! Write the real type variable out (data conversion might occur: int => real, double => real)
  call PIO_write_darray(pio_file, pio_var_real, wiodesc, wbuf, ierr)   ! ncdf_simple_tests.F90.in:182
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to write darray on a var of real type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:183)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:183
   ! ncdf_simple_tests.F90.in:184
  ! Write the double type variable out (data conversion might occur: int => double, real => double)
  call PIO_write_darray(pio_file, pio_var_double, wiodesc, wbuf, ierr)   ! ncdf_simple_tests.F90.in:186
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to write darray on a var of double type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:187)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:187
   ! ncdf_simple_tests.F90.in:188
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
  call PIO_closefile(pio_file)   ! ncdf_simple_tests.F90.in:190
   ! ncdf_simple_tests.F90.in:191
  ierr = PIO_openfile(pio_tf_iosystem_, pio_file, tgv_iotype, data_fname, PIO_nowrite)   ! ncdf_simple_tests.F90.in:192
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Could not reopen file " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:193)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:193
   ! ncdf_simple_tests.F90.in:194
  ierr = PIO_inq_varid(pio_file, PIO_VAR_INT_NAME, pio_var_int)   ! ncdf_simple_tests.F90.in:195
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Cannot inq int var " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:196)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:196
   ! ncdf_simple_tests.F90.in:197
  ierr = PIO_inq_varid(pio_file, PIO_VAR_REAL_NAME, pio_var_real)   ! ncdf_simple_tests.F90.in:198
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Cannot inq real var " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:199)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:199
   ! ncdf_simple_tests.F90.in:200
  ierr = PIO_inq_varid(pio_file, PIO_VAR_DBL_NAME, pio_var_double)   ! ncdf_simple_tests.F90.in:201
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Cannot inq double var " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:202)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:202
#else
  call PIO_syncfile(pio_file)   ! ncdf_simple_tests.F90.in:204
#endif
   ! ncdf_simple_tests.F90.in:206
  ! Read the int type variable back (data conversion might occur: int => real, int => double)
  rbuf = 0   ! ncdf_simple_tests.F90.in:208
  call PIO_read_darray(pio_file, pio_var_int, riodesc, rbuf, ierr)   ! ncdf_simple_tests.F90.in:209
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to read darray on a var of int type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:210)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:210
   ! ncdf_simple_tests.F90.in:211
  
  IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Check failed:",&
         "Got wrong val",&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:212)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:212
   ! ncdf_simple_tests.F90.in:213
  ! Read the real type variable back (data conversion might occur: real => int, real => double)
  rbuf = 0   ! ncdf_simple_tests.F90.in:215
  call PIO_read_darray(pio_file, pio_var_real, riodesc, rbuf, ierr)   ! ncdf_simple_tests.F90.in:216
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to read darray on a var of real type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:217)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:217
   ! ncdf_simple_tests.F90.in:218
  
  IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Check failed:",&
         "Got wrong val",&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:219)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:219
   ! ncdf_simple_tests.F90.in:220
  ! Read the double type variable back (data conversion might occur: double => int, double => real)
  rbuf = 0   ! ncdf_simple_tests.F90.in:222
  call PIO_read_darray(pio_file, pio_var_double, riodesc, rbuf, ierr)   ! ncdf_simple_tests.F90.in:223
  
  IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Function failed:",&
         "Failed to read darray on a var of double type : " // trim(data_fname),&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:224)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:224
   ! ncdf_simple_tests.F90.in:225
  
  IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
    pio_tf_retval_utest_ = -1
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: PIO Check failed:",&
         "Got wrong val",&
        ":", __FILE__, ":", __LINE__,&
        "(ncdf_simple_tests.F90.in:226)"
    END IF
    RETURN
  END IF   ! ncdf_simple_tests.F90.in:226
   ! ncdf_simple_tests.F90.in:227
  call PIO_closefile(pio_file)   ! ncdf_simple_tests.F90.in:228
  call PIO_deletefile(pio_tf_iosystem_, data_fname);   ! ncdf_simple_tests.F90.in:229
   ! ncdf_simple_tests.F90.in:230
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! ncdf_simple_tests.F90.in:231
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! ncdf_simple_tests.F90.in:232
   ! ncdf_simple_tests.F90.in:233
END SUBROUTINE test_data_conversion_PIO_double_real_kind_fc_double___   ! ncdf_simple_tests.F90.in:234
   ! ncdf_simple_tests.F90.in:234


SUBROUTINE PIO_TF_Test_driver_
  USE pio_tutil
   ! ncdf_simple_tests.F90.in:236
  use ncdf_simple_tests_tgv   ! ncdf_simple_tests.F90.in:237
  Implicit none   ! ncdf_simple_tests.F90.in:238
  type(file_desc_t) :: pio_file   ! ncdf_simple_tests.F90.in:239
  integer :: ret, i   ! ncdf_simple_tests.F90.in:240
  ! iotypes = valid NC types
  integer, dimension(:), allocatable :: iotypes   ! ncdf_simple_tests.F90.in:242
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_simple_tests.F90.in:243
  integer :: num_iotypes   ! ncdf_simple_tests.F90.in:244


  num_iotypes = 0   ! ncdf_simple_tests.F90.in:246
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)    ! ncdf_simple_tests.F90.in:247
  do i=1,num_iotypes   ! ncdf_simple_tests.F90.in:248
    tgv_iotype = iotypes(i)   ! ncdf_simple_tests.F90.in:249
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, tgv_iotype, tgv_fname)   ! ncdf_simple_tests.F90.in:250
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to create:"//trim(iotype_descs(i))//":"//trim(tgv_fname),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_simple_tests.F90.in:251)"
      END IF
      RETURN
    END IF   ! ncdf_simple_tests.F90.in:251


    call PIO_closefile(pio_file)   ! ncdf_simple_tests.F90.in:253


    ! Make sure that global variables are set correctly before running the tests
    
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: Running AUTO tests: ", trim(iotype_descs(i))
      END IF
      pio_tf_retval_utest_ = 0
      pio_tf_tmp_log_str_="test_data_conversion_PIO_int_integer__"//"("//trim(iotype_descs(i))//")"
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: Starting test_data_conversion_PIO_int_integer__"
      END IF
      CALL test_data_conversion_PIO_int_integer__()
      IF (pio_tf_retval_utest_ /= 0) THEN
        pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
      END IF
      IF (pio_tf_world_rank_ == 0) THEN
        IF (pio_tf_retval_utest_ == 0) THEN
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 1:",&
            pio_tf_tmp_log_str_,&
            "---------","PASSED"
        ELSE
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 1:",&
            pio_tf_tmp_log_str_,&
            "---------","FAILED"
        END IF
      END IF
      pio_tf_retval_utest_ = 0
      pio_tf_tmp_log_str_="test_data_conversion_PIO_real_real_kind_fc_real___"//"("//trim(iotype_descs(i))//")"
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: Starting test_data_conversion_PIO_real_real_kind_fc_real___"
      END IF
      CALL test_data_conversion_PIO_real_real_kind_fc_real___()
      IF (pio_tf_retval_utest_ /= 0) THEN
        pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
      END IF
      IF (pio_tf_world_rank_ == 0) THEN
        IF (pio_tf_retval_utest_ == 0) THEN
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 2:",&
            pio_tf_tmp_log_str_,&
            "---------","PASSED"
        ELSE
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 2:",&
            pio_tf_tmp_log_str_,&
            "---------","FAILED"
        END IF
      END IF
      pio_tf_retval_utest_ = 0
      pio_tf_tmp_log_str_="test_data_conversion_PIO_double_real_kind_fc_double___"//"("//trim(iotype_descs(i))//")"
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: Starting test_data_conversion_PIO_double_real_kind_fc_double___"
      END IF
      CALL test_data_conversion_PIO_double_real_kind_fc_double___()
      IF (pio_tf_retval_utest_ /= 0) THEN
        pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
      END IF
      IF (pio_tf_world_rank_ == 0) THEN
        IF (pio_tf_retval_utest_ == 0) THEN
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 3:",&
            pio_tf_tmp_log_str_,&
            "---------","PASSED"
        ELSE
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 3:",&
            pio_tf_tmp_log_str_,&
            "---------","FAILED"
        END IF
      END IF
      pio_tf_retval_utest_ = 0
      pio_tf_tmp_log_str_="test_create"//"("//trim(iotype_descs(i))//")"
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: Starting test_create"
      END IF
      CALL test_create()
      IF (pio_tf_retval_utest_ /= 0) THEN
        pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
      END IF
      IF (pio_tf_world_rank_ == 0) THEN
        IF (pio_tf_retval_utest_ == 0) THEN
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 4:",&
            pio_tf_tmp_log_str_,&
            "---------","PASSED"
        ELSE
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 4:",&
            pio_tf_tmp_log_str_,&
            "---------","FAILED"
        END IF
      END IF
      pio_tf_retval_utest_ = 0
      pio_tf_tmp_log_str_="test_clobber"//"("//trim(iotype_descs(i))//")"
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: Starting test_clobber"
      END IF
      CALL test_clobber()
      IF (pio_tf_retval_utest_ /= 0) THEN
        pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
      END IF
      IF (pio_tf_world_rank_ == 0) THEN
        IF (pio_tf_retval_utest_ == 0) THEN
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 5:",&
            pio_tf_tmp_log_str_,&
            "---------","PASSED"
        ELSE
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 5:",&
            pio_tf_tmp_log_str_,&
            "---------","FAILED"
        END IF
      END IF
      pio_tf_retval_utest_ = 0
      pio_tf_tmp_log_str_="test_redef_enddef"//"("//trim(iotype_descs(i))//")"
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: Starting test_redef_enddef"
      END IF
      CALL test_redef_enddef()
      IF (pio_tf_retval_utest_ /= 0) THEN
        pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
      END IF
      IF (pio_tf_world_rank_ == 0) THEN
        IF (pio_tf_retval_utest_ == 0) THEN
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 6:",&
            pio_tf_tmp_log_str_,&
            "---------","PASSED"
        ELSE
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 6:",&
            pio_tf_tmp_log_str_,&
            "---------","FAILED"
        END IF
      END IF
      pio_tf_retval_utest_ = 0
      pio_tf_tmp_log_str_="test_def_dim"//"("//trim(iotype_descs(i))//")"
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: Starting test_def_dim"
      END IF
      CALL test_def_dim()
      IF (pio_tf_retval_utest_ /= 0) THEN
        pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
      END IF
      IF (pio_tf_world_rank_ == 0) THEN
        IF (pio_tf_retval_utest_ == 0) THEN
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 7:",&
            pio_tf_tmp_log_str_,&
            "---------","PASSED"
        ELSE
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 7:",&
            pio_tf_tmp_log_str_,&
            "---------","FAILED"
        END IF
      END IF
      pio_tf_retval_utest_ = 0
      pio_tf_tmp_log_str_="test_def_var"//"("//trim(iotype_descs(i))//")"
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: Starting test_def_var"
      END IF
      CALL test_def_var()
      IF (pio_tf_retval_utest_ /= 0) THEN
        pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
      END IF
      IF (pio_tf_world_rank_ == 0) THEN
        IF (pio_tf_retval_utest_ == 0) THEN
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 8:",&
            pio_tf_tmp_log_str_,&
            "---------","PASSED"
        ELSE
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 8:",&
            pio_tf_tmp_log_str_,&
            "---------","FAILED"
        END IF
      END IF
   ! ncdf_simple_tests.F90.in:256


    call PIO_deletefile(pio_tf_iosystem_, tgv_fname)   ! ncdf_simple_tests.F90.in:258
  end do   ! ncdf_simple_tests.F90.in:259
  if(allocated(iotypes)) then   ! ncdf_simple_tests.F90.in:260
    deallocate(iotypes)   ! ncdf_simple_tests.F90.in:261
    deallocate(iotype_descs)   ! ncdf_simple_tests.F90.in:262
  end if   ! ncdf_simple_tests.F90.in:263



END SUBROUTINE PIO_TF_Test_driver_   ! ncdf_simple_tests.F90.in:265


  PROGRAM PIO_TF_Test_main_
    USE pio_tutil
    IMPLICIT NONE
    INTEGER, PARAMETER :: NREARRS = 2
    INTEGER :: rearrs(NREARRS) = (/pio_rearr_subset,pio_rearr_box/)
    CHARACTER(LEN=PIO_TF_MAX_STR_LEN) :: rearrs_info(NREARRS) = (/"PIO_REARR_SUBSET","PIO_REARR_BOX   "/)
    INTEGER i, ierr

    pio_tf_nerrs_total_=0
    pio_tf_retval_utest_=0
    CALL MPI_Init(ierr)
    DO i=1,SIZE(rearrs)
      CALL PIO_TF_Init_(rearrs(i))
      IF (pio_tf_world_rank_ == 0) THEN
        WRITE(*,*) "PIO_TF: Testing : ", trim(rearrs_info(i))
      END IF
      CALL PIO_TF_Test_driver_()
      CALL PIO_TF_Finalize_()
    END DO
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_nerrs_total_ == 0) THEN
        IF (pio_tf_retval_utest_ == 0) THEN
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF: ",&
           "All tests", "---------", "PASSED"
        ELSE
          pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF: ",&
           "Test driver", "---------", "FAILED"
        END IF
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT2) "PIO_TF:[",&
          pio_tf_nerrs_total_,"] Tests",&
          "----- FAILED"
      END IF
    END IF
    CALL MPI_Finalize(ierr)
    IF (pio_tf_nerrs_total_ /= 0) THEN
      STOP 99
    END IF
  END PROGRAM
