! DON'T MODIFY THIS FILE, ALL YOUR CHANGES WILL BE LOST
! This file is generated by ../../../tests/general/util/pio_tf_f90gen.pl
! from /home/tkurc/codar/e3sm/pio_adios1/ParallelIO/tests/general/ncdf_get_put.F90.in



SUBROUTINE test_put_1datt_PIO_int_integer__
USE pio_tutil
   ! ncdf_get_put.F90.in:2
  Implicit none   ! ncdf_get_put.F90.in:3
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:4
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:5
  type(var_desc_t)  :: pio_var, pio_cvar   ! ncdf_get_put.F90.in:6
  integer :: pio_dim   ! ncdf_get_put.F90.in:7
  integer, parameter :: DIM_LEN = 100   ! ncdf_get_put.F90.in:8
  integer, dimension(DIM_LEN) :: val   ! ncdf_get_put.F90.in:9
  CHARACTER(len=DIM_LEN) :: cval   ! ncdf_get_put.F90.in:10
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:11
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:12
  integer :: num_iotypes   ! ncdf_get_put.F90.in:13
  integer :: i, ret   ! ncdf_get_put.F90.in:14
     ! ncdf_get_put.F90.in:15
  val = pio_tf_world_sz_   ! ncdf_get_put.F90.in:16
  cval = "DUMMY_STRING"   ! ncdf_get_put.F90.in:17
  num_iotypes = 0   ! ncdf_get_put.F90.in:18
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:19
  filename = "test_pio_ncdf_get_put.testfile"   ! ncdf_get_put.F90.in:20
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:21

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:22
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:23
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:24)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:24
   ! ncdf_get_put.F90.in:25
    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'dummy_dim_put_val', DIM_LEN, pio_dim)   ! ncdf_get_put.F90.in:27
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:28)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:28
   ! ncdf_get_put.F90.in:29
    ret = PIO_def_var(pio_file, 'dummy_var_put_val', PIO_int, (/pio_dim/), pio_var)   ! ncdf_get_put.F90.in:30
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:31)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:31
   ! ncdf_get_put.F90.in:32
    ret = PIO_def_var(pio_file, 'dummy_var_put_cval', PIO_char, (/pio_dim/), pio_cvar)   ! ncdf_get_put.F90.in:33
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:34)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:34
   ! ncdf_get_put.F90.in:35
    ret = PIO_put_att(pio_file, pio_var, 'dummy_att_put_val', val);   ! ncdf_get_put.F90.in:36
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put attribute:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:37)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:37
   ! ncdf_get_put.F90.in:38
    ret = PIO_put_att(pio_file, pio_cvar, 'dummy_att_put_cval', cval);   ! ncdf_get_put.F90.in:39
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put char attribute:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:40)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:40
   ! ncdf_get_put.F90.in:41
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:42
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:43)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:43
   ! ncdf_get_put.F90.in:44
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:45
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:46
  end do   ! ncdf_get_put.F90.in:47
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:48
    deallocate(iotypes)   ! ncdf_get_put.F90.in:49
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:50
  end if   ! ncdf_get_put.F90.in:51
   ! ncdf_get_put.F90.in:52
END SUBROUTINE test_put_1datt_PIO_int_integer__   ! ncdf_get_put.F90.in:53


SUBROUTINE test_put_1datt_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! ncdf_get_put.F90.in:2
  Implicit none   ! ncdf_get_put.F90.in:3
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:4
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:5
  type(var_desc_t)  :: pio_var, pio_cvar   ! ncdf_get_put.F90.in:6
  integer :: pio_dim   ! ncdf_get_put.F90.in:7
  integer, parameter :: DIM_LEN = 100   ! ncdf_get_put.F90.in:8
  real(kind=fc_real), dimension(DIM_LEN) :: val   ! ncdf_get_put.F90.in:9
  CHARACTER(len=DIM_LEN) :: cval   ! ncdf_get_put.F90.in:10
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:11
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:12
  integer :: num_iotypes   ! ncdf_get_put.F90.in:13
  integer :: i, ret   ! ncdf_get_put.F90.in:14
     ! ncdf_get_put.F90.in:15
  val = pio_tf_world_sz_   ! ncdf_get_put.F90.in:16
  cval = "DUMMY_STRING"   ! ncdf_get_put.F90.in:17
  num_iotypes = 0   ! ncdf_get_put.F90.in:18
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:19
  filename = "test_pio_ncdf_get_put.testfile"   ! ncdf_get_put.F90.in:20
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:21

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:22
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:23
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:24)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:24
   ! ncdf_get_put.F90.in:25
    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'dummy_dim_put_val', DIM_LEN, pio_dim)   ! ncdf_get_put.F90.in:27
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:28)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:28
   ! ncdf_get_put.F90.in:29
    ret = PIO_def_var(pio_file, 'dummy_var_put_val', PIO_real, (/pio_dim/), pio_var)   ! ncdf_get_put.F90.in:30
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:31)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:31
   ! ncdf_get_put.F90.in:32
    ret = PIO_def_var(pio_file, 'dummy_var_put_cval', PIO_char, (/pio_dim/), pio_cvar)   ! ncdf_get_put.F90.in:33
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:34)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:34
   ! ncdf_get_put.F90.in:35
    ret = PIO_put_att(pio_file, pio_var, 'dummy_att_put_val', val);   ! ncdf_get_put.F90.in:36
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put attribute:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:37)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:37
   ! ncdf_get_put.F90.in:38
    ret = PIO_put_att(pio_file, pio_cvar, 'dummy_att_put_cval', cval);   ! ncdf_get_put.F90.in:39
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put char attribute:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:40)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:40
   ! ncdf_get_put.F90.in:41
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:42
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:43)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:43
   ! ncdf_get_put.F90.in:44
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:45
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:46
  end do   ! ncdf_get_put.F90.in:47
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:48
    deallocate(iotypes)   ! ncdf_get_put.F90.in:49
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:50
  end if   ! ncdf_get_put.F90.in:51
   ! ncdf_get_put.F90.in:52
END SUBROUTINE test_put_1datt_PIO_real_real_kind_fc_real___   ! ncdf_get_put.F90.in:53


SUBROUTINE test_put_1datt_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! ncdf_get_put.F90.in:2
  Implicit none   ! ncdf_get_put.F90.in:3
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:4
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:5
  type(var_desc_t)  :: pio_var, pio_cvar   ! ncdf_get_put.F90.in:6
  integer :: pio_dim   ! ncdf_get_put.F90.in:7
  integer, parameter :: DIM_LEN = 100   ! ncdf_get_put.F90.in:8
  real(kind=fc_double), dimension(DIM_LEN) :: val   ! ncdf_get_put.F90.in:9
  CHARACTER(len=DIM_LEN) :: cval   ! ncdf_get_put.F90.in:10
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:11
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:12
  integer :: num_iotypes   ! ncdf_get_put.F90.in:13
  integer :: i, ret   ! ncdf_get_put.F90.in:14
     ! ncdf_get_put.F90.in:15
  val = pio_tf_world_sz_   ! ncdf_get_put.F90.in:16
  cval = "DUMMY_STRING"   ! ncdf_get_put.F90.in:17
  num_iotypes = 0   ! ncdf_get_put.F90.in:18
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:19
  filename = "test_pio_ncdf_get_put.testfile"   ! ncdf_get_put.F90.in:20
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:21

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:22
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:23
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:24)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:24
   ! ncdf_get_put.F90.in:25
    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'dummy_dim_put_val', DIM_LEN, pio_dim)   ! ncdf_get_put.F90.in:27
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:28)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:28
   ! ncdf_get_put.F90.in:29
    ret = PIO_def_var(pio_file, 'dummy_var_put_val', PIO_double, (/pio_dim/), pio_var)   ! ncdf_get_put.F90.in:30
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:31)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:31
   ! ncdf_get_put.F90.in:32
    ret = PIO_def_var(pio_file, 'dummy_var_put_cval', PIO_char, (/pio_dim/), pio_cvar)   ! ncdf_get_put.F90.in:33
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:34)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:34
   ! ncdf_get_put.F90.in:35
    ret = PIO_put_att(pio_file, pio_var, 'dummy_att_put_val', val);   ! ncdf_get_put.F90.in:36
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put attribute:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:37)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:37
   ! ncdf_get_put.F90.in:38
    ret = PIO_put_att(pio_file, pio_cvar, 'dummy_att_put_cval', cval);   ! ncdf_get_put.F90.in:39
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put char attribute:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:40)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:40
   ! ncdf_get_put.F90.in:41
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:42
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:43)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:43
   ! ncdf_get_put.F90.in:44
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:45
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:46
  end do   ! ncdf_get_put.F90.in:47
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:48
    deallocate(iotypes)   ! ncdf_get_put.F90.in:49
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:50
  end if   ! ncdf_get_put.F90.in:51
   ! ncdf_get_put.F90.in:52
END SUBROUTINE test_put_1datt_PIO_double_real_kind_fc_double___   ! ncdf_get_put.F90.in:53
   ! ncdf_get_put.F90.in:53




SUBROUTINE test_put_get_1datt_PIO_int_integer__
USE pio_tutil
   ! ncdf_get_put.F90.in:56
  Implicit none   ! ncdf_get_put.F90.in:57
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:58
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:59
  type(var_desc_t)  :: pio_var, pio_cvar   ! ncdf_get_put.F90.in:60
  integer :: pio_dim   ! ncdf_get_put.F90.in:61
  integer, parameter :: DIM_LEN = 100   ! ncdf_get_put.F90.in:62
  integer, dimension(DIM_LEN) :: pval, gval   ! ncdf_get_put.F90.in:63
  integer :: init_val   ! ncdf_get_put.F90.in:64
  CHARACTER(len=DIM_LEN) :: pcval, gcval   ! ncdf_get_put.F90.in:65
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:66
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:67
  integer :: num_iotypes   ! ncdf_get_put.F90.in:68
  integer :: i, ret   ! ncdf_get_put.F90.in:69
     ! ncdf_get_put.F90.in:70
  init_val = pio_tf_world_sz_   ! ncdf_get_put.F90.in:71
   ! ncdf_get_put.F90.in:72
  pval = init_val   ! ncdf_get_put.F90.in:73
  pcval = "DUMMY_STRING"   ! ncdf_get_put.F90.in:74
  num_iotypes = 0   ! ncdf_get_put.F90.in:75
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:76
  filename = "test_pio_ncdf_get_put.testfile"   ! ncdf_get_put.F90.in:77
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:78

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:79
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:80
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:81)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:81
   ! ncdf_get_put.F90.in:82
    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'dummy_dim', DIM_LEN, pio_dim)   ! ncdf_get_put.F90.in:84
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:85)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:85
   ! ncdf_get_put.F90.in:86
    ret = PIO_def_var(pio_file, 'dummy_val', PIO_int, (/pio_dim/), pio_var)   ! ncdf_get_put.F90.in:87
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:88)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:88
   ! ncdf_get_put.F90.in:89
    ret = PIO_def_var(pio_file, 'dummy_cval', PIO_char, (/pio_dim/), pio_cvar)   ! ncdf_get_put.F90.in:90
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:91)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:91
   ! ncdf_get_put.F90.in:92
    ret = PIO_put_att(pio_file, pio_var, 'dummy_att_val', pval);   ! ncdf_get_put.F90.in:93
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put attribute:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:94)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:94
   ! ncdf_get_put.F90.in:95
    ret = PIO_put_att(pio_file, pio_cvar, 'dummy_att_cval', pcval);   ! ncdf_get_put.F90.in:96
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put char attribute:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:97)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:97
   ! ncdf_get_put.F90.in:98
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:99
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:100)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:100
   ! ncdf_get_put.F90.in:101
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:103
   ! ncdf_get_put.F90.in:104
    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:105
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:106)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:106
   ! ncdf_get_put.F90.in:107
    ret = PIO_inq_varid(pio_file, 'dummy_val', pio_var)   ! ncdf_get_put.F90.in:108
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:109)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:109
   ! ncdf_get_put.F90.in:110
    ret = PIO_inq_varid(pio_file, 'dummy_cval', pio_cvar)   ! ncdf_get_put.F90.in:111
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:112)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:112
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:114
#endif
   ! ncdf_get_put.F90.in:116
    ret = PIO_get_att(pio_file, pio_var, 'dummy_att_val', gval);   ! ncdf_get_put.F90.in:117
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get attribute:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:118)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:118
   ! ncdf_get_put.F90.in:119
    
    IF (.NOT. PIO_TF_Check_val_(gval, init_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:120)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:120
   ! ncdf_get_put.F90.in:121
    ! FIXME: Check the values are correct
    ret = PIO_get_att(pio_file, pio_cvar, 'dummy_att_cval', gcval);   ! ncdf_get_put.F90.in:123
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get attribute:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:124)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:124
   ! ncdf_get_put.F90.in:125
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:126
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:127
  end do   ! ncdf_get_put.F90.in:128
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:129
    deallocate(iotypes)   ! ncdf_get_put.F90.in:130
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:131
  end if   ! ncdf_get_put.F90.in:132
   ! ncdf_get_put.F90.in:133
END SUBROUTINE test_put_get_1datt_PIO_int_integer__   ! ncdf_get_put.F90.in:134


SUBROUTINE test_put_get_1datt_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! ncdf_get_put.F90.in:56
  Implicit none   ! ncdf_get_put.F90.in:57
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:58
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:59
  type(var_desc_t)  :: pio_var, pio_cvar   ! ncdf_get_put.F90.in:60
  integer :: pio_dim   ! ncdf_get_put.F90.in:61
  integer, parameter :: DIM_LEN = 100   ! ncdf_get_put.F90.in:62
  real(kind=fc_real), dimension(DIM_LEN) :: pval, gval   ! ncdf_get_put.F90.in:63
  real(kind=fc_real) :: init_val   ! ncdf_get_put.F90.in:64
  CHARACTER(len=DIM_LEN) :: pcval, gcval   ! ncdf_get_put.F90.in:65
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:66
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:67
  integer :: num_iotypes   ! ncdf_get_put.F90.in:68
  integer :: i, ret   ! ncdf_get_put.F90.in:69
     ! ncdf_get_put.F90.in:70
  init_val = pio_tf_world_sz_   ! ncdf_get_put.F90.in:71
   ! ncdf_get_put.F90.in:72
  pval = init_val   ! ncdf_get_put.F90.in:73
  pcval = "DUMMY_STRING"   ! ncdf_get_put.F90.in:74
  num_iotypes = 0   ! ncdf_get_put.F90.in:75
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:76
  filename = "test_pio_ncdf_get_put.testfile"   ! ncdf_get_put.F90.in:77
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:78

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:79
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:80
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:81)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:81
   ! ncdf_get_put.F90.in:82
    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'dummy_dim', DIM_LEN, pio_dim)   ! ncdf_get_put.F90.in:84
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:85)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:85
   ! ncdf_get_put.F90.in:86
    ret = PIO_def_var(pio_file, 'dummy_val', PIO_real, (/pio_dim/), pio_var)   ! ncdf_get_put.F90.in:87
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:88)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:88
   ! ncdf_get_put.F90.in:89
    ret = PIO_def_var(pio_file, 'dummy_cval', PIO_char, (/pio_dim/), pio_cvar)   ! ncdf_get_put.F90.in:90
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:91)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:91
   ! ncdf_get_put.F90.in:92
    ret = PIO_put_att(pio_file, pio_var, 'dummy_att_val', pval);   ! ncdf_get_put.F90.in:93
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put attribute:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:94)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:94
   ! ncdf_get_put.F90.in:95
    ret = PIO_put_att(pio_file, pio_cvar, 'dummy_att_cval', pcval);   ! ncdf_get_put.F90.in:96
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put char attribute:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:97)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:97
   ! ncdf_get_put.F90.in:98
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:99
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:100)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:100
   ! ncdf_get_put.F90.in:101
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:103
   ! ncdf_get_put.F90.in:104
    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:105
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:106)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:106
   ! ncdf_get_put.F90.in:107
    ret = PIO_inq_varid(pio_file, 'dummy_val', pio_var)   ! ncdf_get_put.F90.in:108
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:109)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:109
   ! ncdf_get_put.F90.in:110
    ret = PIO_inq_varid(pio_file, 'dummy_cval', pio_cvar)   ! ncdf_get_put.F90.in:111
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:112)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:112
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:114
#endif
   ! ncdf_get_put.F90.in:116
    ret = PIO_get_att(pio_file, pio_var, 'dummy_att_val', gval);   ! ncdf_get_put.F90.in:117
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get attribute:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:118)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:118
   ! ncdf_get_put.F90.in:119
    
    IF (.NOT. PIO_TF_Check_val_(gval, init_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:120)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:120
   ! ncdf_get_put.F90.in:121
    ! FIXME: Check the values are correct
    ret = PIO_get_att(pio_file, pio_cvar, 'dummy_att_cval', gcval);   ! ncdf_get_put.F90.in:123
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get attribute:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:124)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:124
   ! ncdf_get_put.F90.in:125
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:126
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:127
  end do   ! ncdf_get_put.F90.in:128
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:129
    deallocate(iotypes)   ! ncdf_get_put.F90.in:130
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:131
  end if   ! ncdf_get_put.F90.in:132
   ! ncdf_get_put.F90.in:133
END SUBROUTINE test_put_get_1datt_PIO_real_real_kind_fc_real___   ! ncdf_get_put.F90.in:134


SUBROUTINE test_put_get_1datt_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! ncdf_get_put.F90.in:56
  Implicit none   ! ncdf_get_put.F90.in:57
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:58
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:59
  type(var_desc_t)  :: pio_var, pio_cvar   ! ncdf_get_put.F90.in:60
  integer :: pio_dim   ! ncdf_get_put.F90.in:61
  integer, parameter :: DIM_LEN = 100   ! ncdf_get_put.F90.in:62
  real(kind=fc_double), dimension(DIM_LEN) :: pval, gval   ! ncdf_get_put.F90.in:63
  real(kind=fc_double) :: init_val   ! ncdf_get_put.F90.in:64
  CHARACTER(len=DIM_LEN) :: pcval, gcval   ! ncdf_get_put.F90.in:65
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:66
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:67
  integer :: num_iotypes   ! ncdf_get_put.F90.in:68
  integer :: i, ret   ! ncdf_get_put.F90.in:69
     ! ncdf_get_put.F90.in:70
  init_val = pio_tf_world_sz_   ! ncdf_get_put.F90.in:71
   ! ncdf_get_put.F90.in:72
  pval = init_val   ! ncdf_get_put.F90.in:73
  pcval = "DUMMY_STRING"   ! ncdf_get_put.F90.in:74
  num_iotypes = 0   ! ncdf_get_put.F90.in:75
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:76
  filename = "test_pio_ncdf_get_put.testfile"   ! ncdf_get_put.F90.in:77
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:78

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:79
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:80
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:81)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:81
   ! ncdf_get_put.F90.in:82
    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'dummy_dim', DIM_LEN, pio_dim)   ! ncdf_get_put.F90.in:84
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:85)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:85
   ! ncdf_get_put.F90.in:86
    ret = PIO_def_var(pio_file, 'dummy_val', PIO_double, (/pio_dim/), pio_var)   ! ncdf_get_put.F90.in:87
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:88)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:88
   ! ncdf_get_put.F90.in:89
    ret = PIO_def_var(pio_file, 'dummy_cval', PIO_char, (/pio_dim/), pio_cvar)   ! ncdf_get_put.F90.in:90
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:91)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:91
   ! ncdf_get_put.F90.in:92
    ret = PIO_put_att(pio_file, pio_var, 'dummy_att_val', pval);   ! ncdf_get_put.F90.in:93
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put attribute:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:94)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:94
   ! ncdf_get_put.F90.in:95
    ret = PIO_put_att(pio_file, pio_cvar, 'dummy_att_cval', pcval);   ! ncdf_get_put.F90.in:96
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put char attribute:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:97)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:97
   ! ncdf_get_put.F90.in:98
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:99
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:100)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:100
   ! ncdf_get_put.F90.in:101
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:103
   ! ncdf_get_put.F90.in:104
    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:105
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:106)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:106
   ! ncdf_get_put.F90.in:107
    ret = PIO_inq_varid(pio_file, 'dummy_val', pio_var)   ! ncdf_get_put.F90.in:108
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:109)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:109
   ! ncdf_get_put.F90.in:110
    ret = PIO_inq_varid(pio_file, 'dummy_cval', pio_cvar)   ! ncdf_get_put.F90.in:111
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:112)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:112
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:114
#endif
   ! ncdf_get_put.F90.in:116
    ret = PIO_get_att(pio_file, pio_var, 'dummy_att_val', gval);   ! ncdf_get_put.F90.in:117
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get attribute:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:118)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:118
   ! ncdf_get_put.F90.in:119
    
    IF (.NOT. PIO_TF_Check_val_(gval, init_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:120)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:120
   ! ncdf_get_put.F90.in:121
    ! FIXME: Check the values are correct
    ret = PIO_get_att(pio_file, pio_cvar, 'dummy_att_cval', gcval);   ! ncdf_get_put.F90.in:123
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get attribute:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:124)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:124
   ! ncdf_get_put.F90.in:125
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:126
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:127
  end do   ! ncdf_get_put.F90.in:128
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:129
    deallocate(iotypes)   ! ncdf_get_put.F90.in:130
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:131
  end if   ! ncdf_get_put.F90.in:132
   ! ncdf_get_put.F90.in:133
END SUBROUTINE test_put_get_1datt_PIO_double_real_kind_fc_double___   ! ncdf_get_put.F90.in:134
   ! ncdf_get_put.F90.in:134




SUBROUTINE test_put_get_0dvar_PIO_int_integer__
USE pio_tutil
   ! ncdf_get_put.F90.in:137
  Implicit none   ! ncdf_get_put.F90.in:138
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:139
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:140
  type(var_desc_t)  :: pio_var, pio_cvar   ! ncdf_get_put.F90.in:141
  integer, dimension(1) :: pval, gval   ! ncdf_get_put.F90.in:142
  CHARACTER(len=1) :: pcval, gcval   ! ncdf_get_put.F90.in:143
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:144
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:145
  character(len=*), parameter :: PIO_VAR_NAME = 'dummy_scalar_var_put_val'   ! ncdf_get_put.F90.in:146
  character(len=*), parameter :: PIO_CVAR_NAME = 'dummy_scalar_var_put_cval'   ! ncdf_get_put.F90.in:147
  integer :: num_iotypes   ! ncdf_get_put.F90.in:148
  integer :: i, ret   ! ncdf_get_put.F90.in:149
     ! ncdf_get_put.F90.in:150
  pval = pio_tf_world_sz_   ! ncdf_get_put.F90.in:151
  pcval = "D"   ! ncdf_get_put.F90.in:152
  num_iotypes = 0   ! ncdf_get_put.F90.in:153
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:154
  filename = "test_pio_ncdf_get_put.testfile"   ! ncdf_get_put.F90.in:155
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:156

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:157
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:158
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:159)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:159
   ! ncdf_get_put.F90.in:160
    ! Since file is just created no need to enter redef
    ret = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_int, pio_var)   ! ncdf_get_put.F90.in:162
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:163)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:163
   ! ncdf_get_put.F90.in:164
    ret = PIO_def_var(pio_file, PIO_CVAR_NAME, PIO_char, pio_cvar)   ! ncdf_get_put.F90.in:165
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define scalar char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:166)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:166
   ! ncdf_get_put.F90.in:167
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:168
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:169)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:169
   ! ncdf_get_put.F90.in:170
    ret = PIO_put_var(pio_file, pio_var, pval);   ! ncdf_get_put.F90.in:171
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:172)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:172
   ! ncdf_get_put.F90.in:173
    ret = PIO_put_var(pio_file, pio_cvar, pcval);   ! ncdf_get_put.F90.in:174
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put scalar char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:175)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:175
   ! ncdf_get_put.F90.in:176
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:178
   ! ncdf_get_put.F90.in:179
    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:180
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to reopen:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:181)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:181
   ! ncdf_get_put.F90.in:182
    ret = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! ncdf_get_put.F90.in:183
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:184)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:184
   ! ncdf_get_put.F90.in:185
    ret = PIO_inq_varid(pio_file, PIO_CVAR_NAME, pio_cvar)   ! ncdf_get_put.F90.in:186
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:187)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:187
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:189
#endif
   ! ncdf_get_put.F90.in:191
    ret = PIO_get_var(pio_file, pio_var, gval);   ! ncdf_get_put.F90.in:192
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:193)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:193
   ! ncdf_get_put.F90.in:194
    
    IF (.NOT. PIO_TF_Check_val_(gval, pval)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:195)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:195
   ! ncdf_get_put.F90.in:196
    ret = PIO_get_var(pio_file, pio_cvar, gcval);   ! ncdf_get_put.F90.in:197
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:198)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:198
   ! ncdf_get_put.F90.in:199
    
    IF (.NOT. PIO_TF_Check_val_(gcval, pcval)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:200)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:200
   ! ncdf_get_put.F90.in:201
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:202
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:203
  end do   ! ncdf_get_put.F90.in:204
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:205
    deallocate(iotypes)   ! ncdf_get_put.F90.in:206
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:207
  end if   ! ncdf_get_put.F90.in:208
   ! ncdf_get_put.F90.in:209
END SUBROUTINE test_put_get_0dvar_PIO_int_integer__   ! ncdf_get_put.F90.in:210


SUBROUTINE test_put_get_0dvar_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! ncdf_get_put.F90.in:137
  Implicit none   ! ncdf_get_put.F90.in:138
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:139
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:140
  type(var_desc_t)  :: pio_var, pio_cvar   ! ncdf_get_put.F90.in:141
  real(kind=fc_real), dimension(1) :: pval, gval   ! ncdf_get_put.F90.in:142
  CHARACTER(len=1) :: pcval, gcval   ! ncdf_get_put.F90.in:143
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:144
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:145
  character(len=*), parameter :: PIO_VAR_NAME = 'dummy_scalar_var_put_val'   ! ncdf_get_put.F90.in:146
  character(len=*), parameter :: PIO_CVAR_NAME = 'dummy_scalar_var_put_cval'   ! ncdf_get_put.F90.in:147
  integer :: num_iotypes   ! ncdf_get_put.F90.in:148
  integer :: i, ret   ! ncdf_get_put.F90.in:149
     ! ncdf_get_put.F90.in:150
  pval = pio_tf_world_sz_   ! ncdf_get_put.F90.in:151
  pcval = "D"   ! ncdf_get_put.F90.in:152
  num_iotypes = 0   ! ncdf_get_put.F90.in:153
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:154
  filename = "test_pio_ncdf_get_put.testfile"   ! ncdf_get_put.F90.in:155
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:156

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:157
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:158
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:159)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:159
   ! ncdf_get_put.F90.in:160
    ! Since file is just created no need to enter redef
    ret = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_real, pio_var)   ! ncdf_get_put.F90.in:162
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:163)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:163
   ! ncdf_get_put.F90.in:164
    ret = PIO_def_var(pio_file, PIO_CVAR_NAME, PIO_char, pio_cvar)   ! ncdf_get_put.F90.in:165
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define scalar char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:166)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:166
   ! ncdf_get_put.F90.in:167
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:168
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:169)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:169
   ! ncdf_get_put.F90.in:170
    ret = PIO_put_var(pio_file, pio_var, pval);   ! ncdf_get_put.F90.in:171
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:172)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:172
   ! ncdf_get_put.F90.in:173
    ret = PIO_put_var(pio_file, pio_cvar, pcval);   ! ncdf_get_put.F90.in:174
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put scalar char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:175)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:175
   ! ncdf_get_put.F90.in:176
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:178
   ! ncdf_get_put.F90.in:179
    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:180
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to reopen:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:181)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:181
   ! ncdf_get_put.F90.in:182
    ret = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! ncdf_get_put.F90.in:183
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:184)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:184
   ! ncdf_get_put.F90.in:185
    ret = PIO_inq_varid(pio_file, PIO_CVAR_NAME, pio_cvar)   ! ncdf_get_put.F90.in:186
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:187)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:187
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:189
#endif
   ! ncdf_get_put.F90.in:191
    ret = PIO_get_var(pio_file, pio_var, gval);   ! ncdf_get_put.F90.in:192
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:193)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:193
   ! ncdf_get_put.F90.in:194
    
    IF (.NOT. PIO_TF_Check_val_(gval, pval)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:195)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:195
   ! ncdf_get_put.F90.in:196
    ret = PIO_get_var(pio_file, pio_cvar, gcval);   ! ncdf_get_put.F90.in:197
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:198)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:198
   ! ncdf_get_put.F90.in:199
    
    IF (.NOT. PIO_TF_Check_val_(gcval, pcval)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:200)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:200
   ! ncdf_get_put.F90.in:201
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:202
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:203
  end do   ! ncdf_get_put.F90.in:204
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:205
    deallocate(iotypes)   ! ncdf_get_put.F90.in:206
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:207
  end if   ! ncdf_get_put.F90.in:208
   ! ncdf_get_put.F90.in:209
END SUBROUTINE test_put_get_0dvar_PIO_real_real_kind_fc_real___   ! ncdf_get_put.F90.in:210


SUBROUTINE test_put_get_0dvar_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! ncdf_get_put.F90.in:137
  Implicit none   ! ncdf_get_put.F90.in:138
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:139
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:140
  type(var_desc_t)  :: pio_var, pio_cvar   ! ncdf_get_put.F90.in:141
  real(kind=fc_double), dimension(1) :: pval, gval   ! ncdf_get_put.F90.in:142
  CHARACTER(len=1) :: pcval, gcval   ! ncdf_get_put.F90.in:143
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:144
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:145
  character(len=*), parameter :: PIO_VAR_NAME = 'dummy_scalar_var_put_val'   ! ncdf_get_put.F90.in:146
  character(len=*), parameter :: PIO_CVAR_NAME = 'dummy_scalar_var_put_cval'   ! ncdf_get_put.F90.in:147
  integer :: num_iotypes   ! ncdf_get_put.F90.in:148
  integer :: i, ret   ! ncdf_get_put.F90.in:149
     ! ncdf_get_put.F90.in:150
  pval = pio_tf_world_sz_   ! ncdf_get_put.F90.in:151
  pcval = "D"   ! ncdf_get_put.F90.in:152
  num_iotypes = 0   ! ncdf_get_put.F90.in:153
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:154
  filename = "test_pio_ncdf_get_put.testfile"   ! ncdf_get_put.F90.in:155
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:156

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:157
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:158
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:159)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:159
   ! ncdf_get_put.F90.in:160
    ! Since file is just created no need to enter redef
    ret = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_double, pio_var)   ! ncdf_get_put.F90.in:162
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:163)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:163
   ! ncdf_get_put.F90.in:164
    ret = PIO_def_var(pio_file, PIO_CVAR_NAME, PIO_char, pio_cvar)   ! ncdf_get_put.F90.in:165
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define scalar char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:166)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:166
   ! ncdf_get_put.F90.in:167
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:168
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:169)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:169
   ! ncdf_get_put.F90.in:170
    ret = PIO_put_var(pio_file, pio_var, pval);   ! ncdf_get_put.F90.in:171
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:172)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:172
   ! ncdf_get_put.F90.in:173
    ret = PIO_put_var(pio_file, pio_cvar, pcval);   ! ncdf_get_put.F90.in:174
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put scalar char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:175)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:175
   ! ncdf_get_put.F90.in:176
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:178
   ! ncdf_get_put.F90.in:179
    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:180
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to reopen:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:181)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:181
   ! ncdf_get_put.F90.in:182
    ret = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! ncdf_get_put.F90.in:183
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:184)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:184
   ! ncdf_get_put.F90.in:185
    ret = PIO_inq_varid(pio_file, PIO_CVAR_NAME, pio_cvar)   ! ncdf_get_put.F90.in:186
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:187)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:187
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:189
#endif
   ! ncdf_get_put.F90.in:191
    ret = PIO_get_var(pio_file, pio_var, gval);   ! ncdf_get_put.F90.in:192
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:193)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:193
   ! ncdf_get_put.F90.in:194
    
    IF (.NOT. PIO_TF_Check_val_(gval, pval)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:195)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:195
   ! ncdf_get_put.F90.in:196
    ret = PIO_get_var(pio_file, pio_cvar, gcval);   ! ncdf_get_put.F90.in:197
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:198)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:198
   ! ncdf_get_put.F90.in:199
    
    IF (.NOT. PIO_TF_Check_val_(gcval, pcval)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:200)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:200
   ! ncdf_get_put.F90.in:201
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:202
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:203
  end do   ! ncdf_get_put.F90.in:204
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:205
    deallocate(iotypes)   ! ncdf_get_put.F90.in:206
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:207
  end if   ! ncdf_get_put.F90.in:208
   ! ncdf_get_put.F90.in:209
END SUBROUTINE test_put_get_0dvar_PIO_double_real_kind_fc_double___   ! ncdf_get_put.F90.in:210
   ! ncdf_get_put.F90.in:210




SUBROUTINE test_put_get_1dvar_PIO_int_integer__
USE pio_tutil
   ! ncdf_get_put.F90.in:213
  Implicit none   ! ncdf_get_put.F90.in:214
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:215
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:216
  type(var_desc_t)  :: pio_var, pio_cvar   ! ncdf_get_put.F90.in:217
  integer :: pio_dim   ! ncdf_get_put.F90.in:218
  integer, parameter :: DIM_LEN = 100   ! ncdf_get_put.F90.in:219
  integer, dimension(DIM_LEN) :: pval, gval   ! ncdf_get_put.F90.in:220
  CHARACTER(len=DIM_LEN) :: pcval, gcval   ! ncdf_get_put.F90.in:221
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:222
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:223
  character(len=*), parameter :: PIO_VAR_NAME = 'dummy_var_put_val'   ! ncdf_get_put.F90.in:224
  character(len=*), parameter :: PIO_CVAR_NAME = 'dummy_var_put_cval'   ! ncdf_get_put.F90.in:225
  integer :: num_iotypes   ! ncdf_get_put.F90.in:226
  integer :: i, ret   ! ncdf_get_put.F90.in:227
     ! ncdf_get_put.F90.in:228
  pval = pio_tf_world_sz_   ! ncdf_get_put.F90.in:229
  pcval = "DUMMY_STRING"   ! ncdf_get_put.F90.in:230
  num_iotypes = 0   ! ncdf_get_put.F90.in:231
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:232
  filename = "test_pio_ncdf_get_put.testfile"   ! ncdf_get_put.F90.in:233
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:234

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:235
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:236
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:237)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:237
   ! ncdf_get_put.F90.in:238
    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'dummy_dim_put_val', DIM_LEN, pio_dim)   ! ncdf_get_put.F90.in:240
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:241)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:241
   ! ncdf_get_put.F90.in:242
    ret = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_int, (/pio_dim/), pio_var)   ! ncdf_get_put.F90.in:243
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:244)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:244
   ! ncdf_get_put.F90.in:245
    ret = PIO_def_var(pio_file, PIO_CVAR_NAME, PIO_char, (/pio_dim/), pio_cvar)   ! ncdf_get_put.F90.in:246
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:247)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:247
   ! ncdf_get_put.F90.in:248
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:249
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:250)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:250
   ! ncdf_get_put.F90.in:251
    ret = PIO_put_var(pio_file, pio_var, pval);   ! ncdf_get_put.F90.in:252
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:253)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:253
   ! ncdf_get_put.F90.in:254
    ret = PIO_put_var(pio_file, pio_cvar, pcval);   ! ncdf_get_put.F90.in:255
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:256)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:256
   ! ncdf_get_put.F90.in:257
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:259
   ! ncdf_get_put.F90.in:260
    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:261
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to reopen:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:262)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:262
   ! ncdf_get_put.F90.in:263
    ret = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! ncdf_get_put.F90.in:264
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:265)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:265
   ! ncdf_get_put.F90.in:266
    ret = PIO_inq_varid(pio_file, PIO_CVAR_NAME, pio_cvar)   ! ncdf_get_put.F90.in:267
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:268)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:268
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:270
#endif
   ! ncdf_get_put.F90.in:272
    ret = PIO_get_var(pio_file, pio_var, gval);   ! ncdf_get_put.F90.in:273
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:274)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:274
   ! ncdf_get_put.F90.in:275
    
    IF (.NOT. PIO_TF_Check_val_(gval, pval)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:276)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:276
   ! ncdf_get_put.F90.in:277
    ret = PIO_get_var(pio_file, pio_cvar, gcval);   ! ncdf_get_put.F90.in:278
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:279)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:279
   ! ncdf_get_put.F90.in:280
    
    IF (.NOT. PIO_TF_Check_val_(gcval, pcval)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:281)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:281
   ! ncdf_get_put.F90.in:282
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:283
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:284
  end do   ! ncdf_get_put.F90.in:285
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:286
    deallocate(iotypes)   ! ncdf_get_put.F90.in:287
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:288
  end if   ! ncdf_get_put.F90.in:289
   ! ncdf_get_put.F90.in:290
END SUBROUTINE test_put_get_1dvar_PIO_int_integer__   ! ncdf_get_put.F90.in:291


SUBROUTINE test_put_get_1dvar_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! ncdf_get_put.F90.in:213
  Implicit none   ! ncdf_get_put.F90.in:214
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:215
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:216
  type(var_desc_t)  :: pio_var, pio_cvar   ! ncdf_get_put.F90.in:217
  integer :: pio_dim   ! ncdf_get_put.F90.in:218
  integer, parameter :: DIM_LEN = 100   ! ncdf_get_put.F90.in:219
  real(kind=fc_real), dimension(DIM_LEN) :: pval, gval   ! ncdf_get_put.F90.in:220
  CHARACTER(len=DIM_LEN) :: pcval, gcval   ! ncdf_get_put.F90.in:221
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:222
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:223
  character(len=*), parameter :: PIO_VAR_NAME = 'dummy_var_put_val'   ! ncdf_get_put.F90.in:224
  character(len=*), parameter :: PIO_CVAR_NAME = 'dummy_var_put_cval'   ! ncdf_get_put.F90.in:225
  integer :: num_iotypes   ! ncdf_get_put.F90.in:226
  integer :: i, ret   ! ncdf_get_put.F90.in:227
     ! ncdf_get_put.F90.in:228
  pval = pio_tf_world_sz_   ! ncdf_get_put.F90.in:229
  pcval = "DUMMY_STRING"   ! ncdf_get_put.F90.in:230
  num_iotypes = 0   ! ncdf_get_put.F90.in:231
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:232
  filename = "test_pio_ncdf_get_put.testfile"   ! ncdf_get_put.F90.in:233
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:234

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:235
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:236
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:237)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:237
   ! ncdf_get_put.F90.in:238
    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'dummy_dim_put_val', DIM_LEN, pio_dim)   ! ncdf_get_put.F90.in:240
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:241)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:241
   ! ncdf_get_put.F90.in:242
    ret = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_real, (/pio_dim/), pio_var)   ! ncdf_get_put.F90.in:243
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:244)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:244
   ! ncdf_get_put.F90.in:245
    ret = PIO_def_var(pio_file, PIO_CVAR_NAME, PIO_char, (/pio_dim/), pio_cvar)   ! ncdf_get_put.F90.in:246
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:247)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:247
   ! ncdf_get_put.F90.in:248
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:249
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:250)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:250
   ! ncdf_get_put.F90.in:251
    ret = PIO_put_var(pio_file, pio_var, pval);   ! ncdf_get_put.F90.in:252
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:253)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:253
   ! ncdf_get_put.F90.in:254
    ret = PIO_put_var(pio_file, pio_cvar, pcval);   ! ncdf_get_put.F90.in:255
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:256)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:256
   ! ncdf_get_put.F90.in:257
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:259
   ! ncdf_get_put.F90.in:260
    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:261
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to reopen:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:262)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:262
   ! ncdf_get_put.F90.in:263
    ret = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! ncdf_get_put.F90.in:264
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:265)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:265
   ! ncdf_get_put.F90.in:266
    ret = PIO_inq_varid(pio_file, PIO_CVAR_NAME, pio_cvar)   ! ncdf_get_put.F90.in:267
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:268)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:268
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:270
#endif
   ! ncdf_get_put.F90.in:272
    ret = PIO_get_var(pio_file, pio_var, gval);   ! ncdf_get_put.F90.in:273
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:274)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:274
   ! ncdf_get_put.F90.in:275
    
    IF (.NOT. PIO_TF_Check_val_(gval, pval)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:276)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:276
   ! ncdf_get_put.F90.in:277
    ret = PIO_get_var(pio_file, pio_cvar, gcval);   ! ncdf_get_put.F90.in:278
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:279)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:279
   ! ncdf_get_put.F90.in:280
    
    IF (.NOT. PIO_TF_Check_val_(gcval, pcval)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:281)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:281
   ! ncdf_get_put.F90.in:282
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:283
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:284
  end do   ! ncdf_get_put.F90.in:285
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:286
    deallocate(iotypes)   ! ncdf_get_put.F90.in:287
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:288
  end if   ! ncdf_get_put.F90.in:289
   ! ncdf_get_put.F90.in:290
END SUBROUTINE test_put_get_1dvar_PIO_real_real_kind_fc_real___   ! ncdf_get_put.F90.in:291


SUBROUTINE test_put_get_1dvar_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! ncdf_get_put.F90.in:213
  Implicit none   ! ncdf_get_put.F90.in:214
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:215
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:216
  type(var_desc_t)  :: pio_var, pio_cvar   ! ncdf_get_put.F90.in:217
  integer :: pio_dim   ! ncdf_get_put.F90.in:218
  integer, parameter :: DIM_LEN = 100   ! ncdf_get_put.F90.in:219
  real(kind=fc_double), dimension(DIM_LEN) :: pval, gval   ! ncdf_get_put.F90.in:220
  CHARACTER(len=DIM_LEN) :: pcval, gcval   ! ncdf_get_put.F90.in:221
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:222
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:223
  character(len=*), parameter :: PIO_VAR_NAME = 'dummy_var_put_val'   ! ncdf_get_put.F90.in:224
  character(len=*), parameter :: PIO_CVAR_NAME = 'dummy_var_put_cval'   ! ncdf_get_put.F90.in:225
  integer :: num_iotypes   ! ncdf_get_put.F90.in:226
  integer :: i, ret   ! ncdf_get_put.F90.in:227
     ! ncdf_get_put.F90.in:228
  pval = pio_tf_world_sz_   ! ncdf_get_put.F90.in:229
  pcval = "DUMMY_STRING"   ! ncdf_get_put.F90.in:230
  num_iotypes = 0   ! ncdf_get_put.F90.in:231
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:232
  filename = "test_pio_ncdf_get_put.testfile"   ! ncdf_get_put.F90.in:233
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:234

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:235
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:236
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:237)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:237
   ! ncdf_get_put.F90.in:238
    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'dummy_dim_put_val', DIM_LEN, pio_dim)   ! ncdf_get_put.F90.in:240
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:241)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:241
   ! ncdf_get_put.F90.in:242
    ret = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_double, (/pio_dim/), pio_var)   ! ncdf_get_put.F90.in:243
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:244)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:244
   ! ncdf_get_put.F90.in:245
    ret = PIO_def_var(pio_file, PIO_CVAR_NAME, PIO_char, (/pio_dim/), pio_cvar)   ! ncdf_get_put.F90.in:246
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:247)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:247
   ! ncdf_get_put.F90.in:248
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:249
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:250)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:250
   ! ncdf_get_put.F90.in:251
    ret = PIO_put_var(pio_file, pio_var, pval);   ! ncdf_get_put.F90.in:252
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:253)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:253
   ! ncdf_get_put.F90.in:254
    ret = PIO_put_var(pio_file, pio_cvar, pcval);   ! ncdf_get_put.F90.in:255
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:256)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:256
   ! ncdf_get_put.F90.in:257
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:259
   ! ncdf_get_put.F90.in:260
    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:261
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to reopen:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:262)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:262
   ! ncdf_get_put.F90.in:263
    ret = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! ncdf_get_put.F90.in:264
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:265)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:265
   ! ncdf_get_put.F90.in:266
    ret = PIO_inq_varid(pio_file, PIO_CVAR_NAME, pio_cvar)   ! ncdf_get_put.F90.in:267
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:268)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:268
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:270
#endif
   ! ncdf_get_put.F90.in:272
    ret = PIO_get_var(pio_file, pio_var, gval);   ! ncdf_get_put.F90.in:273
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:274)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:274
   ! ncdf_get_put.F90.in:275
    
    IF (.NOT. PIO_TF_Check_val_(gval, pval)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:276)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:276
   ! ncdf_get_put.F90.in:277
    ret = PIO_get_var(pio_file, pio_cvar, gcval);   ! ncdf_get_put.F90.in:278
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get char var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:279)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:279
   ! ncdf_get_put.F90.in:280
    
    IF (.NOT. PIO_TF_Check_val_(gcval, pcval)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:281)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:281
   ! ncdf_get_put.F90.in:282
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:283
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:284
  end do   ! ncdf_get_put.F90.in:285
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:286
    deallocate(iotypes)   ! ncdf_get_put.F90.in:287
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:288
  end if   ! ncdf_get_put.F90.in:289
   ! ncdf_get_put.F90.in:290
END SUBROUTINE test_put_get_1dvar_PIO_double_real_kind_fc_double___   ! ncdf_get_put.F90.in:291
   ! ncdf_get_put.F90.in:291


! Write out a 1d var slice from a 2d var


SUBROUTINE test_put_get_1dvar_slice_PIO_int_integer__
USE pio_tutil
   ! ncdf_get_put.F90.in:295
  Implicit none   ! ncdf_get_put.F90.in:296
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:297
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:298
  character(len=*), parameter :: PIO_VAR_NAME = 'dummy_var_put_val'   ! ncdf_get_put.F90.in:299
  type(var_desc_t)  :: pio_var, pio_cvar   ! ncdf_get_put.F90.in:300
  integer :: pio_dim   ! ncdf_get_put.F90.in:301
  integer, parameter :: MAX_ROW_DIM_LEN = 100   ! ncdf_get_put.F90.in:302
  integer, dimension(MAX_ROW_DIM_LEN) :: gval, exp_val   ! ncdf_get_put.F90.in:303
  integer, parameter :: MAX_COL_DIM_LEN = 4   ! ncdf_get_put.F90.in:304
  ! Only COL_WRITE_DIM of MAX_COL_DIM_LEN columns in pval is written out
  integer, parameter :: COL_WRITE_DIM = 2   ! ncdf_get_put.F90.in:306
  integer, dimension(MAX_ROW_DIM_LEN, MAX_COL_DIM_LEN) :: pval   ! ncdf_get_put.F90.in:307
  integer, dimension(:) :: start(4), count(4)   ! ncdf_get_put.F90.in:308
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:309
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:310
  integer :: num_iotypes   ! ncdf_get_put.F90.in:311
  integer :: i, ret   ! ncdf_get_put.F90.in:312
     ! ncdf_get_put.F90.in:313
  pval = -1   ! ncdf_get_put.F90.in:314
  pval(:,COL_WRITE_DIM) = pio_tf_world_sz_   ! ncdf_get_put.F90.in:315
  exp_val = pio_tf_world_sz_   ! ncdf_get_put.F90.in:316
  start = 0   ! ncdf_get_put.F90.in:317
  count = 0   ! ncdf_get_put.F90.in:318
  start(1) = 1   ! ncdf_get_put.F90.in:319
  count(1) = MAX_ROW_DIM_LEN   ! ncdf_get_put.F90.in:320
  num_iotypes = 0   ! ncdf_get_put.F90.in:321
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:322
  filename = "test_pio_ncdf_get_put_slice.testfile"   ! ncdf_get_put.F90.in:323
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:324

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:325
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:326
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:327)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:327
   ! ncdf_get_put.F90.in:328
    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'dummy_dim_put_val', MAX_ROW_DIM_LEN, pio_dim)   ! ncdf_get_put.F90.in:330
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:331)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:331
   ! ncdf_get_put.F90.in:332
    ret = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_int, (/pio_dim/), pio_var)   ! ncdf_get_put.F90.in:333
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:334)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:334
   ! ncdf_get_put.F90.in:335
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:336
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:337)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:337
   ! ncdf_get_put.F90.in:338
    ret = PIO_put_var(pio_file, pio_var, start, count, pval(:,COL_WRITE_DIM));   ! ncdf_get_put.F90.in:339
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:340)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:340
   ! ncdf_get_put.F90.in:341
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:343
   ! ncdf_get_put.F90.in:344
    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:345
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to reopen:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:346)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:346
   ! ncdf_get_put.F90.in:347
    ret = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! ncdf_get_put.F90.in:348
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:349)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:349
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:351
#endif
   ! ncdf_get_put.F90.in:353
    ret = PIO_get_var(pio_file, pio_var, gval);   ! ncdf_get_put.F90.in:354
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:355)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:355
   ! ncdf_get_put.F90.in:356
    
    IF (.NOT. PIO_TF_Check_val_(gval, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:357)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:357
   ! ncdf_get_put.F90.in:358
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:359
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:360
  end do   ! ncdf_get_put.F90.in:361
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:362
    deallocate(iotypes)   ! ncdf_get_put.F90.in:363
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:364
  end if   ! ncdf_get_put.F90.in:365
   ! ncdf_get_put.F90.in:366
END SUBROUTINE test_put_get_1dvar_slice_PIO_int_integer__   ! ncdf_get_put.F90.in:367


SUBROUTINE test_put_get_1dvar_slice_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! ncdf_get_put.F90.in:295
  Implicit none   ! ncdf_get_put.F90.in:296
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:297
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:298
  character(len=*), parameter :: PIO_VAR_NAME = 'dummy_var_put_val'   ! ncdf_get_put.F90.in:299
  type(var_desc_t)  :: pio_var, pio_cvar   ! ncdf_get_put.F90.in:300
  integer :: pio_dim   ! ncdf_get_put.F90.in:301
  integer, parameter :: MAX_ROW_DIM_LEN = 100   ! ncdf_get_put.F90.in:302
  real(kind=fc_real), dimension(MAX_ROW_DIM_LEN) :: gval, exp_val   ! ncdf_get_put.F90.in:303
  integer, parameter :: MAX_COL_DIM_LEN = 4   ! ncdf_get_put.F90.in:304
  ! Only COL_WRITE_DIM of MAX_COL_DIM_LEN columns in pval is written out
  integer, parameter :: COL_WRITE_DIM = 2   ! ncdf_get_put.F90.in:306
  real(kind=fc_real), dimension(MAX_ROW_DIM_LEN, MAX_COL_DIM_LEN) :: pval   ! ncdf_get_put.F90.in:307
  integer, dimension(:) :: start(4), count(4)   ! ncdf_get_put.F90.in:308
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:309
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:310
  integer :: num_iotypes   ! ncdf_get_put.F90.in:311
  integer :: i, ret   ! ncdf_get_put.F90.in:312
     ! ncdf_get_put.F90.in:313
  pval = -1   ! ncdf_get_put.F90.in:314
  pval(:,COL_WRITE_DIM) = pio_tf_world_sz_   ! ncdf_get_put.F90.in:315
  exp_val = pio_tf_world_sz_   ! ncdf_get_put.F90.in:316
  start = 0   ! ncdf_get_put.F90.in:317
  count = 0   ! ncdf_get_put.F90.in:318
  start(1) = 1   ! ncdf_get_put.F90.in:319
  count(1) = MAX_ROW_DIM_LEN   ! ncdf_get_put.F90.in:320
  num_iotypes = 0   ! ncdf_get_put.F90.in:321
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:322
  filename = "test_pio_ncdf_get_put_slice.testfile"   ! ncdf_get_put.F90.in:323
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:324

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:325
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:326
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:327)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:327
   ! ncdf_get_put.F90.in:328
    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'dummy_dim_put_val', MAX_ROW_DIM_LEN, pio_dim)   ! ncdf_get_put.F90.in:330
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:331)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:331
   ! ncdf_get_put.F90.in:332
    ret = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_real, (/pio_dim/), pio_var)   ! ncdf_get_put.F90.in:333
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:334)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:334
   ! ncdf_get_put.F90.in:335
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:336
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:337)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:337
   ! ncdf_get_put.F90.in:338
    ret = PIO_put_var(pio_file, pio_var, start, count, pval(:,COL_WRITE_DIM));   ! ncdf_get_put.F90.in:339
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:340)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:340
   ! ncdf_get_put.F90.in:341
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:343
   ! ncdf_get_put.F90.in:344
    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:345
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to reopen:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:346)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:346
   ! ncdf_get_put.F90.in:347
    ret = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! ncdf_get_put.F90.in:348
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:349)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:349
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:351
#endif
   ! ncdf_get_put.F90.in:353
    ret = PIO_get_var(pio_file, pio_var, gval);   ! ncdf_get_put.F90.in:354
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:355)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:355
   ! ncdf_get_put.F90.in:356
    
    IF (.NOT. PIO_TF_Check_val_(gval, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:357)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:357
   ! ncdf_get_put.F90.in:358
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:359
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:360
  end do   ! ncdf_get_put.F90.in:361
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:362
    deallocate(iotypes)   ! ncdf_get_put.F90.in:363
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:364
  end if   ! ncdf_get_put.F90.in:365
   ! ncdf_get_put.F90.in:366
END SUBROUTINE test_put_get_1dvar_slice_PIO_real_real_kind_fc_real___   ! ncdf_get_put.F90.in:367


SUBROUTINE test_put_get_1dvar_slice_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! ncdf_get_put.F90.in:295
  Implicit none   ! ncdf_get_put.F90.in:296
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:297
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:298
  character(len=*), parameter :: PIO_VAR_NAME = 'dummy_var_put_val'   ! ncdf_get_put.F90.in:299
  type(var_desc_t)  :: pio_var, pio_cvar   ! ncdf_get_put.F90.in:300
  integer :: pio_dim   ! ncdf_get_put.F90.in:301
  integer, parameter :: MAX_ROW_DIM_LEN = 100   ! ncdf_get_put.F90.in:302
  real(kind=fc_double), dimension(MAX_ROW_DIM_LEN) :: gval, exp_val   ! ncdf_get_put.F90.in:303
  integer, parameter :: MAX_COL_DIM_LEN = 4   ! ncdf_get_put.F90.in:304
  ! Only COL_WRITE_DIM of MAX_COL_DIM_LEN columns in pval is written out
  integer, parameter :: COL_WRITE_DIM = 2   ! ncdf_get_put.F90.in:306
  real(kind=fc_double), dimension(MAX_ROW_DIM_LEN, MAX_COL_DIM_LEN) :: pval   ! ncdf_get_put.F90.in:307
  integer, dimension(:) :: start(4), count(4)   ! ncdf_get_put.F90.in:308
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:309
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:310
  integer :: num_iotypes   ! ncdf_get_put.F90.in:311
  integer :: i, ret   ! ncdf_get_put.F90.in:312
     ! ncdf_get_put.F90.in:313
  pval = -1   ! ncdf_get_put.F90.in:314
  pval(:,COL_WRITE_DIM) = pio_tf_world_sz_   ! ncdf_get_put.F90.in:315
  exp_val = pio_tf_world_sz_   ! ncdf_get_put.F90.in:316
  start = 0   ! ncdf_get_put.F90.in:317
  count = 0   ! ncdf_get_put.F90.in:318
  start(1) = 1   ! ncdf_get_put.F90.in:319
  count(1) = MAX_ROW_DIM_LEN   ! ncdf_get_put.F90.in:320
  num_iotypes = 0   ! ncdf_get_put.F90.in:321
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:322
  filename = "test_pio_ncdf_get_put_slice.testfile"   ! ncdf_get_put.F90.in:323
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:324

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:325
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:326
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:327)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:327
   ! ncdf_get_put.F90.in:328
    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'dummy_dim_put_val', MAX_ROW_DIM_LEN, pio_dim)   ! ncdf_get_put.F90.in:330
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:331)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:331
   ! ncdf_get_put.F90.in:332
    ret = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_double, (/pio_dim/), pio_var)   ! ncdf_get_put.F90.in:333
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:334)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:334
   ! ncdf_get_put.F90.in:335
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:336
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:337)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:337
   ! ncdf_get_put.F90.in:338
    ret = PIO_put_var(pio_file, pio_var, start, count, pval(:,COL_WRITE_DIM));   ! ncdf_get_put.F90.in:339
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:340)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:340
   ! ncdf_get_put.F90.in:341
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:343
   ! ncdf_get_put.F90.in:344
    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:345
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to reopen:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:346)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:346
   ! ncdf_get_put.F90.in:347
    ret = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! ncdf_get_put.F90.in:348
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:349)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:349
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:351
#endif
   ! ncdf_get_put.F90.in:353
    ret = PIO_get_var(pio_file, pio_var, gval);   ! ncdf_get_put.F90.in:354
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:355)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:355
   ! ncdf_get_put.F90.in:356
    
    IF (.NOT. PIO_TF_Check_val_(gval, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:357)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:357
   ! ncdf_get_put.F90.in:358
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:359
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:360
  end do   ! ncdf_get_put.F90.in:361
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:362
    deallocate(iotypes)   ! ncdf_get_put.F90.in:363
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:364
  end if   ! ncdf_get_put.F90.in:365
   ! ncdf_get_put.F90.in:366
END SUBROUTINE test_put_get_1dvar_slice_PIO_double_real_kind_fc_double___   ! ncdf_get_put.F90.in:367
   ! ncdf_get_put.F90.in:367




SUBROUTINE test_put_get_1dvar_4parts_PIO_int_integer__
USE pio_tutil
   ! ncdf_get_put.F90.in:370
  Implicit none   ! ncdf_get_put.F90.in:371
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:372
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:373
  character(len=*), parameter :: PIO_VAR_NAME = 'dummy_var_put_val'   ! ncdf_get_put.F90.in:374
  type(var_desc_t)  :: pio_var, pio_cvar   ! ncdf_get_put.F90.in:375
  integer :: pio_dim   ! ncdf_get_put.F90.in:376
  integer, parameter :: DIM_LEN = 16   ! ncdf_get_put.F90.in:377
  integer, parameter :: PART_LEN = DIM_LEN / 4   ! ncdf_get_put.F90.in:378
  integer, dimension(DIM_LEN) :: pval, gval   ! ncdf_get_put.F90.in:379
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:380
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:381
  integer :: num_iotypes   ! ncdf_get_put.F90.in:382
  integer :: i, ret   ! ncdf_get_put.F90.in:383
  integer, dimension(1) :: start, count = PART_LEN   ! ncdf_get_put.F90.in:384
     ! ncdf_get_put.F90.in:385
  do i=1,DIM_LEN   ! ncdf_get_put.F90.in:386
    pval(i) = i   ! ncdf_get_put.F90.in:387
  end do   ! ncdf_get_put.F90.in:388
  num_iotypes = 0   ! ncdf_get_put.F90.in:389
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:390
  filename = "test_pio_ncdf_get_put.testfile"   ! ncdf_get_put.F90.in:391
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:392

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:393
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:394
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:395)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:395
   ! ncdf_get_put.F90.in:396
    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'dummy_dim_put_val', DIM_LEN, pio_dim)   ! ncdf_get_put.F90.in:398
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:399)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:399
   ! ncdf_get_put.F90.in:400
    ret = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_int, (/pio_dim/), pio_var)   ! ncdf_get_put.F90.in:401
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:402)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:402
   ! ncdf_get_put.F90.in:403
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:404
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:405)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:405
   ! ncdf_get_put.F90.in:406
    start = 1   ! ncdf_get_put.F90.in:407
    ret = PIO_put_var(pio_file, pio_var, start, count, pval(1 : PART_LEN))   ! ncdf_get_put.F90.in:408
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put var (1st part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:409)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:409
   ! ncdf_get_put.F90.in:410
    start = PART_LEN + 1   ! ncdf_get_put.F90.in:411
    ret = PIO_put_var(pio_file, pio_var, start, count, pval(PART_LEN + 1 : PART_LEN * 2))   ! ncdf_get_put.F90.in:412
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put var (2nd part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:413)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:413
   ! ncdf_get_put.F90.in:414
    start = PART_LEN * 2 + 1   ! ncdf_get_put.F90.in:415
    ret = PIO_put_var(pio_file, pio_var, start, count, pval(PART_LEN * 2 + 1 : PART_LEN * 3))   ! ncdf_get_put.F90.in:416
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put var (3rd part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:417)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:417
   ! ncdf_get_put.F90.in:418
    start = PART_LEN * 3 + 1   ! ncdf_get_put.F90.in:419
    ret = PIO_put_var(pio_file, pio_var, start, count, pval(PART_LEN * 3 + 1 : DIM_LEN))   ! ncdf_get_put.F90.in:420
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put var (4th part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:421)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:421
   ! ncdf_get_put.F90.in:422
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:424
   ! ncdf_get_put.F90.in:425
    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:426
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to reopen:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:427)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:427
   ! ncdf_get_put.F90.in:428
    ret = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! ncdf_get_put.F90.in:429
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:430)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:430
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:432
#endif
   ! ncdf_get_put.F90.in:434
    start = PART_LEN * 3 + 1   ! ncdf_get_put.F90.in:435
    ret = PIO_get_var(pio_file, pio_var, start, count, gval(PART_LEN * 3 + 1 : DIM_LEN))   ! ncdf_get_put.F90.in:436
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get var (4th part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:437)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:437
   ! ncdf_get_put.F90.in:438
    start = PART_LEN * 2 + 1   ! ncdf_get_put.F90.in:439
    ret = PIO_get_var(pio_file, pio_var, start, count, gval(PART_LEN * 2 + 1 : PART_LEN * 3))   ! ncdf_get_put.F90.in:440
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get var (3rd part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:441)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:441
   ! ncdf_get_put.F90.in:442
    start = PART_LEN + 1   ! ncdf_get_put.F90.in:443
    ret = PIO_get_var(pio_file, pio_var, start, count, gval(PART_LEN + 1 : PART_LEN * 2))   ! ncdf_get_put.F90.in:444
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get var (2nd part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:445)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:445
   ! ncdf_get_put.F90.in:446
    start = 1   ! ncdf_get_put.F90.in:447
    ret = PIO_get_var(pio_file, pio_var, start, count, gval(1 : PART_LEN))   ! ncdf_get_put.F90.in:448
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get var (1st part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:449)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:449
   ! ncdf_get_put.F90.in:450
    
    IF (.NOT. PIO_TF_Check_val_(gval, pval)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:451)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:451
   ! ncdf_get_put.F90.in:452
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:453
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:454
  end do   ! ncdf_get_put.F90.in:455
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:456
    deallocate(iotypes)   ! ncdf_get_put.F90.in:457
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:458
  end if   ! ncdf_get_put.F90.in:459
   ! ncdf_get_put.F90.in:460
END SUBROUTINE test_put_get_1dvar_4parts_PIO_int_integer__   ! ncdf_get_put.F90.in:461


SUBROUTINE test_put_get_1dvar_4parts_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! ncdf_get_put.F90.in:370
  Implicit none   ! ncdf_get_put.F90.in:371
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:372
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:373
  character(len=*), parameter :: PIO_VAR_NAME = 'dummy_var_put_val'   ! ncdf_get_put.F90.in:374
  type(var_desc_t)  :: pio_var, pio_cvar   ! ncdf_get_put.F90.in:375
  integer :: pio_dim   ! ncdf_get_put.F90.in:376
  integer, parameter :: DIM_LEN = 16   ! ncdf_get_put.F90.in:377
  integer, parameter :: PART_LEN = DIM_LEN / 4   ! ncdf_get_put.F90.in:378
  real(kind=fc_real), dimension(DIM_LEN) :: pval, gval   ! ncdf_get_put.F90.in:379
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:380
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:381
  integer :: num_iotypes   ! ncdf_get_put.F90.in:382
  integer :: i, ret   ! ncdf_get_put.F90.in:383
  integer, dimension(1) :: start, count = PART_LEN   ! ncdf_get_put.F90.in:384
     ! ncdf_get_put.F90.in:385
  do i=1,DIM_LEN   ! ncdf_get_put.F90.in:386
    pval(i) = i   ! ncdf_get_put.F90.in:387
  end do   ! ncdf_get_put.F90.in:388
  num_iotypes = 0   ! ncdf_get_put.F90.in:389
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:390
  filename = "test_pio_ncdf_get_put.testfile"   ! ncdf_get_put.F90.in:391
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:392

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:393
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:394
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:395)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:395
   ! ncdf_get_put.F90.in:396
    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'dummy_dim_put_val', DIM_LEN, pio_dim)   ! ncdf_get_put.F90.in:398
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:399)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:399
   ! ncdf_get_put.F90.in:400
    ret = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_real, (/pio_dim/), pio_var)   ! ncdf_get_put.F90.in:401
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:402)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:402
   ! ncdf_get_put.F90.in:403
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:404
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:405)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:405
   ! ncdf_get_put.F90.in:406
    start = 1   ! ncdf_get_put.F90.in:407
    ret = PIO_put_var(pio_file, pio_var, start, count, pval(1 : PART_LEN))   ! ncdf_get_put.F90.in:408
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put var (1st part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:409)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:409
   ! ncdf_get_put.F90.in:410
    start = PART_LEN + 1   ! ncdf_get_put.F90.in:411
    ret = PIO_put_var(pio_file, pio_var, start, count, pval(PART_LEN + 1 : PART_LEN * 2))   ! ncdf_get_put.F90.in:412
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put var (2nd part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:413)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:413
   ! ncdf_get_put.F90.in:414
    start = PART_LEN * 2 + 1   ! ncdf_get_put.F90.in:415
    ret = PIO_put_var(pio_file, pio_var, start, count, pval(PART_LEN * 2 + 1 : PART_LEN * 3))   ! ncdf_get_put.F90.in:416
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put var (3rd part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:417)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:417
   ! ncdf_get_put.F90.in:418
    start = PART_LEN * 3 + 1   ! ncdf_get_put.F90.in:419
    ret = PIO_put_var(pio_file, pio_var, start, count, pval(PART_LEN * 3 + 1 : DIM_LEN))   ! ncdf_get_put.F90.in:420
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put var (4th part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:421)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:421
   ! ncdf_get_put.F90.in:422
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:424
   ! ncdf_get_put.F90.in:425
    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:426
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to reopen:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:427)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:427
   ! ncdf_get_put.F90.in:428
    ret = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! ncdf_get_put.F90.in:429
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:430)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:430
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:432
#endif
   ! ncdf_get_put.F90.in:434
    start = PART_LEN * 3 + 1   ! ncdf_get_put.F90.in:435
    ret = PIO_get_var(pio_file, pio_var, start, count, gval(PART_LEN * 3 + 1 : DIM_LEN))   ! ncdf_get_put.F90.in:436
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get var (4th part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:437)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:437
   ! ncdf_get_put.F90.in:438
    start = PART_LEN * 2 + 1   ! ncdf_get_put.F90.in:439
    ret = PIO_get_var(pio_file, pio_var, start, count, gval(PART_LEN * 2 + 1 : PART_LEN * 3))   ! ncdf_get_put.F90.in:440
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get var (3rd part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:441)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:441
   ! ncdf_get_put.F90.in:442
    start = PART_LEN + 1   ! ncdf_get_put.F90.in:443
    ret = PIO_get_var(pio_file, pio_var, start, count, gval(PART_LEN + 1 : PART_LEN * 2))   ! ncdf_get_put.F90.in:444
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get var (2nd part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:445)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:445
   ! ncdf_get_put.F90.in:446
    start = 1   ! ncdf_get_put.F90.in:447
    ret = PIO_get_var(pio_file, pio_var, start, count, gval(1 : PART_LEN))   ! ncdf_get_put.F90.in:448
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get var (1st part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:449)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:449
   ! ncdf_get_put.F90.in:450
    
    IF (.NOT. PIO_TF_Check_val_(gval, pval)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:451)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:451
   ! ncdf_get_put.F90.in:452
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:453
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:454
  end do   ! ncdf_get_put.F90.in:455
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:456
    deallocate(iotypes)   ! ncdf_get_put.F90.in:457
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:458
  end if   ! ncdf_get_put.F90.in:459
   ! ncdf_get_put.F90.in:460
END SUBROUTINE test_put_get_1dvar_4parts_PIO_real_real_kind_fc_real___   ! ncdf_get_put.F90.in:461


SUBROUTINE test_put_get_1dvar_4parts_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! ncdf_get_put.F90.in:370
  Implicit none   ! ncdf_get_put.F90.in:371
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:372
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:373
  character(len=*), parameter :: PIO_VAR_NAME = 'dummy_var_put_val'   ! ncdf_get_put.F90.in:374
  type(var_desc_t)  :: pio_var, pio_cvar   ! ncdf_get_put.F90.in:375
  integer :: pio_dim   ! ncdf_get_put.F90.in:376
  integer, parameter :: DIM_LEN = 16   ! ncdf_get_put.F90.in:377
  integer, parameter :: PART_LEN = DIM_LEN / 4   ! ncdf_get_put.F90.in:378
  real(kind=fc_double), dimension(DIM_LEN) :: pval, gval   ! ncdf_get_put.F90.in:379
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:380
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:381
  integer :: num_iotypes   ! ncdf_get_put.F90.in:382
  integer :: i, ret   ! ncdf_get_put.F90.in:383
  integer, dimension(1) :: start, count = PART_LEN   ! ncdf_get_put.F90.in:384
     ! ncdf_get_put.F90.in:385
  do i=1,DIM_LEN   ! ncdf_get_put.F90.in:386
    pval(i) = i   ! ncdf_get_put.F90.in:387
  end do   ! ncdf_get_put.F90.in:388
  num_iotypes = 0   ! ncdf_get_put.F90.in:389
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:390
  filename = "test_pio_ncdf_get_put.testfile"   ! ncdf_get_put.F90.in:391
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:392

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:393
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:394
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:395)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:395
   ! ncdf_get_put.F90.in:396
    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'dummy_dim_put_val', DIM_LEN, pio_dim)   ! ncdf_get_put.F90.in:398
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:399)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:399
   ! ncdf_get_put.F90.in:400
    ret = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_double, (/pio_dim/), pio_var)   ! ncdf_get_put.F90.in:401
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:402)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:402
   ! ncdf_get_put.F90.in:403
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:404
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:405)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:405
   ! ncdf_get_put.F90.in:406
    start = 1   ! ncdf_get_put.F90.in:407
    ret = PIO_put_var(pio_file, pio_var, start, count, pval(1 : PART_LEN))   ! ncdf_get_put.F90.in:408
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put var (1st part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:409)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:409
   ! ncdf_get_put.F90.in:410
    start = PART_LEN + 1   ! ncdf_get_put.F90.in:411
    ret = PIO_put_var(pio_file, pio_var, start, count, pval(PART_LEN + 1 : PART_LEN * 2))   ! ncdf_get_put.F90.in:412
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put var (2nd part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:413)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:413
   ! ncdf_get_put.F90.in:414
    start = PART_LEN * 2 + 1   ! ncdf_get_put.F90.in:415
    ret = PIO_put_var(pio_file, pio_var, start, count, pval(PART_LEN * 2 + 1 : PART_LEN * 3))   ! ncdf_get_put.F90.in:416
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put var (3rd part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:417)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:417
   ! ncdf_get_put.F90.in:418
    start = PART_LEN * 3 + 1   ! ncdf_get_put.F90.in:419
    ret = PIO_put_var(pio_file, pio_var, start, count, pval(PART_LEN * 3 + 1 : DIM_LEN))   ! ncdf_get_put.F90.in:420
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put var (4th part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:421)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:421
   ! ncdf_get_put.F90.in:422
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:424
   ! ncdf_get_put.F90.in:425
    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:426
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to reopen:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:427)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:427
   ! ncdf_get_put.F90.in:428
    ret = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! ncdf_get_put.F90.in:429
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get scalar var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:430)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:430
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:432
#endif
   ! ncdf_get_put.F90.in:434
    start = PART_LEN * 3 + 1   ! ncdf_get_put.F90.in:435
    ret = PIO_get_var(pio_file, pio_var, start, count, gval(PART_LEN * 3 + 1 : DIM_LEN))   ! ncdf_get_put.F90.in:436
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get var (4th part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:437)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:437
   ! ncdf_get_put.F90.in:438
    start = PART_LEN * 2 + 1   ! ncdf_get_put.F90.in:439
    ret = PIO_get_var(pio_file, pio_var, start, count, gval(PART_LEN * 2 + 1 : PART_LEN * 3))   ! ncdf_get_put.F90.in:440
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get var (3rd part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:441)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:441
   ! ncdf_get_put.F90.in:442
    start = PART_LEN + 1   ! ncdf_get_put.F90.in:443
    ret = PIO_get_var(pio_file, pio_var, start, count, gval(PART_LEN + 1 : PART_LEN * 2))   ! ncdf_get_put.F90.in:444
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get var (2nd part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:445)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:445
   ! ncdf_get_put.F90.in:446
    start = 1   ! ncdf_get_put.F90.in:447
    ret = PIO_get_var(pio_file, pio_var, start, count, gval(1 : PART_LEN))   ! ncdf_get_put.F90.in:448
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get var (1st part):" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:449)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:449
   ! ncdf_get_put.F90.in:450
    
    IF (.NOT. PIO_TF_Check_val_(gval, pval)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:451)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:451
   ! ncdf_get_put.F90.in:452
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:453
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:454
  end do   ! ncdf_get_put.F90.in:455
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:456
    deallocate(iotypes)   ! ncdf_get_put.F90.in:457
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:458
  end if   ! ncdf_get_put.F90.in:459
   ! ncdf_get_put.F90.in:460
END SUBROUTINE test_put_get_1dvar_4parts_PIO_double_real_kind_fc_double___   ! ncdf_get_put.F90.in:461
   ! ncdf_get_put.F90.in:461


! Write out 2d/3d/4d vars, one time slice at a time


SUBROUTINE test_put_get_md2mdplus1_var_PIO_int_integer__
USE pio_tutil
   ! ncdf_get_put.F90.in:465
  Implicit none   ! ncdf_get_put.F90.in:466
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:467
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:468
  character(len=*), parameter :: PIO_2DVAR_NAME = '2d_val'   ! ncdf_get_put.F90.in:469
  character(len=*), parameter :: PIO_3DVAR_NAME = '3d_val'   ! ncdf_get_put.F90.in:470
  character(len=*), parameter :: PIO_4DVAR_NAME = '4d_val'   ! ncdf_get_put.F90.in:471
  integer, parameter :: MAX_DIMS = 4   ! ncdf_get_put.F90.in:472
  integer, parameter :: MAX_ROWS = 10   ! ncdf_get_put.F90.in:473
  integer, parameter :: MAX_COLS = 10   ! ncdf_get_put.F90.in:474
  integer, parameter :: MAX_LEVS = 3   ! ncdf_get_put.F90.in:475
  integer, parameter :: MAX_TIMES = 3   ! ncdf_get_put.F90.in:476
  integer, dimension(MAX_DIMS) :: pio_dims   ! ncdf_get_put.F90.in:477
  type(var_desc_t)  :: pio_2dvar, pio_3dvar, pio_4dvar   ! ncdf_get_put.F90.in:478
  integer, dimension(MAX_ROWS,MAX_TIMES) :: gval_2d, exp_val_2d   ! ncdf_get_put.F90.in:479
  integer, dimension(MAX_ROWS,MAX_COLS,MAX_TIMES) :: gval_3d, exp_val_3d   ! ncdf_get_put.F90.in:480
  integer, dimension(MAX_ROWS,MAX_COLS,MAX_LEVS,MAX_TIMES) ::&   ! ncdf_get_put.F90.in:481
                                                      gval_4d, exp_val_4d   ! ncdf_get_put.F90.in:482
  ! Only one slice is written out at a time
  ! pval_1d is a 1d slice of gval_2d ...
  integer, dimension(MAX_ROWS) :: pval_1d   ! ncdf_get_put.F90.in:485
  integer, dimension(MAX_ROWS, MAX_COLS) :: pval_2d   ! ncdf_get_put.F90.in:486
  integer, dimension(MAX_ROWS, MAX_COLS, MAX_LEVS) :: pval_3d   ! ncdf_get_put.F90.in:487
  integer, dimension(:) :: start(MAX_DIMS), count(MAX_DIMS)   ! ncdf_get_put.F90.in:488
  integer :: pval_start   ! ncdf_get_put.F90.in:489
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:490
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:491
  integer :: num_iotypes   ! ncdf_get_put.F90.in:492
  integer :: i, k, l, m, n, tstep, ret   ! ncdf_get_put.F90.in:493
     ! ncdf_get_put.F90.in:494
  num_iotypes = 0   ! ncdf_get_put.F90.in:495
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:496
  filename = "test_pio_ncdf_get_put_md_slice.testfile"   ! ncdf_get_put.F90.in:497
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:498

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:499
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:500
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:501)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:501
   ! ncdf_get_put.F90.in:502
    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'nrows', MAX_ROWS, pio_dims(1))   ! ncdf_get_put.F90.in:504
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:505)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:505
   ! ncdf_get_put.F90.in:506
    ret = PIO_def_dim(pio_file, 'ncols', MAX_COLS, pio_dims(2))   ! ncdf_get_put.F90.in:507
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:508)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:508
   ! ncdf_get_put.F90.in:509
    ret = PIO_def_dim(pio_file, 'nlevs', MAX_LEVS, pio_dims(3))   ! ncdf_get_put.F90.in:510
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:511)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:511
   ! ncdf_get_put.F90.in:512
    ret = PIO_def_dim(pio_file, 'timesteps', MAX_TIMES, pio_dims(4))   ! ncdf_get_put.F90.in:513
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:514)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:514
   ! ncdf_get_put.F90.in:515
    ret = PIO_def_var(pio_file, PIO_2DVAR_NAME, PIO_int,&   ! ncdf_get_put.F90.in:516
              (/pio_dims(1),pio_dims(4)/), pio_2dvar)   ! ncdf_get_put.F90.in:517
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:518)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:518
   ! ncdf_get_put.F90.in:519
    ret = PIO_def_var(pio_file, PIO_3DVAR_NAME, PIO_int,&   ! ncdf_get_put.F90.in:520
              (/pio_dims(1),pio_dims(2),pio_dims(4)/), pio_3dvar)   ! ncdf_get_put.F90.in:521
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:522)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:522
   ! ncdf_get_put.F90.in:523
    ret = PIO_def_var(pio_file, PIO_4DVAR_NAME, PIO_int,&   ! ncdf_get_put.F90.in:524
              pio_dims, pio_4dvar)   ! ncdf_get_put.F90.in:525
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:526)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:526
   ! ncdf_get_put.F90.in:527
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:528
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:529)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:529
   ! ncdf_get_put.F90.in:530
    ! Put vals are for each timestep &
    ! expected vals are combined for all timesteps
    do k=1,MAX_ROWS   ! ncdf_get_put.F90.in:533
      pval_1d(k) = k   ! ncdf_get_put.F90.in:534
    end do   ! ncdf_get_put.F90.in:535
    do tstep=1,MAX_TIMES   ! ncdf_get_put.F90.in:536
      pval_start = (tstep - 1) * MAX_ROWS   ! ncdf_get_put.F90.in:537
      exp_val_2d(:,tstep) = pval_1d + pval_start   ! ncdf_get_put.F90.in:538
    end do   ! ncdf_get_put.F90.in:539
    do l=1,MAX_COLS   ! ncdf_get_put.F90.in:540
      do k=1,MAX_ROWS   ! ncdf_get_put.F90.in:541
        pval_2d(k,l) = (l - 1)*MAX_ROWS + k   ! ncdf_get_put.F90.in:542
      end do   ! ncdf_get_put.F90.in:543
    end do   ! ncdf_get_put.F90.in:544
    do tstep=1,MAX_TIMES   ! ncdf_get_put.F90.in:545
      do l=1,MAX_COLS   ! ncdf_get_put.F90.in:546
        do k=1,MAX_ROWS   ! ncdf_get_put.F90.in:547
          pval_start = (tstep - 1) * (MAX_ROWS * MAX_COLS)   ! ncdf_get_put.F90.in:548
          exp_val_3d(:,:,tstep) = pval_2d + pval_start   ! ncdf_get_put.F90.in:549
        end do   ! ncdf_get_put.F90.in:550
      end do   ! ncdf_get_put.F90.in:551
    end do   ! ncdf_get_put.F90.in:552
    do m=1,MAX_LEVS   ! ncdf_get_put.F90.in:553
      do l=1,MAX_COLS   ! ncdf_get_put.F90.in:554
        do k=1,MAX_ROWS   ! ncdf_get_put.F90.in:555
          pval_3d(k,l,m) = ((m-1)*(MAX_COLS*MAX_ROWS)+(l - 1)*MAX_ROWS + k)   ! ncdf_get_put.F90.in:556
        end do   ! ncdf_get_put.F90.in:557
      end do   ! ncdf_get_put.F90.in:558
    end do   ! ncdf_get_put.F90.in:559
    do tstep=1,MAX_TIMES   ! ncdf_get_put.F90.in:560
      do m=1,MAX_LEVS   ! ncdf_get_put.F90.in:561
        do l=1,MAX_COLS   ! ncdf_get_put.F90.in:562
          do k=1,MAX_ROWS   ! ncdf_get_put.F90.in:563
            pval_start = (tstep - 1) * (MAX_ROWS * MAX_COLS * MAX_LEVS)   ! ncdf_get_put.F90.in:564
            exp_val_4d(:,:,:,tstep) = pval_3d + pval_start   ! ncdf_get_put.F90.in:565
          end do   ! ncdf_get_put.F90.in:566
        end do   ! ncdf_get_put.F90.in:567
      end do   ! ncdf_get_put.F90.in:568
    end do   ! ncdf_get_put.F90.in:569
    ! Put 2d/3d/4d vals, one timestep at a time
    do tstep=1,MAX_TIMES   ! ncdf_get_put.F90.in:571
      start = 0   ! ncdf_get_put.F90.in:572
      count = 0   ! ncdf_get_put.F90.in:573
   ! ncdf_get_put.F90.in:574
      start(1) = 1   ! ncdf_get_put.F90.in:575
      count(1) = MAX_ROWS   ! ncdf_get_put.F90.in:576
      start(2) = tstep   ! ncdf_get_put.F90.in:577
      count(2) = 1   ! ncdf_get_put.F90.in:578
      pval_start = (tstep - 1) * MAX_ROWS   ! ncdf_get_put.F90.in:579
      ret = PIO_put_var(pio_file, pio_2dvar, start, count,&   ! ncdf_get_put.F90.in:580
              pval_1d(:)+pval_start)   ! ncdf_get_put.F90.in:581
      
      IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to put 2d var:" // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(ncdf_get_put.F90.in:582)"
        END IF
        RETURN
      END IF   ! ncdf_get_put.F90.in:582
   ! ncdf_get_put.F90.in:583
      start(1) = 1   ! ncdf_get_put.F90.in:584
      count(1) = MAX_ROWS   ! ncdf_get_put.F90.in:585
      start(2) = 1   ! ncdf_get_put.F90.in:586
      count(2) = MAX_COLS   ! ncdf_get_put.F90.in:587
      start(3) = tstep   ! ncdf_get_put.F90.in:588
      count(3) = 1   ! ncdf_get_put.F90.in:589
      pval_start = (tstep - 1) * (MAX_ROWS * MAX_COLS)   ! ncdf_get_put.F90.in:590
      ret = PIO_put_var(pio_file, pio_3dvar, start, count,&   ! ncdf_get_put.F90.in:591
              pval_2d(:,:)+pval_start)   ! ncdf_get_put.F90.in:592
      
      IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to put 3d var:" // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(ncdf_get_put.F90.in:593)"
        END IF
        RETURN
      END IF   ! ncdf_get_put.F90.in:593
   ! ncdf_get_put.F90.in:594
      start(1) = 1   ! ncdf_get_put.F90.in:595
      count(1) = MAX_ROWS   ! ncdf_get_put.F90.in:596
      start(2) = 1   ! ncdf_get_put.F90.in:597
      count(2) = MAX_COLS   ! ncdf_get_put.F90.in:598
      start(3) = 1   ! ncdf_get_put.F90.in:599
      count(3) = MAX_LEVS   ! ncdf_get_put.F90.in:600
      start(4) = tstep   ! ncdf_get_put.F90.in:601
      count(4) = 1   ! ncdf_get_put.F90.in:602
      pval_start = (tstep - 1) * (MAX_ROWS * MAX_COLS * MAX_LEVS)   ! ncdf_get_put.F90.in:603
      ret = PIO_put_var(pio_file, pio_4dvar, start, count,&   ! ncdf_get_put.F90.in:604
              pval_3d(:,:,:)+pval_start)   ! ncdf_get_put.F90.in:605
      
      IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to put 4d var:" // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(ncdf_get_put.F90.in:606)"
        END IF
        RETURN
      END IF   ! ncdf_get_put.F90.in:606
    end do   ! ncdf_get_put.F90.in:607
   ! ncdf_get_put.F90.in:608
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:610
   ! ncdf_get_put.F90.in:611
    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:612
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to reopen:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:613)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:613
   ! ncdf_get_put.F90.in:614
    ret = PIO_inq_varid(pio_file, PIO_2DVAR_NAME, pio_2dvar)   ! ncdf_get_put.F90.in:615
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to inq 2d var" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:616)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:616
   ! ncdf_get_put.F90.in:617
    ret = PIO_inq_varid(pio_file, PIO_3DVAR_NAME, pio_3dvar)   ! ncdf_get_put.F90.in:618
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to inq 3d var" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:619)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:619
   ! ncdf_get_put.F90.in:620
    ret = PIO_inq_varid(pio_file, PIO_4DVAR_NAME, pio_4dvar)   ! ncdf_get_put.F90.in:621
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to inq 4d var" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:622)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:622
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:624
#endif
   ! ncdf_get_put.F90.in:626
    ret = PIO_get_var(pio_file, pio_2dvar, gval_2d)   ! ncdf_get_put.F90.in:627
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get 2d var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:628)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:628
   ! ncdf_get_put.F90.in:629
    
    IF (.NOT. PIO_TF_Check_val_(gval_2d, exp_val_2d)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value (2d var)",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:630)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:630
   ! ncdf_get_put.F90.in:631
    ret = PIO_get_var(pio_file, pio_3dvar, gval_3d)   ! ncdf_get_put.F90.in:632
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get 3d var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:633)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:633
   ! ncdf_get_put.F90.in:634
    
    IF (.NOT. PIO_TF_Check_val_(gval_3d, exp_val_3d)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value (3d var)",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:635)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:635
   ! ncdf_get_put.F90.in:636
    ret = PIO_get_var(pio_file, pio_4dvar, gval_4d)   ! ncdf_get_put.F90.in:637
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get 4d var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:638)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:638
   ! ncdf_get_put.F90.in:639
    ! Special code to handle 4d vals is required since the framework
    ! currently does not support comparing 4d arrays
    do tstep=1,MAX_TIMES   ! ncdf_get_put.F90.in:642
      
      IF (.NOT. PIO_TF_Check_val_(gval_4d(:,:,:,tstep), exp_val_4d(:,:,:,tstep))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Check failed:",&
             "Got wrong value (4d var)",&
            ":", __FILE__, ":", __LINE__,&
            "(ncdf_get_put.F90.in:643)"
        END IF
        RETURN
      END IF   ! ncdf_get_put.F90.in:643
    end do   ! ncdf_get_put.F90.in:644
   ! ncdf_get_put.F90.in:645
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:646
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:647
  end do   ! ncdf_get_put.F90.in:648
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:649
    deallocate(iotypes)   ! ncdf_get_put.F90.in:650
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:651
  end if   ! ncdf_get_put.F90.in:652
   ! ncdf_get_put.F90.in:653
END SUBROUTINE test_put_get_md2mdplus1_var_PIO_int_integer__   ! ncdf_get_put.F90.in:654


SUBROUTINE test_put_get_md2mdplus1_var_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! ncdf_get_put.F90.in:465
  Implicit none   ! ncdf_get_put.F90.in:466
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:467
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:468
  character(len=*), parameter :: PIO_2DVAR_NAME = '2d_val'   ! ncdf_get_put.F90.in:469
  character(len=*), parameter :: PIO_3DVAR_NAME = '3d_val'   ! ncdf_get_put.F90.in:470
  character(len=*), parameter :: PIO_4DVAR_NAME = '4d_val'   ! ncdf_get_put.F90.in:471
  integer, parameter :: MAX_DIMS = 4   ! ncdf_get_put.F90.in:472
  integer, parameter :: MAX_ROWS = 10   ! ncdf_get_put.F90.in:473
  integer, parameter :: MAX_COLS = 10   ! ncdf_get_put.F90.in:474
  integer, parameter :: MAX_LEVS = 3   ! ncdf_get_put.F90.in:475
  integer, parameter :: MAX_TIMES = 3   ! ncdf_get_put.F90.in:476
  integer, dimension(MAX_DIMS) :: pio_dims   ! ncdf_get_put.F90.in:477
  type(var_desc_t)  :: pio_2dvar, pio_3dvar, pio_4dvar   ! ncdf_get_put.F90.in:478
  real(kind=fc_real), dimension(MAX_ROWS,MAX_TIMES) :: gval_2d, exp_val_2d   ! ncdf_get_put.F90.in:479
  real(kind=fc_real), dimension(MAX_ROWS,MAX_COLS,MAX_TIMES) :: gval_3d, exp_val_3d   ! ncdf_get_put.F90.in:480
  real(kind=fc_real), dimension(MAX_ROWS,MAX_COLS,MAX_LEVS,MAX_TIMES) ::&   ! ncdf_get_put.F90.in:481
                                                      gval_4d, exp_val_4d   ! ncdf_get_put.F90.in:482
  ! Only one slice is written out at a time
  ! pval_1d is a 1d slice of gval_2d ...
  real(kind=fc_real), dimension(MAX_ROWS) :: pval_1d   ! ncdf_get_put.F90.in:485
  real(kind=fc_real), dimension(MAX_ROWS, MAX_COLS) :: pval_2d   ! ncdf_get_put.F90.in:486
  real(kind=fc_real), dimension(MAX_ROWS, MAX_COLS, MAX_LEVS) :: pval_3d   ! ncdf_get_put.F90.in:487
  integer, dimension(:) :: start(MAX_DIMS), count(MAX_DIMS)   ! ncdf_get_put.F90.in:488
  integer :: pval_start   ! ncdf_get_put.F90.in:489
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:490
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:491
  integer :: num_iotypes   ! ncdf_get_put.F90.in:492
  integer :: i, k, l, m, n, tstep, ret   ! ncdf_get_put.F90.in:493
     ! ncdf_get_put.F90.in:494
  num_iotypes = 0   ! ncdf_get_put.F90.in:495
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:496
  filename = "test_pio_ncdf_get_put_md_slice.testfile"   ! ncdf_get_put.F90.in:497
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:498

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:499
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:500
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:501)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:501
   ! ncdf_get_put.F90.in:502
    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'nrows', MAX_ROWS, pio_dims(1))   ! ncdf_get_put.F90.in:504
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:505)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:505
   ! ncdf_get_put.F90.in:506
    ret = PIO_def_dim(pio_file, 'ncols', MAX_COLS, pio_dims(2))   ! ncdf_get_put.F90.in:507
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:508)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:508
   ! ncdf_get_put.F90.in:509
    ret = PIO_def_dim(pio_file, 'nlevs', MAX_LEVS, pio_dims(3))   ! ncdf_get_put.F90.in:510
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:511)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:511
   ! ncdf_get_put.F90.in:512
    ret = PIO_def_dim(pio_file, 'timesteps', MAX_TIMES, pio_dims(4))   ! ncdf_get_put.F90.in:513
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:514)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:514
   ! ncdf_get_put.F90.in:515
    ret = PIO_def_var(pio_file, PIO_2DVAR_NAME, PIO_real,&   ! ncdf_get_put.F90.in:516
              (/pio_dims(1),pio_dims(4)/), pio_2dvar)   ! ncdf_get_put.F90.in:517
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:518)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:518
   ! ncdf_get_put.F90.in:519
    ret = PIO_def_var(pio_file, PIO_3DVAR_NAME, PIO_real,&   ! ncdf_get_put.F90.in:520
              (/pio_dims(1),pio_dims(2),pio_dims(4)/), pio_3dvar)   ! ncdf_get_put.F90.in:521
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:522)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:522
   ! ncdf_get_put.F90.in:523
    ret = PIO_def_var(pio_file, PIO_4DVAR_NAME, PIO_real,&   ! ncdf_get_put.F90.in:524
              pio_dims, pio_4dvar)   ! ncdf_get_put.F90.in:525
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:526)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:526
   ! ncdf_get_put.F90.in:527
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:528
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:529)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:529
   ! ncdf_get_put.F90.in:530
    ! Put vals are for each timestep &
    ! expected vals are combined for all timesteps
    do k=1,MAX_ROWS   ! ncdf_get_put.F90.in:533
      pval_1d(k) = k   ! ncdf_get_put.F90.in:534
    end do   ! ncdf_get_put.F90.in:535
    do tstep=1,MAX_TIMES   ! ncdf_get_put.F90.in:536
      pval_start = (tstep - 1) * MAX_ROWS   ! ncdf_get_put.F90.in:537
      exp_val_2d(:,tstep) = pval_1d + pval_start   ! ncdf_get_put.F90.in:538
    end do   ! ncdf_get_put.F90.in:539
    do l=1,MAX_COLS   ! ncdf_get_put.F90.in:540
      do k=1,MAX_ROWS   ! ncdf_get_put.F90.in:541
        pval_2d(k,l) = (l - 1)*MAX_ROWS + k   ! ncdf_get_put.F90.in:542
      end do   ! ncdf_get_put.F90.in:543
    end do   ! ncdf_get_put.F90.in:544
    do tstep=1,MAX_TIMES   ! ncdf_get_put.F90.in:545
      do l=1,MAX_COLS   ! ncdf_get_put.F90.in:546
        do k=1,MAX_ROWS   ! ncdf_get_put.F90.in:547
          pval_start = (tstep - 1) * (MAX_ROWS * MAX_COLS)   ! ncdf_get_put.F90.in:548
          exp_val_3d(:,:,tstep) = pval_2d + pval_start   ! ncdf_get_put.F90.in:549
        end do   ! ncdf_get_put.F90.in:550
      end do   ! ncdf_get_put.F90.in:551
    end do   ! ncdf_get_put.F90.in:552
    do m=1,MAX_LEVS   ! ncdf_get_put.F90.in:553
      do l=1,MAX_COLS   ! ncdf_get_put.F90.in:554
        do k=1,MAX_ROWS   ! ncdf_get_put.F90.in:555
          pval_3d(k,l,m) = ((m-1)*(MAX_COLS*MAX_ROWS)+(l - 1)*MAX_ROWS + k)   ! ncdf_get_put.F90.in:556
        end do   ! ncdf_get_put.F90.in:557
      end do   ! ncdf_get_put.F90.in:558
    end do   ! ncdf_get_put.F90.in:559
    do tstep=1,MAX_TIMES   ! ncdf_get_put.F90.in:560
      do m=1,MAX_LEVS   ! ncdf_get_put.F90.in:561
        do l=1,MAX_COLS   ! ncdf_get_put.F90.in:562
          do k=1,MAX_ROWS   ! ncdf_get_put.F90.in:563
            pval_start = (tstep - 1) * (MAX_ROWS * MAX_COLS * MAX_LEVS)   ! ncdf_get_put.F90.in:564
            exp_val_4d(:,:,:,tstep) = pval_3d + pval_start   ! ncdf_get_put.F90.in:565
          end do   ! ncdf_get_put.F90.in:566
        end do   ! ncdf_get_put.F90.in:567
      end do   ! ncdf_get_put.F90.in:568
    end do   ! ncdf_get_put.F90.in:569
    ! Put 2d/3d/4d vals, one timestep at a time
    do tstep=1,MAX_TIMES   ! ncdf_get_put.F90.in:571
      start = 0   ! ncdf_get_put.F90.in:572
      count = 0   ! ncdf_get_put.F90.in:573
   ! ncdf_get_put.F90.in:574
      start(1) = 1   ! ncdf_get_put.F90.in:575
      count(1) = MAX_ROWS   ! ncdf_get_put.F90.in:576
      start(2) = tstep   ! ncdf_get_put.F90.in:577
      count(2) = 1   ! ncdf_get_put.F90.in:578
      pval_start = (tstep - 1) * MAX_ROWS   ! ncdf_get_put.F90.in:579
      ret = PIO_put_var(pio_file, pio_2dvar, start, count,&   ! ncdf_get_put.F90.in:580
              pval_1d(:)+pval_start)   ! ncdf_get_put.F90.in:581
      
      IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to put 2d var:" // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(ncdf_get_put.F90.in:582)"
        END IF
        RETURN
      END IF   ! ncdf_get_put.F90.in:582
   ! ncdf_get_put.F90.in:583
      start(1) = 1   ! ncdf_get_put.F90.in:584
      count(1) = MAX_ROWS   ! ncdf_get_put.F90.in:585
      start(2) = 1   ! ncdf_get_put.F90.in:586
      count(2) = MAX_COLS   ! ncdf_get_put.F90.in:587
      start(3) = tstep   ! ncdf_get_put.F90.in:588
      count(3) = 1   ! ncdf_get_put.F90.in:589
      pval_start = (tstep - 1) * (MAX_ROWS * MAX_COLS)   ! ncdf_get_put.F90.in:590
      ret = PIO_put_var(pio_file, pio_3dvar, start, count,&   ! ncdf_get_put.F90.in:591
              pval_2d(:,:)+pval_start)   ! ncdf_get_put.F90.in:592
      
      IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to put 3d var:" // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(ncdf_get_put.F90.in:593)"
        END IF
        RETURN
      END IF   ! ncdf_get_put.F90.in:593
   ! ncdf_get_put.F90.in:594
      start(1) = 1   ! ncdf_get_put.F90.in:595
      count(1) = MAX_ROWS   ! ncdf_get_put.F90.in:596
      start(2) = 1   ! ncdf_get_put.F90.in:597
      count(2) = MAX_COLS   ! ncdf_get_put.F90.in:598
      start(3) = 1   ! ncdf_get_put.F90.in:599
      count(3) = MAX_LEVS   ! ncdf_get_put.F90.in:600
      start(4) = tstep   ! ncdf_get_put.F90.in:601
      count(4) = 1   ! ncdf_get_put.F90.in:602
      pval_start = (tstep - 1) * (MAX_ROWS * MAX_COLS * MAX_LEVS)   ! ncdf_get_put.F90.in:603
      ret = PIO_put_var(pio_file, pio_4dvar, start, count,&   ! ncdf_get_put.F90.in:604
              pval_3d(:,:,:)+pval_start)   ! ncdf_get_put.F90.in:605
      
      IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to put 4d var:" // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(ncdf_get_put.F90.in:606)"
        END IF
        RETURN
      END IF   ! ncdf_get_put.F90.in:606
    end do   ! ncdf_get_put.F90.in:607
   ! ncdf_get_put.F90.in:608
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:610
   ! ncdf_get_put.F90.in:611
    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:612
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to reopen:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:613)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:613
   ! ncdf_get_put.F90.in:614
    ret = PIO_inq_varid(pio_file, PIO_2DVAR_NAME, pio_2dvar)   ! ncdf_get_put.F90.in:615
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to inq 2d var" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:616)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:616
   ! ncdf_get_put.F90.in:617
    ret = PIO_inq_varid(pio_file, PIO_3DVAR_NAME, pio_3dvar)   ! ncdf_get_put.F90.in:618
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to inq 3d var" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:619)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:619
   ! ncdf_get_put.F90.in:620
    ret = PIO_inq_varid(pio_file, PIO_4DVAR_NAME, pio_4dvar)   ! ncdf_get_put.F90.in:621
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to inq 4d var" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:622)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:622
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:624
#endif
   ! ncdf_get_put.F90.in:626
    ret = PIO_get_var(pio_file, pio_2dvar, gval_2d)   ! ncdf_get_put.F90.in:627
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get 2d var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:628)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:628
   ! ncdf_get_put.F90.in:629
    
    IF (.NOT. PIO_TF_Check_val_(gval_2d, exp_val_2d)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value (2d var)",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:630)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:630
   ! ncdf_get_put.F90.in:631
    ret = PIO_get_var(pio_file, pio_3dvar, gval_3d)   ! ncdf_get_put.F90.in:632
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get 3d var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:633)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:633
   ! ncdf_get_put.F90.in:634
    
    IF (.NOT. PIO_TF_Check_val_(gval_3d, exp_val_3d)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value (3d var)",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:635)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:635
   ! ncdf_get_put.F90.in:636
    ret = PIO_get_var(pio_file, pio_4dvar, gval_4d)   ! ncdf_get_put.F90.in:637
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get 4d var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:638)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:638
   ! ncdf_get_put.F90.in:639
    ! Special code to handle 4d vals is required since the framework
    ! currently does not support comparing 4d arrays
    do tstep=1,MAX_TIMES   ! ncdf_get_put.F90.in:642
      
      IF (.NOT. PIO_TF_Check_val_(gval_4d(:,:,:,tstep), exp_val_4d(:,:,:,tstep))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Check failed:",&
             "Got wrong value (4d var)",&
            ":", __FILE__, ":", __LINE__,&
            "(ncdf_get_put.F90.in:643)"
        END IF
        RETURN
      END IF   ! ncdf_get_put.F90.in:643
    end do   ! ncdf_get_put.F90.in:644
   ! ncdf_get_put.F90.in:645
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:646
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:647
  end do   ! ncdf_get_put.F90.in:648
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:649
    deallocate(iotypes)   ! ncdf_get_put.F90.in:650
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:651
  end if   ! ncdf_get_put.F90.in:652
   ! ncdf_get_put.F90.in:653
END SUBROUTINE test_put_get_md2mdplus1_var_PIO_real_real_kind_fc_real___   ! ncdf_get_put.F90.in:654


SUBROUTINE test_put_get_md2mdplus1_var_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! ncdf_get_put.F90.in:465
  Implicit none   ! ncdf_get_put.F90.in:466
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:467
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:468
  character(len=*), parameter :: PIO_2DVAR_NAME = '2d_val'   ! ncdf_get_put.F90.in:469
  character(len=*), parameter :: PIO_3DVAR_NAME = '3d_val'   ! ncdf_get_put.F90.in:470
  character(len=*), parameter :: PIO_4DVAR_NAME = '4d_val'   ! ncdf_get_put.F90.in:471
  integer, parameter :: MAX_DIMS = 4   ! ncdf_get_put.F90.in:472
  integer, parameter :: MAX_ROWS = 10   ! ncdf_get_put.F90.in:473
  integer, parameter :: MAX_COLS = 10   ! ncdf_get_put.F90.in:474
  integer, parameter :: MAX_LEVS = 3   ! ncdf_get_put.F90.in:475
  integer, parameter :: MAX_TIMES = 3   ! ncdf_get_put.F90.in:476
  integer, dimension(MAX_DIMS) :: pio_dims   ! ncdf_get_put.F90.in:477
  type(var_desc_t)  :: pio_2dvar, pio_3dvar, pio_4dvar   ! ncdf_get_put.F90.in:478
  real(kind=fc_double), dimension(MAX_ROWS,MAX_TIMES) :: gval_2d, exp_val_2d   ! ncdf_get_put.F90.in:479
  real(kind=fc_double), dimension(MAX_ROWS,MAX_COLS,MAX_TIMES) :: gval_3d, exp_val_3d   ! ncdf_get_put.F90.in:480
  real(kind=fc_double), dimension(MAX_ROWS,MAX_COLS,MAX_LEVS,MAX_TIMES) ::&   ! ncdf_get_put.F90.in:481
                                                      gval_4d, exp_val_4d   ! ncdf_get_put.F90.in:482
  ! Only one slice is written out at a time
  ! pval_1d is a 1d slice of gval_2d ...
  real(kind=fc_double), dimension(MAX_ROWS) :: pval_1d   ! ncdf_get_put.F90.in:485
  real(kind=fc_double), dimension(MAX_ROWS, MAX_COLS) :: pval_2d   ! ncdf_get_put.F90.in:486
  real(kind=fc_double), dimension(MAX_ROWS, MAX_COLS, MAX_LEVS) :: pval_3d   ! ncdf_get_put.F90.in:487
  integer, dimension(:) :: start(MAX_DIMS), count(MAX_DIMS)   ! ncdf_get_put.F90.in:488
  integer :: pval_start   ! ncdf_get_put.F90.in:489
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:490
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:491
  integer :: num_iotypes   ! ncdf_get_put.F90.in:492
  integer :: i, k, l, m, n, tstep, ret   ! ncdf_get_put.F90.in:493
     ! ncdf_get_put.F90.in:494
  num_iotypes = 0   ! ncdf_get_put.F90.in:495
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:496
  filename = "test_pio_ncdf_get_put_md_slice.testfile"   ! ncdf_get_put.F90.in:497
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:498

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:499
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:500
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:501)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:501
   ! ncdf_get_put.F90.in:502
    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'nrows', MAX_ROWS, pio_dims(1))   ! ncdf_get_put.F90.in:504
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:505)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:505
   ! ncdf_get_put.F90.in:506
    ret = PIO_def_dim(pio_file, 'ncols', MAX_COLS, pio_dims(2))   ! ncdf_get_put.F90.in:507
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:508)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:508
   ! ncdf_get_put.F90.in:509
    ret = PIO_def_dim(pio_file, 'nlevs', MAX_LEVS, pio_dims(3))   ! ncdf_get_put.F90.in:510
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:511)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:511
   ! ncdf_get_put.F90.in:512
    ret = PIO_def_dim(pio_file, 'timesteps', MAX_TIMES, pio_dims(4))   ! ncdf_get_put.F90.in:513
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:514)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:514
   ! ncdf_get_put.F90.in:515
    ret = PIO_def_var(pio_file, PIO_2DVAR_NAME, PIO_double,&   ! ncdf_get_put.F90.in:516
              (/pio_dims(1),pio_dims(4)/), pio_2dvar)   ! ncdf_get_put.F90.in:517
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:518)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:518
   ! ncdf_get_put.F90.in:519
    ret = PIO_def_var(pio_file, PIO_3DVAR_NAME, PIO_double,&   ! ncdf_get_put.F90.in:520
              (/pio_dims(1),pio_dims(2),pio_dims(4)/), pio_3dvar)   ! ncdf_get_put.F90.in:521
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:522)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:522
   ! ncdf_get_put.F90.in:523
    ret = PIO_def_var(pio_file, PIO_4DVAR_NAME, PIO_double,&   ! ncdf_get_put.F90.in:524
              pio_dims, pio_4dvar)   ! ncdf_get_put.F90.in:525
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:526)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:526
   ! ncdf_get_put.F90.in:527
    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:528
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:529)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:529
   ! ncdf_get_put.F90.in:530
    ! Put vals are for each timestep &
    ! expected vals are combined for all timesteps
    do k=1,MAX_ROWS   ! ncdf_get_put.F90.in:533
      pval_1d(k) = k   ! ncdf_get_put.F90.in:534
    end do   ! ncdf_get_put.F90.in:535
    do tstep=1,MAX_TIMES   ! ncdf_get_put.F90.in:536
      pval_start = (tstep - 1) * MAX_ROWS   ! ncdf_get_put.F90.in:537
      exp_val_2d(:,tstep) = pval_1d + pval_start   ! ncdf_get_put.F90.in:538
    end do   ! ncdf_get_put.F90.in:539
    do l=1,MAX_COLS   ! ncdf_get_put.F90.in:540
      do k=1,MAX_ROWS   ! ncdf_get_put.F90.in:541
        pval_2d(k,l) = (l - 1)*MAX_ROWS + k   ! ncdf_get_put.F90.in:542
      end do   ! ncdf_get_put.F90.in:543
    end do   ! ncdf_get_put.F90.in:544
    do tstep=1,MAX_TIMES   ! ncdf_get_put.F90.in:545
      do l=1,MAX_COLS   ! ncdf_get_put.F90.in:546
        do k=1,MAX_ROWS   ! ncdf_get_put.F90.in:547
          pval_start = (tstep - 1) * (MAX_ROWS * MAX_COLS)   ! ncdf_get_put.F90.in:548
          exp_val_3d(:,:,tstep) = pval_2d + pval_start   ! ncdf_get_put.F90.in:549
        end do   ! ncdf_get_put.F90.in:550
      end do   ! ncdf_get_put.F90.in:551
    end do   ! ncdf_get_put.F90.in:552
    do m=1,MAX_LEVS   ! ncdf_get_put.F90.in:553
      do l=1,MAX_COLS   ! ncdf_get_put.F90.in:554
        do k=1,MAX_ROWS   ! ncdf_get_put.F90.in:555
          pval_3d(k,l,m) = ((m-1)*(MAX_COLS*MAX_ROWS)+(l - 1)*MAX_ROWS + k)   ! ncdf_get_put.F90.in:556
        end do   ! ncdf_get_put.F90.in:557
      end do   ! ncdf_get_put.F90.in:558
    end do   ! ncdf_get_put.F90.in:559
    do tstep=1,MAX_TIMES   ! ncdf_get_put.F90.in:560
      do m=1,MAX_LEVS   ! ncdf_get_put.F90.in:561
        do l=1,MAX_COLS   ! ncdf_get_put.F90.in:562
          do k=1,MAX_ROWS   ! ncdf_get_put.F90.in:563
            pval_start = (tstep - 1) * (MAX_ROWS * MAX_COLS * MAX_LEVS)   ! ncdf_get_put.F90.in:564
            exp_val_4d(:,:,:,tstep) = pval_3d + pval_start   ! ncdf_get_put.F90.in:565
          end do   ! ncdf_get_put.F90.in:566
        end do   ! ncdf_get_put.F90.in:567
      end do   ! ncdf_get_put.F90.in:568
    end do   ! ncdf_get_put.F90.in:569
    ! Put 2d/3d/4d vals, one timestep at a time
    do tstep=1,MAX_TIMES   ! ncdf_get_put.F90.in:571
      start = 0   ! ncdf_get_put.F90.in:572
      count = 0   ! ncdf_get_put.F90.in:573
   ! ncdf_get_put.F90.in:574
      start(1) = 1   ! ncdf_get_put.F90.in:575
      count(1) = MAX_ROWS   ! ncdf_get_put.F90.in:576
      start(2) = tstep   ! ncdf_get_put.F90.in:577
      count(2) = 1   ! ncdf_get_put.F90.in:578
      pval_start = (tstep - 1) * MAX_ROWS   ! ncdf_get_put.F90.in:579
      ret = PIO_put_var(pio_file, pio_2dvar, start, count,&   ! ncdf_get_put.F90.in:580
              pval_1d(:)+pval_start)   ! ncdf_get_put.F90.in:581
      
      IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to put 2d var:" // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(ncdf_get_put.F90.in:582)"
        END IF
        RETURN
      END IF   ! ncdf_get_put.F90.in:582
   ! ncdf_get_put.F90.in:583
      start(1) = 1   ! ncdf_get_put.F90.in:584
      count(1) = MAX_ROWS   ! ncdf_get_put.F90.in:585
      start(2) = 1   ! ncdf_get_put.F90.in:586
      count(2) = MAX_COLS   ! ncdf_get_put.F90.in:587
      start(3) = tstep   ! ncdf_get_put.F90.in:588
      count(3) = 1   ! ncdf_get_put.F90.in:589
      pval_start = (tstep - 1) * (MAX_ROWS * MAX_COLS)   ! ncdf_get_put.F90.in:590
      ret = PIO_put_var(pio_file, pio_3dvar, start, count,&   ! ncdf_get_put.F90.in:591
              pval_2d(:,:)+pval_start)   ! ncdf_get_put.F90.in:592
      
      IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to put 3d var:" // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(ncdf_get_put.F90.in:593)"
        END IF
        RETURN
      END IF   ! ncdf_get_put.F90.in:593
   ! ncdf_get_put.F90.in:594
      start(1) = 1   ! ncdf_get_put.F90.in:595
      count(1) = MAX_ROWS   ! ncdf_get_put.F90.in:596
      start(2) = 1   ! ncdf_get_put.F90.in:597
      count(2) = MAX_COLS   ! ncdf_get_put.F90.in:598
      start(3) = 1   ! ncdf_get_put.F90.in:599
      count(3) = MAX_LEVS   ! ncdf_get_put.F90.in:600
      start(4) = tstep   ! ncdf_get_put.F90.in:601
      count(4) = 1   ! ncdf_get_put.F90.in:602
      pval_start = (tstep - 1) * (MAX_ROWS * MAX_COLS * MAX_LEVS)   ! ncdf_get_put.F90.in:603
      ret = PIO_put_var(pio_file, pio_4dvar, start, count,&   ! ncdf_get_put.F90.in:604
              pval_3d(:,:,:)+pval_start)   ! ncdf_get_put.F90.in:605
      
      IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to put 4d var:" // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(ncdf_get_put.F90.in:606)"
        END IF
        RETURN
      END IF   ! ncdf_get_put.F90.in:606
    end do   ! ncdf_get_put.F90.in:607
   ! ncdf_get_put.F90.in:608
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:610
   ! ncdf_get_put.F90.in:611
    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:612
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to reopen:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:613)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:613
   ! ncdf_get_put.F90.in:614
    ret = PIO_inq_varid(pio_file, PIO_2DVAR_NAME, pio_2dvar)   ! ncdf_get_put.F90.in:615
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to inq 2d var" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:616)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:616
   ! ncdf_get_put.F90.in:617
    ret = PIO_inq_varid(pio_file, PIO_3DVAR_NAME, pio_3dvar)   ! ncdf_get_put.F90.in:618
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to inq 3d var" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:619)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:619
   ! ncdf_get_put.F90.in:620
    ret = PIO_inq_varid(pio_file, PIO_4DVAR_NAME, pio_4dvar)   ! ncdf_get_put.F90.in:621
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to inq 4d var" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:622)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:622
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:624
#endif
   ! ncdf_get_put.F90.in:626
    ret = PIO_get_var(pio_file, pio_2dvar, gval_2d)   ! ncdf_get_put.F90.in:627
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get 2d var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:628)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:628
   ! ncdf_get_put.F90.in:629
    
    IF (.NOT. PIO_TF_Check_val_(gval_2d, exp_val_2d)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value (2d var)",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:630)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:630
   ! ncdf_get_put.F90.in:631
    ret = PIO_get_var(pio_file, pio_3dvar, gval_3d)   ! ncdf_get_put.F90.in:632
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get 3d var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:633)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:633
   ! ncdf_get_put.F90.in:634
    
    IF (.NOT. PIO_TF_Check_val_(gval_3d, exp_val_3d)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong value (3d var)",&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:635)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:635
   ! ncdf_get_put.F90.in:636
    ret = PIO_get_var(pio_file, pio_4dvar, gval_4d)   ! ncdf_get_put.F90.in:637
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get 4d var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:638)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:638
   ! ncdf_get_put.F90.in:639
    ! Special code to handle 4d vals is required since the framework
    ! currently does not support comparing 4d arrays
    do tstep=1,MAX_TIMES   ! ncdf_get_put.F90.in:642
      
      IF (.NOT. PIO_TF_Check_val_(gval_4d(:,:,:,tstep), exp_val_4d(:,:,:,tstep))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Check failed:",&
             "Got wrong value (4d var)",&
            ":", __FILE__, ":", __LINE__,&
            "(ncdf_get_put.F90.in:643)"
        END IF
        RETURN
      END IF   ! ncdf_get_put.F90.in:643
    end do   ! ncdf_get_put.F90.in:644
   ! ncdf_get_put.F90.in:645
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:646
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:647
  end do   ! ncdf_get_put.F90.in:648
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:649
    deallocate(iotypes)   ! ncdf_get_put.F90.in:650
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:651
  end if   ! ncdf_get_put.F90.in:652
   ! ncdf_get_put.F90.in:653
END SUBROUTINE test_put_get_md2mdplus1_var_PIO_double_real_kind_fc_double___   ! ncdf_get_put.F90.in:654
   ! ncdf_get_put.F90.in:654


SUBROUTINE test_put_get_1d_str_arr
  USE pio_tutil
   ! ncdf_get_put.F90.in:656
  Implicit none   ! ncdf_get_put.F90.in:657
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:658
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:659
  type(var_desc_t)  :: pio_str_arr_var1, pio_str_arr_var2   ! ncdf_get_put.F90.in:660
  integer, dimension(2) :: pio_dims   ! ncdf_get_put.F90.in:661
  integer, parameter :: STR_LEN = 64   ! ncdf_get_put.F90.in:662
  integer, parameter :: NUM_STRS = 32   ! ncdf_get_put.F90.in:663
  character(len=STR_LEN) :: exp_str   ! ncdf_get_put.F90.in:664
  character(len=STR_LEN), dimension(NUM_STRS) :: pstr_arr, gstr_arr   ! ncdf_get_put.F90.in:665
  integer, dimension(2) :: start   ! ncdf_get_put.F90.in:666
  integer, dimension(2) :: count   ! ncdf_get_put.F90.in:667
  integer, parameter :: StrKIND = 512   ! ncdf_get_put.F90.in:668
  character(len=StrKIND), dimension(1) :: single_str_arr   ! ncdf_get_put.F90.in:669
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:670
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:671
  integer :: num_iotypes   ! ncdf_get_put.F90.in:672
  integer :: i, index, ret   ! ncdf_get_put.F90.in:673


  do index=1,NUM_STRS   ! ncdf_get_put.F90.in:675
    write(exp_str, '(a, i2)') 'DUMMY_STRING, index = ', index   ! ncdf_get_put.F90.in:676
    pstr_arr(index) = exp_str   ! ncdf_get_put.F90.in:677
    gstr_arr(index) = ' '   ! ncdf_get_put.F90.in:678
  end do   ! ncdf_get_put.F90.in:679


  num_iotypes = 0   ! ncdf_get_put.F90.in:681
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:682
  filename = "test_pio_ncdf_get_put.testfile"   ! ncdf_get_put.F90.in:683
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:684

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:685
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:686
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:687)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:687


    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'StrLen', STR_LEN, pio_dims(1))   ! ncdf_get_put.F90.in:690
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:691)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:691


    ret = PIO_def_dim(pio_file, 'nstrs', NUM_STRS, pio_dims(2))   ! ncdf_get_put.F90.in:693
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:694)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:694


    ret = PIO_def_var(pio_file, 'var1_1d_str_arr', PIO_char, (/pio_dims/), pio_str_arr_var1)   ! ncdf_get_put.F90.in:696
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define string array var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:697)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:697


    ret = PIO_def_var(pio_file, 'var2_1d_str_arr', PIO_char, (/pio_dims/), pio_str_arr_var2)   ! ncdf_get_put.F90.in:699
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define string array var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:700)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:700


    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:702
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:703)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:703


    ! This calls put_var_1d_text()
    ret = PIO_put_var(pio_file, pio_str_arr_var1, pstr_arr);   ! ncdf_get_put.F90.in:706
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put string array var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:707)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:707


    start(1) = 1   ! ncdf_get_put.F90.in:709
    start(2) = 1   ! ncdf_get_put.F90.in:710
    count(1) = STR_LEN   ! ncdf_get_put.F90.in:711
    count(2) = NUM_STRS   ! ncdf_get_put.F90.in:712


    ! This calls put_vara_1d_text()
    ret = PIO_put_var(pio_file, pio_str_arr_var2, start, count, pstr_arr);   ! ncdf_get_put.F90.in:715
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put string array var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:716)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:716


#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:719


    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:721
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to reopen:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:722)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:722


    ret = PIO_inq_varid(pio_file, 'var1_1d_str_arr', pio_str_arr_var1)   ! ncdf_get_put.F90.in:724
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to inq string array var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:725)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:725


    ret = PIO_inq_varid(pio_file, 'var2_1d_str_arr', pio_str_arr_var2)   ! ncdf_get_put.F90.in:727
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to inq string array var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:728)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:728
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:730
#endif


    ! This calls get_var_1d_text()
    ret = PIO_get_var(pio_file, pio_str_arr_var1, gstr_arr);   ! ncdf_get_put.F90.in:734
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get string array var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:735)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:735


    do index=1,NUM_STRS   ! ncdf_get_put.F90.in:737
      
      IF (.NOT. PIO_TF_Check_val_(gstr_arr(index), pstr_arr(index))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Check failed:",&
             "Got wrong value",&
            ":", __FILE__, ":", __LINE__,&
            "(ncdf_get_put.F90.in:738)"
        END IF
        RETURN
      END IF   ! ncdf_get_put.F90.in:738
    end do   ! ncdf_get_put.F90.in:739


    do index=1,NUM_STRS   ! ncdf_get_put.F90.in:741
      gstr_arr(index) = ' '   ! ncdf_get_put.F90.in:742
    end do   ! ncdf_get_put.F90.in:743


    ! This calls get_vara_1d_text()
    ret = PIO_get_var(pio_file, pio_str_arr_var2, start, count, gstr_arr);   ! ncdf_get_put.F90.in:746
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get string array var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:747)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:747


    do index=1,NUM_STRS   ! ncdf_get_put.F90.in:749
      
      IF (.NOT. PIO_TF_Check_val_(gstr_arr(index), pstr_arr(index))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Check failed:",&
             "Got wrong value",&
            ":", __FILE__, ":", __LINE__,&
            "(ncdf_get_put.F90.in:750)"
        END IF
        RETURN
      END IF   ! ncdf_get_put.F90.in:750
    end do   ! ncdf_get_put.F90.in:751


    count(2) = 1   ! ncdf_get_put.F90.in:753


    ! Read one string at a time, since the sizes differ (i.e. StrLen != StrKIND)
    do index=1,NUM_STRS   ! ncdf_get_put.F90.in:756
      write(exp_str, '(a, i2)') 'DUMMY_STRING, index = ', index   ! ncdf_get_put.F90.in:757


      start(2) = index   ! ncdf_get_put.F90.in:759


      single_str_arr(1) = ' '   ! ncdf_get_put.F90.in:761


      ! This calls get_vara_1d_text()
      ret = PIO_get_var(pio_file, pio_str_arr_var1, start, count, single_str_arr)   ! ncdf_get_put.F90.in:764
      
      IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to get string array var:" // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(ncdf_get_put.F90.in:765)"
        END IF
        RETURN
      END IF   ! ncdf_get_put.F90.in:765


      
      IF (.NOT. PIO_TF_Check_val_(single_str_arr(1)(1:STR_LEN), exp_str)) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Check failed:",&
             "Got wrong value",&
            ":", __FILE__, ":", __LINE__,&
            "(ncdf_get_put.F90.in:767)"
        END IF
        RETURN
      END IF   ! ncdf_get_put.F90.in:767


      single_str_arr(1) = ' '   ! ncdf_get_put.F90.in:769


      ! This calls get_vara_1d_text()
      ret = PIO_get_var(pio_file, pio_str_arr_var2, start, count, single_str_arr)   ! ncdf_get_put.F90.in:772
      
      IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to get string array var:" // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(ncdf_get_put.F90.in:773)"
        END IF
        RETURN
      END IF   ! ncdf_get_put.F90.in:773


      
      IF (.NOT. PIO_TF_Check_val_(single_str_arr(1)(1:STR_LEN), exp_str)) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Check failed:",&
             "Got wrong value",&
            ":", __FILE__, ":", __LINE__,&
            "(ncdf_get_put.F90.in:775)"
        END IF
        RETURN
      END IF   ! ncdf_get_put.F90.in:775
    end do   ! ncdf_get_put.F90.in:776


    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:778
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:779
  end do   ! ncdf_get_put.F90.in:780
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:781
    deallocate(iotypes)   ! ncdf_get_put.F90.in:782
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:783
  end if   ! ncdf_get_put.F90.in:784


END SUBROUTINE test_put_get_1d_str_arr   ! ncdf_get_put.F90.in:786


SUBROUTINE test_put_get_2d_str_arr
  USE pio_tutil
   ! ncdf_get_put.F90.in:788
  Implicit none   ! ncdf_get_put.F90.in:789
  type(file_desc_t) :: pio_file   ! ncdf_get_put.F90.in:790
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! ncdf_get_put.F90.in:791
  type(var_desc_t)  :: pio_str_arr_var1, pio_str_arr_var2   ! ncdf_get_put.F90.in:792
  integer, dimension(3) :: pio_dims   ! ncdf_get_put.F90.in:793
  integer, parameter :: STR_LEN = 64   ! ncdf_get_put.F90.in:794
  integer, parameter :: NUM_ROWS = 4   ! ncdf_get_put.F90.in:795
  integer, parameter :: NUM_COLS = 8   ! ncdf_get_put.F90.in:796
  character(len=STR_LEN) :: exp_str   ! ncdf_get_put.F90.in:797
  character(len=STR_LEN), dimension(NUM_ROWS, NUM_COLS) :: pstr_arr, gstr_arr   ! ncdf_get_put.F90.in:798
  integer, dimension(3) :: start   ! ncdf_get_put.F90.in:799
  integer, dimension(3) :: count   ! ncdf_get_put.F90.in:800
  integer, parameter :: StrKIND = 512   ! ncdf_get_put.F90.in:801
  character(len=StrKIND), dimension(1) :: single_str_arr   ! ncdf_get_put.F90.in:802
  integer, dimension(:), allocatable :: iotypes   ! ncdf_get_put.F90.in:803
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! ncdf_get_put.F90.in:804
  integer :: num_iotypes   ! ncdf_get_put.F90.in:805
  integer :: i, row, col, index, ret   ! ncdf_get_put.F90.in:806


  do col=1,NUM_COLS   ! ncdf_get_put.F90.in:808
    do row=1,NUM_ROWS   ! ncdf_get_put.F90.in:809
      ! Array storage in Fortran is column-major
      index = (col - 1) * NUM_ROWS + row   ! ncdf_get_put.F90.in:811
      write(exp_str, '(a, i2)') 'DUMMY_STRING, index = ', index   ! ncdf_get_put.F90.in:812
      pstr_arr(row, col) = exp_str   ! ncdf_get_put.F90.in:813
      gstr_arr(row, col) = ' '   ! ncdf_get_put.F90.in:814
    end do   ! ncdf_get_put.F90.in:815
  end do   ! ncdf_get_put.F90.in:816


  num_iotypes = 0   ! ncdf_get_put.F90.in:818
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! ncdf_get_put.F90.in:819
  filename = "test_pio_ncdf_get_put.testfile"   ! ncdf_get_put.F90.in:820
  do i=1,num_iotypes   ! ncdf_get_put.F90.in:821

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing type :", iotype_descs(i)
      END IF
    END IF   ! ncdf_get_put.F90.in:822
    ret = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)   ! ncdf_get_put.F90.in:823
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to open:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:824)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:824


    ! Since file is just created no need to enter redef
    ret = PIO_def_dim(pio_file, 'StrLen', STR_LEN, pio_dims(1))   ! ncdf_get_put.F90.in:827
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:828)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:828


    ret = PIO_def_dim(pio_file, 'col', NUM_COLS, pio_dims(2))   ! ncdf_get_put.F90.in:830
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:831)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:831


    ret = PIO_def_dim(pio_file, 'row', NUM_ROWS, pio_dims(3))   ! ncdf_get_put.F90.in:833
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define dim:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:834)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:834


    ret = PIO_def_var(pio_file, 'var1_2d_str_arr', PIO_char, (/pio_dims/), pio_str_arr_var1)   ! ncdf_get_put.F90.in:836
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define string array var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:837)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:837


    ret = PIO_def_var(pio_file, 'var2_2d_str_arr', PIO_char, (/pio_dims/), pio_str_arr_var2)   ! ncdf_get_put.F90.in:839
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define string array var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:840)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:840


    ret = PIO_enddef(pio_file)   ! ncdf_get_put.F90.in:842
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to enddef:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:843)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:843


    ! This calls put_var_2d_text()
    ret = PIO_put_var(pio_file, pio_str_arr_var1, pstr_arr);   ! ncdf_get_put.F90.in:846
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put string array var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:847)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:847


    start(1) = 1   ! ncdf_get_put.F90.in:849
    start(2) = 1   ! ncdf_get_put.F90.in:850
    start(3) = 1   ! ncdf_get_put.F90.in:851
    count(1) = STR_LEN   ! ncdf_get_put.F90.in:852
    count(2) = NUM_COLS   ! ncdf_get_put.F90.in:853
    count(3) = NUM_ROWS   ! ncdf_get_put.F90.in:854


    ! This calls put_vara_2d_text()
    ret = PIO_put_var(pio_file, pio_str_arr_var2, start, count, pstr_arr);   ! ncdf_get_put.F90.in:857
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to put string array var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:858)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:858


#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:861


    ret = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! ncdf_get_put.F90.in:863
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to reopen:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:864)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:864


    ret = PIO_inq_varid(pio_file, 'var1_2d_str_arr', pio_str_arr_var1)   ! ncdf_get_put.F90.in:866
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to inq string array var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:867)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:867


    ret = PIO_inq_varid(pio_file, 'var2_2d_str_arr', pio_str_arr_var2)   ! ncdf_get_put.F90.in:869
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to inq string array var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:870)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:870
#else
    call PIO_syncfile(pio_file)   ! ncdf_get_put.F90.in:872
#endif


    ! This calls get_var_2d_text()
    ret = PIO_get_var(pio_file, pio_str_arr_var1, gstr_arr);   ! ncdf_get_put.F90.in:876
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get string array var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:877)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:877


    do col=1,NUM_COLS   ! ncdf_get_put.F90.in:879
      do row=1,NUM_ROWS   ! ncdf_get_put.F90.in:880
        
        IF (.NOT. PIO_TF_Check_val_(gstr_arr(row, col), pstr_arr(row, col))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Check failed:",&
               "Got wrong value",&
              ":", __FILE__, ":", __LINE__,&
              "(ncdf_get_put.F90.in:881)"
          END IF
          RETURN
        END IF   ! ncdf_get_put.F90.in:881
      end do   ! ncdf_get_put.F90.in:882
    end do   ! ncdf_get_put.F90.in:883


    do col=1,NUM_COLS   ! ncdf_get_put.F90.in:885
      do row=1,NUM_ROWS   ! ncdf_get_put.F90.in:886
        gstr_arr(row, col) = ' '   ! ncdf_get_put.F90.in:887
      end do   ! ncdf_get_put.F90.in:888
    end do   ! ncdf_get_put.F90.in:889


    ! This calls get_vara_2d_text()
    ret = PIO_get_var(pio_file, pio_str_arr_var2, start, count, gstr_arr);   ! ncdf_get_put.F90.in:892
    
    IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to get string array var:" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(ncdf_get_put.F90.in:893)"
      END IF
      RETURN
    END IF   ! ncdf_get_put.F90.in:893


    do col=1,NUM_COLS   ! ncdf_get_put.F90.in:895
      do row=1,NUM_ROWS   ! ncdf_get_put.F90.in:896
        
        IF (.NOT. PIO_TF_Check_val_(gstr_arr(row, col), pstr_arr(row, col))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Check failed:",&
               "Got wrong value",&
              ":", __FILE__, ":", __LINE__,&
              "(ncdf_get_put.F90.in:897)"
          END IF
          RETURN
        END IF   ! ncdf_get_put.F90.in:897
      end do   ! ncdf_get_put.F90.in:898
    end do   ! ncdf_get_put.F90.in:899


    count(2) = 1   ! ncdf_get_put.F90.in:901
    count(3) = 1   ! ncdf_get_put.F90.in:902


    ! Read one string at a time, since the sizes differ (i.e. StrLen != StrKIND)
    do row=1,NUM_ROWS   ! ncdf_get_put.F90.in:905
      do col=1,NUM_COLS   ! ncdf_get_put.F90.in:906
        ! NetCDF uses C row-major convention
        index = (row - 1) * NUM_COLS + col   ! ncdf_get_put.F90.in:908
        write(exp_str, '(a, i2)') 'DUMMY_STRING, index = ', index   ! ncdf_get_put.F90.in:909


        start(2) = col   ! ncdf_get_put.F90.in:911
        start(3) = row   ! ncdf_get_put.F90.in:912


        single_str_arr(1) = ' '   ! ncdf_get_put.F90.in:914


        ! This calls get_vara_1d_text()
        ret = PIO_get_var(pio_file, pio_str_arr_var1, start, count, single_str_arr)   ! ncdf_get_put.F90.in:917
        
        IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Failed to get string array var:" // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(ncdf_get_put.F90.in:918)"
          END IF
          RETURN
        END IF   ! ncdf_get_put.F90.in:918


        
        IF (.NOT. PIO_TF_Check_val_(single_str_arr(1)(1:STR_LEN), exp_str)) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Check failed:",&
               "Got wrong value",&
              ":", __FILE__, ":", __LINE__,&
              "(ncdf_get_put.F90.in:920)"
          END IF
          RETURN
        END IF   ! ncdf_get_put.F90.in:920


        single_str_arr(1) = ' '   ! ncdf_get_put.F90.in:922


        ! This calls get_vara_1d_text()
        ret = PIO_get_var(pio_file, pio_str_arr_var2, start, count, single_str_arr)   ! ncdf_get_put.F90.in:925
        
        IF (.NOT. (PIO_TF_Passert_((ret) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Failed to get string array var:" // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(ncdf_get_put.F90.in:926)"
          END IF
          RETURN
        END IF   ! ncdf_get_put.F90.in:926


        
        IF (.NOT. PIO_TF_Check_val_(single_str_arr(1)(1:STR_LEN), exp_str)) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Check failed:",&
               "Got wrong value",&
              ":", __FILE__, ":", __LINE__,&
              "(ncdf_get_put.F90.in:928)"
          END IF
          RETURN
        END IF   ! ncdf_get_put.F90.in:928
      end do   ! ncdf_get_put.F90.in:929
    end do   ! ncdf_get_put.F90.in:930


    call PIO_closefile(pio_file)   ! ncdf_get_put.F90.in:932
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! ncdf_get_put.F90.in:933
  end do   ! ncdf_get_put.F90.in:934
  if(allocated(iotypes)) then   ! ncdf_get_put.F90.in:935
    deallocate(iotypes)   ! ncdf_get_put.F90.in:936
    deallocate(iotype_descs)   ! ncdf_get_put.F90.in:937
  end if   ! ncdf_get_put.F90.in:938


END SUBROUTINE test_put_get_2d_str_arr   ! ncdf_get_put.F90.in:940




  SUBROUTINE PIO_TF_Test_driver_
    USE pio_tutil
    IMPLICIT NONE
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_int_integer__"
    END IF
    CALL test_put_1datt_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 1:",&
          "test_put_1datt_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 1:",&
          "test_put_1datt_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_1datt_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 2:",&
          "test_put_1datt_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 2:",&
          "test_put_1datt_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_1datt_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 3:",&
          "test_put_1datt_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 3:",&
          "test_put_1datt_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_int_integer__"
    END IF
    CALL test_put_1datt_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 4:",&
          "test_put_1datt_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 4:",&
          "test_put_1datt_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_1datt_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 5:",&
          "test_put_1datt_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 5:",&
          "test_put_1datt_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_1datt_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 6:",&
          "test_put_1datt_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 6:",&
          "test_put_1datt_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1datt_PIO_int_integer__"
    END IF
    CALL test_put_get_1datt_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 7:",&
          "test_put_get_1datt_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 7:",&
          "test_put_get_1datt_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1datt_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_1datt_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 8:",&
          "test_put_get_1datt_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 8:",&
          "test_put_get_1datt_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1datt_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_1datt_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 9:",&
          "test_put_get_1datt_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 9:",&
          "test_put_get_1datt_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_int_integer__"
    END IF
    CALL test_put_1datt_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 10:",&
          "test_put_1datt_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 10:",&
          "test_put_1datt_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_1datt_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 11:",&
          "test_put_1datt_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 11:",&
          "test_put_1datt_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_1datt_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 12:",&
          "test_put_1datt_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 12:",&
          "test_put_1datt_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1datt_PIO_int_integer__"
    END IF
    CALL test_put_get_1datt_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 13:",&
          "test_put_get_1datt_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 13:",&
          "test_put_get_1datt_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1datt_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_1datt_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 14:",&
          "test_put_get_1datt_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 14:",&
          "test_put_get_1datt_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1datt_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_1datt_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 15:",&
          "test_put_get_1datt_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 15:",&
          "test_put_get_1datt_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_0dvar_PIO_int_integer__"
    END IF
    CALL test_put_get_0dvar_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 16:",&
          "test_put_get_0dvar_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 16:",&
          "test_put_get_0dvar_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_0dvar_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_0dvar_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 17:",&
          "test_put_get_0dvar_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 17:",&
          "test_put_get_0dvar_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_0dvar_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_0dvar_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 18:",&
          "test_put_get_0dvar_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 18:",&
          "test_put_get_0dvar_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_int_integer__"
    END IF
    CALL test_put_1datt_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 19:",&
          "test_put_1datt_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 19:",&
          "test_put_1datt_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_1datt_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 20:",&
          "test_put_1datt_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 20:",&
          "test_put_1datt_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_1datt_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 21:",&
          "test_put_1datt_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 21:",&
          "test_put_1datt_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1datt_PIO_int_integer__"
    END IF
    CALL test_put_get_1datt_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 22:",&
          "test_put_get_1datt_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 22:",&
          "test_put_get_1datt_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1datt_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_1datt_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 23:",&
          "test_put_get_1datt_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 23:",&
          "test_put_get_1datt_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1datt_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_1datt_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 24:",&
          "test_put_get_1datt_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 24:",&
          "test_put_get_1datt_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_0dvar_PIO_int_integer__"
    END IF
    CALL test_put_get_0dvar_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 25:",&
          "test_put_get_0dvar_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 25:",&
          "test_put_get_0dvar_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_0dvar_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_0dvar_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 26:",&
          "test_put_get_0dvar_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 26:",&
          "test_put_get_0dvar_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_0dvar_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_0dvar_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 27:",&
          "test_put_get_0dvar_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 27:",&
          "test_put_get_0dvar_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_PIO_int_integer__"
    END IF
    CALL test_put_get_1dvar_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 28:",&
          "test_put_get_1dvar_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 28:",&
          "test_put_get_1dvar_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_1dvar_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 29:",&
          "test_put_get_1dvar_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 29:",&
          "test_put_get_1dvar_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_1dvar_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 30:",&
          "test_put_get_1dvar_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 30:",&
          "test_put_get_1dvar_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_int_integer__"
    END IF
    CALL test_put_1datt_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 31:",&
          "test_put_1datt_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 31:",&
          "test_put_1datt_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_1datt_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 32:",&
          "test_put_1datt_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 32:",&
          "test_put_1datt_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_1datt_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 33:",&
          "test_put_1datt_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 33:",&
          "test_put_1datt_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1datt_PIO_int_integer__"
    END IF
    CALL test_put_get_1datt_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 34:",&
          "test_put_get_1datt_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 34:",&
          "test_put_get_1datt_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1datt_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_1datt_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 35:",&
          "test_put_get_1datt_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 35:",&
          "test_put_get_1datt_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1datt_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_1datt_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 36:",&
          "test_put_get_1datt_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 36:",&
          "test_put_get_1datt_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_0dvar_PIO_int_integer__"
    END IF
    CALL test_put_get_0dvar_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 37:",&
          "test_put_get_0dvar_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 37:",&
          "test_put_get_0dvar_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_0dvar_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_0dvar_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 38:",&
          "test_put_get_0dvar_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 38:",&
          "test_put_get_0dvar_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_0dvar_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_0dvar_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 39:",&
          "test_put_get_0dvar_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 39:",&
          "test_put_get_0dvar_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_PIO_int_integer__"
    END IF
    CALL test_put_get_1dvar_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 40:",&
          "test_put_get_1dvar_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 40:",&
          "test_put_get_1dvar_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_1dvar_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 41:",&
          "test_put_get_1dvar_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 41:",&
          "test_put_get_1dvar_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_1dvar_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 42:",&
          "test_put_get_1dvar_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 42:",&
          "test_put_get_1dvar_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_slice_PIO_int_integer__"
    END IF
    CALL test_put_get_1dvar_slice_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 43:",&
          "test_put_get_1dvar_slice_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 43:",&
          "test_put_get_1dvar_slice_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_slice_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_1dvar_slice_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 44:",&
          "test_put_get_1dvar_slice_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 44:",&
          "test_put_get_1dvar_slice_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_slice_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_1dvar_slice_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 45:",&
          "test_put_get_1dvar_slice_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 45:",&
          "test_put_get_1dvar_slice_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_int_integer__"
    END IF
    CALL test_put_1datt_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 46:",&
          "test_put_1datt_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 46:",&
          "test_put_1datt_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_1datt_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 47:",&
          "test_put_1datt_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 47:",&
          "test_put_1datt_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_1datt_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 48:",&
          "test_put_1datt_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 48:",&
          "test_put_1datt_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1datt_PIO_int_integer__"
    END IF
    CALL test_put_get_1datt_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 49:",&
          "test_put_get_1datt_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 49:",&
          "test_put_get_1datt_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1datt_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_1datt_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 50:",&
          "test_put_get_1datt_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 50:",&
          "test_put_get_1datt_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1datt_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_1datt_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 51:",&
          "test_put_get_1datt_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 51:",&
          "test_put_get_1datt_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_0dvar_PIO_int_integer__"
    END IF
    CALL test_put_get_0dvar_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 52:",&
          "test_put_get_0dvar_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 52:",&
          "test_put_get_0dvar_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_0dvar_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_0dvar_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 53:",&
          "test_put_get_0dvar_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 53:",&
          "test_put_get_0dvar_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_0dvar_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_0dvar_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 54:",&
          "test_put_get_0dvar_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 54:",&
          "test_put_get_0dvar_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_PIO_int_integer__"
    END IF
    CALL test_put_get_1dvar_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 55:",&
          "test_put_get_1dvar_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 55:",&
          "test_put_get_1dvar_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_1dvar_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 56:",&
          "test_put_get_1dvar_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 56:",&
          "test_put_get_1dvar_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_1dvar_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 57:",&
          "test_put_get_1dvar_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 57:",&
          "test_put_get_1dvar_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_slice_PIO_int_integer__"
    END IF
    CALL test_put_get_1dvar_slice_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 58:",&
          "test_put_get_1dvar_slice_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 58:",&
          "test_put_get_1dvar_slice_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_slice_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_1dvar_slice_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 59:",&
          "test_put_get_1dvar_slice_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 59:",&
          "test_put_get_1dvar_slice_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_slice_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_1dvar_slice_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 60:",&
          "test_put_get_1dvar_slice_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 60:",&
          "test_put_get_1dvar_slice_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_4parts_PIO_int_integer__"
    END IF
    CALL test_put_get_1dvar_4parts_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 61:",&
          "test_put_get_1dvar_4parts_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 61:",&
          "test_put_get_1dvar_4parts_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_4parts_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_1dvar_4parts_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 62:",&
          "test_put_get_1dvar_4parts_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 62:",&
          "test_put_get_1dvar_4parts_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_4parts_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_1dvar_4parts_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 63:",&
          "test_put_get_1dvar_4parts_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 63:",&
          "test_put_get_1dvar_4parts_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_int_integer__"
    END IF
    CALL test_put_1datt_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 64:",&
          "test_put_1datt_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 64:",&
          "test_put_1datt_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_1datt_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 65:",&
          "test_put_1datt_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 65:",&
          "test_put_1datt_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_1datt_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_1datt_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 66:",&
          "test_put_1datt_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 66:",&
          "test_put_1datt_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1datt_PIO_int_integer__"
    END IF
    CALL test_put_get_1datt_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 67:",&
          "test_put_get_1datt_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 67:",&
          "test_put_get_1datt_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1datt_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_1datt_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 68:",&
          "test_put_get_1datt_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 68:",&
          "test_put_get_1datt_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1datt_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_1datt_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 69:",&
          "test_put_get_1datt_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 69:",&
          "test_put_get_1datt_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_0dvar_PIO_int_integer__"
    END IF
    CALL test_put_get_0dvar_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 70:",&
          "test_put_get_0dvar_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 70:",&
          "test_put_get_0dvar_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_0dvar_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_0dvar_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 71:",&
          "test_put_get_0dvar_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 71:",&
          "test_put_get_0dvar_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_0dvar_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_0dvar_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 72:",&
          "test_put_get_0dvar_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 72:",&
          "test_put_get_0dvar_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_PIO_int_integer__"
    END IF
    CALL test_put_get_1dvar_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 73:",&
          "test_put_get_1dvar_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 73:",&
          "test_put_get_1dvar_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_1dvar_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 74:",&
          "test_put_get_1dvar_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 74:",&
          "test_put_get_1dvar_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_1dvar_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 75:",&
          "test_put_get_1dvar_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 75:",&
          "test_put_get_1dvar_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_slice_PIO_int_integer__"
    END IF
    CALL test_put_get_1dvar_slice_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 76:",&
          "test_put_get_1dvar_slice_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 76:",&
          "test_put_get_1dvar_slice_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_slice_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_1dvar_slice_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 77:",&
          "test_put_get_1dvar_slice_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 77:",&
          "test_put_get_1dvar_slice_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_slice_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_1dvar_slice_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 78:",&
          "test_put_get_1dvar_slice_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 78:",&
          "test_put_get_1dvar_slice_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_4parts_PIO_int_integer__"
    END IF
    CALL test_put_get_1dvar_4parts_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 79:",&
          "test_put_get_1dvar_4parts_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 79:",&
          "test_put_get_1dvar_4parts_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_4parts_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_1dvar_4parts_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 80:",&
          "test_put_get_1dvar_4parts_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 80:",&
          "test_put_get_1dvar_4parts_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1dvar_4parts_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_1dvar_4parts_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 81:",&
          "test_put_get_1dvar_4parts_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 81:",&
          "test_put_get_1dvar_4parts_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_md2mdplus1_var_PIO_int_integer__"
    END IF
    CALL test_put_get_md2mdplus1_var_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 82:",&
          "test_put_get_md2mdplus1_var_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 82:",&
          "test_put_get_md2mdplus1_var_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_md2mdplus1_var_PIO_real_real_kind_fc_real___"
    END IF
    CALL test_put_get_md2mdplus1_var_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 83:",&
          "test_put_get_md2mdplus1_var_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 83:",&
          "test_put_get_md2mdplus1_var_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_md2mdplus1_var_PIO_double_real_kind_fc_double___"
    END IF
    CALL test_put_get_md2mdplus1_var_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 84:",&
          "test_put_get_md2mdplus1_var_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 84:",&
          "test_put_get_md2mdplus1_var_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_1d_str_arr"
    END IF
    CALL test_put_get_1d_str_arr()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 85:",&
          "test_put_get_1d_str_arr","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 85:",&
          "test_put_get_1d_str_arr","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting test_put_get_2d_str_arr"
    END IF
    CALL test_put_get_2d_str_arr()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 86:",&
          "test_put_get_2d_str_arr","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 86:",&
          "test_put_get_2d_str_arr","-----------", "FAILED"
      END IF
    END IF
  END SUBROUTINE PIO_TF_Test_driver_


  PROGRAM PIO_TF_Test_main_
    USE pio_tutil
    IMPLICIT NONE
    INTEGER, PARAMETER :: NREARRS = 2
    INTEGER :: rearrs(NREARRS) = (/pio_rearr_subset,pio_rearr_box/)
    CHARACTER(LEN=PIO_TF_MAX_STR_LEN) :: rearrs_info(NREARRS) = (/"PIO_REARR_SUBSET","PIO_REARR_BOX   "/)
    INTEGER i, ierr

    pio_tf_nerrs_total_=0
    pio_tf_retval_utest_=0
    CALL MPI_Init(ierr)
    DO i=1,SIZE(rearrs)
      CALL PIO_TF_Init_(rearrs(i))
      IF (pio_tf_world_rank_ == 0) THEN
        WRITE(*,*) "PIO_TF: Testing : ", trim(rearrs_info(i))
      END IF
      CALL PIO_TF_Test_driver_()
      CALL PIO_TF_Finalize_()
    END DO
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_nerrs_total_ == 0) THEN
        IF (pio_tf_retval_utest_ == 0) THEN
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF: ",&
           "All tests", "---------", "PASSED"
        ELSE
          pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF: ",&
           "Test driver", "---------", "FAILED"
        END IF
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT2) "PIO_TF:[",&
          pio_tf_nerrs_total_,"] Tests",&
          "----- FAILED"
      END IF
    END IF
    CALL MPI_Finalize(ierr)
    IF (pio_tf_nerrs_total_ /= 0) THEN
      STOP 99
    END IF
  END PROGRAM
