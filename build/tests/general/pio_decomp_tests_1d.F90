! DON'T MODIFY THIS FILE, ALL YOUR CHANGES WILL BE LOST
! This file is generated by ../../../tests/general/util/pio_tf_f90gen.pl
! from /home/tkurc/codar/e3sm/pio_adios1/ParallelIO/tests/general/pio_decomp_tests_1d.F90.in

! Get a block cyclic decomposition
! If force_rearrange is FALSE, the decomposition is such that
! # All even procs have VEC_LOCAL_SZ elements
! # All odd procs have VEC_LOCAL_SZ + 1 elements
! e.g. For VEC_LOCAL_SZ = 2,
! e.g. 1)    [1,2] [3,4,5] [6,7]
! e.g. 2)    [1,2] [3,4,5] [6,7] [8,9,10]
! e.g. 3)    [1,2] [3,4,5] [6,7] [8,9,10] [11,12]
! If force_rearrange is TRUE, the decomposition is such that,
! If possible, the even rank "exchanges" elements with the next
! higher ranked odd proc.
! This for example can be used to force rearrangement when reading
! or writing data.
! e.g. For VEC_LOCAL_SZ = 2,
! e.g. 1)    [3,4,5] [1,2] [6,7]
! e.g. 2)    [3,4,5] [1,2] [8,9,10] [6,7]
! e.g. 3)    [3,4,5] [1,2] [8,9,10] [6,7] [11,12]
SUBROUTINE get_1d_bc_info(rank, sz, dims, start, count, force_rearrange)   ! pio_decomp_tests_1d.F90.in:18
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_tests_1d.F90.in:19
  integer, intent(in) :: rank   ! pio_decomp_tests_1d.F90.in:20
  integer, intent(in) :: sz   ! pio_decomp_tests_1d.F90.in:21
  integer, dimension(1), intent(out) :: dims   ! pio_decomp_tests_1d.F90.in:22
  integer, dimension(1), intent(out) :: start   ! pio_decomp_tests_1d.F90.in:23
  integer, dimension(1), intent(out) :: count   ! pio_decomp_tests_1d.F90.in:24
  logical, intent(in) :: force_rearrange   ! pio_decomp_tests_1d.F90.in:25


  logical :: is_even_rank   ! pio_decomp_tests_1d.F90.in:27
  integer :: num_odd_procs, num_even_procs   ! pio_decomp_tests_1d.F90.in:28
  integer :: iodd, ieven   ! pio_decomp_tests_1d.F90.in:29


  is_even_rank = .false.   ! pio_decomp_tests_1d.F90.in:31
  if (mod(rank, 2) == 0) then   ! pio_decomp_tests_1d.F90.in:32
    is_even_rank = .true.   ! pio_decomp_tests_1d.F90.in:33
  end if   ! pio_decomp_tests_1d.F90.in:34
  num_odd_procs = sz / 2   ! pio_decomp_tests_1d.F90.in:35
  num_even_procs = sz - num_odd_procs   ! pio_decomp_tests_1d.F90.in:36
  dims(1) = num_even_procs * VEC_LOCAL_SZ + num_odd_procs * (VEC_LOCAL_SZ + 1)   ! pio_decomp_tests_1d.F90.in:37
  ! Number of odd and even procs before this rank
  iodd = rank / 2   ! pio_decomp_tests_1d.F90.in:39
  ieven = (rank + 1) / 2   ! pio_decomp_tests_1d.F90.in:40
  if(force_rearrange) then   ! pio_decomp_tests_1d.F90.in:41
    ! Make sure that we force rearrangement
    if (is_even_rank) then   ! pio_decomp_tests_1d.F90.in:43
      if(rank + 1 < sz) then   ! pio_decomp_tests_1d.F90.in:44
        ! Force rearrangement
        count(1) = VEC_LOCAL_SZ + 1   ! pio_decomp_tests_1d.F90.in:46
        start(1) = ieven * VEC_LOCAL_SZ + iodd * (VEC_LOCAL_SZ + 1) + (VEC_LOCAL_SZ) + 1   ! pio_decomp_tests_1d.F90.in:47
      else   ! pio_decomp_tests_1d.F90.in:48
        count(1) = VEC_LOCAL_SZ   ! pio_decomp_tests_1d.F90.in:49
        start(1) = ieven * VEC_LOCAL_SZ + iodd * (VEC_LOCAL_SZ + 1) + 1   ! pio_decomp_tests_1d.F90.in:50
      end if   ! pio_decomp_tests_1d.F90.in:51
    else   ! pio_decomp_tests_1d.F90.in:52
      ! For all odd procs there is an even lower ranked, rank-1, proc
      ! So force rearrangement
      count(1) = VEC_LOCAL_SZ   ! pio_decomp_tests_1d.F90.in:55
      start(1) = ieven * VEC_LOCAL_SZ + iodd * (VEC_LOCAL_SZ + 1) - (VEC_LOCAL_SZ) + 1   ! pio_decomp_tests_1d.F90.in:56
    end if   ! pio_decomp_tests_1d.F90.in:57
  else   ! pio_decomp_tests_1d.F90.in:58
    if (is_even_rank) then   ! pio_decomp_tests_1d.F90.in:59
      count(1) = VEC_LOCAL_SZ   ! pio_decomp_tests_1d.F90.in:60
    else   ! pio_decomp_tests_1d.F90.in:61
      count(1) = VEC_LOCAL_SZ + 1   ! pio_decomp_tests_1d.F90.in:62
    end if   ! pio_decomp_tests_1d.F90.in:63
    start(1) = ieven * VEC_LOCAL_SZ + iodd * (VEC_LOCAL_SZ + 1) + 1   ! pio_decomp_tests_1d.F90.in:64
  end if   ! pio_decomp_tests_1d.F90.in:65


END SUBROUTINE   ! pio_decomp_tests_1d.F90.in:67


! Get a block cyclic decomposition with multiple regions to write
! from a single proc
! # All procs have VEC_LOCAL_SZ elements starting at offset rank+1
!   and also starting at offset (size * VEC_LOCAL_SZ)
! e.g. For VEC_LOCAL_SZ = 2, NUM_REGIONS=2
! e.g. 1)    [1,2,7,8] [3,4,9,10] [5,6,11,12]
SUBROUTINE get_1d_bc_mreg_info(rank, sz, dims, start, count)   ! pio_decomp_tests_1d.F90.in:75
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_tests_1d.F90.in:76
  integer, parameter :: NUM_REGIONS = 3   ! pio_decomp_tests_1d.F90.in:77
  integer, intent(in) :: rank   ! pio_decomp_tests_1d.F90.in:78
  integer, intent(in) :: sz   ! pio_decomp_tests_1d.F90.in:79
  integer, dimension(1), intent(out) :: dims   ! pio_decomp_tests_1d.F90.in:80
  integer, dimension(:), allocatable, intent(out) :: start   ! pio_decomp_tests_1d.F90.in:81
  integer, dimension(:), allocatable, intent(out) :: count   ! pio_decomp_tests_1d.F90.in:82
  integer :: i   ! pio_decomp_tests_1d.F90.in:83


  dims(1) = sz * VEC_LOCAL_SZ * NUM_REGIONS   ! pio_decomp_tests_1d.F90.in:85
  allocate(start(NUM_REGIONS))   ! pio_decomp_tests_1d.F90.in:86
  allocate(count(NUM_REGIONS))   ! pio_decomp_tests_1d.F90.in:87




  do i=1,NUM_REGIONS   ! pio_decomp_tests_1d.F90.in:90
    count(i) = VEC_LOCAL_SZ   ! pio_decomp_tests_1d.F90.in:91
    start(i) = rank * VEC_LOCAL_SZ + (i-1) * (sz * VEC_LOCAL_SZ) + 1   ! pio_decomp_tests_1d.F90.in:92
  end do   ! pio_decomp_tests_1d.F90.in:93


END SUBROUTINE get_1d_bc_mreg_info   ! pio_decomp_tests_1d.F90.in:95


! Get a decomp that represents data in global reverse order
! i.e., rank i contains data corresponding to
!       (total_procs - i - 1)
! # All even procs have VEC_LOCAL_SZ elements
! # All odd procs have VEC_LOCAL_SZ + 1 elements
! e.g. For VEC_LOCAL_SZ = 2,
! e.g. 1)    [6,7] [3,4,5] [1,2]
! e.g. 2)    [8,9,10] [6,7] [3,4,5] [1,2]
! e.g. 3)    [11,12] [8,9,10] [6,7] [3,4,5] [1,2]
SUBROUTINE get_1d_rev_info(rank, sz, dims, start, count)   ! pio_decomp_tests_1d.F90.in:106
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_tests_1d.F90.in:107
  integer, intent(in) :: rank   ! pio_decomp_tests_1d.F90.in:108
  integer, intent(in) :: sz   ! pio_decomp_tests_1d.F90.in:109
  integer, dimension(1), intent(out) :: dims   ! pio_decomp_tests_1d.F90.in:110
  integer, dimension(1), intent(out) :: start   ! pio_decomp_tests_1d.F90.in:111
  integer, dimension(1), intent(out) :: count   ! pio_decomp_tests_1d.F90.in:112


  logical :: is_even_rank   ! pio_decomp_tests_1d.F90.in:114
  integer :: num_odd_procs, num_even_procs   ! pio_decomp_tests_1d.F90.in:115
  integer :: num_odd_procs_bfr_rank, num_even_procs_bfr_rank   ! pio_decomp_tests_1d.F90.in:116
  integer :: num_odd_procs_aftr_rank, num_even_procs_aftr_rank   ! pio_decomp_tests_1d.F90.in:117


  is_even_rank = .false.   ! pio_decomp_tests_1d.F90.in:119
  if (mod(rank, 2) == 0) then   ! pio_decomp_tests_1d.F90.in:120
    is_even_rank = .true.   ! pio_decomp_tests_1d.F90.in:121
  end if   ! pio_decomp_tests_1d.F90.in:122
  num_odd_procs = sz / 2   ! pio_decomp_tests_1d.F90.in:123
  num_even_procs = sz - num_odd_procs   ! pio_decomp_tests_1d.F90.in:124
  dims(1) = num_even_procs * VEC_LOCAL_SZ + num_odd_procs * (VEC_LOCAL_SZ + 1)   ! pio_decomp_tests_1d.F90.in:125


  num_odd_procs_bfr_rank = rank/2   ! pio_decomp_tests_1d.F90.in:127
  num_even_procs_bfr_rank = (rank + 1)/2   ! pio_decomp_tests_1d.F90.in:128
  if(is_even_rank) then   ! pio_decomp_tests_1d.F90.in:129
    num_odd_procs_aftr_rank = num_odd_procs - num_odd_procs_bfr_rank   ! pio_decomp_tests_1d.F90.in:130
    num_even_procs_aftr_rank = num_even_procs - num_even_procs_bfr_rank - 1   ! pio_decomp_tests_1d.F90.in:131
  else   ! pio_decomp_tests_1d.F90.in:132
    num_odd_procs_aftr_rank = num_odd_procs - num_odd_procs_bfr_rank - 1   ! pio_decomp_tests_1d.F90.in:133
    num_even_procs_aftr_rank = num_even_procs - num_even_procs_bfr_rank   ! pio_decomp_tests_1d.F90.in:134
  end if   ! pio_decomp_tests_1d.F90.in:135


  if (is_even_rank) then   ! pio_decomp_tests_1d.F90.in:137
    count(1) = VEC_LOCAL_SZ   ! pio_decomp_tests_1d.F90.in:138
  else   ! pio_decomp_tests_1d.F90.in:139
    count(1) = VEC_LOCAL_SZ + 1   ! pio_decomp_tests_1d.F90.in:140
  end if   ! pio_decomp_tests_1d.F90.in:141
  start(1) = num_even_procs_aftr_rank * VEC_LOCAL_SZ +&
              num_odd_procs_aftr_rank * (VEC_LOCAL_SZ + 1) + 1   ! pio_decomp_tests_1d.F90.in:143


END SUBROUTINE   ! pio_decomp_tests_1d.F90.in:145


! Get a 1d block decomposition with holes
! If has_hole is TRUE, the decomposition is such that
! # All even procs have VEC_LOCAL_SZ * 2 elements
! # (the even procs take all elems from the odd procs)
! # All odd procs have 0 elements
! e.g. For VEC_LOCAL_SZ = 2,
! e.g. 1)    [1,2,3,4] [] [5,6]
! e.g. 2)    [1,2,3,4] [] [5,6,7,8] []
! If has_hole is FALSE, the data is evenly divided among all procs
! e.g. For VEC_LOCAL_SZ = 2,
! e.g. 1)    [1,2] [3,4] [5,6]
! e.g. 2)    [1,2] [3,4] [5,6] [7,8]
SUBROUTINE get_1d_bc_with_holes_info(rank, sz, dims, start, count, has_hole)   ! pio_decomp_tests_1d.F90.in:159
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_tests_1d.F90.in:160
  integer, intent(in) :: rank   ! pio_decomp_tests_1d.F90.in:161
  integer, intent(in) :: sz   ! pio_decomp_tests_1d.F90.in:162
  integer, dimension(1), intent(out) :: dims   ! pio_decomp_tests_1d.F90.in:163
  integer, dimension(1), intent(out) :: start   ! pio_decomp_tests_1d.F90.in:164
  integer, dimension(1), intent(out) :: count   ! pio_decomp_tests_1d.F90.in:165
  logical, intent(in) :: has_hole   ! pio_decomp_tests_1d.F90.in:166


  logical :: is_even_rank   ! pio_decomp_tests_1d.F90.in:168
  integer :: num_odd_procs, num_even_procs   ! pio_decomp_tests_1d.F90.in:169
  integer :: iodd, ieven   ! pio_decomp_tests_1d.F90.in:170


  is_even_rank = .false.   ! pio_decomp_tests_1d.F90.in:172
  if (mod(rank, 2) == 0) then   ! pio_decomp_tests_1d.F90.in:173
    is_even_rank = .true.   ! pio_decomp_tests_1d.F90.in:174
  end if   ! pio_decomp_tests_1d.F90.in:175
  num_odd_procs = sz / 2   ! pio_decomp_tests_1d.F90.in:176
  num_even_procs = sz - num_odd_procs   ! pio_decomp_tests_1d.F90.in:177
  dims(1) = VEC_LOCAL_SZ * sz   ! pio_decomp_tests_1d.F90.in:178
  ! Number of odd and even procs before this rank
  iodd = rank / 2   ! pio_decomp_tests_1d.F90.in:180
  ieven = (rank + 1) / 2   ! pio_decomp_tests_1d.F90.in:181
  if(has_hole) then   ! pio_decomp_tests_1d.F90.in:182
    if (is_even_rank) then   ! pio_decomp_tests_1d.F90.in:183
      if(rank + 1 < sz) then   ! pio_decomp_tests_1d.F90.in:184
        count(1) = VEC_LOCAL_SZ * 2   ! pio_decomp_tests_1d.F90.in:185
      else   ! pio_decomp_tests_1d.F90.in:186
        count(1) = VEC_LOCAL_SZ   ! pio_decomp_tests_1d.F90.in:187
      end if   ! pio_decomp_tests_1d.F90.in:188
      start(1) = ieven * VEC_LOCAL_SZ * 2 + 1   ! pio_decomp_tests_1d.F90.in:189
    else   ! pio_decomp_tests_1d.F90.in:190
      count(1) = 0   ! pio_decomp_tests_1d.F90.in:191
      start(1) = 0   ! pio_decomp_tests_1d.F90.in:192
    end if   ! pio_decomp_tests_1d.F90.in:193
  else   ! pio_decomp_tests_1d.F90.in:194
    count(1) = VEC_LOCAL_SZ   ! pio_decomp_tests_1d.F90.in:195
    start(1) = ieven * VEC_LOCAL_SZ + iodd * (VEC_LOCAL_SZ) + 1   ! pio_decomp_tests_1d.F90.in:196
  end if   ! pio_decomp_tests_1d.F90.in:197


END SUBROUTINE   ! pio_decomp_tests_1d.F90.in:199


! Test block cyclic interface
! Write with one decomp and read with another
! Test all combs 
! - no rearrage read + no rearrange write
! - rearrage read + no rearrange write
! - no rearrage read + rearrange write
! - rearrage read + rearrange write


SUBROUTINE nc_wr_rd_1d_bc_PIO_int_integer__
USE pio_tutil
   ! pio_decomp_tests_1d.F90.in:209
  implicit none   ! pio_decomp_tests_1d.F90.in:210
  type(var_desc_t)  :: pio_var   ! pio_decomp_tests_1d.F90.in:211
  type(file_desc_t) :: pio_file   ! pio_decomp_tests_1d.F90.in:212
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_tests_1d.F90.in:213
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_tests_1d.F90.in:214
  type(io_desc_t) :: wr_iodesc, rd_iodesc   ! pio_decomp_tests_1d.F90.in:215
  integer, dimension(:), allocatable :: compdof   ! pio_decomp_tests_1d.F90.in:216
  integer, dimension(1) :: start, count   ! pio_decomp_tests_1d.F90.in:217
  integer, dimension(:), allocatable :: rbuf, wbuf, exp_val   ! pio_decomp_tests_1d.F90.in:218
  integer, dimension(1) :: dims   ! pio_decomp_tests_1d.F90.in:219
  integer :: pio_dim   ! pio_decomp_tests_1d.F90.in:220
  integer :: i, ierr, lsz   ! pio_decomp_tests_1d.F90.in:221
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests_1d.F90.in:223
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests_1d.F90.in:224
  integer :: num_iotypes   ! pio_decomp_tests_1d.F90.in:225
  logical, dimension(2) :: enable_rd_rearr = (/.false., .true./)   ! pio_decomp_tests_1d.F90.in:226
  integer :: rd_rearr_opt_idx   ! pio_decomp_tests_1d.F90.in:227
  logical, dimension(2) :: enable_wr_rearr = (/.false., .true./)   ! pio_decomp_tests_1d.F90.in:228
  integer :: wr_rearr_opt_idx   ! pio_decomp_tests_1d.F90.in:229
   ! pio_decomp_tests_1d.F90.in:230
  do rd_rearr_opt_idx=1,size(enable_rd_rearr)   ! pio_decomp_tests_1d.F90.in:231
    do wr_rearr_opt_idx=1,size(enable_wr_rearr)   ! pio_decomp_tests_1d.F90.in:232

      IF (pio_tf_world_rank_ == 0) THEN
        IF (pio_tf_log_level_ >= 0) THEN
          WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
          WRITE(*, *)  "Testing Rd rearr =", enable_rd_rearr(rd_rearr_opt_idx), ",Write rearr=", enable_wr_rearr(wr_rearr_opt_idx)
        END IF
      END IF   ! pio_decomp_tests_1d.F90.in:233
      ! Set the decomposition for writing data - forcing rearrangement
      call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_decomp_tests_1d.F90.in:235
             start, count, enable_wr_rearr(wr_rearr_opt_idx))   ! pio_decomp_tests_1d.F90.in:236
      allocate(wbuf(count(1)))   ! pio_decomp_tests_1d.F90.in:237
      allocate(compdof(count(1)))   ! pio_decomp_tests_1d.F90.in:238
      do i=1,count(1)   ! pio_decomp_tests_1d.F90.in:239
        wbuf(i) = start(1) + i - 1   ! pio_decomp_tests_1d.F90.in:240
        compdof(i) = start(1) + i - 1   ! pio_decomp_tests_1d.F90.in:241
      end do   ! pio_decomp_tests_1d.F90.in:242
   ! pio_decomp_tests_1d.F90.in:243
      call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof, wr_iodesc)   ! pio_decomp_tests_1d.F90.in:244
      deallocate(compdof)   ! pio_decomp_tests_1d.F90.in:245
   ! pio_decomp_tests_1d.F90.in:246
      ! Set the decomposition for reading data - different from the write decomp
      call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_decomp_tests_1d.F90.in:248
             start, count, enable_rd_rearr(rd_rearr_opt_idx))   ! pio_decomp_tests_1d.F90.in:249
      allocate(rbuf(count(1)))   ! pio_decomp_tests_1d.F90.in:250
      allocate(compdof(count(1)))   ! pio_decomp_tests_1d.F90.in:251
      allocate(exp_val(count(1)))   ! pio_decomp_tests_1d.F90.in:252
      do i=1,count(1)   ! pio_decomp_tests_1d.F90.in:253
        compdof(i) = start(1) + i -1   ! pio_decomp_tests_1d.F90.in:254
        ! Expected value, after reading, is the same as the compdof
        exp_val(i) = compdof(i)   ! pio_decomp_tests_1d.F90.in:256
      end do   ! pio_decomp_tests_1d.F90.in:257
   ! pio_decomp_tests_1d.F90.in:258
      call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof, rd_iodesc)   ! pio_decomp_tests_1d.F90.in:259
      deallocate(compdof)   ! pio_decomp_tests_1d.F90.in:260
   ! pio_decomp_tests_1d.F90.in:261
      num_iotypes = 0   ! pio_decomp_tests_1d.F90.in:262
      call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests_1d.F90.in:263
      filename = "test_pio_decomp_simple_tests.testfile"   ! pio_decomp_tests_1d.F90.in:264
      do i=1,num_iotypes   ! pio_decomp_tests_1d.F90.in:265

        IF (pio_tf_world_rank_ == 0) THEN
          IF (pio_tf_log_level_ >= 0) THEN
            WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
            WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
          END IF
        END IF   ! pio_decomp_tests_1d.F90.in:266
        ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_tests_1d.F90.in:267
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Could not create file " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:268)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:268
   ! pio_decomp_tests_1d.F90.in:269
        ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_tests_1d.F90.in:270
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Failed to define a dim : " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:271)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:271
   ! pio_decomp_tests_1d.F90.in:272
        ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_int, (/pio_dim/), pio_var)   ! pio_decomp_tests_1d.F90.in:273
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Failed to define a var : " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:274)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:274
   ! pio_decomp_tests_1d.F90.in:275
        ierr = PIO_enddef(pio_file)   ! pio_decomp_tests_1d.F90.in:276
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Failed to end redef mode : " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:277)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:277
   ! pio_decomp_tests_1d.F90.in:278
        ! Write the variable out
        call PIO_write_darray(pio_file, pio_var, wr_iodesc, wbuf, ierr)   ! pio_decomp_tests_1d.F90.in:280
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Failed to write darray : " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:281)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:281
   ! pio_decomp_tests_1d.F90.in:282
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
        call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:284
   ! pio_decomp_tests_1d.F90.in:285
        ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_tests_1d.F90.in:286
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Could not reopen file " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:287)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:287
   ! pio_decomp_tests_1d.F90.in:288
        ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_tests_1d.F90.in:289
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Could not inq var : " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:290)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:290
#else
        call PIO_syncfile(pio_file)   ! pio_decomp_tests_1d.F90.in:292
#endif
   ! pio_decomp_tests_1d.F90.in:294
        rbuf = 0   ! pio_decomp_tests_1d.F90.in:295
        call PIO_read_darray(pio_file, pio_var, rd_iodesc, rbuf, ierr)   ! pio_decomp_tests_1d.F90.in:296
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Failed to read darray : " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:297)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:297
   ! pio_decomp_tests_1d.F90.in:298
        
        IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Check failed:",&
               "Got wrong val",&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:299)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:299
   ! pio_decomp_tests_1d.F90.in:300
        call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:301
           ! pio_decomp_tests_1d.F90.in:302
        call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_decomp_tests_1d.F90.in:303
      end do   ! pio_decomp_tests_1d.F90.in:304
   ! pio_decomp_tests_1d.F90.in:305
      if(allocated(iotypes)) then   ! pio_decomp_tests_1d.F90.in:306
        deallocate(iotypes)   ! pio_decomp_tests_1d.F90.in:307
        deallocate(iotype_descs)   ! pio_decomp_tests_1d.F90.in:308
      end if   ! pio_decomp_tests_1d.F90.in:309
   ! pio_decomp_tests_1d.F90.in:310
      call PIO_freedecomp(pio_tf_iosystem_, rd_iodesc)   ! pio_decomp_tests_1d.F90.in:311
      call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_decomp_tests_1d.F90.in:312
      deallocate(exp_val)   ! pio_decomp_tests_1d.F90.in:313
      deallocate(rbuf)   ! pio_decomp_tests_1d.F90.in:314
      deallocate(wbuf)   ! pio_decomp_tests_1d.F90.in:315
    end do    ! pio_decomp_tests_1d.F90.in:316
  end do    ! pio_decomp_tests_1d.F90.in:317
END SUBROUTINE nc_wr_rd_1d_bc_PIO_int_integer__   ! pio_decomp_tests_1d.F90.in:318


SUBROUTINE nc_wr_rd_1d_bc_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_decomp_tests_1d.F90.in:209
  implicit none   ! pio_decomp_tests_1d.F90.in:210
  type(var_desc_t)  :: pio_var   ! pio_decomp_tests_1d.F90.in:211
  type(file_desc_t) :: pio_file   ! pio_decomp_tests_1d.F90.in:212
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_tests_1d.F90.in:213
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_tests_1d.F90.in:214
  type(io_desc_t) :: wr_iodesc, rd_iodesc   ! pio_decomp_tests_1d.F90.in:215
  integer, dimension(:), allocatable :: compdof   ! pio_decomp_tests_1d.F90.in:216
  integer, dimension(1) :: start, count   ! pio_decomp_tests_1d.F90.in:217
  real(kind=fc_real), dimension(:), allocatable :: rbuf, wbuf, exp_val   ! pio_decomp_tests_1d.F90.in:218
  integer, dimension(1) :: dims   ! pio_decomp_tests_1d.F90.in:219
  integer :: pio_dim   ! pio_decomp_tests_1d.F90.in:220
  integer :: i, ierr, lsz   ! pio_decomp_tests_1d.F90.in:221
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests_1d.F90.in:223
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests_1d.F90.in:224
  integer :: num_iotypes   ! pio_decomp_tests_1d.F90.in:225
  logical, dimension(2) :: enable_rd_rearr = (/.false., .true./)   ! pio_decomp_tests_1d.F90.in:226
  integer :: rd_rearr_opt_idx   ! pio_decomp_tests_1d.F90.in:227
  logical, dimension(2) :: enable_wr_rearr = (/.false., .true./)   ! pio_decomp_tests_1d.F90.in:228
  integer :: wr_rearr_opt_idx   ! pio_decomp_tests_1d.F90.in:229
   ! pio_decomp_tests_1d.F90.in:230
  do rd_rearr_opt_idx=1,size(enable_rd_rearr)   ! pio_decomp_tests_1d.F90.in:231
    do wr_rearr_opt_idx=1,size(enable_wr_rearr)   ! pio_decomp_tests_1d.F90.in:232

      IF (pio_tf_world_rank_ == 0) THEN
        IF (pio_tf_log_level_ >= 0) THEN
          WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
          WRITE(*, *)  "Testing Rd rearr =", enable_rd_rearr(rd_rearr_opt_idx), ",Write rearr=", enable_wr_rearr(wr_rearr_opt_idx)
        END IF
      END IF   ! pio_decomp_tests_1d.F90.in:233
      ! Set the decomposition for writing data - forcing rearrangement
      call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_decomp_tests_1d.F90.in:235
             start, count, enable_wr_rearr(wr_rearr_opt_idx))   ! pio_decomp_tests_1d.F90.in:236
      allocate(wbuf(count(1)))   ! pio_decomp_tests_1d.F90.in:237
      allocate(compdof(count(1)))   ! pio_decomp_tests_1d.F90.in:238
      do i=1,count(1)   ! pio_decomp_tests_1d.F90.in:239
        wbuf(i) = start(1) + i - 1   ! pio_decomp_tests_1d.F90.in:240
        compdof(i) = start(1) + i - 1   ! pio_decomp_tests_1d.F90.in:241
      end do   ! pio_decomp_tests_1d.F90.in:242
   ! pio_decomp_tests_1d.F90.in:243
      call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof, wr_iodesc)   ! pio_decomp_tests_1d.F90.in:244
      deallocate(compdof)   ! pio_decomp_tests_1d.F90.in:245
   ! pio_decomp_tests_1d.F90.in:246
      ! Set the decomposition for reading data - different from the write decomp
      call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_decomp_tests_1d.F90.in:248
             start, count, enable_rd_rearr(rd_rearr_opt_idx))   ! pio_decomp_tests_1d.F90.in:249
      allocate(rbuf(count(1)))   ! pio_decomp_tests_1d.F90.in:250
      allocate(compdof(count(1)))   ! pio_decomp_tests_1d.F90.in:251
      allocate(exp_val(count(1)))   ! pio_decomp_tests_1d.F90.in:252
      do i=1,count(1)   ! pio_decomp_tests_1d.F90.in:253
        compdof(i) = start(1) + i -1   ! pio_decomp_tests_1d.F90.in:254
        ! Expected value, after reading, is the same as the compdof
        exp_val(i) = compdof(i)   ! pio_decomp_tests_1d.F90.in:256
      end do   ! pio_decomp_tests_1d.F90.in:257
   ! pio_decomp_tests_1d.F90.in:258
      call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof, rd_iodesc)   ! pio_decomp_tests_1d.F90.in:259
      deallocate(compdof)   ! pio_decomp_tests_1d.F90.in:260
   ! pio_decomp_tests_1d.F90.in:261
      num_iotypes = 0   ! pio_decomp_tests_1d.F90.in:262
      call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests_1d.F90.in:263
      filename = "test_pio_decomp_simple_tests.testfile"   ! pio_decomp_tests_1d.F90.in:264
      do i=1,num_iotypes   ! pio_decomp_tests_1d.F90.in:265

        IF (pio_tf_world_rank_ == 0) THEN
          IF (pio_tf_log_level_ >= 0) THEN
            WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
            WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
          END IF
        END IF   ! pio_decomp_tests_1d.F90.in:266
        ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_tests_1d.F90.in:267
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Could not create file " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:268)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:268
   ! pio_decomp_tests_1d.F90.in:269
        ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_tests_1d.F90.in:270
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Failed to define a dim : " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:271)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:271
   ! pio_decomp_tests_1d.F90.in:272
        ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_real, (/pio_dim/), pio_var)   ! pio_decomp_tests_1d.F90.in:273
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Failed to define a var : " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:274)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:274
   ! pio_decomp_tests_1d.F90.in:275
        ierr = PIO_enddef(pio_file)   ! pio_decomp_tests_1d.F90.in:276
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Failed to end redef mode : " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:277)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:277
   ! pio_decomp_tests_1d.F90.in:278
        ! Write the variable out
        call PIO_write_darray(pio_file, pio_var, wr_iodesc, wbuf, ierr)   ! pio_decomp_tests_1d.F90.in:280
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Failed to write darray : " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:281)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:281
   ! pio_decomp_tests_1d.F90.in:282
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
        call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:284
   ! pio_decomp_tests_1d.F90.in:285
        ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_tests_1d.F90.in:286
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Could not reopen file " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:287)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:287
   ! pio_decomp_tests_1d.F90.in:288
        ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_tests_1d.F90.in:289
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Could not inq var : " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:290)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:290
#else
        call PIO_syncfile(pio_file)   ! pio_decomp_tests_1d.F90.in:292
#endif
   ! pio_decomp_tests_1d.F90.in:294
        rbuf = 0   ! pio_decomp_tests_1d.F90.in:295
        call PIO_read_darray(pio_file, pio_var, rd_iodesc, rbuf, ierr)   ! pio_decomp_tests_1d.F90.in:296
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Failed to read darray : " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:297)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:297
   ! pio_decomp_tests_1d.F90.in:298
        
        IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Check failed:",&
               "Got wrong val",&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:299)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:299
   ! pio_decomp_tests_1d.F90.in:300
        call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:301
           ! pio_decomp_tests_1d.F90.in:302
        call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_decomp_tests_1d.F90.in:303
      end do   ! pio_decomp_tests_1d.F90.in:304
   ! pio_decomp_tests_1d.F90.in:305
      if(allocated(iotypes)) then   ! pio_decomp_tests_1d.F90.in:306
        deallocate(iotypes)   ! pio_decomp_tests_1d.F90.in:307
        deallocate(iotype_descs)   ! pio_decomp_tests_1d.F90.in:308
      end if   ! pio_decomp_tests_1d.F90.in:309
   ! pio_decomp_tests_1d.F90.in:310
      call PIO_freedecomp(pio_tf_iosystem_, rd_iodesc)   ! pio_decomp_tests_1d.F90.in:311
      call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_decomp_tests_1d.F90.in:312
      deallocate(exp_val)   ! pio_decomp_tests_1d.F90.in:313
      deallocate(rbuf)   ! pio_decomp_tests_1d.F90.in:314
      deallocate(wbuf)   ! pio_decomp_tests_1d.F90.in:315
    end do    ! pio_decomp_tests_1d.F90.in:316
  end do    ! pio_decomp_tests_1d.F90.in:317
END SUBROUTINE nc_wr_rd_1d_bc_PIO_real_real_kind_fc_real___   ! pio_decomp_tests_1d.F90.in:318


SUBROUTINE nc_wr_rd_1d_bc_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_decomp_tests_1d.F90.in:209
  implicit none   ! pio_decomp_tests_1d.F90.in:210
  type(var_desc_t)  :: pio_var   ! pio_decomp_tests_1d.F90.in:211
  type(file_desc_t) :: pio_file   ! pio_decomp_tests_1d.F90.in:212
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_tests_1d.F90.in:213
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_tests_1d.F90.in:214
  type(io_desc_t) :: wr_iodesc, rd_iodesc   ! pio_decomp_tests_1d.F90.in:215
  integer, dimension(:), allocatable :: compdof   ! pio_decomp_tests_1d.F90.in:216
  integer, dimension(1) :: start, count   ! pio_decomp_tests_1d.F90.in:217
  real(kind=fc_double), dimension(:), allocatable :: rbuf, wbuf, exp_val   ! pio_decomp_tests_1d.F90.in:218
  integer, dimension(1) :: dims   ! pio_decomp_tests_1d.F90.in:219
  integer :: pio_dim   ! pio_decomp_tests_1d.F90.in:220
  integer :: i, ierr, lsz   ! pio_decomp_tests_1d.F90.in:221
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests_1d.F90.in:223
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests_1d.F90.in:224
  integer :: num_iotypes   ! pio_decomp_tests_1d.F90.in:225
  logical, dimension(2) :: enable_rd_rearr = (/.false., .true./)   ! pio_decomp_tests_1d.F90.in:226
  integer :: rd_rearr_opt_idx   ! pio_decomp_tests_1d.F90.in:227
  logical, dimension(2) :: enable_wr_rearr = (/.false., .true./)   ! pio_decomp_tests_1d.F90.in:228
  integer :: wr_rearr_opt_idx   ! pio_decomp_tests_1d.F90.in:229
   ! pio_decomp_tests_1d.F90.in:230
  do rd_rearr_opt_idx=1,size(enable_rd_rearr)   ! pio_decomp_tests_1d.F90.in:231
    do wr_rearr_opt_idx=1,size(enable_wr_rearr)   ! pio_decomp_tests_1d.F90.in:232

      IF (pio_tf_world_rank_ == 0) THEN
        IF (pio_tf_log_level_ >= 0) THEN
          WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
          WRITE(*, *)  "Testing Rd rearr =", enable_rd_rearr(rd_rearr_opt_idx), ",Write rearr=", enable_wr_rearr(wr_rearr_opt_idx)
        END IF
      END IF   ! pio_decomp_tests_1d.F90.in:233
      ! Set the decomposition for writing data - forcing rearrangement
      call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_decomp_tests_1d.F90.in:235
             start, count, enable_wr_rearr(wr_rearr_opt_idx))   ! pio_decomp_tests_1d.F90.in:236
      allocate(wbuf(count(1)))   ! pio_decomp_tests_1d.F90.in:237
      allocate(compdof(count(1)))   ! pio_decomp_tests_1d.F90.in:238
      do i=1,count(1)   ! pio_decomp_tests_1d.F90.in:239
        wbuf(i) = start(1) + i - 1   ! pio_decomp_tests_1d.F90.in:240
        compdof(i) = start(1) + i - 1   ! pio_decomp_tests_1d.F90.in:241
      end do   ! pio_decomp_tests_1d.F90.in:242
   ! pio_decomp_tests_1d.F90.in:243
      call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof, wr_iodesc)   ! pio_decomp_tests_1d.F90.in:244
      deallocate(compdof)   ! pio_decomp_tests_1d.F90.in:245
   ! pio_decomp_tests_1d.F90.in:246
      ! Set the decomposition for reading data - different from the write decomp
      call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_decomp_tests_1d.F90.in:248
             start, count, enable_rd_rearr(rd_rearr_opt_idx))   ! pio_decomp_tests_1d.F90.in:249
      allocate(rbuf(count(1)))   ! pio_decomp_tests_1d.F90.in:250
      allocate(compdof(count(1)))   ! pio_decomp_tests_1d.F90.in:251
      allocate(exp_val(count(1)))   ! pio_decomp_tests_1d.F90.in:252
      do i=1,count(1)   ! pio_decomp_tests_1d.F90.in:253
        compdof(i) = start(1) + i -1   ! pio_decomp_tests_1d.F90.in:254
        ! Expected value, after reading, is the same as the compdof
        exp_val(i) = compdof(i)   ! pio_decomp_tests_1d.F90.in:256
      end do   ! pio_decomp_tests_1d.F90.in:257
   ! pio_decomp_tests_1d.F90.in:258
      call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof, rd_iodesc)   ! pio_decomp_tests_1d.F90.in:259
      deallocate(compdof)   ! pio_decomp_tests_1d.F90.in:260
   ! pio_decomp_tests_1d.F90.in:261
      num_iotypes = 0   ! pio_decomp_tests_1d.F90.in:262
      call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests_1d.F90.in:263
      filename = "test_pio_decomp_simple_tests.testfile"   ! pio_decomp_tests_1d.F90.in:264
      do i=1,num_iotypes   ! pio_decomp_tests_1d.F90.in:265

        IF (pio_tf_world_rank_ == 0) THEN
          IF (pio_tf_log_level_ >= 0) THEN
            WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
            WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
          END IF
        END IF   ! pio_decomp_tests_1d.F90.in:266
        ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_tests_1d.F90.in:267
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Could not create file " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:268)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:268
   ! pio_decomp_tests_1d.F90.in:269
        ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_tests_1d.F90.in:270
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Failed to define a dim : " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:271)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:271
   ! pio_decomp_tests_1d.F90.in:272
        ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_double, (/pio_dim/), pio_var)   ! pio_decomp_tests_1d.F90.in:273
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Failed to define a var : " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:274)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:274
   ! pio_decomp_tests_1d.F90.in:275
        ierr = PIO_enddef(pio_file)   ! pio_decomp_tests_1d.F90.in:276
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Failed to end redef mode : " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:277)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:277
   ! pio_decomp_tests_1d.F90.in:278
        ! Write the variable out
        call PIO_write_darray(pio_file, pio_var, wr_iodesc, wbuf, ierr)   ! pio_decomp_tests_1d.F90.in:280
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Failed to write darray : " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:281)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:281
   ! pio_decomp_tests_1d.F90.in:282
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
        call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:284
   ! pio_decomp_tests_1d.F90.in:285
        ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_tests_1d.F90.in:286
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Could not reopen file " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:287)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:287
   ! pio_decomp_tests_1d.F90.in:288
        ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_tests_1d.F90.in:289
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Could not inq var : " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:290)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:290
#else
        call PIO_syncfile(pio_file)   ! pio_decomp_tests_1d.F90.in:292
#endif
   ! pio_decomp_tests_1d.F90.in:294
        rbuf = 0   ! pio_decomp_tests_1d.F90.in:295
        call PIO_read_darray(pio_file, pio_var, rd_iodesc, rbuf, ierr)   ! pio_decomp_tests_1d.F90.in:296
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Failed to read darray : " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:297)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:297
   ! pio_decomp_tests_1d.F90.in:298
        
        IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Check failed:",&
               "Got wrong val",&
              ":", __FILE__, ":", __LINE__,&
              "(pio_decomp_tests_1d.F90.in:299)"
          END IF
          RETURN
        END IF   ! pio_decomp_tests_1d.F90.in:299
   ! pio_decomp_tests_1d.F90.in:300
        call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:301
           ! pio_decomp_tests_1d.F90.in:302
        call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_decomp_tests_1d.F90.in:303
      end do   ! pio_decomp_tests_1d.F90.in:304
   ! pio_decomp_tests_1d.F90.in:305
      if(allocated(iotypes)) then   ! pio_decomp_tests_1d.F90.in:306
        deallocate(iotypes)   ! pio_decomp_tests_1d.F90.in:307
        deallocate(iotype_descs)   ! pio_decomp_tests_1d.F90.in:308
      end if   ! pio_decomp_tests_1d.F90.in:309
   ! pio_decomp_tests_1d.F90.in:310
      call PIO_freedecomp(pio_tf_iosystem_, rd_iodesc)   ! pio_decomp_tests_1d.F90.in:311
      call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_decomp_tests_1d.F90.in:312
      deallocate(exp_val)   ! pio_decomp_tests_1d.F90.in:313
      deallocate(rbuf)   ! pio_decomp_tests_1d.F90.in:314
      deallocate(wbuf)   ! pio_decomp_tests_1d.F90.in:315
    end do    ! pio_decomp_tests_1d.F90.in:316
  end do    ! pio_decomp_tests_1d.F90.in:317
END SUBROUTINE nc_wr_rd_1d_bc_PIO_double_real_kind_fc_double___   ! pio_decomp_tests_1d.F90.in:318
   ! pio_decomp_tests_1d.F90.in:318


! Test write/read of a variable where each proc writes/reads multiple regions
! of the data


SUBROUTINE nc_wr_rd_mreg_1d_bc_PIO_int_integer__
USE pio_tutil
   ! pio_decomp_tests_1d.F90.in:323
  implicit none   ! pio_decomp_tests_1d.F90.in:324
  interface   ! pio_decomp_tests_1d.F90.in:325
    subroutine get_1d_bc_mreg_info(rank, sz, dims, start, count)   ! pio_decomp_tests_1d.F90.in:326
      integer, intent(in) :: rank   ! pio_decomp_tests_1d.F90.in:327
      integer, intent(in) :: sz   ! pio_decomp_tests_1d.F90.in:328
      integer, dimension(1), intent(out) :: dims   ! pio_decomp_tests_1d.F90.in:329
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_decomp_tests_1d.F90.in:330
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_decomp_tests_1d.F90.in:331
    end subroutine get_1d_bc_mreg_info   ! pio_decomp_tests_1d.F90.in:332
  end interface   ! pio_decomp_tests_1d.F90.in:333
  type(var_desc_t)  :: pio_var   ! pio_decomp_tests_1d.F90.in:334
  type(file_desc_t) :: pio_file   ! pio_decomp_tests_1d.F90.in:335
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_tests_1d.F90.in:336
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_tests_1d.F90.in:337
  type(io_desc_t) :: iodesc   ! pio_decomp_tests_1d.F90.in:338
  integer, dimension(:), allocatable :: compdof   ! pio_decomp_tests_1d.F90.in:339
  integer, dimension(:), allocatable :: start, count   ! pio_decomp_tests_1d.F90.in:340
  integer :: total_count   ! pio_decomp_tests_1d.F90.in:341
  integer, dimension(:), allocatable :: rbuf, wbuf   ! pio_decomp_tests_1d.F90.in:342
  integer, dimension(1) :: dims   ! pio_decomp_tests_1d.F90.in:343
  integer :: pio_dim   ! pio_decomp_tests_1d.F90.in:344
  integer :: i, j, idx, ierr, lsz   ! pio_decomp_tests_1d.F90.in:345
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests_1d.F90.in:347
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests_1d.F90.in:348
  integer :: num_iotypes   ! pio_decomp_tests_1d.F90.in:349
   ! pio_decomp_tests_1d.F90.in:350
  call get_1d_bc_mreg_info(pio_tf_world_rank_, pio_tf_world_sz_,&   ! pio_decomp_tests_1d.F90.in:351
         dims, start, count)   ! pio_decomp_tests_1d.F90.in:352
  total_count = 0   ! pio_decomp_tests_1d.F90.in:353
  do i=1,size(count)   ! pio_decomp_tests_1d.F90.in:354
    total_count = total_count + count(i)    ! pio_decomp_tests_1d.F90.in:355
  end do   ! pio_decomp_tests_1d.F90.in:356
  allocate(wbuf(total_count))   ! pio_decomp_tests_1d.F90.in:357
  allocate(rbuf(total_count))   ! pio_decomp_tests_1d.F90.in:358
  allocate(compdof(total_count))   ! pio_decomp_tests_1d.F90.in:359
  do i=1,size(count)   ! pio_decomp_tests_1d.F90.in:360
    do j=1,count(i)   ! pio_decomp_tests_1d.F90.in:361
      idx = (i-1)*count(i) + j   ! pio_decomp_tests_1d.F90.in:362
      compdof(idx) = start(i) + j - 1   ! pio_decomp_tests_1d.F90.in:363
      wbuf(idx) = compdof(idx)   ! pio_decomp_tests_1d.F90.in:364
      rbuf(idx) = compdof(idx)   ! pio_decomp_tests_1d.F90.in:365
    end do   ! pio_decomp_tests_1d.F90.in:366
  end do   ! pio_decomp_tests_1d.F90.in:367
  if(allocated(start)) then   ! pio_decomp_tests_1d.F90.in:368
    deallocate(start)   ! pio_decomp_tests_1d.F90.in:369
  end if   ! pio_decomp_tests_1d.F90.in:370
  if(allocated(count)) then   ! pio_decomp_tests_1d.F90.in:371
    deallocate(count)   ! pio_decomp_tests_1d.F90.in:372
  end if   ! pio_decomp_tests_1d.F90.in:373
   ! pio_decomp_tests_1d.F90.in:374
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof, iodesc)   ! pio_decomp_tests_1d.F90.in:375
  deallocate(compdof)   ! pio_decomp_tests_1d.F90.in:376
   ! pio_decomp_tests_1d.F90.in:377
  num_iotypes = 0   ! pio_decomp_tests_1d.F90.in:378
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests_1d.F90.in:379
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_decomp_tests_1d.F90.in:380
  do i=1,num_iotypes   ! pio_decomp_tests_1d.F90.in:381

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_tests_1d.F90.in:382
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_tests_1d.F90.in:383
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:384)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:384
   ! pio_decomp_tests_1d.F90.in:385
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_tests_1d.F90.in:386
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:387)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:387
   ! pio_decomp_tests_1d.F90.in:388
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_int, (/pio_dim/), pio_var)   ! pio_decomp_tests_1d.F90.in:389
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:390)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:390
   ! pio_decomp_tests_1d.F90.in:391
    ierr = PIO_enddef(pio_file)   ! pio_decomp_tests_1d.F90.in:392
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:393)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:393
   ! pio_decomp_tests_1d.F90.in:394
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, iodesc, wbuf, ierr)   ! pio_decomp_tests_1d.F90.in:396
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:397)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:397
   ! pio_decomp_tests_1d.F90.in:398
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:400
   ! pio_decomp_tests_1d.F90.in:401
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_tests_1d.F90.in:402
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:403)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:403
   ! pio_decomp_tests_1d.F90.in:404
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_tests_1d.F90.in:405
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:406)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:406
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_tests_1d.F90.in:408
#endif
   ! pio_decomp_tests_1d.F90.in:410
    rbuf = 0   ! pio_decomp_tests_1d.F90.in:411
    call PIO_read_darray(pio_file, pio_var, iodesc, rbuf, ierr)   ! pio_decomp_tests_1d.F90.in:412
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:413)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:413
   ! pio_decomp_tests_1d.F90.in:414
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:415)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:415
   ! pio_decomp_tests_1d.F90.in:416
    call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:417
       ! pio_decomp_tests_1d.F90.in:418
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_decomp_tests_1d.F90.in:419
  end do   ! pio_decomp_tests_1d.F90.in:420
   ! pio_decomp_tests_1d.F90.in:421
  if(allocated(iotypes)) then   ! pio_decomp_tests_1d.F90.in:422
    deallocate(iotypes)   ! pio_decomp_tests_1d.F90.in:423
    deallocate(iotype_descs)   ! pio_decomp_tests_1d.F90.in:424
  end if   ! pio_decomp_tests_1d.F90.in:425
   ! pio_decomp_tests_1d.F90.in:426
  call PIO_freedecomp(pio_tf_iosystem_, iodesc)   ! pio_decomp_tests_1d.F90.in:427
  deallocate(rbuf)   ! pio_decomp_tests_1d.F90.in:428
  deallocate(wbuf)   ! pio_decomp_tests_1d.F90.in:429
END SUBROUTINE nc_wr_rd_mreg_1d_bc_PIO_int_integer__   ! pio_decomp_tests_1d.F90.in:430


SUBROUTINE nc_wr_rd_mreg_1d_bc_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_decomp_tests_1d.F90.in:323
  implicit none   ! pio_decomp_tests_1d.F90.in:324
  interface   ! pio_decomp_tests_1d.F90.in:325
    subroutine get_1d_bc_mreg_info(rank, sz, dims, start, count)   ! pio_decomp_tests_1d.F90.in:326
      integer, intent(in) :: rank   ! pio_decomp_tests_1d.F90.in:327
      integer, intent(in) :: sz   ! pio_decomp_tests_1d.F90.in:328
      integer, dimension(1), intent(out) :: dims   ! pio_decomp_tests_1d.F90.in:329
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_decomp_tests_1d.F90.in:330
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_decomp_tests_1d.F90.in:331
    end subroutine get_1d_bc_mreg_info   ! pio_decomp_tests_1d.F90.in:332
  end interface   ! pio_decomp_tests_1d.F90.in:333
  type(var_desc_t)  :: pio_var   ! pio_decomp_tests_1d.F90.in:334
  type(file_desc_t) :: pio_file   ! pio_decomp_tests_1d.F90.in:335
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_tests_1d.F90.in:336
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_tests_1d.F90.in:337
  type(io_desc_t) :: iodesc   ! pio_decomp_tests_1d.F90.in:338
  integer, dimension(:), allocatable :: compdof   ! pio_decomp_tests_1d.F90.in:339
  integer, dimension(:), allocatable :: start, count   ! pio_decomp_tests_1d.F90.in:340
  integer :: total_count   ! pio_decomp_tests_1d.F90.in:341
  real(kind=fc_real), dimension(:), allocatable :: rbuf, wbuf   ! pio_decomp_tests_1d.F90.in:342
  integer, dimension(1) :: dims   ! pio_decomp_tests_1d.F90.in:343
  integer :: pio_dim   ! pio_decomp_tests_1d.F90.in:344
  integer :: i, j, idx, ierr, lsz   ! pio_decomp_tests_1d.F90.in:345
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests_1d.F90.in:347
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests_1d.F90.in:348
  integer :: num_iotypes   ! pio_decomp_tests_1d.F90.in:349
   ! pio_decomp_tests_1d.F90.in:350
  call get_1d_bc_mreg_info(pio_tf_world_rank_, pio_tf_world_sz_,&   ! pio_decomp_tests_1d.F90.in:351
         dims, start, count)   ! pio_decomp_tests_1d.F90.in:352
  total_count = 0   ! pio_decomp_tests_1d.F90.in:353
  do i=1,size(count)   ! pio_decomp_tests_1d.F90.in:354
    total_count = total_count + count(i)    ! pio_decomp_tests_1d.F90.in:355
  end do   ! pio_decomp_tests_1d.F90.in:356
  allocate(wbuf(total_count))   ! pio_decomp_tests_1d.F90.in:357
  allocate(rbuf(total_count))   ! pio_decomp_tests_1d.F90.in:358
  allocate(compdof(total_count))   ! pio_decomp_tests_1d.F90.in:359
  do i=1,size(count)   ! pio_decomp_tests_1d.F90.in:360
    do j=1,count(i)   ! pio_decomp_tests_1d.F90.in:361
      idx = (i-1)*count(i) + j   ! pio_decomp_tests_1d.F90.in:362
      compdof(idx) = start(i) + j - 1   ! pio_decomp_tests_1d.F90.in:363
      wbuf(idx) = compdof(idx)   ! pio_decomp_tests_1d.F90.in:364
      rbuf(idx) = compdof(idx)   ! pio_decomp_tests_1d.F90.in:365
    end do   ! pio_decomp_tests_1d.F90.in:366
  end do   ! pio_decomp_tests_1d.F90.in:367
  if(allocated(start)) then   ! pio_decomp_tests_1d.F90.in:368
    deallocate(start)   ! pio_decomp_tests_1d.F90.in:369
  end if   ! pio_decomp_tests_1d.F90.in:370
  if(allocated(count)) then   ! pio_decomp_tests_1d.F90.in:371
    deallocate(count)   ! pio_decomp_tests_1d.F90.in:372
  end if   ! pio_decomp_tests_1d.F90.in:373
   ! pio_decomp_tests_1d.F90.in:374
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof, iodesc)   ! pio_decomp_tests_1d.F90.in:375
  deallocate(compdof)   ! pio_decomp_tests_1d.F90.in:376
   ! pio_decomp_tests_1d.F90.in:377
  num_iotypes = 0   ! pio_decomp_tests_1d.F90.in:378
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests_1d.F90.in:379
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_decomp_tests_1d.F90.in:380
  do i=1,num_iotypes   ! pio_decomp_tests_1d.F90.in:381

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_tests_1d.F90.in:382
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_tests_1d.F90.in:383
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:384)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:384
   ! pio_decomp_tests_1d.F90.in:385
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_tests_1d.F90.in:386
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:387)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:387
   ! pio_decomp_tests_1d.F90.in:388
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_real, (/pio_dim/), pio_var)   ! pio_decomp_tests_1d.F90.in:389
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:390)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:390
   ! pio_decomp_tests_1d.F90.in:391
    ierr = PIO_enddef(pio_file)   ! pio_decomp_tests_1d.F90.in:392
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:393)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:393
   ! pio_decomp_tests_1d.F90.in:394
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, iodesc, wbuf, ierr)   ! pio_decomp_tests_1d.F90.in:396
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:397)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:397
   ! pio_decomp_tests_1d.F90.in:398
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:400
   ! pio_decomp_tests_1d.F90.in:401
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_tests_1d.F90.in:402
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:403)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:403
   ! pio_decomp_tests_1d.F90.in:404
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_tests_1d.F90.in:405
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:406)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:406
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_tests_1d.F90.in:408
#endif
   ! pio_decomp_tests_1d.F90.in:410
    rbuf = 0   ! pio_decomp_tests_1d.F90.in:411
    call PIO_read_darray(pio_file, pio_var, iodesc, rbuf, ierr)   ! pio_decomp_tests_1d.F90.in:412
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:413)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:413
   ! pio_decomp_tests_1d.F90.in:414
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:415)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:415
   ! pio_decomp_tests_1d.F90.in:416
    call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:417
       ! pio_decomp_tests_1d.F90.in:418
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_decomp_tests_1d.F90.in:419
  end do   ! pio_decomp_tests_1d.F90.in:420
   ! pio_decomp_tests_1d.F90.in:421
  if(allocated(iotypes)) then   ! pio_decomp_tests_1d.F90.in:422
    deallocate(iotypes)   ! pio_decomp_tests_1d.F90.in:423
    deallocate(iotype_descs)   ! pio_decomp_tests_1d.F90.in:424
  end if   ! pio_decomp_tests_1d.F90.in:425
   ! pio_decomp_tests_1d.F90.in:426
  call PIO_freedecomp(pio_tf_iosystem_, iodesc)   ! pio_decomp_tests_1d.F90.in:427
  deallocate(rbuf)   ! pio_decomp_tests_1d.F90.in:428
  deallocate(wbuf)   ! pio_decomp_tests_1d.F90.in:429
END SUBROUTINE nc_wr_rd_mreg_1d_bc_PIO_real_real_kind_fc_real___   ! pio_decomp_tests_1d.F90.in:430


SUBROUTINE nc_wr_rd_mreg_1d_bc_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_decomp_tests_1d.F90.in:323
  implicit none   ! pio_decomp_tests_1d.F90.in:324
  interface   ! pio_decomp_tests_1d.F90.in:325
    subroutine get_1d_bc_mreg_info(rank, sz, dims, start, count)   ! pio_decomp_tests_1d.F90.in:326
      integer, intent(in) :: rank   ! pio_decomp_tests_1d.F90.in:327
      integer, intent(in) :: sz   ! pio_decomp_tests_1d.F90.in:328
      integer, dimension(1), intent(out) :: dims   ! pio_decomp_tests_1d.F90.in:329
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_decomp_tests_1d.F90.in:330
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_decomp_tests_1d.F90.in:331
    end subroutine get_1d_bc_mreg_info   ! pio_decomp_tests_1d.F90.in:332
  end interface   ! pio_decomp_tests_1d.F90.in:333
  type(var_desc_t)  :: pio_var   ! pio_decomp_tests_1d.F90.in:334
  type(file_desc_t) :: pio_file   ! pio_decomp_tests_1d.F90.in:335
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_tests_1d.F90.in:336
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_tests_1d.F90.in:337
  type(io_desc_t) :: iodesc   ! pio_decomp_tests_1d.F90.in:338
  integer, dimension(:), allocatable :: compdof   ! pio_decomp_tests_1d.F90.in:339
  integer, dimension(:), allocatable :: start, count   ! pio_decomp_tests_1d.F90.in:340
  integer :: total_count   ! pio_decomp_tests_1d.F90.in:341
  real(kind=fc_double), dimension(:), allocatable :: rbuf, wbuf   ! pio_decomp_tests_1d.F90.in:342
  integer, dimension(1) :: dims   ! pio_decomp_tests_1d.F90.in:343
  integer :: pio_dim   ! pio_decomp_tests_1d.F90.in:344
  integer :: i, j, idx, ierr, lsz   ! pio_decomp_tests_1d.F90.in:345
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests_1d.F90.in:347
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests_1d.F90.in:348
  integer :: num_iotypes   ! pio_decomp_tests_1d.F90.in:349
   ! pio_decomp_tests_1d.F90.in:350
  call get_1d_bc_mreg_info(pio_tf_world_rank_, pio_tf_world_sz_,&   ! pio_decomp_tests_1d.F90.in:351
         dims, start, count)   ! pio_decomp_tests_1d.F90.in:352
  total_count = 0   ! pio_decomp_tests_1d.F90.in:353
  do i=1,size(count)   ! pio_decomp_tests_1d.F90.in:354
    total_count = total_count + count(i)    ! pio_decomp_tests_1d.F90.in:355
  end do   ! pio_decomp_tests_1d.F90.in:356
  allocate(wbuf(total_count))   ! pio_decomp_tests_1d.F90.in:357
  allocate(rbuf(total_count))   ! pio_decomp_tests_1d.F90.in:358
  allocate(compdof(total_count))   ! pio_decomp_tests_1d.F90.in:359
  do i=1,size(count)   ! pio_decomp_tests_1d.F90.in:360
    do j=1,count(i)   ! pio_decomp_tests_1d.F90.in:361
      idx = (i-1)*count(i) + j   ! pio_decomp_tests_1d.F90.in:362
      compdof(idx) = start(i) + j - 1   ! pio_decomp_tests_1d.F90.in:363
      wbuf(idx) = compdof(idx)   ! pio_decomp_tests_1d.F90.in:364
      rbuf(idx) = compdof(idx)   ! pio_decomp_tests_1d.F90.in:365
    end do   ! pio_decomp_tests_1d.F90.in:366
  end do   ! pio_decomp_tests_1d.F90.in:367
  if(allocated(start)) then   ! pio_decomp_tests_1d.F90.in:368
    deallocate(start)   ! pio_decomp_tests_1d.F90.in:369
  end if   ! pio_decomp_tests_1d.F90.in:370
  if(allocated(count)) then   ! pio_decomp_tests_1d.F90.in:371
    deallocate(count)   ! pio_decomp_tests_1d.F90.in:372
  end if   ! pio_decomp_tests_1d.F90.in:373
   ! pio_decomp_tests_1d.F90.in:374
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof, iodesc)   ! pio_decomp_tests_1d.F90.in:375
  deallocate(compdof)   ! pio_decomp_tests_1d.F90.in:376
   ! pio_decomp_tests_1d.F90.in:377
  num_iotypes = 0   ! pio_decomp_tests_1d.F90.in:378
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests_1d.F90.in:379
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_decomp_tests_1d.F90.in:380
  do i=1,num_iotypes   ! pio_decomp_tests_1d.F90.in:381

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_tests_1d.F90.in:382
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_tests_1d.F90.in:383
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:384)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:384
   ! pio_decomp_tests_1d.F90.in:385
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_tests_1d.F90.in:386
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:387)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:387
   ! pio_decomp_tests_1d.F90.in:388
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_double, (/pio_dim/), pio_var)   ! pio_decomp_tests_1d.F90.in:389
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:390)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:390
   ! pio_decomp_tests_1d.F90.in:391
    ierr = PIO_enddef(pio_file)   ! pio_decomp_tests_1d.F90.in:392
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:393)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:393
   ! pio_decomp_tests_1d.F90.in:394
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, iodesc, wbuf, ierr)   ! pio_decomp_tests_1d.F90.in:396
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:397)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:397
   ! pio_decomp_tests_1d.F90.in:398
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:400
   ! pio_decomp_tests_1d.F90.in:401
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_tests_1d.F90.in:402
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:403)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:403
   ! pio_decomp_tests_1d.F90.in:404
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_tests_1d.F90.in:405
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:406)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:406
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_tests_1d.F90.in:408
#endif
   ! pio_decomp_tests_1d.F90.in:410
    rbuf = 0   ! pio_decomp_tests_1d.F90.in:411
    call PIO_read_darray(pio_file, pio_var, iodesc, rbuf, ierr)   ! pio_decomp_tests_1d.F90.in:412
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:413)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:413
   ! pio_decomp_tests_1d.F90.in:414
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:415)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:415
   ! pio_decomp_tests_1d.F90.in:416
    call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:417
       ! pio_decomp_tests_1d.F90.in:418
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_decomp_tests_1d.F90.in:419
  end do   ! pio_decomp_tests_1d.F90.in:420
   ! pio_decomp_tests_1d.F90.in:421
  if(allocated(iotypes)) then   ! pio_decomp_tests_1d.F90.in:422
    deallocate(iotypes)   ! pio_decomp_tests_1d.F90.in:423
    deallocate(iotype_descs)   ! pio_decomp_tests_1d.F90.in:424
  end if   ! pio_decomp_tests_1d.F90.in:425
   ! pio_decomp_tests_1d.F90.in:426
  call PIO_freedecomp(pio_tf_iosystem_, iodesc)   ! pio_decomp_tests_1d.F90.in:427
  deallocate(rbuf)   ! pio_decomp_tests_1d.F90.in:428
  deallocate(wbuf)   ! pio_decomp_tests_1d.F90.in:429
END SUBROUTINE nc_wr_rd_mreg_1d_bc_PIO_double_real_kind_fc_double___   ! pio_decomp_tests_1d.F90.in:430
   ! pio_decomp_tests_1d.F90.in:430




SUBROUTINE nc_wr_1d_bc_with_holes_PIO_int_integer__
USE pio_tutil
   ! pio_decomp_tests_1d.F90.in:433
  implicit none   ! pio_decomp_tests_1d.F90.in:434
  type(var_desc_t)  :: pio_var   ! pio_decomp_tests_1d.F90.in:435
  type(file_desc_t) :: pio_file   ! pio_decomp_tests_1d.F90.in:436
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_tests_1d.F90.in:437
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_tests_1d.F90.in:438
  type(io_desc_t) :: wr_iodesc   ! pio_decomp_tests_1d.F90.in:439
  integer, dimension(:), allocatable :: compdof   ! pio_decomp_tests_1d.F90.in:440
  integer, dimension(1) :: start, count   ! pio_decomp_tests_1d.F90.in:441
  integer, dimension(:), allocatable :: rbuf, wbuf, exp_val   ! pio_decomp_tests_1d.F90.in:442
  integer, dimension(1) :: dims   ! pio_decomp_tests_1d.F90.in:443
  integer :: pio_dim   ! pio_decomp_tests_1d.F90.in:444
  integer :: i, ierr, lsz   ! pio_decomp_tests_1d.F90.in:445
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests_1d.F90.in:447
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests_1d.F90.in:448
  integer :: num_iotypes   ! pio_decomp_tests_1d.F90.in:449
   ! pio_decomp_tests_1d.F90.in:450
  ! Set the decomposition for writing data - has holes
  call get_1d_bc_with_holes_info(pio_tf_world_rank_, pio_tf_world_sz_, dims, start, count, .true.)   ! pio_decomp_tests_1d.F90.in:452
  allocate(wbuf(count(1)))   ! pio_decomp_tests_1d.F90.in:453
  allocate(rbuf(count(1)))   ! pio_decomp_tests_1d.F90.in:454
  allocate(compdof(count(1)))   ! pio_decomp_tests_1d.F90.in:455
  allocate(exp_val(count(1)))   ! pio_decomp_tests_1d.F90.in:456
  do i=1,count(1)   ! pio_decomp_tests_1d.F90.in:457
    wbuf(i) = start(1) + i - 1   ! pio_decomp_tests_1d.F90.in:458
    compdof(i) = wbuf(i)   ! pio_decomp_tests_1d.F90.in:459
    exp_val(i) = wbuf(i)   ! pio_decomp_tests_1d.F90.in:460
  end do   ! pio_decomp_tests_1d.F90.in:461
   ! pio_decomp_tests_1d.F90.in:462
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof, wr_iodesc)   ! pio_decomp_tests_1d.F90.in:463
  deallocate(compdof)   ! pio_decomp_tests_1d.F90.in:464
   ! pio_decomp_tests_1d.F90.in:465
  num_iotypes = 0   ! pio_decomp_tests_1d.F90.in:466
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests_1d.F90.in:467
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_decomp_tests_1d.F90.in:468
  do i=1,num_iotypes   ! pio_decomp_tests_1d.F90.in:469

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_tests_1d.F90.in:470
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_tests_1d.F90.in:471
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:472)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:472
   ! pio_decomp_tests_1d.F90.in:473
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_tests_1d.F90.in:474
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:475)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:475
   ! pio_decomp_tests_1d.F90.in:476
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_int, (/pio_dim/), pio_var)   ! pio_decomp_tests_1d.F90.in:477
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:478)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:478
   ! pio_decomp_tests_1d.F90.in:479
    ierr = PIO_enddef(pio_file)   ! pio_decomp_tests_1d.F90.in:480
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:481)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:481
   ! pio_decomp_tests_1d.F90.in:482
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, wr_iodesc, wbuf, ierr)   ! pio_decomp_tests_1d.F90.in:484
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:485)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:485
   ! pio_decomp_tests_1d.F90.in:486
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:488
   ! pio_decomp_tests_1d.F90.in:489
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_tests_1d.F90.in:490
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:491)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:491
   ! pio_decomp_tests_1d.F90.in:492
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_tests_1d.F90.in:493
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:494)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:494
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_tests_1d.F90.in:496
#endif
   ! pio_decomp_tests_1d.F90.in:498
    call PIO_read_darray(pio_file, pio_var, wr_iodesc, rbuf, ierr)   ! pio_decomp_tests_1d.F90.in:499
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:500)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:500
   ! pio_decomp_tests_1d.F90.in:501
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:502)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:502
   ! pio_decomp_tests_1d.F90.in:503
    call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:504
       ! pio_decomp_tests_1d.F90.in:505
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_decomp_tests_1d.F90.in:506
  end do   ! pio_decomp_tests_1d.F90.in:507
   ! pio_decomp_tests_1d.F90.in:508
  if(allocated(iotypes)) then   ! pio_decomp_tests_1d.F90.in:509
    deallocate(iotypes)   ! pio_decomp_tests_1d.F90.in:510
    deallocate(iotype_descs)   ! pio_decomp_tests_1d.F90.in:511
  end if   ! pio_decomp_tests_1d.F90.in:512
   ! pio_decomp_tests_1d.F90.in:513
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_decomp_tests_1d.F90.in:514
  deallocate(exp_val)   ! pio_decomp_tests_1d.F90.in:515
  deallocate(rbuf)   ! pio_decomp_tests_1d.F90.in:516
  deallocate(wbuf)   ! pio_decomp_tests_1d.F90.in:517
END SUBROUTINE nc_wr_1d_bc_with_holes_PIO_int_integer__   ! pio_decomp_tests_1d.F90.in:518


SUBROUTINE nc_wr_1d_bc_with_holes_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_decomp_tests_1d.F90.in:433
  implicit none   ! pio_decomp_tests_1d.F90.in:434
  type(var_desc_t)  :: pio_var   ! pio_decomp_tests_1d.F90.in:435
  type(file_desc_t) :: pio_file   ! pio_decomp_tests_1d.F90.in:436
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_tests_1d.F90.in:437
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_tests_1d.F90.in:438
  type(io_desc_t) :: wr_iodesc   ! pio_decomp_tests_1d.F90.in:439
  integer, dimension(:), allocatable :: compdof   ! pio_decomp_tests_1d.F90.in:440
  integer, dimension(1) :: start, count   ! pio_decomp_tests_1d.F90.in:441
  real(kind=fc_real), dimension(:), allocatable :: rbuf, wbuf, exp_val   ! pio_decomp_tests_1d.F90.in:442
  integer, dimension(1) :: dims   ! pio_decomp_tests_1d.F90.in:443
  integer :: pio_dim   ! pio_decomp_tests_1d.F90.in:444
  integer :: i, ierr, lsz   ! pio_decomp_tests_1d.F90.in:445
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests_1d.F90.in:447
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests_1d.F90.in:448
  integer :: num_iotypes   ! pio_decomp_tests_1d.F90.in:449
   ! pio_decomp_tests_1d.F90.in:450
  ! Set the decomposition for writing data - has holes
  call get_1d_bc_with_holes_info(pio_tf_world_rank_, pio_tf_world_sz_, dims, start, count, .true.)   ! pio_decomp_tests_1d.F90.in:452
  allocate(wbuf(count(1)))   ! pio_decomp_tests_1d.F90.in:453
  allocate(rbuf(count(1)))   ! pio_decomp_tests_1d.F90.in:454
  allocate(compdof(count(1)))   ! pio_decomp_tests_1d.F90.in:455
  allocate(exp_val(count(1)))   ! pio_decomp_tests_1d.F90.in:456
  do i=1,count(1)   ! pio_decomp_tests_1d.F90.in:457
    wbuf(i) = start(1) + i - 1   ! pio_decomp_tests_1d.F90.in:458
    compdof(i) = wbuf(i)   ! pio_decomp_tests_1d.F90.in:459
    exp_val(i) = wbuf(i)   ! pio_decomp_tests_1d.F90.in:460
  end do   ! pio_decomp_tests_1d.F90.in:461
   ! pio_decomp_tests_1d.F90.in:462
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof, wr_iodesc)   ! pio_decomp_tests_1d.F90.in:463
  deallocate(compdof)   ! pio_decomp_tests_1d.F90.in:464
   ! pio_decomp_tests_1d.F90.in:465
  num_iotypes = 0   ! pio_decomp_tests_1d.F90.in:466
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests_1d.F90.in:467
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_decomp_tests_1d.F90.in:468
  do i=1,num_iotypes   ! pio_decomp_tests_1d.F90.in:469

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_tests_1d.F90.in:470
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_tests_1d.F90.in:471
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:472)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:472
   ! pio_decomp_tests_1d.F90.in:473
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_tests_1d.F90.in:474
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:475)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:475
   ! pio_decomp_tests_1d.F90.in:476
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_real, (/pio_dim/), pio_var)   ! pio_decomp_tests_1d.F90.in:477
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:478)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:478
   ! pio_decomp_tests_1d.F90.in:479
    ierr = PIO_enddef(pio_file)   ! pio_decomp_tests_1d.F90.in:480
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:481)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:481
   ! pio_decomp_tests_1d.F90.in:482
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, wr_iodesc, wbuf, ierr)   ! pio_decomp_tests_1d.F90.in:484
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:485)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:485
   ! pio_decomp_tests_1d.F90.in:486
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:488
   ! pio_decomp_tests_1d.F90.in:489
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_tests_1d.F90.in:490
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:491)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:491
   ! pio_decomp_tests_1d.F90.in:492
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_tests_1d.F90.in:493
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:494)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:494
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_tests_1d.F90.in:496
#endif
   ! pio_decomp_tests_1d.F90.in:498
    call PIO_read_darray(pio_file, pio_var, wr_iodesc, rbuf, ierr)   ! pio_decomp_tests_1d.F90.in:499
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:500)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:500
   ! pio_decomp_tests_1d.F90.in:501
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:502)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:502
   ! pio_decomp_tests_1d.F90.in:503
    call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:504
       ! pio_decomp_tests_1d.F90.in:505
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_decomp_tests_1d.F90.in:506
  end do   ! pio_decomp_tests_1d.F90.in:507
   ! pio_decomp_tests_1d.F90.in:508
  if(allocated(iotypes)) then   ! pio_decomp_tests_1d.F90.in:509
    deallocate(iotypes)   ! pio_decomp_tests_1d.F90.in:510
    deallocate(iotype_descs)   ! pio_decomp_tests_1d.F90.in:511
  end if   ! pio_decomp_tests_1d.F90.in:512
   ! pio_decomp_tests_1d.F90.in:513
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_decomp_tests_1d.F90.in:514
  deallocate(exp_val)   ! pio_decomp_tests_1d.F90.in:515
  deallocate(rbuf)   ! pio_decomp_tests_1d.F90.in:516
  deallocate(wbuf)   ! pio_decomp_tests_1d.F90.in:517
END SUBROUTINE nc_wr_1d_bc_with_holes_PIO_real_real_kind_fc_real___   ! pio_decomp_tests_1d.F90.in:518


SUBROUTINE nc_wr_1d_bc_with_holes_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_decomp_tests_1d.F90.in:433
  implicit none   ! pio_decomp_tests_1d.F90.in:434
  type(var_desc_t)  :: pio_var   ! pio_decomp_tests_1d.F90.in:435
  type(file_desc_t) :: pio_file   ! pio_decomp_tests_1d.F90.in:436
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_tests_1d.F90.in:437
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_tests_1d.F90.in:438
  type(io_desc_t) :: wr_iodesc   ! pio_decomp_tests_1d.F90.in:439
  integer, dimension(:), allocatable :: compdof   ! pio_decomp_tests_1d.F90.in:440
  integer, dimension(1) :: start, count   ! pio_decomp_tests_1d.F90.in:441
  real(kind=fc_double), dimension(:), allocatable :: rbuf, wbuf, exp_val   ! pio_decomp_tests_1d.F90.in:442
  integer, dimension(1) :: dims   ! pio_decomp_tests_1d.F90.in:443
  integer :: pio_dim   ! pio_decomp_tests_1d.F90.in:444
  integer :: i, ierr, lsz   ! pio_decomp_tests_1d.F90.in:445
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests_1d.F90.in:447
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests_1d.F90.in:448
  integer :: num_iotypes   ! pio_decomp_tests_1d.F90.in:449
   ! pio_decomp_tests_1d.F90.in:450
  ! Set the decomposition for writing data - has holes
  call get_1d_bc_with_holes_info(pio_tf_world_rank_, pio_tf_world_sz_, dims, start, count, .true.)   ! pio_decomp_tests_1d.F90.in:452
  allocate(wbuf(count(1)))   ! pio_decomp_tests_1d.F90.in:453
  allocate(rbuf(count(1)))   ! pio_decomp_tests_1d.F90.in:454
  allocate(compdof(count(1)))   ! pio_decomp_tests_1d.F90.in:455
  allocate(exp_val(count(1)))   ! pio_decomp_tests_1d.F90.in:456
  do i=1,count(1)   ! pio_decomp_tests_1d.F90.in:457
    wbuf(i) = start(1) + i - 1   ! pio_decomp_tests_1d.F90.in:458
    compdof(i) = wbuf(i)   ! pio_decomp_tests_1d.F90.in:459
    exp_val(i) = wbuf(i)   ! pio_decomp_tests_1d.F90.in:460
  end do   ! pio_decomp_tests_1d.F90.in:461
   ! pio_decomp_tests_1d.F90.in:462
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof, wr_iodesc)   ! pio_decomp_tests_1d.F90.in:463
  deallocate(compdof)   ! pio_decomp_tests_1d.F90.in:464
   ! pio_decomp_tests_1d.F90.in:465
  num_iotypes = 0   ! pio_decomp_tests_1d.F90.in:466
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests_1d.F90.in:467
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_decomp_tests_1d.F90.in:468
  do i=1,num_iotypes   ! pio_decomp_tests_1d.F90.in:469

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_tests_1d.F90.in:470
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_tests_1d.F90.in:471
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:472)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:472
   ! pio_decomp_tests_1d.F90.in:473
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_tests_1d.F90.in:474
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:475)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:475
   ! pio_decomp_tests_1d.F90.in:476
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_double, (/pio_dim/), pio_var)   ! pio_decomp_tests_1d.F90.in:477
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:478)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:478
   ! pio_decomp_tests_1d.F90.in:479
    ierr = PIO_enddef(pio_file)   ! pio_decomp_tests_1d.F90.in:480
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:481)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:481
   ! pio_decomp_tests_1d.F90.in:482
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, wr_iodesc, wbuf, ierr)   ! pio_decomp_tests_1d.F90.in:484
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:485)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:485
   ! pio_decomp_tests_1d.F90.in:486
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:488
   ! pio_decomp_tests_1d.F90.in:489
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_tests_1d.F90.in:490
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:491)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:491
   ! pio_decomp_tests_1d.F90.in:492
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_tests_1d.F90.in:493
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:494)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:494
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_tests_1d.F90.in:496
#endif
   ! pio_decomp_tests_1d.F90.in:498
    call PIO_read_darray(pio_file, pio_var, wr_iodesc, rbuf, ierr)   ! pio_decomp_tests_1d.F90.in:499
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:500)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:500
   ! pio_decomp_tests_1d.F90.in:501
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:502)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:502
   ! pio_decomp_tests_1d.F90.in:503
    call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:504
       ! pio_decomp_tests_1d.F90.in:505
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_decomp_tests_1d.F90.in:506
  end do   ! pio_decomp_tests_1d.F90.in:507
   ! pio_decomp_tests_1d.F90.in:508
  if(allocated(iotypes)) then   ! pio_decomp_tests_1d.F90.in:509
    deallocate(iotypes)   ! pio_decomp_tests_1d.F90.in:510
    deallocate(iotype_descs)   ! pio_decomp_tests_1d.F90.in:511
  end if   ! pio_decomp_tests_1d.F90.in:512
   ! pio_decomp_tests_1d.F90.in:513
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_decomp_tests_1d.F90.in:514
  deallocate(exp_val)   ! pio_decomp_tests_1d.F90.in:515
  deallocate(rbuf)   ! pio_decomp_tests_1d.F90.in:516
  deallocate(wbuf)   ! pio_decomp_tests_1d.F90.in:517
END SUBROUTINE nc_wr_1d_bc_with_holes_PIO_double_real_kind_fc_double___   ! pio_decomp_tests_1d.F90.in:518
   ! pio_decomp_tests_1d.F90.in:518


! Write (and read back) data in global reverse order of
! the file offsets.


SUBROUTINE nc_wr_1d_rev_PIO_int_integer__
USE pio_tutil
   ! pio_decomp_tests_1d.F90.in:523
  implicit none   ! pio_decomp_tests_1d.F90.in:524
  type(var_desc_t)  :: pio_var   ! pio_decomp_tests_1d.F90.in:525
  type(file_desc_t) :: pio_file   ! pio_decomp_tests_1d.F90.in:526
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_tests_1d.F90.in:527
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_tests_1d.F90.in:528
  type(io_desc_t) :: wr_iodesc   ! pio_decomp_tests_1d.F90.in:529
  integer, dimension(:), allocatable :: compdof   ! pio_decomp_tests_1d.F90.in:530
  integer, dimension(1) :: start, count   ! pio_decomp_tests_1d.F90.in:531
  integer, dimension(:), allocatable :: rbuf, wbuf, exp_val   ! pio_decomp_tests_1d.F90.in:532
  integer, dimension(1) :: dims   ! pio_decomp_tests_1d.F90.in:533
  integer :: pio_dim   ! pio_decomp_tests_1d.F90.in:534
  integer :: i, ierr, lsz   ! pio_decomp_tests_1d.F90.in:535
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests_1d.F90.in:537
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests_1d.F90.in:538
  integer :: num_iotypes   ! pio_decomp_tests_1d.F90.in:539
   ! pio_decomp_tests_1d.F90.in:540
  ! Set the decomposition for writing data
  call get_1d_rev_info(pio_tf_world_rank_, pio_tf_world_sz_, dims, start, count)   ! pio_decomp_tests_1d.F90.in:542
  allocate(wbuf(count(1)))   ! pio_decomp_tests_1d.F90.in:543
  allocate(rbuf(count(1)))   ! pio_decomp_tests_1d.F90.in:544
  allocate(compdof(count(1)))   ! pio_decomp_tests_1d.F90.in:545
  allocate(exp_val(count(1)))   ! pio_decomp_tests_1d.F90.in:546
  do i=1,count(1)   ! pio_decomp_tests_1d.F90.in:547
    wbuf(i) = start(1) + i - 1   ! pio_decomp_tests_1d.F90.in:548
    compdof(i) = wbuf(i)   ! pio_decomp_tests_1d.F90.in:549
    exp_val(i) = wbuf(i)   ! pio_decomp_tests_1d.F90.in:550
  end do   ! pio_decomp_tests_1d.F90.in:551
   ! pio_decomp_tests_1d.F90.in:552
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof, wr_iodesc)   ! pio_decomp_tests_1d.F90.in:553
  deallocate(compdof)   ! pio_decomp_tests_1d.F90.in:554
   ! pio_decomp_tests_1d.F90.in:555
  num_iotypes = 0   ! pio_decomp_tests_1d.F90.in:556
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests_1d.F90.in:557
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_decomp_tests_1d.F90.in:558
  do i=1,num_iotypes   ! pio_decomp_tests_1d.F90.in:559

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_tests_1d.F90.in:560
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_tests_1d.F90.in:561
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:562)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:562
   ! pio_decomp_tests_1d.F90.in:563
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_tests_1d.F90.in:564
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:565)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:565
   ! pio_decomp_tests_1d.F90.in:566
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_int, (/pio_dim/), pio_var)   ! pio_decomp_tests_1d.F90.in:567
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:568)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:568
   ! pio_decomp_tests_1d.F90.in:569
    ierr = PIO_enddef(pio_file)   ! pio_decomp_tests_1d.F90.in:570
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:571)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:571
   ! pio_decomp_tests_1d.F90.in:572
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, wr_iodesc, wbuf, ierr)   ! pio_decomp_tests_1d.F90.in:574
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:575)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:575
   ! pio_decomp_tests_1d.F90.in:576
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:578
   ! pio_decomp_tests_1d.F90.in:579
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_tests_1d.F90.in:580
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:581)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:581
   ! pio_decomp_tests_1d.F90.in:582
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_tests_1d.F90.in:583
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:584)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:584
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_tests_1d.F90.in:586
#endif
   ! pio_decomp_tests_1d.F90.in:588
    call PIO_read_darray(pio_file, pio_var, wr_iodesc, rbuf, ierr)   ! pio_decomp_tests_1d.F90.in:589
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:590)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:590
   ! pio_decomp_tests_1d.F90.in:591
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:592)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:592
   ! pio_decomp_tests_1d.F90.in:593
    call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:594
       ! pio_decomp_tests_1d.F90.in:595
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_decomp_tests_1d.F90.in:596
  end do   ! pio_decomp_tests_1d.F90.in:597
   ! pio_decomp_tests_1d.F90.in:598
  if(allocated(iotypes)) then   ! pio_decomp_tests_1d.F90.in:599
    deallocate(iotypes)   ! pio_decomp_tests_1d.F90.in:600
    deallocate(iotype_descs)   ! pio_decomp_tests_1d.F90.in:601
  end if   ! pio_decomp_tests_1d.F90.in:602
   ! pio_decomp_tests_1d.F90.in:603
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_decomp_tests_1d.F90.in:604
  deallocate(exp_val)   ! pio_decomp_tests_1d.F90.in:605
  deallocate(rbuf)   ! pio_decomp_tests_1d.F90.in:606
  deallocate(wbuf)   ! pio_decomp_tests_1d.F90.in:607
END SUBROUTINE nc_wr_1d_rev_PIO_int_integer__   ! pio_decomp_tests_1d.F90.in:608


SUBROUTINE nc_wr_1d_rev_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_decomp_tests_1d.F90.in:523
  implicit none   ! pio_decomp_tests_1d.F90.in:524
  type(var_desc_t)  :: pio_var   ! pio_decomp_tests_1d.F90.in:525
  type(file_desc_t) :: pio_file   ! pio_decomp_tests_1d.F90.in:526
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_tests_1d.F90.in:527
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_tests_1d.F90.in:528
  type(io_desc_t) :: wr_iodesc   ! pio_decomp_tests_1d.F90.in:529
  integer, dimension(:), allocatable :: compdof   ! pio_decomp_tests_1d.F90.in:530
  integer, dimension(1) :: start, count   ! pio_decomp_tests_1d.F90.in:531
  real(kind=fc_real), dimension(:), allocatable :: rbuf, wbuf, exp_val   ! pio_decomp_tests_1d.F90.in:532
  integer, dimension(1) :: dims   ! pio_decomp_tests_1d.F90.in:533
  integer :: pio_dim   ! pio_decomp_tests_1d.F90.in:534
  integer :: i, ierr, lsz   ! pio_decomp_tests_1d.F90.in:535
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests_1d.F90.in:537
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests_1d.F90.in:538
  integer :: num_iotypes   ! pio_decomp_tests_1d.F90.in:539
   ! pio_decomp_tests_1d.F90.in:540
  ! Set the decomposition for writing data
  call get_1d_rev_info(pio_tf_world_rank_, pio_tf_world_sz_, dims, start, count)   ! pio_decomp_tests_1d.F90.in:542
  allocate(wbuf(count(1)))   ! pio_decomp_tests_1d.F90.in:543
  allocate(rbuf(count(1)))   ! pio_decomp_tests_1d.F90.in:544
  allocate(compdof(count(1)))   ! pio_decomp_tests_1d.F90.in:545
  allocate(exp_val(count(1)))   ! pio_decomp_tests_1d.F90.in:546
  do i=1,count(1)   ! pio_decomp_tests_1d.F90.in:547
    wbuf(i) = start(1) + i - 1   ! pio_decomp_tests_1d.F90.in:548
    compdof(i) = wbuf(i)   ! pio_decomp_tests_1d.F90.in:549
    exp_val(i) = wbuf(i)   ! pio_decomp_tests_1d.F90.in:550
  end do   ! pio_decomp_tests_1d.F90.in:551
   ! pio_decomp_tests_1d.F90.in:552
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof, wr_iodesc)   ! pio_decomp_tests_1d.F90.in:553
  deallocate(compdof)   ! pio_decomp_tests_1d.F90.in:554
   ! pio_decomp_tests_1d.F90.in:555
  num_iotypes = 0   ! pio_decomp_tests_1d.F90.in:556
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests_1d.F90.in:557
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_decomp_tests_1d.F90.in:558
  do i=1,num_iotypes   ! pio_decomp_tests_1d.F90.in:559

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_tests_1d.F90.in:560
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_tests_1d.F90.in:561
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:562)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:562
   ! pio_decomp_tests_1d.F90.in:563
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_tests_1d.F90.in:564
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:565)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:565
   ! pio_decomp_tests_1d.F90.in:566
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_real, (/pio_dim/), pio_var)   ! pio_decomp_tests_1d.F90.in:567
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:568)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:568
   ! pio_decomp_tests_1d.F90.in:569
    ierr = PIO_enddef(pio_file)   ! pio_decomp_tests_1d.F90.in:570
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:571)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:571
   ! pio_decomp_tests_1d.F90.in:572
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, wr_iodesc, wbuf, ierr)   ! pio_decomp_tests_1d.F90.in:574
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:575)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:575
   ! pio_decomp_tests_1d.F90.in:576
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:578
   ! pio_decomp_tests_1d.F90.in:579
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_tests_1d.F90.in:580
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:581)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:581
   ! pio_decomp_tests_1d.F90.in:582
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_tests_1d.F90.in:583
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:584)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:584
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_tests_1d.F90.in:586
#endif
   ! pio_decomp_tests_1d.F90.in:588
    call PIO_read_darray(pio_file, pio_var, wr_iodesc, rbuf, ierr)   ! pio_decomp_tests_1d.F90.in:589
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:590)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:590
   ! pio_decomp_tests_1d.F90.in:591
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:592)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:592
   ! pio_decomp_tests_1d.F90.in:593
    call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:594
       ! pio_decomp_tests_1d.F90.in:595
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_decomp_tests_1d.F90.in:596
  end do   ! pio_decomp_tests_1d.F90.in:597
   ! pio_decomp_tests_1d.F90.in:598
  if(allocated(iotypes)) then   ! pio_decomp_tests_1d.F90.in:599
    deallocate(iotypes)   ! pio_decomp_tests_1d.F90.in:600
    deallocate(iotype_descs)   ! pio_decomp_tests_1d.F90.in:601
  end if   ! pio_decomp_tests_1d.F90.in:602
   ! pio_decomp_tests_1d.F90.in:603
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_decomp_tests_1d.F90.in:604
  deallocate(exp_val)   ! pio_decomp_tests_1d.F90.in:605
  deallocate(rbuf)   ! pio_decomp_tests_1d.F90.in:606
  deallocate(wbuf)   ! pio_decomp_tests_1d.F90.in:607
END SUBROUTINE nc_wr_1d_rev_PIO_real_real_kind_fc_real___   ! pio_decomp_tests_1d.F90.in:608


SUBROUTINE nc_wr_1d_rev_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_decomp_tests_1d.F90.in:523
  implicit none   ! pio_decomp_tests_1d.F90.in:524
  type(var_desc_t)  :: pio_var   ! pio_decomp_tests_1d.F90.in:525
  type(file_desc_t) :: pio_file   ! pio_decomp_tests_1d.F90.in:526
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_tests_1d.F90.in:527
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_tests_1d.F90.in:528
  type(io_desc_t) :: wr_iodesc   ! pio_decomp_tests_1d.F90.in:529
  integer, dimension(:), allocatable :: compdof   ! pio_decomp_tests_1d.F90.in:530
  integer, dimension(1) :: start, count   ! pio_decomp_tests_1d.F90.in:531
  real(kind=fc_double), dimension(:), allocatable :: rbuf, wbuf, exp_val   ! pio_decomp_tests_1d.F90.in:532
  integer, dimension(1) :: dims   ! pio_decomp_tests_1d.F90.in:533
  integer :: pio_dim   ! pio_decomp_tests_1d.F90.in:534
  integer :: i, ierr, lsz   ! pio_decomp_tests_1d.F90.in:535
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests_1d.F90.in:537
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests_1d.F90.in:538
  integer :: num_iotypes   ! pio_decomp_tests_1d.F90.in:539
   ! pio_decomp_tests_1d.F90.in:540
  ! Set the decomposition for writing data
  call get_1d_rev_info(pio_tf_world_rank_, pio_tf_world_sz_, dims, start, count)   ! pio_decomp_tests_1d.F90.in:542
  allocate(wbuf(count(1)))   ! pio_decomp_tests_1d.F90.in:543
  allocate(rbuf(count(1)))   ! pio_decomp_tests_1d.F90.in:544
  allocate(compdof(count(1)))   ! pio_decomp_tests_1d.F90.in:545
  allocate(exp_val(count(1)))   ! pio_decomp_tests_1d.F90.in:546
  do i=1,count(1)   ! pio_decomp_tests_1d.F90.in:547
    wbuf(i) = start(1) + i - 1   ! pio_decomp_tests_1d.F90.in:548
    compdof(i) = wbuf(i)   ! pio_decomp_tests_1d.F90.in:549
    exp_val(i) = wbuf(i)   ! pio_decomp_tests_1d.F90.in:550
  end do   ! pio_decomp_tests_1d.F90.in:551
   ! pio_decomp_tests_1d.F90.in:552
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof, wr_iodesc)   ! pio_decomp_tests_1d.F90.in:553
  deallocate(compdof)   ! pio_decomp_tests_1d.F90.in:554
   ! pio_decomp_tests_1d.F90.in:555
  num_iotypes = 0   ! pio_decomp_tests_1d.F90.in:556
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests_1d.F90.in:557
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_decomp_tests_1d.F90.in:558
  do i=1,num_iotypes   ! pio_decomp_tests_1d.F90.in:559

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_tests_1d.F90.in:560
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_tests_1d.F90.in:561
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:562)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:562
   ! pio_decomp_tests_1d.F90.in:563
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_tests_1d.F90.in:564
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:565)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:565
   ! pio_decomp_tests_1d.F90.in:566
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_double, (/pio_dim/), pio_var)   ! pio_decomp_tests_1d.F90.in:567
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:568)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:568
   ! pio_decomp_tests_1d.F90.in:569
    ierr = PIO_enddef(pio_file)   ! pio_decomp_tests_1d.F90.in:570
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:571)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:571
   ! pio_decomp_tests_1d.F90.in:572
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, wr_iodesc, wbuf, ierr)   ! pio_decomp_tests_1d.F90.in:574
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:575)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:575
   ! pio_decomp_tests_1d.F90.in:576
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:578
   ! pio_decomp_tests_1d.F90.in:579
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_tests_1d.F90.in:580
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:581)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:581
   ! pio_decomp_tests_1d.F90.in:582
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_tests_1d.F90.in:583
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:584)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:584
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_tests_1d.F90.in:586
#endif
   ! pio_decomp_tests_1d.F90.in:588
    call PIO_read_darray(pio_file, pio_var, wr_iodesc, rbuf, ierr)   ! pio_decomp_tests_1d.F90.in:589
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:590)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:590
   ! pio_decomp_tests_1d.F90.in:591
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests_1d.F90.in:592)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests_1d.F90.in:592
   ! pio_decomp_tests_1d.F90.in:593
    call PIO_closefile(pio_file)   ! pio_decomp_tests_1d.F90.in:594
       ! pio_decomp_tests_1d.F90.in:595
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_decomp_tests_1d.F90.in:596
  end do   ! pio_decomp_tests_1d.F90.in:597
   ! pio_decomp_tests_1d.F90.in:598
  if(allocated(iotypes)) then   ! pio_decomp_tests_1d.F90.in:599
    deallocate(iotypes)   ! pio_decomp_tests_1d.F90.in:600
    deallocate(iotype_descs)   ! pio_decomp_tests_1d.F90.in:601
  end if   ! pio_decomp_tests_1d.F90.in:602
   ! pio_decomp_tests_1d.F90.in:603
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_decomp_tests_1d.F90.in:604
  deallocate(exp_val)   ! pio_decomp_tests_1d.F90.in:605
  deallocate(rbuf)   ! pio_decomp_tests_1d.F90.in:606
  deallocate(wbuf)   ! pio_decomp_tests_1d.F90.in:607
END SUBROUTINE nc_wr_1d_rev_PIO_double_real_kind_fc_double___   ! pio_decomp_tests_1d.F90.in:608
   ! pio_decomp_tests_1d.F90.in:608


  SUBROUTINE PIO_TF_Test_driver_
    USE pio_tutil
    IMPLICIT NONE
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_1d_bc_PIO_int_integer__"
    END IF
    CALL nc_wr_rd_1d_bc_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 1:",&
          "nc_wr_rd_1d_bc_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 1:",&
          "nc_wr_rd_1d_bc_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_1d_bc_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_rd_1d_bc_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 2:",&
          "nc_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 2:",&
          "nc_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_1d_bc_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_rd_1d_bc_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 3:",&
          "nc_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 3:",&
          "nc_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_1d_bc_PIO_int_integer__"
    END IF
    CALL nc_wr_rd_1d_bc_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 4:",&
          "nc_wr_rd_1d_bc_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 4:",&
          "nc_wr_rd_1d_bc_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_1d_bc_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_rd_1d_bc_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 5:",&
          "nc_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 5:",&
          "nc_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_1d_bc_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_rd_1d_bc_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 6:",&
          "nc_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 6:",&
          "nc_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_mreg_1d_bc_PIO_int_integer__"
    END IF
    CALL nc_wr_rd_mreg_1d_bc_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 7:",&
          "nc_wr_rd_mreg_1d_bc_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 7:",&
          "nc_wr_rd_mreg_1d_bc_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_mreg_1d_bc_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_rd_mreg_1d_bc_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 8:",&
          "nc_wr_rd_mreg_1d_bc_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 8:",&
          "nc_wr_rd_mreg_1d_bc_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_mreg_1d_bc_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_rd_mreg_1d_bc_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 9:",&
          "nc_wr_rd_mreg_1d_bc_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 9:",&
          "nc_wr_rd_mreg_1d_bc_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_1d_bc_PIO_int_integer__"
    END IF
    CALL nc_wr_rd_1d_bc_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 10:",&
          "nc_wr_rd_1d_bc_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 10:",&
          "nc_wr_rd_1d_bc_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_1d_bc_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_rd_1d_bc_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 11:",&
          "nc_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 11:",&
          "nc_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_1d_bc_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_rd_1d_bc_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 12:",&
          "nc_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 12:",&
          "nc_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_mreg_1d_bc_PIO_int_integer__"
    END IF
    CALL nc_wr_rd_mreg_1d_bc_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 13:",&
          "nc_wr_rd_mreg_1d_bc_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 13:",&
          "nc_wr_rd_mreg_1d_bc_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_mreg_1d_bc_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_rd_mreg_1d_bc_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 14:",&
          "nc_wr_rd_mreg_1d_bc_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 14:",&
          "nc_wr_rd_mreg_1d_bc_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_mreg_1d_bc_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_rd_mreg_1d_bc_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 15:",&
          "nc_wr_rd_mreg_1d_bc_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 15:",&
          "nc_wr_rd_mreg_1d_bc_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_bc_with_holes_PIO_int_integer__"
    END IF
    CALL nc_wr_1d_bc_with_holes_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 16:",&
          "nc_wr_1d_bc_with_holes_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 16:",&
          "nc_wr_1d_bc_with_holes_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_bc_with_holes_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_1d_bc_with_holes_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 17:",&
          "nc_wr_1d_bc_with_holes_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 17:",&
          "nc_wr_1d_bc_with_holes_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_bc_with_holes_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_1d_bc_with_holes_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 18:",&
          "nc_wr_1d_bc_with_holes_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 18:",&
          "nc_wr_1d_bc_with_holes_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_1d_bc_PIO_int_integer__"
    END IF
    CALL nc_wr_rd_1d_bc_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 19:",&
          "nc_wr_rd_1d_bc_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 19:",&
          "nc_wr_rd_1d_bc_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_1d_bc_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_rd_1d_bc_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 20:",&
          "nc_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 20:",&
          "nc_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_1d_bc_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_rd_1d_bc_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 21:",&
          "nc_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 21:",&
          "nc_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_mreg_1d_bc_PIO_int_integer__"
    END IF
    CALL nc_wr_rd_mreg_1d_bc_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 22:",&
          "nc_wr_rd_mreg_1d_bc_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 22:",&
          "nc_wr_rd_mreg_1d_bc_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_mreg_1d_bc_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_rd_mreg_1d_bc_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 23:",&
          "nc_wr_rd_mreg_1d_bc_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 23:",&
          "nc_wr_rd_mreg_1d_bc_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_rd_mreg_1d_bc_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_rd_mreg_1d_bc_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 24:",&
          "nc_wr_rd_mreg_1d_bc_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 24:",&
          "nc_wr_rd_mreg_1d_bc_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_bc_with_holes_PIO_int_integer__"
    END IF
    CALL nc_wr_1d_bc_with_holes_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 25:",&
          "nc_wr_1d_bc_with_holes_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 25:",&
          "nc_wr_1d_bc_with_holes_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_bc_with_holes_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_1d_bc_with_holes_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 26:",&
          "nc_wr_1d_bc_with_holes_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 26:",&
          "nc_wr_1d_bc_with_holes_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_bc_with_holes_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_1d_bc_with_holes_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 27:",&
          "nc_wr_1d_bc_with_holes_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 27:",&
          "nc_wr_1d_bc_with_holes_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_rev_PIO_int_integer__"
    END IF
    CALL nc_wr_1d_rev_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 28:",&
          "nc_wr_1d_rev_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 28:",&
          "nc_wr_1d_rev_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_rev_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_1d_rev_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 29:",&
          "nc_wr_1d_rev_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 29:",&
          "nc_wr_1d_rev_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_rev_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_1d_rev_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 30:",&
          "nc_wr_1d_rev_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 30:",&
          "nc_wr_1d_rev_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
  END SUBROUTINE PIO_TF_Test_driver_


  PROGRAM PIO_TF_Test_main_
    USE pio_tutil
    IMPLICIT NONE
    INTEGER, PARAMETER :: NREARRS = 2
    INTEGER :: rearrs(NREARRS) = (/pio_rearr_subset,pio_rearr_box/)
    CHARACTER(LEN=PIO_TF_MAX_STR_LEN) :: rearrs_info(NREARRS) = (/"PIO_REARR_SUBSET","PIO_REARR_BOX   "/)
    INTEGER i, ierr

    pio_tf_nerrs_total_=0
    pio_tf_retval_utest_=0
    CALL MPI_Init(ierr)
    DO i=1,SIZE(rearrs)
      CALL PIO_TF_Init_(rearrs(i))
      IF (pio_tf_world_rank_ == 0) THEN
        WRITE(*,*) "PIO_TF: Testing : ", trim(rearrs_info(i))
      END IF
      CALL PIO_TF_Test_driver_()
      CALL PIO_TF_Finalize_()
    END DO
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_nerrs_total_ == 0) THEN
        IF (pio_tf_retval_utest_ == 0) THEN
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF: ",&
           "All tests", "---------", "PASSED"
        ELSE
          pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF: ",&
           "Test driver", "---------", "FAILED"
        END IF
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT2) "PIO_TF:[",&
          pio_tf_nerrs_total_,"] Tests",&
          "----- FAILED"
      END IF
    END IF
    CALL MPI_Finalize(ierr)
    IF (pio_tf_nerrs_total_ /= 0) THEN
      STOP 99
    END IF
  END PROGRAM
