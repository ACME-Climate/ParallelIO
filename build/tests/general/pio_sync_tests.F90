! DON'T MODIFY THIS FILE, ALL YOUR CHANGES WILL BE LOST
! This file is generated by ../../../tests/general/util/pio_tf_f90gen.pl
! from /home/tkurc/codar/e3sm/pio_adios1/ParallelIO/tests/general/pio_sync_tests.F90.in

! Get a block cyclic decomposition
! If force_rearrange is FALSE, the decomposition is such that
! # All even procs have VEC_LOCAL_SZ elements
! # All odd procs have VEC_LOCAL_SZ + 1 elements
! e.g. For VEC_LOCAL_SZ = 2,
! e.g. 1)    [1,2] [3,4,5] [6,7]
! e.g. 2)    [1,2] [3,4,5] [6,7] [8,9,10]
! e.g. 3)    [1,2] [3,4,5] [6,7] [8,9,10] [11,12]
! If force_rearrange is TRUE, the decomposition is such that,
! If possible, the even rank "exchanges" elements with the next
! higher ranked odd proc.
! This for example can be used to force rearrangement when reading
! or writing data.
! e.g. For VEC_LOCAL_SZ = 2,
! e.g. 1)    [3,4,5] [1,2] [6,7]
! e.g. 2)    [3,4,5] [1,2] [8,9,10] [6,7]
! e.g. 3)    [3,4,5] [1,2] [8,9,10] [6,7] [11,12]
SUBROUTINE get_1d_bc_info(rank, sz, dims, start, count, force_rearrange)   ! pio_sync_tests.F90.in:18
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_sync_tests.F90.in:19
  integer, parameter :: NUM_REGIONS = 1   ! pio_sync_tests.F90.in:20
  integer, intent(in) :: rank   ! pio_sync_tests.F90.in:21
  integer, intent(in) :: sz   ! pio_sync_tests.F90.in:22
  integer, dimension(1), intent(out) :: dims   ! pio_sync_tests.F90.in:23
  integer, dimension(:), allocatable, intent(out) :: start   ! pio_sync_tests.F90.in:24
  integer, dimension(:), allocatable, intent(out) :: count   ! pio_sync_tests.F90.in:25
  logical, intent(in) :: force_rearrange   ! pio_sync_tests.F90.in:26


  logical :: is_even_rank   ! pio_sync_tests.F90.in:28
  integer :: num_odd_procs, num_even_procs   ! pio_sync_tests.F90.in:29
  integer :: iodd, ieven   ! pio_sync_tests.F90.in:30


  allocate(start(NUM_REGIONS))   ! pio_sync_tests.F90.in:32
  allocate(count(NUM_REGIONS))   ! pio_sync_tests.F90.in:33


  is_even_rank = .false.   ! pio_sync_tests.F90.in:35
  if (mod(rank, 2) == 0) then   ! pio_sync_tests.F90.in:36
    is_even_rank = .true.   ! pio_sync_tests.F90.in:37
  end if   ! pio_sync_tests.F90.in:38
  num_odd_procs = sz / 2   ! pio_sync_tests.F90.in:39
  num_even_procs = sz - num_odd_procs   ! pio_sync_tests.F90.in:40
  dims(1) = num_even_procs * VEC_LOCAL_SZ + num_odd_procs * (VEC_LOCAL_SZ + 1)   ! pio_sync_tests.F90.in:41
  ! Number of odd and even procs before this rank
  iodd = rank / 2   ! pio_sync_tests.F90.in:43
  ieven = (rank + 1) / 2   ! pio_sync_tests.F90.in:44
  if(force_rearrange) then   ! pio_sync_tests.F90.in:45
    ! Make sure that we force rearrangement
    if (is_even_rank) then   ! pio_sync_tests.F90.in:47
      if(rank + 1 < sz) then   ! pio_sync_tests.F90.in:48
        ! Force rearrangement
        count(1) = VEC_LOCAL_SZ + 1   ! pio_sync_tests.F90.in:50
        start(1) = ieven * VEC_LOCAL_SZ + iodd * (VEC_LOCAL_SZ + 1) + (VEC_LOCAL_SZ) + 1   ! pio_sync_tests.F90.in:51
      else   ! pio_sync_tests.F90.in:52
        count(1) = VEC_LOCAL_SZ   ! pio_sync_tests.F90.in:53
        start(1) = ieven * VEC_LOCAL_SZ + iodd * (VEC_LOCAL_SZ + 1) + 1   ! pio_sync_tests.F90.in:54
      end if   ! pio_sync_tests.F90.in:55
    else   ! pio_sync_tests.F90.in:56
      ! For all odd procs there is an even lower ranked, rank-1, proc
      ! So force rearrangement
      count(1) = VEC_LOCAL_SZ   ! pio_sync_tests.F90.in:59
      start(1) = ieven * VEC_LOCAL_SZ + iodd * (VEC_LOCAL_SZ + 1) - (VEC_LOCAL_SZ) + 1   ! pio_sync_tests.F90.in:60
    end if   ! pio_sync_tests.F90.in:61
  else   ! pio_sync_tests.F90.in:62
    if (is_even_rank) then   ! pio_sync_tests.F90.in:63
      count(1) = VEC_LOCAL_SZ   ! pio_sync_tests.F90.in:64
    else   ! pio_sync_tests.F90.in:65
      count(1) = VEC_LOCAL_SZ + 1   ! pio_sync_tests.F90.in:66
    end if   ! pio_sync_tests.F90.in:67
    start(1) = ieven * VEC_LOCAL_SZ + iodd * (VEC_LOCAL_SZ + 1) + 1   ! pio_sync_tests.F90.in:68
  end if   ! pio_sync_tests.F90.in:69


END SUBROUTINE   ! pio_sync_tests.F90.in:71


! Get a block cyclic decomposition with multiple regions to write
! from a single proc
! # All procs have VEC_LOCAL_SZ elements starting at offset rank+1
!   and also starting at offset (size * VEC_LOCAL_SZ)
! e.g. For VEC_LOCAL_SZ = 2, NUM_REGIONS=2
! e.g. 1)    [1,2,7,8] [3,4,9,10] [5,6,11,12]
SUBROUTINE get_1d_bc_mreg_info(rank, sz, dims, start, count)   ! pio_sync_tests.F90.in:79
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_sync_tests.F90.in:80
  integer, parameter :: NUM_REGIONS = 3   ! pio_sync_tests.F90.in:81
  integer, intent(in) :: rank   ! pio_sync_tests.F90.in:82
  integer, intent(in) :: sz   ! pio_sync_tests.F90.in:83
  integer, dimension(1), intent(out) :: dims   ! pio_sync_tests.F90.in:84
  integer, dimension(:), allocatable, intent(out) :: start   ! pio_sync_tests.F90.in:85
  integer, dimension(:), allocatable, intent(out) :: count   ! pio_sync_tests.F90.in:86
  integer :: i   ! pio_sync_tests.F90.in:87


  dims(1) = sz * VEC_LOCAL_SZ * NUM_REGIONS   ! pio_sync_tests.F90.in:89
  allocate(start(NUM_REGIONS))   ! pio_sync_tests.F90.in:90
  allocate(count(NUM_REGIONS))   ! pio_sync_tests.F90.in:91




  do i=1,NUM_REGIONS   ! pio_sync_tests.F90.in:94
    count(i) = VEC_LOCAL_SZ   ! pio_sync_tests.F90.in:95
    start(i) = rank * VEC_LOCAL_SZ + (i-1) * (sz * VEC_LOCAL_SZ) + 1   ! pio_sync_tests.F90.in:96
  end do   ! pio_sync_tests.F90.in:97


END SUBROUTINE get_1d_bc_mreg_info   ! pio_sync_tests.F90.in:99


! Test writes multiple variables before syncing and reading them back


SUBROUTINE nc_mvar_wr_rd_1d_bc_PIO_int_integer__
USE pio_tutil
   ! pio_sync_tests.F90.in:103
  implicit none   ! pio_sync_tests.F90.in:104
  interface   ! pio_sync_tests.F90.in:105
    subroutine get_1d_bc_info(rank, sz, dims, start, count, force_rearrange)   ! pio_sync_tests.F90.in:106
      integer, intent(in) :: rank   ! pio_sync_tests.F90.in:107
      integer, intent(in) :: sz   ! pio_sync_tests.F90.in:108
      integer, dimension(1), intent(out) :: dims   ! pio_sync_tests.F90.in:109
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_sync_tests.F90.in:110
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_sync_tests.F90.in:111
      logical, intent(in) :: force_rearrange   ! pio_sync_tests.F90.in:112
    end subroutine get_1d_bc_info   ! pio_sync_tests.F90.in:113
  end interface   ! pio_sync_tests.F90.in:114
  type(var_desc_t)  :: pio_var1, pio_var2, pio_var3   ! pio_sync_tests.F90.in:115
  type(file_desc_t) :: pio_file   ! pio_sync_tests.F90.in:116
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_sync_tests.F90.in:117
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1'   ! pio_sync_tests.F90.in:118
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2'   ! pio_sync_tests.F90.in:119
  character(len=*), parameter :: PIO_VAR3_NAME = 'PIO_TF_test_var3'   ! pio_sync_tests.F90.in:120
  type(io_desc_t) :: wr_iodesc, rd_iodesc   ! pio_sync_tests.F90.in:121
  integer, dimension(:), allocatable :: compdof   ! pio_sync_tests.F90.in:122
  integer, dimension(:), allocatable :: start, count   ! pio_sync_tests.F90.in:123
  integer, dimension(:), allocatable :: rbuf, wbuf, exp_val   ! pio_sync_tests.F90.in:124
  integer, dimension(1) :: dims   ! pio_sync_tests.F90.in:125
  integer :: pio_dim   ! pio_sync_tests.F90.in:126
  integer :: i, ierr, lsz   ! pio_sync_tests.F90.in:127
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_sync_tests.F90.in:129
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_sync_tests.F90.in:130
  integer :: num_iotypes   ! pio_sync_tests.F90.in:131
   ! pio_sync_tests.F90.in:132
  ! Set the decomposition for writing data - forcing rearrangement
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:134
         start, count, .true.)   ! pio_sync_tests.F90.in:135
  allocate(wbuf(count(1)))   ! pio_sync_tests.F90.in:136
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:137
  do i=1,count(1)   ! pio_sync_tests.F90.in:138
    wbuf(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:139
    compdof(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:140
  end do   ! pio_sync_tests.F90.in:141
  if(allocated(start))then   ! pio_sync_tests.F90.in:142
    deallocate(start)   ! pio_sync_tests.F90.in:143
  end if   ! pio_sync_tests.F90.in:144
   ! pio_sync_tests.F90.in:145
  if(allocated(count))then   ! pio_sync_tests.F90.in:146
    deallocate(count)   ! pio_sync_tests.F90.in:147
  end if   ! pio_sync_tests.F90.in:148
   ! pio_sync_tests.F90.in:149
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof, wr_iodesc)   ! pio_sync_tests.F90.in:150
  deallocate(compdof)   ! pio_sync_tests.F90.in:151
   ! pio_sync_tests.F90.in:152
  ! Set the decomposition for reading data - different from the write decomp
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:154
         start, count, .false.)   ! pio_sync_tests.F90.in:155
  allocate(rbuf(count(1)))   ! pio_sync_tests.F90.in:156
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:157
  allocate(exp_val(count(1)))   ! pio_sync_tests.F90.in:158
  do i=1,count(1)   ! pio_sync_tests.F90.in:159
    compdof(i) = start(1) + i -1   ! pio_sync_tests.F90.in:160
    ! Expected value, after reading, is the same as the compdof
    exp_val(i) = compdof(i)   ! pio_sync_tests.F90.in:162
  end do   ! pio_sync_tests.F90.in:163
   ! pio_sync_tests.F90.in:164
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof, rd_iodesc)   ! pio_sync_tests.F90.in:165
  deallocate(compdof)   ! pio_sync_tests.F90.in:166
   ! pio_sync_tests.F90.in:167
  num_iotypes = 0   ! pio_sync_tests.F90.in:168
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_sync_tests.F90.in:169
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_sync_tests.F90.in:170
  do i=1,num_iotypes   ! pio_sync_tests.F90.in:171

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_sync_tests.F90.in:172
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_sync_tests.F90.in:173
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:174)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:174
   ! pio_sync_tests.F90.in:175
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_sync_tests.F90.in:176
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:177)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:177
   ! pio_sync_tests.F90.in:178
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_int, (/pio_dim/), pio_var1)   ! pio_sync_tests.F90.in:179
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:180)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:180
   ! pio_sync_tests.F90.in:181
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_int, (/pio_dim/), pio_var2)   ! pio_sync_tests.F90.in:182
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:183)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:183
   ! pio_sync_tests.F90.in:184
    ierr = PIO_def_var(pio_file, PIO_VAR3_NAME, PIO_int, (/pio_dim/), pio_var3)   ! pio_sync_tests.F90.in:185
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:186)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:186
   ! pio_sync_tests.F90.in:187
    ierr = PIO_enddef(pio_file)   ! pio_sync_tests.F90.in:188
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:189)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:189
   ! pio_sync_tests.F90.in:190
    ! Write the variables out
    call PIO_write_darray(pio_file, pio_var1, wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:192
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:193)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:193
   ! pio_sync_tests.F90.in:194
    call PIO_write_darray(pio_file, pio_var2, wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:195
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:196)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:196
   ! pio_sync_tests.F90.in:197
    call PIO_write_darray(pio_file, pio_var3, wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:198
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:199)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:199
   ! pio_sync_tests.F90.in:200
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:202
   ! pio_sync_tests.F90.in:203
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_sync_tests.F90.in:204
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:205)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:205
   ! pio_sync_tests.F90.in:206
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_sync_tests.F90.in:207
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:208)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:208
   ! pio_sync_tests.F90.in:209
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_sync_tests.F90.in:210
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:211)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:211
   ! pio_sync_tests.F90.in:212
    ierr = PIO_inq_varid(pio_file, PIO_VAR3_NAME, pio_var3)   ! pio_sync_tests.F90.in:213
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var3 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:214)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:214
#else
    call PIO_syncfile(pio_file)   ! pio_sync_tests.F90.in:216
#endif
   ! pio_sync_tests.F90.in:218
    rbuf = 0   ! pio_sync_tests.F90.in:219
    call PIO_read_darray(pio_file, pio_var1, rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:220
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:221)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:221
   ! pio_sync_tests.F90.in:222
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var1)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:223)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:223
   ! pio_sync_tests.F90.in:224
    rbuf = 0   ! pio_sync_tests.F90.in:225
    call PIO_read_darray(pio_file, pio_var2, rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:226
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:227)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:227
   ! pio_sync_tests.F90.in:228
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var2)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:229)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:229
   ! pio_sync_tests.F90.in:230
    rbuf = 0   ! pio_sync_tests.F90.in:231
    call PIO_read_darray(pio_file, pio_var3, rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:232
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var3) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:233)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:233
   ! pio_sync_tests.F90.in:234
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var3)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:235)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:235
   ! pio_sync_tests.F90.in:236
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:237
       ! pio_sync_tests.F90.in:238
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_sync_tests.F90.in:239
  end do   ! pio_sync_tests.F90.in:240
   ! pio_sync_tests.F90.in:241
  if(allocated(iotypes)) then   ! pio_sync_tests.F90.in:242
    deallocate(iotypes)   ! pio_sync_tests.F90.in:243
    deallocate(iotype_descs)   ! pio_sync_tests.F90.in:244
  end if   ! pio_sync_tests.F90.in:245
   ! pio_sync_tests.F90.in:246
  call PIO_freedecomp(pio_tf_iosystem_, rd_iodesc)   ! pio_sync_tests.F90.in:247
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_sync_tests.F90.in:248
  deallocate(exp_val)   ! pio_sync_tests.F90.in:249
  deallocate(rbuf)   ! pio_sync_tests.F90.in:250
  deallocate(wbuf)   ! pio_sync_tests.F90.in:251
END SUBROUTINE nc_mvar_wr_rd_1d_bc_PIO_int_integer__   ! pio_sync_tests.F90.in:252


SUBROUTINE nc_mvar_wr_rd_1d_bc_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_sync_tests.F90.in:103
  implicit none   ! pio_sync_tests.F90.in:104
  interface   ! pio_sync_tests.F90.in:105
    subroutine get_1d_bc_info(rank, sz, dims, start, count, force_rearrange)   ! pio_sync_tests.F90.in:106
      integer, intent(in) :: rank   ! pio_sync_tests.F90.in:107
      integer, intent(in) :: sz   ! pio_sync_tests.F90.in:108
      integer, dimension(1), intent(out) :: dims   ! pio_sync_tests.F90.in:109
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_sync_tests.F90.in:110
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_sync_tests.F90.in:111
      logical, intent(in) :: force_rearrange   ! pio_sync_tests.F90.in:112
    end subroutine get_1d_bc_info   ! pio_sync_tests.F90.in:113
  end interface   ! pio_sync_tests.F90.in:114
  type(var_desc_t)  :: pio_var1, pio_var2, pio_var3   ! pio_sync_tests.F90.in:115
  type(file_desc_t) :: pio_file   ! pio_sync_tests.F90.in:116
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_sync_tests.F90.in:117
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1'   ! pio_sync_tests.F90.in:118
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2'   ! pio_sync_tests.F90.in:119
  character(len=*), parameter :: PIO_VAR3_NAME = 'PIO_TF_test_var3'   ! pio_sync_tests.F90.in:120
  type(io_desc_t) :: wr_iodesc, rd_iodesc   ! pio_sync_tests.F90.in:121
  integer, dimension(:), allocatable :: compdof   ! pio_sync_tests.F90.in:122
  integer, dimension(:), allocatable :: start, count   ! pio_sync_tests.F90.in:123
  real(kind=fc_real), dimension(:), allocatable :: rbuf, wbuf, exp_val   ! pio_sync_tests.F90.in:124
  integer, dimension(1) :: dims   ! pio_sync_tests.F90.in:125
  integer :: pio_dim   ! pio_sync_tests.F90.in:126
  integer :: i, ierr, lsz   ! pio_sync_tests.F90.in:127
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_sync_tests.F90.in:129
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_sync_tests.F90.in:130
  integer :: num_iotypes   ! pio_sync_tests.F90.in:131
   ! pio_sync_tests.F90.in:132
  ! Set the decomposition for writing data - forcing rearrangement
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:134
         start, count, .true.)   ! pio_sync_tests.F90.in:135
  allocate(wbuf(count(1)))   ! pio_sync_tests.F90.in:136
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:137
  do i=1,count(1)   ! pio_sync_tests.F90.in:138
    wbuf(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:139
    compdof(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:140
  end do   ! pio_sync_tests.F90.in:141
  if(allocated(start))then   ! pio_sync_tests.F90.in:142
    deallocate(start)   ! pio_sync_tests.F90.in:143
  end if   ! pio_sync_tests.F90.in:144
   ! pio_sync_tests.F90.in:145
  if(allocated(count))then   ! pio_sync_tests.F90.in:146
    deallocate(count)   ! pio_sync_tests.F90.in:147
  end if   ! pio_sync_tests.F90.in:148
   ! pio_sync_tests.F90.in:149
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof, wr_iodesc)   ! pio_sync_tests.F90.in:150
  deallocate(compdof)   ! pio_sync_tests.F90.in:151
   ! pio_sync_tests.F90.in:152
  ! Set the decomposition for reading data - different from the write decomp
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:154
         start, count, .false.)   ! pio_sync_tests.F90.in:155
  allocate(rbuf(count(1)))   ! pio_sync_tests.F90.in:156
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:157
  allocate(exp_val(count(1)))   ! pio_sync_tests.F90.in:158
  do i=1,count(1)   ! pio_sync_tests.F90.in:159
    compdof(i) = start(1) + i -1   ! pio_sync_tests.F90.in:160
    ! Expected value, after reading, is the same as the compdof
    exp_val(i) = compdof(i)   ! pio_sync_tests.F90.in:162
  end do   ! pio_sync_tests.F90.in:163
   ! pio_sync_tests.F90.in:164
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof, rd_iodesc)   ! pio_sync_tests.F90.in:165
  deallocate(compdof)   ! pio_sync_tests.F90.in:166
   ! pio_sync_tests.F90.in:167
  num_iotypes = 0   ! pio_sync_tests.F90.in:168
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_sync_tests.F90.in:169
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_sync_tests.F90.in:170
  do i=1,num_iotypes   ! pio_sync_tests.F90.in:171

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_sync_tests.F90.in:172
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_sync_tests.F90.in:173
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:174)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:174
   ! pio_sync_tests.F90.in:175
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_sync_tests.F90.in:176
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:177)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:177
   ! pio_sync_tests.F90.in:178
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_real, (/pio_dim/), pio_var1)   ! pio_sync_tests.F90.in:179
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:180)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:180
   ! pio_sync_tests.F90.in:181
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_real, (/pio_dim/), pio_var2)   ! pio_sync_tests.F90.in:182
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:183)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:183
   ! pio_sync_tests.F90.in:184
    ierr = PIO_def_var(pio_file, PIO_VAR3_NAME, PIO_real, (/pio_dim/), pio_var3)   ! pio_sync_tests.F90.in:185
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:186)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:186
   ! pio_sync_tests.F90.in:187
    ierr = PIO_enddef(pio_file)   ! pio_sync_tests.F90.in:188
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:189)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:189
   ! pio_sync_tests.F90.in:190
    ! Write the variables out
    call PIO_write_darray(pio_file, pio_var1, wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:192
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:193)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:193
   ! pio_sync_tests.F90.in:194
    call PIO_write_darray(pio_file, pio_var2, wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:195
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:196)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:196
   ! pio_sync_tests.F90.in:197
    call PIO_write_darray(pio_file, pio_var3, wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:198
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:199)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:199
   ! pio_sync_tests.F90.in:200
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:202
   ! pio_sync_tests.F90.in:203
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_sync_tests.F90.in:204
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:205)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:205
   ! pio_sync_tests.F90.in:206
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_sync_tests.F90.in:207
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:208)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:208
   ! pio_sync_tests.F90.in:209
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_sync_tests.F90.in:210
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:211)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:211
   ! pio_sync_tests.F90.in:212
    ierr = PIO_inq_varid(pio_file, PIO_VAR3_NAME, pio_var3)   ! pio_sync_tests.F90.in:213
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var3 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:214)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:214
#else
    call PIO_syncfile(pio_file)   ! pio_sync_tests.F90.in:216
#endif
   ! pio_sync_tests.F90.in:218
    rbuf = 0   ! pio_sync_tests.F90.in:219
    call PIO_read_darray(pio_file, pio_var1, rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:220
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:221)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:221
   ! pio_sync_tests.F90.in:222
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var1)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:223)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:223
   ! pio_sync_tests.F90.in:224
    rbuf = 0   ! pio_sync_tests.F90.in:225
    call PIO_read_darray(pio_file, pio_var2, rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:226
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:227)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:227
   ! pio_sync_tests.F90.in:228
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var2)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:229)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:229
   ! pio_sync_tests.F90.in:230
    rbuf = 0   ! pio_sync_tests.F90.in:231
    call PIO_read_darray(pio_file, pio_var3, rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:232
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var3) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:233)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:233
   ! pio_sync_tests.F90.in:234
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var3)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:235)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:235
   ! pio_sync_tests.F90.in:236
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:237
       ! pio_sync_tests.F90.in:238
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_sync_tests.F90.in:239
  end do   ! pio_sync_tests.F90.in:240
   ! pio_sync_tests.F90.in:241
  if(allocated(iotypes)) then   ! pio_sync_tests.F90.in:242
    deallocate(iotypes)   ! pio_sync_tests.F90.in:243
    deallocate(iotype_descs)   ! pio_sync_tests.F90.in:244
  end if   ! pio_sync_tests.F90.in:245
   ! pio_sync_tests.F90.in:246
  call PIO_freedecomp(pio_tf_iosystem_, rd_iodesc)   ! pio_sync_tests.F90.in:247
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_sync_tests.F90.in:248
  deallocate(exp_val)   ! pio_sync_tests.F90.in:249
  deallocate(rbuf)   ! pio_sync_tests.F90.in:250
  deallocate(wbuf)   ! pio_sync_tests.F90.in:251
END SUBROUTINE nc_mvar_wr_rd_1d_bc_PIO_real_real_kind_fc_real___   ! pio_sync_tests.F90.in:252


SUBROUTINE nc_mvar_wr_rd_1d_bc_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_sync_tests.F90.in:103
  implicit none   ! pio_sync_tests.F90.in:104
  interface   ! pio_sync_tests.F90.in:105
    subroutine get_1d_bc_info(rank, sz, dims, start, count, force_rearrange)   ! pio_sync_tests.F90.in:106
      integer, intent(in) :: rank   ! pio_sync_tests.F90.in:107
      integer, intent(in) :: sz   ! pio_sync_tests.F90.in:108
      integer, dimension(1), intent(out) :: dims   ! pio_sync_tests.F90.in:109
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_sync_tests.F90.in:110
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_sync_tests.F90.in:111
      logical, intent(in) :: force_rearrange   ! pio_sync_tests.F90.in:112
    end subroutine get_1d_bc_info   ! pio_sync_tests.F90.in:113
  end interface   ! pio_sync_tests.F90.in:114
  type(var_desc_t)  :: pio_var1, pio_var2, pio_var3   ! pio_sync_tests.F90.in:115
  type(file_desc_t) :: pio_file   ! pio_sync_tests.F90.in:116
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_sync_tests.F90.in:117
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1'   ! pio_sync_tests.F90.in:118
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2'   ! pio_sync_tests.F90.in:119
  character(len=*), parameter :: PIO_VAR3_NAME = 'PIO_TF_test_var3'   ! pio_sync_tests.F90.in:120
  type(io_desc_t) :: wr_iodesc, rd_iodesc   ! pio_sync_tests.F90.in:121
  integer, dimension(:), allocatable :: compdof   ! pio_sync_tests.F90.in:122
  integer, dimension(:), allocatable :: start, count   ! pio_sync_tests.F90.in:123
  real(kind=fc_double), dimension(:), allocatable :: rbuf, wbuf, exp_val   ! pio_sync_tests.F90.in:124
  integer, dimension(1) :: dims   ! pio_sync_tests.F90.in:125
  integer :: pio_dim   ! pio_sync_tests.F90.in:126
  integer :: i, ierr, lsz   ! pio_sync_tests.F90.in:127
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_sync_tests.F90.in:129
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_sync_tests.F90.in:130
  integer :: num_iotypes   ! pio_sync_tests.F90.in:131
   ! pio_sync_tests.F90.in:132
  ! Set the decomposition for writing data - forcing rearrangement
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:134
         start, count, .true.)   ! pio_sync_tests.F90.in:135
  allocate(wbuf(count(1)))   ! pio_sync_tests.F90.in:136
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:137
  do i=1,count(1)   ! pio_sync_tests.F90.in:138
    wbuf(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:139
    compdof(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:140
  end do   ! pio_sync_tests.F90.in:141
  if(allocated(start))then   ! pio_sync_tests.F90.in:142
    deallocate(start)   ! pio_sync_tests.F90.in:143
  end if   ! pio_sync_tests.F90.in:144
   ! pio_sync_tests.F90.in:145
  if(allocated(count))then   ! pio_sync_tests.F90.in:146
    deallocate(count)   ! pio_sync_tests.F90.in:147
  end if   ! pio_sync_tests.F90.in:148
   ! pio_sync_tests.F90.in:149
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof, wr_iodesc)   ! pio_sync_tests.F90.in:150
  deallocate(compdof)   ! pio_sync_tests.F90.in:151
   ! pio_sync_tests.F90.in:152
  ! Set the decomposition for reading data - different from the write decomp
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:154
         start, count, .false.)   ! pio_sync_tests.F90.in:155
  allocate(rbuf(count(1)))   ! pio_sync_tests.F90.in:156
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:157
  allocate(exp_val(count(1)))   ! pio_sync_tests.F90.in:158
  do i=1,count(1)   ! pio_sync_tests.F90.in:159
    compdof(i) = start(1) + i -1   ! pio_sync_tests.F90.in:160
    ! Expected value, after reading, is the same as the compdof
    exp_val(i) = compdof(i)   ! pio_sync_tests.F90.in:162
  end do   ! pio_sync_tests.F90.in:163
   ! pio_sync_tests.F90.in:164
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof, rd_iodesc)   ! pio_sync_tests.F90.in:165
  deallocate(compdof)   ! pio_sync_tests.F90.in:166
   ! pio_sync_tests.F90.in:167
  num_iotypes = 0   ! pio_sync_tests.F90.in:168
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_sync_tests.F90.in:169
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_sync_tests.F90.in:170
  do i=1,num_iotypes   ! pio_sync_tests.F90.in:171

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_sync_tests.F90.in:172
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_sync_tests.F90.in:173
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:174)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:174
   ! pio_sync_tests.F90.in:175
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_sync_tests.F90.in:176
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:177)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:177
   ! pio_sync_tests.F90.in:178
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_double, (/pio_dim/), pio_var1)   ! pio_sync_tests.F90.in:179
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:180)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:180
   ! pio_sync_tests.F90.in:181
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_double, (/pio_dim/), pio_var2)   ! pio_sync_tests.F90.in:182
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:183)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:183
   ! pio_sync_tests.F90.in:184
    ierr = PIO_def_var(pio_file, PIO_VAR3_NAME, PIO_double, (/pio_dim/), pio_var3)   ! pio_sync_tests.F90.in:185
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:186)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:186
   ! pio_sync_tests.F90.in:187
    ierr = PIO_enddef(pio_file)   ! pio_sync_tests.F90.in:188
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:189)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:189
   ! pio_sync_tests.F90.in:190
    ! Write the variables out
    call PIO_write_darray(pio_file, pio_var1, wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:192
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:193)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:193
   ! pio_sync_tests.F90.in:194
    call PIO_write_darray(pio_file, pio_var2, wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:195
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:196)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:196
   ! pio_sync_tests.F90.in:197
    call PIO_write_darray(pio_file, pio_var3, wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:198
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:199)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:199
   ! pio_sync_tests.F90.in:200
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:202
   ! pio_sync_tests.F90.in:203
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_sync_tests.F90.in:204
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:205)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:205
   ! pio_sync_tests.F90.in:206
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_sync_tests.F90.in:207
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:208)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:208
   ! pio_sync_tests.F90.in:209
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_sync_tests.F90.in:210
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:211)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:211
   ! pio_sync_tests.F90.in:212
    ierr = PIO_inq_varid(pio_file, PIO_VAR3_NAME, pio_var3)   ! pio_sync_tests.F90.in:213
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var3 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:214)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:214
#else
    call PIO_syncfile(pio_file)   ! pio_sync_tests.F90.in:216
#endif
   ! pio_sync_tests.F90.in:218
    rbuf = 0   ! pio_sync_tests.F90.in:219
    call PIO_read_darray(pio_file, pio_var1, rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:220
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:221)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:221
   ! pio_sync_tests.F90.in:222
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var1)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:223)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:223
   ! pio_sync_tests.F90.in:224
    rbuf = 0   ! pio_sync_tests.F90.in:225
    call PIO_read_darray(pio_file, pio_var2, rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:226
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:227)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:227
   ! pio_sync_tests.F90.in:228
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var2)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:229)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:229
   ! pio_sync_tests.F90.in:230
    rbuf = 0   ! pio_sync_tests.F90.in:231
    call PIO_read_darray(pio_file, pio_var3, rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:232
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var3) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:233)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:233
   ! pio_sync_tests.F90.in:234
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var3)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:235)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:235
   ! pio_sync_tests.F90.in:236
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:237
       ! pio_sync_tests.F90.in:238
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_sync_tests.F90.in:239
  end do   ! pio_sync_tests.F90.in:240
   ! pio_sync_tests.F90.in:241
  if(allocated(iotypes)) then   ! pio_sync_tests.F90.in:242
    deallocate(iotypes)   ! pio_sync_tests.F90.in:243
    deallocate(iotype_descs)   ! pio_sync_tests.F90.in:244
  end if   ! pio_sync_tests.F90.in:245
   ! pio_sync_tests.F90.in:246
  call PIO_freedecomp(pio_tf_iosystem_, rd_iodesc)   ! pio_sync_tests.F90.in:247
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_sync_tests.F90.in:248
  deallocate(exp_val)   ! pio_sync_tests.F90.in:249
  deallocate(rbuf)   ! pio_sync_tests.F90.in:250
  deallocate(wbuf)   ! pio_sync_tests.F90.in:251
END SUBROUTINE nc_mvar_wr_rd_1d_bc_PIO_double_real_kind_fc_double___   ! pio_sync_tests.F90.in:252
   ! pio_sync_tests.F90.in:252


! Test writes multiple variables before syncing and reading them back
! This test adds multiple syncs between writes


SUBROUTINE nc_mvar_msync_1d_bc_PIO_int_integer__
USE pio_tutil
   ! pio_sync_tests.F90.in:257
  implicit none   ! pio_sync_tests.F90.in:258
  interface   ! pio_sync_tests.F90.in:259
    subroutine get_1d_bc_info(rank, sz, dims, start, count, force_rearrange)   ! pio_sync_tests.F90.in:260
      integer, intent(in) :: rank   ! pio_sync_tests.F90.in:261
      integer, intent(in) :: sz   ! pio_sync_tests.F90.in:262
      integer, dimension(1), intent(out) :: dims   ! pio_sync_tests.F90.in:263
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_sync_tests.F90.in:264
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_sync_tests.F90.in:265
      logical, intent(in) :: force_rearrange   ! pio_sync_tests.F90.in:266
    end subroutine get_1d_bc_info   ! pio_sync_tests.F90.in:267
  end interface   ! pio_sync_tests.F90.in:268
  integer, parameter :: NVARS = 8   ! pio_sync_tests.F90.in:269
  integer, parameter :: SYNC_STRIDE_START = 1   ! pio_sync_tests.F90.in:270
  ! The strides get incremented by SYNC_STRIDE_INC after each sync call
  ! With NVARS = 10, SYNC_STRIDE_START = 1, SYNC_STRIDE_INC = 1, the sync
  ! call is invoked after
  ! 1st (stride = 1), 3rd (stride = 2), 6th (stride = 3), 10th (stride = 4)
  ! pio_write_darray() calls
  integer, parameter :: SYNC_STRIDE_INC = 1   ! pio_sync_tests.F90.in:276
  type(var_desc_t)  :: pio_vars(NVARS)   ! pio_sync_tests.F90.in:277
  type(file_desc_t) :: pio_file   ! pio_sync_tests.F90.in:278
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_sync_tests.F90.in:279
  character(len=PIO_TF_MAX_STR_LEN) :: vnames(NVARS)   ! pio_sync_tests.F90.in:280
  type(io_desc_t) :: wr_iodesc, rd_iodesc   ! pio_sync_tests.F90.in:281
  integer, dimension(:), allocatable :: compdof   ! pio_sync_tests.F90.in:282
  integer, dimension(:), allocatable :: start, count   ! pio_sync_tests.F90.in:283
  integer, dimension(:), allocatable :: rbuf, wbuf, exp_val   ! pio_sync_tests.F90.in:284
  integer, dimension(1) :: dims   ! pio_sync_tests.F90.in:285
  integer :: pio_dim   ! pio_sync_tests.F90.in:286
  integer :: i, j, k, cur_sync_stride, isync, prev_isync, ierr, lsz   ! pio_sync_tests.F90.in:287
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_sync_tests.F90.in:289
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_sync_tests.F90.in:290
  integer :: num_iotypes   ! pio_sync_tests.F90.in:291
   ! pio_sync_tests.F90.in:292
  ! Set the decomposition for writing data - forcing rearrangement
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:294
         start, count, .true.)   ! pio_sync_tests.F90.in:295
  allocate(wbuf(count(1)))   ! pio_sync_tests.F90.in:296
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:297
  do i=1,count(1)   ! pio_sync_tests.F90.in:298
    wbuf(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:299
    compdof(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:300
  end do   ! pio_sync_tests.F90.in:301
  if(allocated(start))then   ! pio_sync_tests.F90.in:302
    deallocate(start)   ! pio_sync_tests.F90.in:303
  end if   ! pio_sync_tests.F90.in:304
   ! pio_sync_tests.F90.in:305
  if(allocated(count))then   ! pio_sync_tests.F90.in:306
    deallocate(count)   ! pio_sync_tests.F90.in:307
  end if   ! pio_sync_tests.F90.in:308
   ! pio_sync_tests.F90.in:309
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof, wr_iodesc)   ! pio_sync_tests.F90.in:310
  deallocate(compdof)   ! pio_sync_tests.F90.in:311
   ! pio_sync_tests.F90.in:312
  ! Set the decomposition for reading data - different from the write decomp
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:314
         start, count, .false.)   ! pio_sync_tests.F90.in:315
  allocate(rbuf(count(1)))   ! pio_sync_tests.F90.in:316
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:317
  allocate(exp_val(count(1)))   ! pio_sync_tests.F90.in:318
  do i=1,count(1)   ! pio_sync_tests.F90.in:319
    compdof(i) = start(1) + i -1   ! pio_sync_tests.F90.in:320
    ! Expected value, after reading, is the same as the compdof
    exp_val(i) = compdof(i)   ! pio_sync_tests.F90.in:322
  end do   ! pio_sync_tests.F90.in:323
   ! pio_sync_tests.F90.in:324
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof, rd_iodesc)   ! pio_sync_tests.F90.in:325
  deallocate(compdof)   ! pio_sync_tests.F90.in:326
   ! pio_sync_tests.F90.in:327
  num_iotypes = 0   ! pio_sync_tests.F90.in:328
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_sync_tests.F90.in:329
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_sync_tests.F90.in:330
  do i=1,num_iotypes   ! pio_sync_tests.F90.in:331

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_sync_tests.F90.in:332
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_sync_tests.F90.in:333
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:334)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:334
   ! pio_sync_tests.F90.in:335
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_sync_tests.F90.in:336
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:337)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:337
   ! pio_sync_tests.F90.in:338
    do j=1,NVARS   ! pio_sync_tests.F90.in:339
      vnames(j) = ""   ! pio_sync_tests.F90.in:340
      write(vnames(j), "(A15,I6.6)") "PIO_TF_test_var", j   ! pio_sync_tests.F90.in:341
      ierr = PIO_def_var(pio_file, trim(vnames(j)), PIO_int, (/pio_dim/), pio_vars(j))   ! pio_sync_tests.F90.in:342
      
      IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to define a var : " // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(pio_sync_tests.F90.in:343)"
        END IF
        RETURN
      END IF   ! pio_sync_tests.F90.in:343
    end do   ! pio_sync_tests.F90.in:344
   ! pio_sync_tests.F90.in:345
    ierr = PIO_enddef(pio_file)   ! pio_sync_tests.F90.in:346
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:347)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:347
   ! pio_sync_tests.F90.in:348
    ! Write the variables out - all the variables write out the same
    ! data.
    ! The stride determines the pio_syncfile calls, stride starts
    ! at SYNC_STRIDE_START and increases by SYNC_STRIDE_INC
    isync = SYNC_STRIDE_START   ! pio_sync_tests.F90.in:353
    prev_isync = 0   ! pio_sync_tests.F90.in:354
    cur_sync_stride = SYNC_STRIDE_START   ! pio_sync_tests.F90.in:355
    do j=1,NVARS   ! pio_sync_tests.F90.in:356
      call PIO_write_darray(pio_file, pio_vars(j), wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:357
      
      IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to write darray : " // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(pio_sync_tests.F90.in:358)"
        END IF
        RETURN
      END IF   ! pio_sync_tests.F90.in:358
      if(j == isync) then   ! pio_sync_tests.F90.in:359
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
        call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:361
   ! pio_sync_tests.F90.in:362
        ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_write)   ! pio_sync_tests.F90.in:363
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Could not reopen file " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_sync_tests.F90.in:364)"
          END IF
          RETURN
        END IF   ! pio_sync_tests.F90.in:364
   ! pio_sync_tests.F90.in:365
        do k=1,NVARS   ! pio_sync_tests.F90.in:366
          ierr = PIO_inq_varid(pio_file, vnames(k), pio_vars(k))   ! pio_sync_tests.F90.in:367
          
          IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
            pio_tf_retval_utest_ = -1
            IF (pio_tf_world_rank_ == 0) THEN
              PRINT *, "PIO_TF: PIO Function failed:",&
                 "Could not inq var :" // trim(filename),&
                ":", __FILE__, ":", __LINE__,&
                "(pio_sync_tests.F90.in:368)"
            END IF
            RETURN
          END IF   ! pio_sync_tests.F90.in:368
        end do   ! pio_sync_tests.F90.in:369
#else
        call PIO_syncfile(pio_file)   ! pio_sync_tests.F90.in:371
#endif
        do k=prev_isync+1, isync   ! pio_sync_tests.F90.in:373
          rbuf = 0   ! pio_sync_tests.F90.in:374
          call PIO_read_darray(pio_file, pio_vars(k), rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:375
          
          IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
            pio_tf_retval_utest_ = -1
            IF (pio_tf_world_rank_ == 0) THEN
              PRINT *, "PIO_TF: PIO Function failed:",&
                 "Failed to read darray : " // trim(filename),&
                ":", __FILE__, ":", __LINE__,&
                "(pio_sync_tests.F90.in:376)"
            END IF
            RETURN
          END IF   ! pio_sync_tests.F90.in:376
   ! pio_sync_tests.F90.in:377
          
          IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
            pio_tf_retval_utest_ = -1
            IF (pio_tf_world_rank_ == 0) THEN
              PRINT *, "PIO_TF: PIO Check failed:",&
                 "Got wrong val",&
                ":", __FILE__, ":", __LINE__,&
                "(pio_sync_tests.F90.in:378)"
            END IF
            RETURN
          END IF   ! pio_sync_tests.F90.in:378
        end do   ! pio_sync_tests.F90.in:379
        cur_sync_stride = cur_sync_stride + SYNC_STRIDE_INC   ! pio_sync_tests.F90.in:380
        prev_isync = isync   ! pio_sync_tests.F90.in:381
        isync = isync + cur_sync_stride   ! pio_sync_tests.F90.in:382
      end if   ! pio_sync_tests.F90.in:383
    end do   ! pio_sync_tests.F90.in:384
   ! pio_sync_tests.F90.in:385
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:387
   ! pio_sync_tests.F90.in:388
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_sync_tests.F90.in:389
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:390)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:390
   ! pio_sync_tests.F90.in:391
    do k=1,NVARS   ! pio_sync_tests.F90.in:392
      ierr = PIO_inq_varid(pio_file, vnames(k), pio_vars(k))   ! pio_sync_tests.F90.in:393
      
      IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Could not inq var :" // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(pio_sync_tests.F90.in:394)"
        END IF
        RETURN
      END IF   ! pio_sync_tests.F90.in:394
    end do   ! pio_sync_tests.F90.in:395
#else
    call PIO_syncfile(pio_file)   ! pio_sync_tests.F90.in:397
#endif
   ! pio_sync_tests.F90.in:399
    if(prev_isync < NVARS) then   ! pio_sync_tests.F90.in:400
      do k=prev_isync+1,NVARS   ! pio_sync_tests.F90.in:401
          rbuf = 0   ! pio_sync_tests.F90.in:402
          call PIO_read_darray(pio_file, pio_vars(k), rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:403
          
          IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
            pio_tf_retval_utest_ = -1
            IF (pio_tf_world_rank_ == 0) THEN
              PRINT *, "PIO_TF: PIO Function failed:",&
                 "Failed to read darray : " // trim(filename),&
                ":", __FILE__, ":", __LINE__,&
                "(pio_sync_tests.F90.in:404)"
            END IF
            RETURN
          END IF   ! pio_sync_tests.F90.in:404
   ! pio_sync_tests.F90.in:405
          
          IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
            pio_tf_retval_utest_ = -1
            IF (pio_tf_world_rank_ == 0) THEN
              PRINT *, "PIO_TF: PIO Check failed:",&
                 "Got wrong val",&
                ":", __FILE__, ":", __LINE__,&
                "(pio_sync_tests.F90.in:406)"
            END IF
            RETURN
          END IF   ! pio_sync_tests.F90.in:406
      end do   ! pio_sync_tests.F90.in:407
    end if   ! pio_sync_tests.F90.in:408
   ! pio_sync_tests.F90.in:409
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:410
   ! pio_sync_tests.F90.in:411
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_sync_tests.F90.in:412
  end do   ! pio_sync_tests.F90.in:413
   ! pio_sync_tests.F90.in:414
  if(allocated(iotypes)) then   ! pio_sync_tests.F90.in:415
    deallocate(iotypes)   ! pio_sync_tests.F90.in:416
    deallocate(iotype_descs)   ! pio_sync_tests.F90.in:417
  end if   ! pio_sync_tests.F90.in:418
   ! pio_sync_tests.F90.in:419
  call PIO_freedecomp(pio_tf_iosystem_, rd_iodesc)   ! pio_sync_tests.F90.in:420
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_sync_tests.F90.in:421
  deallocate(exp_val)   ! pio_sync_tests.F90.in:422
  deallocate(rbuf)   ! pio_sync_tests.F90.in:423
  deallocate(wbuf)   ! pio_sync_tests.F90.in:424
END SUBROUTINE nc_mvar_msync_1d_bc_PIO_int_integer__   ! pio_sync_tests.F90.in:425


SUBROUTINE nc_mvar_msync_1d_bc_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_sync_tests.F90.in:257
  implicit none   ! pio_sync_tests.F90.in:258
  interface   ! pio_sync_tests.F90.in:259
    subroutine get_1d_bc_info(rank, sz, dims, start, count, force_rearrange)   ! pio_sync_tests.F90.in:260
      integer, intent(in) :: rank   ! pio_sync_tests.F90.in:261
      integer, intent(in) :: sz   ! pio_sync_tests.F90.in:262
      integer, dimension(1), intent(out) :: dims   ! pio_sync_tests.F90.in:263
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_sync_tests.F90.in:264
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_sync_tests.F90.in:265
      logical, intent(in) :: force_rearrange   ! pio_sync_tests.F90.in:266
    end subroutine get_1d_bc_info   ! pio_sync_tests.F90.in:267
  end interface   ! pio_sync_tests.F90.in:268
  integer, parameter :: NVARS = 8   ! pio_sync_tests.F90.in:269
  integer, parameter :: SYNC_STRIDE_START = 1   ! pio_sync_tests.F90.in:270
  ! The strides get incremented by SYNC_STRIDE_INC after each sync call
  ! With NVARS = 10, SYNC_STRIDE_START = 1, SYNC_STRIDE_INC = 1, the sync
  ! call is invoked after
  ! 1st (stride = 1), 3rd (stride = 2), 6th (stride = 3), 10th (stride = 4)
  ! pio_write_darray() calls
  integer, parameter :: SYNC_STRIDE_INC = 1   ! pio_sync_tests.F90.in:276
  type(var_desc_t)  :: pio_vars(NVARS)   ! pio_sync_tests.F90.in:277
  type(file_desc_t) :: pio_file   ! pio_sync_tests.F90.in:278
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_sync_tests.F90.in:279
  character(len=PIO_TF_MAX_STR_LEN) :: vnames(NVARS)   ! pio_sync_tests.F90.in:280
  type(io_desc_t) :: wr_iodesc, rd_iodesc   ! pio_sync_tests.F90.in:281
  integer, dimension(:), allocatable :: compdof   ! pio_sync_tests.F90.in:282
  integer, dimension(:), allocatable :: start, count   ! pio_sync_tests.F90.in:283
  real(kind=fc_real), dimension(:), allocatable :: rbuf, wbuf, exp_val   ! pio_sync_tests.F90.in:284
  integer, dimension(1) :: dims   ! pio_sync_tests.F90.in:285
  integer :: pio_dim   ! pio_sync_tests.F90.in:286
  integer :: i, j, k, cur_sync_stride, isync, prev_isync, ierr, lsz   ! pio_sync_tests.F90.in:287
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_sync_tests.F90.in:289
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_sync_tests.F90.in:290
  integer :: num_iotypes   ! pio_sync_tests.F90.in:291
   ! pio_sync_tests.F90.in:292
  ! Set the decomposition for writing data - forcing rearrangement
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:294
         start, count, .true.)   ! pio_sync_tests.F90.in:295
  allocate(wbuf(count(1)))   ! pio_sync_tests.F90.in:296
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:297
  do i=1,count(1)   ! pio_sync_tests.F90.in:298
    wbuf(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:299
    compdof(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:300
  end do   ! pio_sync_tests.F90.in:301
  if(allocated(start))then   ! pio_sync_tests.F90.in:302
    deallocate(start)   ! pio_sync_tests.F90.in:303
  end if   ! pio_sync_tests.F90.in:304
   ! pio_sync_tests.F90.in:305
  if(allocated(count))then   ! pio_sync_tests.F90.in:306
    deallocate(count)   ! pio_sync_tests.F90.in:307
  end if   ! pio_sync_tests.F90.in:308
   ! pio_sync_tests.F90.in:309
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof, wr_iodesc)   ! pio_sync_tests.F90.in:310
  deallocate(compdof)   ! pio_sync_tests.F90.in:311
   ! pio_sync_tests.F90.in:312
  ! Set the decomposition for reading data - different from the write decomp
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:314
         start, count, .false.)   ! pio_sync_tests.F90.in:315
  allocate(rbuf(count(1)))   ! pio_sync_tests.F90.in:316
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:317
  allocate(exp_val(count(1)))   ! pio_sync_tests.F90.in:318
  do i=1,count(1)   ! pio_sync_tests.F90.in:319
    compdof(i) = start(1) + i -1   ! pio_sync_tests.F90.in:320
    ! Expected value, after reading, is the same as the compdof
    exp_val(i) = compdof(i)   ! pio_sync_tests.F90.in:322
  end do   ! pio_sync_tests.F90.in:323
   ! pio_sync_tests.F90.in:324
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof, rd_iodesc)   ! pio_sync_tests.F90.in:325
  deallocate(compdof)   ! pio_sync_tests.F90.in:326
   ! pio_sync_tests.F90.in:327
  num_iotypes = 0   ! pio_sync_tests.F90.in:328
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_sync_tests.F90.in:329
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_sync_tests.F90.in:330
  do i=1,num_iotypes   ! pio_sync_tests.F90.in:331

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_sync_tests.F90.in:332
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_sync_tests.F90.in:333
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:334)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:334
   ! pio_sync_tests.F90.in:335
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_sync_tests.F90.in:336
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:337)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:337
   ! pio_sync_tests.F90.in:338
    do j=1,NVARS   ! pio_sync_tests.F90.in:339
      vnames(j) = ""   ! pio_sync_tests.F90.in:340
      write(vnames(j), "(A15,I6.6)") "PIO_TF_test_var", j   ! pio_sync_tests.F90.in:341
      ierr = PIO_def_var(pio_file, trim(vnames(j)), PIO_real, (/pio_dim/), pio_vars(j))   ! pio_sync_tests.F90.in:342
      
      IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to define a var : " // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(pio_sync_tests.F90.in:343)"
        END IF
        RETURN
      END IF   ! pio_sync_tests.F90.in:343
    end do   ! pio_sync_tests.F90.in:344
   ! pio_sync_tests.F90.in:345
    ierr = PIO_enddef(pio_file)   ! pio_sync_tests.F90.in:346
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:347)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:347
   ! pio_sync_tests.F90.in:348
    ! Write the variables out - all the variables write out the same
    ! data.
    ! The stride determines the pio_syncfile calls, stride starts
    ! at SYNC_STRIDE_START and increases by SYNC_STRIDE_INC
    isync = SYNC_STRIDE_START   ! pio_sync_tests.F90.in:353
    prev_isync = 0   ! pio_sync_tests.F90.in:354
    cur_sync_stride = SYNC_STRIDE_START   ! pio_sync_tests.F90.in:355
    do j=1,NVARS   ! pio_sync_tests.F90.in:356
      call PIO_write_darray(pio_file, pio_vars(j), wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:357
      
      IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to write darray : " // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(pio_sync_tests.F90.in:358)"
        END IF
        RETURN
      END IF   ! pio_sync_tests.F90.in:358
      if(j == isync) then   ! pio_sync_tests.F90.in:359
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
        call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:361
   ! pio_sync_tests.F90.in:362
        ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_write)   ! pio_sync_tests.F90.in:363
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Could not reopen file " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_sync_tests.F90.in:364)"
          END IF
          RETURN
        END IF   ! pio_sync_tests.F90.in:364
   ! pio_sync_tests.F90.in:365
        do k=1,NVARS   ! pio_sync_tests.F90.in:366
          ierr = PIO_inq_varid(pio_file, vnames(k), pio_vars(k))   ! pio_sync_tests.F90.in:367
          
          IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
            pio_tf_retval_utest_ = -1
            IF (pio_tf_world_rank_ == 0) THEN
              PRINT *, "PIO_TF: PIO Function failed:",&
                 "Could not inq var :" // trim(filename),&
                ":", __FILE__, ":", __LINE__,&
                "(pio_sync_tests.F90.in:368)"
            END IF
            RETURN
          END IF   ! pio_sync_tests.F90.in:368
        end do   ! pio_sync_tests.F90.in:369
#else
        call PIO_syncfile(pio_file)   ! pio_sync_tests.F90.in:371
#endif
        do k=prev_isync+1, isync   ! pio_sync_tests.F90.in:373
          rbuf = 0   ! pio_sync_tests.F90.in:374
          call PIO_read_darray(pio_file, pio_vars(k), rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:375
          
          IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
            pio_tf_retval_utest_ = -1
            IF (pio_tf_world_rank_ == 0) THEN
              PRINT *, "PIO_TF: PIO Function failed:",&
                 "Failed to read darray : " // trim(filename),&
                ":", __FILE__, ":", __LINE__,&
                "(pio_sync_tests.F90.in:376)"
            END IF
            RETURN
          END IF   ! pio_sync_tests.F90.in:376
   ! pio_sync_tests.F90.in:377
          
          IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
            pio_tf_retval_utest_ = -1
            IF (pio_tf_world_rank_ == 0) THEN
              PRINT *, "PIO_TF: PIO Check failed:",&
                 "Got wrong val",&
                ":", __FILE__, ":", __LINE__,&
                "(pio_sync_tests.F90.in:378)"
            END IF
            RETURN
          END IF   ! pio_sync_tests.F90.in:378
        end do   ! pio_sync_tests.F90.in:379
        cur_sync_stride = cur_sync_stride + SYNC_STRIDE_INC   ! pio_sync_tests.F90.in:380
        prev_isync = isync   ! pio_sync_tests.F90.in:381
        isync = isync + cur_sync_stride   ! pio_sync_tests.F90.in:382
      end if   ! pio_sync_tests.F90.in:383
    end do   ! pio_sync_tests.F90.in:384
   ! pio_sync_tests.F90.in:385
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:387
   ! pio_sync_tests.F90.in:388
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_sync_tests.F90.in:389
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:390)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:390
   ! pio_sync_tests.F90.in:391
    do k=1,NVARS   ! pio_sync_tests.F90.in:392
      ierr = PIO_inq_varid(pio_file, vnames(k), pio_vars(k))   ! pio_sync_tests.F90.in:393
      
      IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Could not inq var :" // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(pio_sync_tests.F90.in:394)"
        END IF
        RETURN
      END IF   ! pio_sync_tests.F90.in:394
    end do   ! pio_sync_tests.F90.in:395
#else
    call PIO_syncfile(pio_file)   ! pio_sync_tests.F90.in:397
#endif
   ! pio_sync_tests.F90.in:399
    if(prev_isync < NVARS) then   ! pio_sync_tests.F90.in:400
      do k=prev_isync+1,NVARS   ! pio_sync_tests.F90.in:401
          rbuf = 0   ! pio_sync_tests.F90.in:402
          call PIO_read_darray(pio_file, pio_vars(k), rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:403
          
          IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
            pio_tf_retval_utest_ = -1
            IF (pio_tf_world_rank_ == 0) THEN
              PRINT *, "PIO_TF: PIO Function failed:",&
                 "Failed to read darray : " // trim(filename),&
                ":", __FILE__, ":", __LINE__,&
                "(pio_sync_tests.F90.in:404)"
            END IF
            RETURN
          END IF   ! pio_sync_tests.F90.in:404
   ! pio_sync_tests.F90.in:405
          
          IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
            pio_tf_retval_utest_ = -1
            IF (pio_tf_world_rank_ == 0) THEN
              PRINT *, "PIO_TF: PIO Check failed:",&
                 "Got wrong val",&
                ":", __FILE__, ":", __LINE__,&
                "(pio_sync_tests.F90.in:406)"
            END IF
            RETURN
          END IF   ! pio_sync_tests.F90.in:406
      end do   ! pio_sync_tests.F90.in:407
    end if   ! pio_sync_tests.F90.in:408
   ! pio_sync_tests.F90.in:409
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:410
   ! pio_sync_tests.F90.in:411
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_sync_tests.F90.in:412
  end do   ! pio_sync_tests.F90.in:413
   ! pio_sync_tests.F90.in:414
  if(allocated(iotypes)) then   ! pio_sync_tests.F90.in:415
    deallocate(iotypes)   ! pio_sync_tests.F90.in:416
    deallocate(iotype_descs)   ! pio_sync_tests.F90.in:417
  end if   ! pio_sync_tests.F90.in:418
   ! pio_sync_tests.F90.in:419
  call PIO_freedecomp(pio_tf_iosystem_, rd_iodesc)   ! pio_sync_tests.F90.in:420
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_sync_tests.F90.in:421
  deallocate(exp_val)   ! pio_sync_tests.F90.in:422
  deallocate(rbuf)   ! pio_sync_tests.F90.in:423
  deallocate(wbuf)   ! pio_sync_tests.F90.in:424
END SUBROUTINE nc_mvar_msync_1d_bc_PIO_real_real_kind_fc_real___   ! pio_sync_tests.F90.in:425


SUBROUTINE nc_mvar_msync_1d_bc_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_sync_tests.F90.in:257
  implicit none   ! pio_sync_tests.F90.in:258
  interface   ! pio_sync_tests.F90.in:259
    subroutine get_1d_bc_info(rank, sz, dims, start, count, force_rearrange)   ! pio_sync_tests.F90.in:260
      integer, intent(in) :: rank   ! pio_sync_tests.F90.in:261
      integer, intent(in) :: sz   ! pio_sync_tests.F90.in:262
      integer, dimension(1), intent(out) :: dims   ! pio_sync_tests.F90.in:263
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_sync_tests.F90.in:264
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_sync_tests.F90.in:265
      logical, intent(in) :: force_rearrange   ! pio_sync_tests.F90.in:266
    end subroutine get_1d_bc_info   ! pio_sync_tests.F90.in:267
  end interface   ! pio_sync_tests.F90.in:268
  integer, parameter :: NVARS = 8   ! pio_sync_tests.F90.in:269
  integer, parameter :: SYNC_STRIDE_START = 1   ! pio_sync_tests.F90.in:270
  ! The strides get incremented by SYNC_STRIDE_INC after each sync call
  ! With NVARS = 10, SYNC_STRIDE_START = 1, SYNC_STRIDE_INC = 1, the sync
  ! call is invoked after
  ! 1st (stride = 1), 3rd (stride = 2), 6th (stride = 3), 10th (stride = 4)
  ! pio_write_darray() calls
  integer, parameter :: SYNC_STRIDE_INC = 1   ! pio_sync_tests.F90.in:276
  type(var_desc_t)  :: pio_vars(NVARS)   ! pio_sync_tests.F90.in:277
  type(file_desc_t) :: pio_file   ! pio_sync_tests.F90.in:278
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_sync_tests.F90.in:279
  character(len=PIO_TF_MAX_STR_LEN) :: vnames(NVARS)   ! pio_sync_tests.F90.in:280
  type(io_desc_t) :: wr_iodesc, rd_iodesc   ! pio_sync_tests.F90.in:281
  integer, dimension(:), allocatable :: compdof   ! pio_sync_tests.F90.in:282
  integer, dimension(:), allocatable :: start, count   ! pio_sync_tests.F90.in:283
  real(kind=fc_double), dimension(:), allocatable :: rbuf, wbuf, exp_val   ! pio_sync_tests.F90.in:284
  integer, dimension(1) :: dims   ! pio_sync_tests.F90.in:285
  integer :: pio_dim   ! pio_sync_tests.F90.in:286
  integer :: i, j, k, cur_sync_stride, isync, prev_isync, ierr, lsz   ! pio_sync_tests.F90.in:287
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_sync_tests.F90.in:289
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_sync_tests.F90.in:290
  integer :: num_iotypes   ! pio_sync_tests.F90.in:291
   ! pio_sync_tests.F90.in:292
  ! Set the decomposition for writing data - forcing rearrangement
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:294
         start, count, .true.)   ! pio_sync_tests.F90.in:295
  allocate(wbuf(count(1)))   ! pio_sync_tests.F90.in:296
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:297
  do i=1,count(1)   ! pio_sync_tests.F90.in:298
    wbuf(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:299
    compdof(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:300
  end do   ! pio_sync_tests.F90.in:301
  if(allocated(start))then   ! pio_sync_tests.F90.in:302
    deallocate(start)   ! pio_sync_tests.F90.in:303
  end if   ! pio_sync_tests.F90.in:304
   ! pio_sync_tests.F90.in:305
  if(allocated(count))then   ! pio_sync_tests.F90.in:306
    deallocate(count)   ! pio_sync_tests.F90.in:307
  end if   ! pio_sync_tests.F90.in:308
   ! pio_sync_tests.F90.in:309
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof, wr_iodesc)   ! pio_sync_tests.F90.in:310
  deallocate(compdof)   ! pio_sync_tests.F90.in:311
   ! pio_sync_tests.F90.in:312
  ! Set the decomposition for reading data - different from the write decomp
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:314
         start, count, .false.)   ! pio_sync_tests.F90.in:315
  allocate(rbuf(count(1)))   ! pio_sync_tests.F90.in:316
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:317
  allocate(exp_val(count(1)))   ! pio_sync_tests.F90.in:318
  do i=1,count(1)   ! pio_sync_tests.F90.in:319
    compdof(i) = start(1) + i -1   ! pio_sync_tests.F90.in:320
    ! Expected value, after reading, is the same as the compdof
    exp_val(i) = compdof(i)   ! pio_sync_tests.F90.in:322
  end do   ! pio_sync_tests.F90.in:323
   ! pio_sync_tests.F90.in:324
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof, rd_iodesc)   ! pio_sync_tests.F90.in:325
  deallocate(compdof)   ! pio_sync_tests.F90.in:326
   ! pio_sync_tests.F90.in:327
  num_iotypes = 0   ! pio_sync_tests.F90.in:328
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_sync_tests.F90.in:329
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_sync_tests.F90.in:330
  do i=1,num_iotypes   ! pio_sync_tests.F90.in:331

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_sync_tests.F90.in:332
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_sync_tests.F90.in:333
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:334)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:334
   ! pio_sync_tests.F90.in:335
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_sync_tests.F90.in:336
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:337)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:337
   ! pio_sync_tests.F90.in:338
    do j=1,NVARS   ! pio_sync_tests.F90.in:339
      vnames(j) = ""   ! pio_sync_tests.F90.in:340
      write(vnames(j), "(A15,I6.6)") "PIO_TF_test_var", j   ! pio_sync_tests.F90.in:341
      ierr = PIO_def_var(pio_file, trim(vnames(j)), PIO_double, (/pio_dim/), pio_vars(j))   ! pio_sync_tests.F90.in:342
      
      IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to define a var : " // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(pio_sync_tests.F90.in:343)"
        END IF
        RETURN
      END IF   ! pio_sync_tests.F90.in:343
    end do   ! pio_sync_tests.F90.in:344
   ! pio_sync_tests.F90.in:345
    ierr = PIO_enddef(pio_file)   ! pio_sync_tests.F90.in:346
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:347)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:347
   ! pio_sync_tests.F90.in:348
    ! Write the variables out - all the variables write out the same
    ! data.
    ! The stride determines the pio_syncfile calls, stride starts
    ! at SYNC_STRIDE_START and increases by SYNC_STRIDE_INC
    isync = SYNC_STRIDE_START   ! pio_sync_tests.F90.in:353
    prev_isync = 0   ! pio_sync_tests.F90.in:354
    cur_sync_stride = SYNC_STRIDE_START   ! pio_sync_tests.F90.in:355
    do j=1,NVARS   ! pio_sync_tests.F90.in:356
      call PIO_write_darray(pio_file, pio_vars(j), wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:357
      
      IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Failed to write darray : " // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(pio_sync_tests.F90.in:358)"
        END IF
        RETURN
      END IF   ! pio_sync_tests.F90.in:358
      if(j == isync) then   ! pio_sync_tests.F90.in:359
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
        call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:361
   ! pio_sync_tests.F90.in:362
        ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_write)   ! pio_sync_tests.F90.in:363
        
        IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
          pio_tf_retval_utest_ = -1
          IF (pio_tf_world_rank_ == 0) THEN
            PRINT *, "PIO_TF: PIO Function failed:",&
               "Could not reopen file " // trim(filename),&
              ":", __FILE__, ":", __LINE__,&
              "(pio_sync_tests.F90.in:364)"
          END IF
          RETURN
        END IF   ! pio_sync_tests.F90.in:364
   ! pio_sync_tests.F90.in:365
        do k=1,NVARS   ! pio_sync_tests.F90.in:366
          ierr = PIO_inq_varid(pio_file, vnames(k), pio_vars(k))   ! pio_sync_tests.F90.in:367
          
          IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
            pio_tf_retval_utest_ = -1
            IF (pio_tf_world_rank_ == 0) THEN
              PRINT *, "PIO_TF: PIO Function failed:",&
                 "Could not inq var :" // trim(filename),&
                ":", __FILE__, ":", __LINE__,&
                "(pio_sync_tests.F90.in:368)"
            END IF
            RETURN
          END IF   ! pio_sync_tests.F90.in:368
        end do   ! pio_sync_tests.F90.in:369
#else
        call PIO_syncfile(pio_file)   ! pio_sync_tests.F90.in:371
#endif
        do k=prev_isync+1, isync   ! pio_sync_tests.F90.in:373
          rbuf = 0   ! pio_sync_tests.F90.in:374
          call PIO_read_darray(pio_file, pio_vars(k), rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:375
          
          IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
            pio_tf_retval_utest_ = -1
            IF (pio_tf_world_rank_ == 0) THEN
              PRINT *, "PIO_TF: PIO Function failed:",&
                 "Failed to read darray : " // trim(filename),&
                ":", __FILE__, ":", __LINE__,&
                "(pio_sync_tests.F90.in:376)"
            END IF
            RETURN
          END IF   ! pio_sync_tests.F90.in:376
   ! pio_sync_tests.F90.in:377
          
          IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
            pio_tf_retval_utest_ = -1
            IF (pio_tf_world_rank_ == 0) THEN
              PRINT *, "PIO_TF: PIO Check failed:",&
                 "Got wrong val",&
                ":", __FILE__, ":", __LINE__,&
                "(pio_sync_tests.F90.in:378)"
            END IF
            RETURN
          END IF   ! pio_sync_tests.F90.in:378
        end do   ! pio_sync_tests.F90.in:379
        cur_sync_stride = cur_sync_stride + SYNC_STRIDE_INC   ! pio_sync_tests.F90.in:380
        prev_isync = isync   ! pio_sync_tests.F90.in:381
        isync = isync + cur_sync_stride   ! pio_sync_tests.F90.in:382
      end if   ! pio_sync_tests.F90.in:383
    end do   ! pio_sync_tests.F90.in:384
   ! pio_sync_tests.F90.in:385
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:387
   ! pio_sync_tests.F90.in:388
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_sync_tests.F90.in:389
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:390)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:390
   ! pio_sync_tests.F90.in:391
    do k=1,NVARS   ! pio_sync_tests.F90.in:392
      ierr = PIO_inq_varid(pio_file, vnames(k), pio_vars(k))   ! pio_sync_tests.F90.in:393
      
      IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
        pio_tf_retval_utest_ = -1
        IF (pio_tf_world_rank_ == 0) THEN
          PRINT *, "PIO_TF: PIO Function failed:",&
             "Could not inq var :" // trim(filename),&
            ":", __FILE__, ":", __LINE__,&
            "(pio_sync_tests.F90.in:394)"
        END IF
        RETURN
      END IF   ! pio_sync_tests.F90.in:394
    end do   ! pio_sync_tests.F90.in:395
#else
    call PIO_syncfile(pio_file)   ! pio_sync_tests.F90.in:397
#endif
   ! pio_sync_tests.F90.in:399
    if(prev_isync < NVARS) then   ! pio_sync_tests.F90.in:400
      do k=prev_isync+1,NVARS   ! pio_sync_tests.F90.in:401
          rbuf = 0   ! pio_sync_tests.F90.in:402
          call PIO_read_darray(pio_file, pio_vars(k), rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:403
          
          IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
            pio_tf_retval_utest_ = -1
            IF (pio_tf_world_rank_ == 0) THEN
              PRINT *, "PIO_TF: PIO Function failed:",&
                 "Failed to read darray : " // trim(filename),&
                ":", __FILE__, ":", __LINE__,&
                "(pio_sync_tests.F90.in:404)"
            END IF
            RETURN
          END IF   ! pio_sync_tests.F90.in:404
   ! pio_sync_tests.F90.in:405
          
          IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
            pio_tf_retval_utest_ = -1
            IF (pio_tf_world_rank_ == 0) THEN
              PRINT *, "PIO_TF: PIO Check failed:",&
                 "Got wrong val",&
                ":", __FILE__, ":", __LINE__,&
                "(pio_sync_tests.F90.in:406)"
            END IF
            RETURN
          END IF   ! pio_sync_tests.F90.in:406
      end do   ! pio_sync_tests.F90.in:407
    end if   ! pio_sync_tests.F90.in:408
   ! pio_sync_tests.F90.in:409
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:410
   ! pio_sync_tests.F90.in:411
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_sync_tests.F90.in:412
  end do   ! pio_sync_tests.F90.in:413
   ! pio_sync_tests.F90.in:414
  if(allocated(iotypes)) then   ! pio_sync_tests.F90.in:415
    deallocate(iotypes)   ! pio_sync_tests.F90.in:416
    deallocate(iotype_descs)   ! pio_sync_tests.F90.in:417
  end if   ! pio_sync_tests.F90.in:418
   ! pio_sync_tests.F90.in:419
  call PIO_freedecomp(pio_tf_iosystem_, rd_iodesc)   ! pio_sync_tests.F90.in:420
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_sync_tests.F90.in:421
  deallocate(exp_val)   ! pio_sync_tests.F90.in:422
  deallocate(rbuf)   ! pio_sync_tests.F90.in:423
  deallocate(wbuf)   ! pio_sync_tests.F90.in:424
END SUBROUTINE nc_mvar_msync_1d_bc_PIO_double_real_kind_fc_double___   ! pio_sync_tests.F90.in:425
   ! pio_sync_tests.F90.in:425


! Test write/read of multiple variables before syncing
! * Variables 1 & 3 - each proc writes/reads multiple regions
!   of the data
! * Variables 2 & 4 - each proc writes/reads 1 region
!   (with data rearrangement)


SUBROUTINE nc_mvar_mreg_wr_rd_1d_bc_PIO_int_integer__
USE pio_tutil
   ! pio_sync_tests.F90.in:433
  implicit none   ! pio_sync_tests.F90.in:434
  interface   ! pio_sync_tests.F90.in:435
    subroutine get_1d_bc_info(rank, sz, dims, start, count, force_rearrange)   ! pio_sync_tests.F90.in:436
      integer, intent(in) :: rank   ! pio_sync_tests.F90.in:437
      integer, intent(in) :: sz   ! pio_sync_tests.F90.in:438
      integer, dimension(1), intent(out) :: dims   ! pio_sync_tests.F90.in:439
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_sync_tests.F90.in:440
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_sync_tests.F90.in:441
      logical, intent(in) :: force_rearrange   ! pio_sync_tests.F90.in:442
    end subroutine get_1d_bc_info   ! pio_sync_tests.F90.in:443
    subroutine get_1d_bc_mreg_info(rank, sz, dims, start, count)   ! pio_sync_tests.F90.in:444
      integer, intent(in) :: rank   ! pio_sync_tests.F90.in:445
      integer, intent(in) :: sz   ! pio_sync_tests.F90.in:446
      integer, dimension(1), intent(out) :: dims   ! pio_sync_tests.F90.in:447
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_sync_tests.F90.in:448
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_sync_tests.F90.in:449
    end subroutine get_1d_bc_mreg_info   ! pio_sync_tests.F90.in:450
  end interface   ! pio_sync_tests.F90.in:451
  type(var_desc_t)  :: pio_var1, pio_var2, pio_var3, pio_var4   ! pio_sync_tests.F90.in:452
  type(file_desc_t) :: pio_file   ! pio_sync_tests.F90.in:453
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_sync_tests.F90.in:454
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1_mreg'   ! pio_sync_tests.F90.in:455
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2'   ! pio_sync_tests.F90.in:456
  character(len=*), parameter :: PIO_VAR3_NAME = 'PIO_TF_test_var3_mreg'   ! pio_sync_tests.F90.in:457
  character(len=*), parameter :: PIO_VAR4_NAME = 'PIO_TF_test_var4'   ! pio_sync_tests.F90.in:458
  type(io_desc_t) :: iodesc_mreg, iodesc   ! pio_sync_tests.F90.in:459
  integer, dimension(:), allocatable :: compdof   ! pio_sync_tests.F90.in:460
  integer, dimension(:), allocatable :: start, count   ! pio_sync_tests.F90.in:461
  integer :: total_count   ! pio_sync_tests.F90.in:462
  integer, dimension(:), allocatable :: rbuf, wbuf   ! pio_sync_tests.F90.in:463
  integer, dimension(:), allocatable :: rbuf_mreg, wbuf_mreg   ! pio_sync_tests.F90.in:464
  integer, dimension(1) :: dims, dims_mreg   ! pio_sync_tests.F90.in:465
  integer :: pio_dim, pio_dim_mreg   ! pio_sync_tests.F90.in:466
  integer :: i, j, idx, ierr, lsz   ! pio_sync_tests.F90.in:467
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_sync_tests.F90.in:469
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_sync_tests.F90.in:470
  integer :: num_iotypes   ! pio_sync_tests.F90.in:471
   ! pio_sync_tests.F90.in:472
  ! Set the decomposition for writing data - forcing rearrangement
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:474
         start, count, .true.)   ! pio_sync_tests.F90.in:475
  allocate(wbuf(count(1)))   ! pio_sync_tests.F90.in:476
  allocate(rbuf(count(1)))   ! pio_sync_tests.F90.in:477
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:478
  do i=1,count(1)   ! pio_sync_tests.F90.in:479
    wbuf(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:480
    compdof(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:481
  end do   ! pio_sync_tests.F90.in:482
  rbuf = wbuf   ! pio_sync_tests.F90.in:483
  if(allocated(start)) then   ! pio_sync_tests.F90.in:484
    deallocate(start)   ! pio_sync_tests.F90.in:485
  end if   ! pio_sync_tests.F90.in:486
  if(allocated(count)) then   ! pio_sync_tests.F90.in:487
    deallocate(count)   ! pio_sync_tests.F90.in:488
  end if   ! pio_sync_tests.F90.in:489
   ! pio_sync_tests.F90.in:490
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof, iodesc)   ! pio_sync_tests.F90.in:491
  deallocate(compdof)   ! pio_sync_tests.F90.in:492
   ! pio_sync_tests.F90.in:493
  call get_1d_bc_mreg_info(pio_tf_world_rank_, pio_tf_world_sz_,&   ! pio_sync_tests.F90.in:494
         dims_mreg, start, count)   ! pio_sync_tests.F90.in:495
  total_count = 0   ! pio_sync_tests.F90.in:496
  do i=1,size(count)   ! pio_sync_tests.F90.in:497
    total_count = total_count + count(i)    ! pio_sync_tests.F90.in:498
  end do   ! pio_sync_tests.F90.in:499
  allocate(wbuf_mreg(total_count))   ! pio_sync_tests.F90.in:500
  allocate(rbuf_mreg(total_count))   ! pio_sync_tests.F90.in:501
  allocate(compdof(total_count))   ! pio_sync_tests.F90.in:502
  do i=1,size(count)   ! pio_sync_tests.F90.in:503
    do j=1,count(i)   ! pio_sync_tests.F90.in:504
      idx = (i-1)*count(i) + j   ! pio_sync_tests.F90.in:505
      compdof(idx) = start(i) + j - 1   ! pio_sync_tests.F90.in:506
      wbuf_mreg(idx) = compdof(idx)   ! pio_sync_tests.F90.in:507
      rbuf_mreg(idx) = compdof(idx)   ! pio_sync_tests.F90.in:508
    end do   ! pio_sync_tests.F90.in:509
  end do   ! pio_sync_tests.F90.in:510
  if(allocated(start)) then   ! pio_sync_tests.F90.in:511
    deallocate(start)   ! pio_sync_tests.F90.in:512
  end if   ! pio_sync_tests.F90.in:513
  if(allocated(count)) then   ! pio_sync_tests.F90.in:514
    deallocate(count)   ! pio_sync_tests.F90.in:515
  end if   ! pio_sync_tests.F90.in:516
   ! pio_sync_tests.F90.in:517
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims_mreg, compdof, iodesc_mreg)   ! pio_sync_tests.F90.in:518
  deallocate(compdof)   ! pio_sync_tests.F90.in:519
   ! pio_sync_tests.F90.in:520
  num_iotypes = 0   ! pio_sync_tests.F90.in:521
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_sync_tests.F90.in:522
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_sync_tests.F90.in:523
  do i=1,num_iotypes   ! pio_sync_tests.F90.in:524

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_sync_tests.F90.in:525
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_sync_tests.F90.in:526
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:527)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:527
   ! pio_sync_tests.F90.in:528
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_sync_tests.F90.in:529
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:530)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:530
   ! pio_sync_tests.F90.in:531
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim_mreg', dims_mreg(1), pio_dim_mreg)   ! pio_sync_tests.F90.in:532
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim (mreg) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:533)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:533
   ! pio_sync_tests.F90.in:534
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_int, (/pio_dim_mreg/), pio_var1)   ! pio_sync_tests.F90.in:535
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:536)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:536
   ! pio_sync_tests.F90.in:537
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_int, (/pio_dim/), pio_var2)   ! pio_sync_tests.F90.in:538
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:539)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:539
   ! pio_sync_tests.F90.in:540
    ierr = PIO_def_var(pio_file, PIO_VAR3_NAME, PIO_int, (/pio_dim_mreg/), pio_var3)   ! pio_sync_tests.F90.in:541
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var3) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:542)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:542
   ! pio_sync_tests.F90.in:543
    ierr = PIO_def_var(pio_file, PIO_VAR4_NAME, PIO_int, (/pio_dim/), pio_var4)   ! pio_sync_tests.F90.in:544
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var4) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:545)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:545
   ! pio_sync_tests.F90.in:546
    ierr = PIO_enddef(pio_file)   ! pio_sync_tests.F90.in:547
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:548)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:548
   ! pio_sync_tests.F90.in:549
    ! Write the variables out
    call PIO_write_darray(pio_file, pio_var1, iodesc_mreg, wbuf_mreg, ierr)   ! pio_sync_tests.F90.in:551
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:552)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:552
   ! pio_sync_tests.F90.in:553
    call PIO_write_darray(pio_file, pio_var2, iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:554
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:555)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:555
   ! pio_sync_tests.F90.in:556
    call PIO_write_darray(pio_file, pio_var3, iodesc_mreg, wbuf_mreg, ierr)   ! pio_sync_tests.F90.in:557
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var3) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:558)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:558
   ! pio_sync_tests.F90.in:559
    call PIO_write_darray(pio_file, pio_var4, iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:560
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var4) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:561)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:561
   ! pio_sync_tests.F90.in:562
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:564
   ! pio_sync_tests.F90.in:565
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_sync_tests.F90.in:566
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:567)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:567
   ! pio_sync_tests.F90.in:568
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_sync_tests.F90.in:569
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:570)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:570
   ! pio_sync_tests.F90.in:571
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_sync_tests.F90.in:572
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:573)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:573
   ! pio_sync_tests.F90.in:574
    ierr = PIO_inq_varid(pio_file, PIO_VAR3_NAME, pio_var3)   ! pio_sync_tests.F90.in:575
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var3 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:576)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:576
   ! pio_sync_tests.F90.in:577
    ierr = PIO_inq_varid(pio_file, PIO_VAR4_NAME, pio_var4)   ! pio_sync_tests.F90.in:578
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var4 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:579)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:579
#else
    call PIO_syncfile(pio_file)   ! pio_sync_tests.F90.in:581
#endif
   ! pio_sync_tests.F90.in:583
    rbuf_mreg = 0   ! pio_sync_tests.F90.in:584
    call PIO_read_darray(pio_file, pio_var1, iodesc_mreg, rbuf_mreg, ierr)   ! pio_sync_tests.F90.in:585
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var1): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:586)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:586
   ! pio_sync_tests.F90.in:587
    
    IF (.NOT. PIO_TF_Check_val_(rbuf_mreg, wbuf_mreg)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var1)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:588)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:588
   ! pio_sync_tests.F90.in:589
    rbuf_mreg = 0   ! pio_sync_tests.F90.in:590
    call PIO_read_darray(pio_file, pio_var3, iodesc_mreg, rbuf_mreg, ierr)   ! pio_sync_tests.F90.in:591
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var3): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:592)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:592
   ! pio_sync_tests.F90.in:593
    
    IF (.NOT. PIO_TF_Check_val_(rbuf_mreg, wbuf_mreg)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var2)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:594)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:594
   ! pio_sync_tests.F90.in:595
    rbuf = 0   ! pio_sync_tests.F90.in:596
    call PIO_read_darray(pio_file, pio_var2, iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:597
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var2): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:598)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:598
   ! pio_sync_tests.F90.in:599
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var2)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:600)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:600
   ! pio_sync_tests.F90.in:601
    rbuf = 0   ! pio_sync_tests.F90.in:602
    call PIO_read_darray(pio_file, pio_var4, iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:603
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var4): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:604)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:604
   ! pio_sync_tests.F90.in:605
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var4)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:606)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:606
   ! pio_sync_tests.F90.in:607
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:608
       ! pio_sync_tests.F90.in:609
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_sync_tests.F90.in:610
  end do   ! pio_sync_tests.F90.in:611
   ! pio_sync_tests.F90.in:612
  if(allocated(iotypes)) then   ! pio_sync_tests.F90.in:613
    deallocate(iotypes)   ! pio_sync_tests.F90.in:614
    deallocate(iotype_descs)   ! pio_sync_tests.F90.in:615
  end if   ! pio_sync_tests.F90.in:616
   ! pio_sync_tests.F90.in:617
  call PIO_freedecomp(pio_tf_iosystem_, iodesc)   ! pio_sync_tests.F90.in:618
  call PIO_freedecomp(pio_tf_iosystem_, iodesc_mreg)   ! pio_sync_tests.F90.in:619
  deallocate(rbuf)   ! pio_sync_tests.F90.in:620
  deallocate(rbuf_mreg)   ! pio_sync_tests.F90.in:621
  deallocate(wbuf)   ! pio_sync_tests.F90.in:622
  deallocate(wbuf_mreg)   ! pio_sync_tests.F90.in:623
END SUBROUTINE nc_mvar_mreg_wr_rd_1d_bc_PIO_int_integer__   ! pio_sync_tests.F90.in:624


SUBROUTINE nc_mvar_mreg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_sync_tests.F90.in:433
  implicit none   ! pio_sync_tests.F90.in:434
  interface   ! pio_sync_tests.F90.in:435
    subroutine get_1d_bc_info(rank, sz, dims, start, count, force_rearrange)   ! pio_sync_tests.F90.in:436
      integer, intent(in) :: rank   ! pio_sync_tests.F90.in:437
      integer, intent(in) :: sz   ! pio_sync_tests.F90.in:438
      integer, dimension(1), intent(out) :: dims   ! pio_sync_tests.F90.in:439
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_sync_tests.F90.in:440
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_sync_tests.F90.in:441
      logical, intent(in) :: force_rearrange   ! pio_sync_tests.F90.in:442
    end subroutine get_1d_bc_info   ! pio_sync_tests.F90.in:443
    subroutine get_1d_bc_mreg_info(rank, sz, dims, start, count)   ! pio_sync_tests.F90.in:444
      integer, intent(in) :: rank   ! pio_sync_tests.F90.in:445
      integer, intent(in) :: sz   ! pio_sync_tests.F90.in:446
      integer, dimension(1), intent(out) :: dims   ! pio_sync_tests.F90.in:447
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_sync_tests.F90.in:448
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_sync_tests.F90.in:449
    end subroutine get_1d_bc_mreg_info   ! pio_sync_tests.F90.in:450
  end interface   ! pio_sync_tests.F90.in:451
  type(var_desc_t)  :: pio_var1, pio_var2, pio_var3, pio_var4   ! pio_sync_tests.F90.in:452
  type(file_desc_t) :: pio_file   ! pio_sync_tests.F90.in:453
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_sync_tests.F90.in:454
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1_mreg'   ! pio_sync_tests.F90.in:455
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2'   ! pio_sync_tests.F90.in:456
  character(len=*), parameter :: PIO_VAR3_NAME = 'PIO_TF_test_var3_mreg'   ! pio_sync_tests.F90.in:457
  character(len=*), parameter :: PIO_VAR4_NAME = 'PIO_TF_test_var4'   ! pio_sync_tests.F90.in:458
  type(io_desc_t) :: iodesc_mreg, iodesc   ! pio_sync_tests.F90.in:459
  integer, dimension(:), allocatable :: compdof   ! pio_sync_tests.F90.in:460
  integer, dimension(:), allocatable :: start, count   ! pio_sync_tests.F90.in:461
  integer :: total_count   ! pio_sync_tests.F90.in:462
  real(kind=fc_real), dimension(:), allocatable :: rbuf, wbuf   ! pio_sync_tests.F90.in:463
  real(kind=fc_real), dimension(:), allocatable :: rbuf_mreg, wbuf_mreg   ! pio_sync_tests.F90.in:464
  integer, dimension(1) :: dims, dims_mreg   ! pio_sync_tests.F90.in:465
  integer :: pio_dim, pio_dim_mreg   ! pio_sync_tests.F90.in:466
  integer :: i, j, idx, ierr, lsz   ! pio_sync_tests.F90.in:467
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_sync_tests.F90.in:469
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_sync_tests.F90.in:470
  integer :: num_iotypes   ! pio_sync_tests.F90.in:471
   ! pio_sync_tests.F90.in:472
  ! Set the decomposition for writing data - forcing rearrangement
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:474
         start, count, .true.)   ! pio_sync_tests.F90.in:475
  allocate(wbuf(count(1)))   ! pio_sync_tests.F90.in:476
  allocate(rbuf(count(1)))   ! pio_sync_tests.F90.in:477
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:478
  do i=1,count(1)   ! pio_sync_tests.F90.in:479
    wbuf(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:480
    compdof(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:481
  end do   ! pio_sync_tests.F90.in:482
  rbuf = wbuf   ! pio_sync_tests.F90.in:483
  if(allocated(start)) then   ! pio_sync_tests.F90.in:484
    deallocate(start)   ! pio_sync_tests.F90.in:485
  end if   ! pio_sync_tests.F90.in:486
  if(allocated(count)) then   ! pio_sync_tests.F90.in:487
    deallocate(count)   ! pio_sync_tests.F90.in:488
  end if   ! pio_sync_tests.F90.in:489
   ! pio_sync_tests.F90.in:490
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof, iodesc)   ! pio_sync_tests.F90.in:491
  deallocate(compdof)   ! pio_sync_tests.F90.in:492
   ! pio_sync_tests.F90.in:493
  call get_1d_bc_mreg_info(pio_tf_world_rank_, pio_tf_world_sz_,&   ! pio_sync_tests.F90.in:494
         dims_mreg, start, count)   ! pio_sync_tests.F90.in:495
  total_count = 0   ! pio_sync_tests.F90.in:496
  do i=1,size(count)   ! pio_sync_tests.F90.in:497
    total_count = total_count + count(i)    ! pio_sync_tests.F90.in:498
  end do   ! pio_sync_tests.F90.in:499
  allocate(wbuf_mreg(total_count))   ! pio_sync_tests.F90.in:500
  allocate(rbuf_mreg(total_count))   ! pio_sync_tests.F90.in:501
  allocate(compdof(total_count))   ! pio_sync_tests.F90.in:502
  do i=1,size(count)   ! pio_sync_tests.F90.in:503
    do j=1,count(i)   ! pio_sync_tests.F90.in:504
      idx = (i-1)*count(i) + j   ! pio_sync_tests.F90.in:505
      compdof(idx) = start(i) + j - 1   ! pio_sync_tests.F90.in:506
      wbuf_mreg(idx) = compdof(idx)   ! pio_sync_tests.F90.in:507
      rbuf_mreg(idx) = compdof(idx)   ! pio_sync_tests.F90.in:508
    end do   ! pio_sync_tests.F90.in:509
  end do   ! pio_sync_tests.F90.in:510
  if(allocated(start)) then   ! pio_sync_tests.F90.in:511
    deallocate(start)   ! pio_sync_tests.F90.in:512
  end if   ! pio_sync_tests.F90.in:513
  if(allocated(count)) then   ! pio_sync_tests.F90.in:514
    deallocate(count)   ! pio_sync_tests.F90.in:515
  end if   ! pio_sync_tests.F90.in:516
   ! pio_sync_tests.F90.in:517
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims_mreg, compdof, iodesc_mreg)   ! pio_sync_tests.F90.in:518
  deallocate(compdof)   ! pio_sync_tests.F90.in:519
   ! pio_sync_tests.F90.in:520
  num_iotypes = 0   ! pio_sync_tests.F90.in:521
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_sync_tests.F90.in:522
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_sync_tests.F90.in:523
  do i=1,num_iotypes   ! pio_sync_tests.F90.in:524

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_sync_tests.F90.in:525
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_sync_tests.F90.in:526
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:527)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:527
   ! pio_sync_tests.F90.in:528
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_sync_tests.F90.in:529
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:530)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:530
   ! pio_sync_tests.F90.in:531
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim_mreg', dims_mreg(1), pio_dim_mreg)   ! pio_sync_tests.F90.in:532
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim (mreg) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:533)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:533
   ! pio_sync_tests.F90.in:534
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_real, (/pio_dim_mreg/), pio_var1)   ! pio_sync_tests.F90.in:535
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:536)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:536
   ! pio_sync_tests.F90.in:537
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_real, (/pio_dim/), pio_var2)   ! pio_sync_tests.F90.in:538
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:539)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:539
   ! pio_sync_tests.F90.in:540
    ierr = PIO_def_var(pio_file, PIO_VAR3_NAME, PIO_real, (/pio_dim_mreg/), pio_var3)   ! pio_sync_tests.F90.in:541
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var3) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:542)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:542
   ! pio_sync_tests.F90.in:543
    ierr = PIO_def_var(pio_file, PIO_VAR4_NAME, PIO_real, (/pio_dim/), pio_var4)   ! pio_sync_tests.F90.in:544
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var4) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:545)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:545
   ! pio_sync_tests.F90.in:546
    ierr = PIO_enddef(pio_file)   ! pio_sync_tests.F90.in:547
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:548)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:548
   ! pio_sync_tests.F90.in:549
    ! Write the variables out
    call PIO_write_darray(pio_file, pio_var1, iodesc_mreg, wbuf_mreg, ierr)   ! pio_sync_tests.F90.in:551
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:552)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:552
   ! pio_sync_tests.F90.in:553
    call PIO_write_darray(pio_file, pio_var2, iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:554
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:555)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:555
   ! pio_sync_tests.F90.in:556
    call PIO_write_darray(pio_file, pio_var3, iodesc_mreg, wbuf_mreg, ierr)   ! pio_sync_tests.F90.in:557
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var3) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:558)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:558
   ! pio_sync_tests.F90.in:559
    call PIO_write_darray(pio_file, pio_var4, iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:560
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var4) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:561)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:561
   ! pio_sync_tests.F90.in:562
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:564
   ! pio_sync_tests.F90.in:565
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_sync_tests.F90.in:566
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:567)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:567
   ! pio_sync_tests.F90.in:568
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_sync_tests.F90.in:569
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:570)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:570
   ! pio_sync_tests.F90.in:571
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_sync_tests.F90.in:572
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:573)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:573
   ! pio_sync_tests.F90.in:574
    ierr = PIO_inq_varid(pio_file, PIO_VAR3_NAME, pio_var3)   ! pio_sync_tests.F90.in:575
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var3 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:576)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:576
   ! pio_sync_tests.F90.in:577
    ierr = PIO_inq_varid(pio_file, PIO_VAR4_NAME, pio_var4)   ! pio_sync_tests.F90.in:578
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var4 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:579)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:579
#else
    call PIO_syncfile(pio_file)   ! pio_sync_tests.F90.in:581
#endif
   ! pio_sync_tests.F90.in:583
    rbuf_mreg = 0   ! pio_sync_tests.F90.in:584
    call PIO_read_darray(pio_file, pio_var1, iodesc_mreg, rbuf_mreg, ierr)   ! pio_sync_tests.F90.in:585
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var1): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:586)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:586
   ! pio_sync_tests.F90.in:587
    
    IF (.NOT. PIO_TF_Check_val_(rbuf_mreg, wbuf_mreg)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var1)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:588)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:588
   ! pio_sync_tests.F90.in:589
    rbuf_mreg = 0   ! pio_sync_tests.F90.in:590
    call PIO_read_darray(pio_file, pio_var3, iodesc_mreg, rbuf_mreg, ierr)   ! pio_sync_tests.F90.in:591
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var3): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:592)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:592
   ! pio_sync_tests.F90.in:593
    
    IF (.NOT. PIO_TF_Check_val_(rbuf_mreg, wbuf_mreg)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var2)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:594)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:594
   ! pio_sync_tests.F90.in:595
    rbuf = 0   ! pio_sync_tests.F90.in:596
    call PIO_read_darray(pio_file, pio_var2, iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:597
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var2): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:598)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:598
   ! pio_sync_tests.F90.in:599
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var2)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:600)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:600
   ! pio_sync_tests.F90.in:601
    rbuf = 0   ! pio_sync_tests.F90.in:602
    call PIO_read_darray(pio_file, pio_var4, iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:603
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var4): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:604)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:604
   ! pio_sync_tests.F90.in:605
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var4)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:606)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:606
   ! pio_sync_tests.F90.in:607
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:608
       ! pio_sync_tests.F90.in:609
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_sync_tests.F90.in:610
  end do   ! pio_sync_tests.F90.in:611
   ! pio_sync_tests.F90.in:612
  if(allocated(iotypes)) then   ! pio_sync_tests.F90.in:613
    deallocate(iotypes)   ! pio_sync_tests.F90.in:614
    deallocate(iotype_descs)   ! pio_sync_tests.F90.in:615
  end if   ! pio_sync_tests.F90.in:616
   ! pio_sync_tests.F90.in:617
  call PIO_freedecomp(pio_tf_iosystem_, iodesc)   ! pio_sync_tests.F90.in:618
  call PIO_freedecomp(pio_tf_iosystem_, iodesc_mreg)   ! pio_sync_tests.F90.in:619
  deallocate(rbuf)   ! pio_sync_tests.F90.in:620
  deallocate(rbuf_mreg)   ! pio_sync_tests.F90.in:621
  deallocate(wbuf)   ! pio_sync_tests.F90.in:622
  deallocate(wbuf_mreg)   ! pio_sync_tests.F90.in:623
END SUBROUTINE nc_mvar_mreg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___   ! pio_sync_tests.F90.in:624


SUBROUTINE nc_mvar_mreg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_sync_tests.F90.in:433
  implicit none   ! pio_sync_tests.F90.in:434
  interface   ! pio_sync_tests.F90.in:435
    subroutine get_1d_bc_info(rank, sz, dims, start, count, force_rearrange)   ! pio_sync_tests.F90.in:436
      integer, intent(in) :: rank   ! pio_sync_tests.F90.in:437
      integer, intent(in) :: sz   ! pio_sync_tests.F90.in:438
      integer, dimension(1), intent(out) :: dims   ! pio_sync_tests.F90.in:439
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_sync_tests.F90.in:440
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_sync_tests.F90.in:441
      logical, intent(in) :: force_rearrange   ! pio_sync_tests.F90.in:442
    end subroutine get_1d_bc_info   ! pio_sync_tests.F90.in:443
    subroutine get_1d_bc_mreg_info(rank, sz, dims, start, count)   ! pio_sync_tests.F90.in:444
      integer, intent(in) :: rank   ! pio_sync_tests.F90.in:445
      integer, intent(in) :: sz   ! pio_sync_tests.F90.in:446
      integer, dimension(1), intent(out) :: dims   ! pio_sync_tests.F90.in:447
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_sync_tests.F90.in:448
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_sync_tests.F90.in:449
    end subroutine get_1d_bc_mreg_info   ! pio_sync_tests.F90.in:450
  end interface   ! pio_sync_tests.F90.in:451
  type(var_desc_t)  :: pio_var1, pio_var2, pio_var3, pio_var4   ! pio_sync_tests.F90.in:452
  type(file_desc_t) :: pio_file   ! pio_sync_tests.F90.in:453
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_sync_tests.F90.in:454
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1_mreg'   ! pio_sync_tests.F90.in:455
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2'   ! pio_sync_tests.F90.in:456
  character(len=*), parameter :: PIO_VAR3_NAME = 'PIO_TF_test_var3_mreg'   ! pio_sync_tests.F90.in:457
  character(len=*), parameter :: PIO_VAR4_NAME = 'PIO_TF_test_var4'   ! pio_sync_tests.F90.in:458
  type(io_desc_t) :: iodesc_mreg, iodesc   ! pio_sync_tests.F90.in:459
  integer, dimension(:), allocatable :: compdof   ! pio_sync_tests.F90.in:460
  integer, dimension(:), allocatable :: start, count   ! pio_sync_tests.F90.in:461
  integer :: total_count   ! pio_sync_tests.F90.in:462
  real(kind=fc_double), dimension(:), allocatable :: rbuf, wbuf   ! pio_sync_tests.F90.in:463
  real(kind=fc_double), dimension(:), allocatable :: rbuf_mreg, wbuf_mreg   ! pio_sync_tests.F90.in:464
  integer, dimension(1) :: dims, dims_mreg   ! pio_sync_tests.F90.in:465
  integer :: pio_dim, pio_dim_mreg   ! pio_sync_tests.F90.in:466
  integer :: i, j, idx, ierr, lsz   ! pio_sync_tests.F90.in:467
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_sync_tests.F90.in:469
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_sync_tests.F90.in:470
  integer :: num_iotypes   ! pio_sync_tests.F90.in:471
   ! pio_sync_tests.F90.in:472
  ! Set the decomposition for writing data - forcing rearrangement
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:474
         start, count, .true.)   ! pio_sync_tests.F90.in:475
  allocate(wbuf(count(1)))   ! pio_sync_tests.F90.in:476
  allocate(rbuf(count(1)))   ! pio_sync_tests.F90.in:477
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:478
  do i=1,count(1)   ! pio_sync_tests.F90.in:479
    wbuf(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:480
    compdof(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:481
  end do   ! pio_sync_tests.F90.in:482
  rbuf = wbuf   ! pio_sync_tests.F90.in:483
  if(allocated(start)) then   ! pio_sync_tests.F90.in:484
    deallocate(start)   ! pio_sync_tests.F90.in:485
  end if   ! pio_sync_tests.F90.in:486
  if(allocated(count)) then   ! pio_sync_tests.F90.in:487
    deallocate(count)   ! pio_sync_tests.F90.in:488
  end if   ! pio_sync_tests.F90.in:489
   ! pio_sync_tests.F90.in:490
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof, iodesc)   ! pio_sync_tests.F90.in:491
  deallocate(compdof)   ! pio_sync_tests.F90.in:492
   ! pio_sync_tests.F90.in:493
  call get_1d_bc_mreg_info(pio_tf_world_rank_, pio_tf_world_sz_,&   ! pio_sync_tests.F90.in:494
         dims_mreg, start, count)   ! pio_sync_tests.F90.in:495
  total_count = 0   ! pio_sync_tests.F90.in:496
  do i=1,size(count)   ! pio_sync_tests.F90.in:497
    total_count = total_count + count(i)    ! pio_sync_tests.F90.in:498
  end do   ! pio_sync_tests.F90.in:499
  allocate(wbuf_mreg(total_count))   ! pio_sync_tests.F90.in:500
  allocate(rbuf_mreg(total_count))   ! pio_sync_tests.F90.in:501
  allocate(compdof(total_count))   ! pio_sync_tests.F90.in:502
  do i=1,size(count)   ! pio_sync_tests.F90.in:503
    do j=1,count(i)   ! pio_sync_tests.F90.in:504
      idx = (i-1)*count(i) + j   ! pio_sync_tests.F90.in:505
      compdof(idx) = start(i) + j - 1   ! pio_sync_tests.F90.in:506
      wbuf_mreg(idx) = compdof(idx)   ! pio_sync_tests.F90.in:507
      rbuf_mreg(idx) = compdof(idx)   ! pio_sync_tests.F90.in:508
    end do   ! pio_sync_tests.F90.in:509
  end do   ! pio_sync_tests.F90.in:510
  if(allocated(start)) then   ! pio_sync_tests.F90.in:511
    deallocate(start)   ! pio_sync_tests.F90.in:512
  end if   ! pio_sync_tests.F90.in:513
  if(allocated(count)) then   ! pio_sync_tests.F90.in:514
    deallocate(count)   ! pio_sync_tests.F90.in:515
  end if   ! pio_sync_tests.F90.in:516
   ! pio_sync_tests.F90.in:517
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims_mreg, compdof, iodesc_mreg)   ! pio_sync_tests.F90.in:518
  deallocate(compdof)   ! pio_sync_tests.F90.in:519
   ! pio_sync_tests.F90.in:520
  num_iotypes = 0   ! pio_sync_tests.F90.in:521
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_sync_tests.F90.in:522
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_sync_tests.F90.in:523
  do i=1,num_iotypes   ! pio_sync_tests.F90.in:524

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_sync_tests.F90.in:525
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_sync_tests.F90.in:526
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:527)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:527
   ! pio_sync_tests.F90.in:528
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_sync_tests.F90.in:529
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:530)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:530
   ! pio_sync_tests.F90.in:531
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim_mreg', dims_mreg(1), pio_dim_mreg)   ! pio_sync_tests.F90.in:532
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim (mreg) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:533)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:533
   ! pio_sync_tests.F90.in:534
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_double, (/pio_dim_mreg/), pio_var1)   ! pio_sync_tests.F90.in:535
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:536)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:536
   ! pio_sync_tests.F90.in:537
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_double, (/pio_dim/), pio_var2)   ! pio_sync_tests.F90.in:538
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:539)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:539
   ! pio_sync_tests.F90.in:540
    ierr = PIO_def_var(pio_file, PIO_VAR3_NAME, PIO_double, (/pio_dim_mreg/), pio_var3)   ! pio_sync_tests.F90.in:541
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var3) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:542)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:542
   ! pio_sync_tests.F90.in:543
    ierr = PIO_def_var(pio_file, PIO_VAR4_NAME, PIO_double, (/pio_dim/), pio_var4)   ! pio_sync_tests.F90.in:544
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var (var4) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:545)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:545
   ! pio_sync_tests.F90.in:546
    ierr = PIO_enddef(pio_file)   ! pio_sync_tests.F90.in:547
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:548)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:548
   ! pio_sync_tests.F90.in:549
    ! Write the variables out
    call PIO_write_darray(pio_file, pio_var1, iodesc_mreg, wbuf_mreg, ierr)   ! pio_sync_tests.F90.in:551
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:552)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:552
   ! pio_sync_tests.F90.in:553
    call PIO_write_darray(pio_file, pio_var2, iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:554
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:555)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:555
   ! pio_sync_tests.F90.in:556
    call PIO_write_darray(pio_file, pio_var3, iodesc_mreg, wbuf_mreg, ierr)   ! pio_sync_tests.F90.in:557
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var3) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:558)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:558
   ! pio_sync_tests.F90.in:559
    call PIO_write_darray(pio_file, pio_var4, iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:560
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray (var4) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:561)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:561
   ! pio_sync_tests.F90.in:562
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:564
   ! pio_sync_tests.F90.in:565
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_sync_tests.F90.in:566
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:567)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:567
   ! pio_sync_tests.F90.in:568
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_sync_tests.F90.in:569
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:570)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:570
   ! pio_sync_tests.F90.in:571
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_sync_tests.F90.in:572
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:573)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:573
   ! pio_sync_tests.F90.in:574
    ierr = PIO_inq_varid(pio_file, PIO_VAR3_NAME, pio_var3)   ! pio_sync_tests.F90.in:575
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var3 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:576)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:576
   ! pio_sync_tests.F90.in:577
    ierr = PIO_inq_varid(pio_file, PIO_VAR4_NAME, pio_var4)   ! pio_sync_tests.F90.in:578
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var4 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:579)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:579
#else
    call PIO_syncfile(pio_file)   ! pio_sync_tests.F90.in:581
#endif
   ! pio_sync_tests.F90.in:583
    rbuf_mreg = 0   ! pio_sync_tests.F90.in:584
    call PIO_read_darray(pio_file, pio_var1, iodesc_mreg, rbuf_mreg, ierr)   ! pio_sync_tests.F90.in:585
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var1): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:586)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:586
   ! pio_sync_tests.F90.in:587
    
    IF (.NOT. PIO_TF_Check_val_(rbuf_mreg, wbuf_mreg)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var1)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:588)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:588
   ! pio_sync_tests.F90.in:589
    rbuf_mreg = 0   ! pio_sync_tests.F90.in:590
    call PIO_read_darray(pio_file, pio_var3, iodesc_mreg, rbuf_mreg, ierr)   ! pio_sync_tests.F90.in:591
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var3): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:592)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:592
   ! pio_sync_tests.F90.in:593
    
    IF (.NOT. PIO_TF_Check_val_(rbuf_mreg, wbuf_mreg)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var2)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:594)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:594
   ! pio_sync_tests.F90.in:595
    rbuf = 0   ! pio_sync_tests.F90.in:596
    call PIO_read_darray(pio_file, pio_var2, iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:597
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var2): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:598)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:598
   ! pio_sync_tests.F90.in:599
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var2)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:600)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:600
   ! pio_sync_tests.F90.in:601
    rbuf = 0   ! pio_sync_tests.F90.in:602
    call PIO_read_darray(pio_file, pio_var4, iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:603
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var4): " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:604)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:604
   ! pio_sync_tests.F90.in:605
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var4)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:606)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:606
   ! pio_sync_tests.F90.in:607
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:608
       ! pio_sync_tests.F90.in:609
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_sync_tests.F90.in:610
  end do   ! pio_sync_tests.F90.in:611
   ! pio_sync_tests.F90.in:612
  if(allocated(iotypes)) then   ! pio_sync_tests.F90.in:613
    deallocate(iotypes)   ! pio_sync_tests.F90.in:614
    deallocate(iotype_descs)   ! pio_sync_tests.F90.in:615
  end if   ! pio_sync_tests.F90.in:616
   ! pio_sync_tests.F90.in:617
  call PIO_freedecomp(pio_tf_iosystem_, iodesc)   ! pio_sync_tests.F90.in:618
  call PIO_freedecomp(pio_tf_iosystem_, iodesc_mreg)   ! pio_sync_tests.F90.in:619
  deallocate(rbuf)   ! pio_sync_tests.F90.in:620
  deallocate(rbuf_mreg)   ! pio_sync_tests.F90.in:621
  deallocate(wbuf)   ! pio_sync_tests.F90.in:622
  deallocate(wbuf_mreg)   ! pio_sync_tests.F90.in:623
END SUBROUTINE nc_mvar_mreg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___   ! pio_sync_tests.F90.in:624
   ! pio_sync_tests.F90.in:624


! Test reading data from a file while writes are pending


SUBROUTINE nc_rd_while_pend_wr_1d_PIO_int_integer__
USE pio_tutil
   ! pio_sync_tests.F90.in:628
  implicit none   ! pio_sync_tests.F90.in:629
  interface   ! pio_sync_tests.F90.in:630
    subroutine get_1d_bc_info(rank, sz, dims, start, count, force_rearrange)   ! pio_sync_tests.F90.in:631
      integer, intent(in) :: rank   ! pio_sync_tests.F90.in:632
      integer, intent(in) :: sz   ! pio_sync_tests.F90.in:633
      integer, dimension(1), intent(out) :: dims   ! pio_sync_tests.F90.in:634
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_sync_tests.F90.in:635
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_sync_tests.F90.in:636
      logical, intent(in) :: force_rearrange   ! pio_sync_tests.F90.in:637
    end subroutine get_1d_bc_info   ! pio_sync_tests.F90.in:638
  end interface   ! pio_sync_tests.F90.in:639
  type(var_desc_t)  :: pio_var1, pio_var2, pio_var3   ! pio_sync_tests.F90.in:640
  type(file_desc_t) :: pio_file   ! pio_sync_tests.F90.in:641
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_sync_tests.F90.in:642
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1'   ! pio_sync_tests.F90.in:643
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2'   ! pio_sync_tests.F90.in:644
  character(len=*), parameter :: PIO_VAR3_NAME = 'PIO_TF_test_var3'   ! pio_sync_tests.F90.in:645
  type(io_desc_t) :: wr_iodesc, rd_iodesc   ! pio_sync_tests.F90.in:646
  integer, dimension(:), allocatable :: compdof   ! pio_sync_tests.F90.in:647
  integer, dimension(:), allocatable :: start, count   ! pio_sync_tests.F90.in:648
  integer, dimension(:), allocatable :: rbuf, wbuf, exp_val   ! pio_sync_tests.F90.in:649
  integer, dimension(1) :: dims   ! pio_sync_tests.F90.in:650
  integer :: pio_dim   ! pio_sync_tests.F90.in:651
  integer :: i, ierr, lsz   ! pio_sync_tests.F90.in:652
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_sync_tests.F90.in:654
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_sync_tests.F90.in:655
  integer :: num_iotypes   ! pio_sync_tests.F90.in:656
   ! pio_sync_tests.F90.in:657
  ! Set the decomposition for writing data - forcing rearrangement
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:659
         start, count, .true.)   ! pio_sync_tests.F90.in:660
  allocate(wbuf(count(1)))   ! pio_sync_tests.F90.in:661
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:662
  do i=1,count(1)   ! pio_sync_tests.F90.in:663
    wbuf(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:664
    compdof(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:665
  end do   ! pio_sync_tests.F90.in:666
  if(allocated(start))then   ! pio_sync_tests.F90.in:667
    deallocate(start)   ! pio_sync_tests.F90.in:668
  end if   ! pio_sync_tests.F90.in:669
   ! pio_sync_tests.F90.in:670
  if(allocated(count))then   ! pio_sync_tests.F90.in:671
    deallocate(count)   ! pio_sync_tests.F90.in:672
  end if   ! pio_sync_tests.F90.in:673
   ! pio_sync_tests.F90.in:674
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof, wr_iodesc)   ! pio_sync_tests.F90.in:675
  deallocate(compdof)   ! pio_sync_tests.F90.in:676
   ! pio_sync_tests.F90.in:677
  ! Set the decomposition for reading data - different from the write decomp
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:679
         start, count, .false.)   ! pio_sync_tests.F90.in:680
  allocate(rbuf(count(1)))   ! pio_sync_tests.F90.in:681
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:682
  allocate(exp_val(count(1)))   ! pio_sync_tests.F90.in:683
  do i=1,count(1)   ! pio_sync_tests.F90.in:684
    compdof(i) = start(1) + i -1   ! pio_sync_tests.F90.in:685
    ! Expected value, after reading, is the same as the compdof
    exp_val(i) = compdof(i)   ! pio_sync_tests.F90.in:687
  end do   ! pio_sync_tests.F90.in:688
   ! pio_sync_tests.F90.in:689
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof, rd_iodesc)   ! pio_sync_tests.F90.in:690
  deallocate(compdof)   ! pio_sync_tests.F90.in:691
   ! pio_sync_tests.F90.in:692
  num_iotypes = 0   ! pio_sync_tests.F90.in:693
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_sync_tests.F90.in:694
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_sync_tests.F90.in:695
  do i=1,num_iotypes   ! pio_sync_tests.F90.in:696

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_sync_tests.F90.in:697
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_sync_tests.F90.in:698
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:699)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:699
   ! pio_sync_tests.F90.in:700
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_sync_tests.F90.in:701
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:702)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:702
   ! pio_sync_tests.F90.in:703
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_int, (/pio_dim/), pio_var1)   ! pio_sync_tests.F90.in:704
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:705)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:705
   ! pio_sync_tests.F90.in:706
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_int, (/pio_dim/), pio_var2)   ! pio_sync_tests.F90.in:707
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:708)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:708
   ! pio_sync_tests.F90.in:709
    ierr = PIO_def_var(pio_file, PIO_VAR3_NAME, PIO_int, (/pio_dim/), pio_var3)   ! pio_sync_tests.F90.in:710
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:711)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:711
   ! pio_sync_tests.F90.in:712
    ierr = PIO_enddef(pio_file)   ! pio_sync_tests.F90.in:713
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:714)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:714
   ! pio_sync_tests.F90.in:715
    ! Write the variables out
    call PIO_write_darray(pio_file, pio_var1, wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:717
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:718)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:718
   ! pio_sync_tests.F90.in:719
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:721
   ! pio_sync_tests.F90.in:722
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_write)   ! pio_sync_tests.F90.in:723
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:724)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:724
   ! pio_sync_tests.F90.in:725
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_sync_tests.F90.in:726
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:727)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:727
   ! pio_sync_tests.F90.in:728
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_sync_tests.F90.in:729
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:730)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:730
   ! pio_sync_tests.F90.in:731
    ierr = PIO_inq_varid(pio_file, PIO_VAR3_NAME, pio_var3)   ! pio_sync_tests.F90.in:732
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var3 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:733)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:733
#else
    call PIO_syncfile(pio_file)   ! pio_sync_tests.F90.in:735
#endif
   ! pio_sync_tests.F90.in:737
    call PIO_write_darray(pio_file, pio_var2, wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:738
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:739)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:739
   ! pio_sync_tests.F90.in:740
    call PIO_write_darray(pio_file, pio_var3, wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:741
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:742)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:742
   ! pio_sync_tests.F90.in:743
   ! pio_sync_tests.F90.in:744
    ! The data written out for pio_var1 is already synced and should be
    ! available to read. Note that two writes above are potentially
    ! pending since we haven't synced it yet
   ! pio_sync_tests.F90.in:748
    rbuf = 0   ! pio_sync_tests.F90.in:749
    call PIO_read_darray(pio_file, pio_var1, rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:750
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:751)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:751
   ! pio_sync_tests.F90.in:752
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var1)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:753)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:753
   ! pio_sync_tests.F90.in:754
    ! Sync pio_var2 and pio_var3
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:757
   ! pio_sync_tests.F90.in:758
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_sync_tests.F90.in:759
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:760)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:760
   ! pio_sync_tests.F90.in:761
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_sync_tests.F90.in:762
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:763)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:763
   ! pio_sync_tests.F90.in:764
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_sync_tests.F90.in:765
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:766)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:766
   ! pio_sync_tests.F90.in:767
    ierr = PIO_inq_varid(pio_file, PIO_VAR3_NAME, pio_var3)   ! pio_sync_tests.F90.in:768
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var3 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:769)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:769
#else
    call PIO_syncfile(pio_file)   ! pio_sync_tests.F90.in:771
#endif
   ! pio_sync_tests.F90.in:773
    rbuf = 0   ! pio_sync_tests.F90.in:774
    call PIO_read_darray(pio_file, pio_var2, rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:775
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:776)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:776
   ! pio_sync_tests.F90.in:777
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var2)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:778)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:778
   ! pio_sync_tests.F90.in:779
    rbuf = 0   ! pio_sync_tests.F90.in:780
    call PIO_read_darray(pio_file, pio_var3, rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:781
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var3) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:782)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:782
   ! pio_sync_tests.F90.in:783
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var3)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:784)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:784
   ! pio_sync_tests.F90.in:785
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:786
   ! pio_sync_tests.F90.in:787
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_sync_tests.F90.in:788
  end do   ! pio_sync_tests.F90.in:789
   ! pio_sync_tests.F90.in:790
  if(allocated(iotypes)) then   ! pio_sync_tests.F90.in:791
    deallocate(iotypes)   ! pio_sync_tests.F90.in:792
    deallocate(iotype_descs)   ! pio_sync_tests.F90.in:793
  end if   ! pio_sync_tests.F90.in:794
   ! pio_sync_tests.F90.in:795
  call PIO_freedecomp(pio_tf_iosystem_, rd_iodesc)   ! pio_sync_tests.F90.in:796
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_sync_tests.F90.in:797
  deallocate(exp_val)   ! pio_sync_tests.F90.in:798
  deallocate(rbuf)   ! pio_sync_tests.F90.in:799
  deallocate(wbuf)   ! pio_sync_tests.F90.in:800
END SUBROUTINE nc_rd_while_pend_wr_1d_PIO_int_integer__   ! pio_sync_tests.F90.in:801


SUBROUTINE nc_rd_while_pend_wr_1d_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_sync_tests.F90.in:628
  implicit none   ! pio_sync_tests.F90.in:629
  interface   ! pio_sync_tests.F90.in:630
    subroutine get_1d_bc_info(rank, sz, dims, start, count, force_rearrange)   ! pio_sync_tests.F90.in:631
      integer, intent(in) :: rank   ! pio_sync_tests.F90.in:632
      integer, intent(in) :: sz   ! pio_sync_tests.F90.in:633
      integer, dimension(1), intent(out) :: dims   ! pio_sync_tests.F90.in:634
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_sync_tests.F90.in:635
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_sync_tests.F90.in:636
      logical, intent(in) :: force_rearrange   ! pio_sync_tests.F90.in:637
    end subroutine get_1d_bc_info   ! pio_sync_tests.F90.in:638
  end interface   ! pio_sync_tests.F90.in:639
  type(var_desc_t)  :: pio_var1, pio_var2, pio_var3   ! pio_sync_tests.F90.in:640
  type(file_desc_t) :: pio_file   ! pio_sync_tests.F90.in:641
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_sync_tests.F90.in:642
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1'   ! pio_sync_tests.F90.in:643
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2'   ! pio_sync_tests.F90.in:644
  character(len=*), parameter :: PIO_VAR3_NAME = 'PIO_TF_test_var3'   ! pio_sync_tests.F90.in:645
  type(io_desc_t) :: wr_iodesc, rd_iodesc   ! pio_sync_tests.F90.in:646
  integer, dimension(:), allocatable :: compdof   ! pio_sync_tests.F90.in:647
  integer, dimension(:), allocatable :: start, count   ! pio_sync_tests.F90.in:648
  real(kind=fc_real), dimension(:), allocatable :: rbuf, wbuf, exp_val   ! pio_sync_tests.F90.in:649
  integer, dimension(1) :: dims   ! pio_sync_tests.F90.in:650
  integer :: pio_dim   ! pio_sync_tests.F90.in:651
  integer :: i, ierr, lsz   ! pio_sync_tests.F90.in:652
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_sync_tests.F90.in:654
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_sync_tests.F90.in:655
  integer :: num_iotypes   ! pio_sync_tests.F90.in:656
   ! pio_sync_tests.F90.in:657
  ! Set the decomposition for writing data - forcing rearrangement
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:659
         start, count, .true.)   ! pio_sync_tests.F90.in:660
  allocate(wbuf(count(1)))   ! pio_sync_tests.F90.in:661
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:662
  do i=1,count(1)   ! pio_sync_tests.F90.in:663
    wbuf(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:664
    compdof(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:665
  end do   ! pio_sync_tests.F90.in:666
  if(allocated(start))then   ! pio_sync_tests.F90.in:667
    deallocate(start)   ! pio_sync_tests.F90.in:668
  end if   ! pio_sync_tests.F90.in:669
   ! pio_sync_tests.F90.in:670
  if(allocated(count))then   ! pio_sync_tests.F90.in:671
    deallocate(count)   ! pio_sync_tests.F90.in:672
  end if   ! pio_sync_tests.F90.in:673
   ! pio_sync_tests.F90.in:674
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof, wr_iodesc)   ! pio_sync_tests.F90.in:675
  deallocate(compdof)   ! pio_sync_tests.F90.in:676
   ! pio_sync_tests.F90.in:677
  ! Set the decomposition for reading data - different from the write decomp
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:679
         start, count, .false.)   ! pio_sync_tests.F90.in:680
  allocate(rbuf(count(1)))   ! pio_sync_tests.F90.in:681
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:682
  allocate(exp_val(count(1)))   ! pio_sync_tests.F90.in:683
  do i=1,count(1)   ! pio_sync_tests.F90.in:684
    compdof(i) = start(1) + i -1   ! pio_sync_tests.F90.in:685
    ! Expected value, after reading, is the same as the compdof
    exp_val(i) = compdof(i)   ! pio_sync_tests.F90.in:687
  end do   ! pio_sync_tests.F90.in:688
   ! pio_sync_tests.F90.in:689
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof, rd_iodesc)   ! pio_sync_tests.F90.in:690
  deallocate(compdof)   ! pio_sync_tests.F90.in:691
   ! pio_sync_tests.F90.in:692
  num_iotypes = 0   ! pio_sync_tests.F90.in:693
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_sync_tests.F90.in:694
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_sync_tests.F90.in:695
  do i=1,num_iotypes   ! pio_sync_tests.F90.in:696

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_sync_tests.F90.in:697
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_sync_tests.F90.in:698
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:699)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:699
   ! pio_sync_tests.F90.in:700
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_sync_tests.F90.in:701
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:702)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:702
   ! pio_sync_tests.F90.in:703
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_real, (/pio_dim/), pio_var1)   ! pio_sync_tests.F90.in:704
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:705)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:705
   ! pio_sync_tests.F90.in:706
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_real, (/pio_dim/), pio_var2)   ! pio_sync_tests.F90.in:707
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:708)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:708
   ! pio_sync_tests.F90.in:709
    ierr = PIO_def_var(pio_file, PIO_VAR3_NAME, PIO_real, (/pio_dim/), pio_var3)   ! pio_sync_tests.F90.in:710
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:711)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:711
   ! pio_sync_tests.F90.in:712
    ierr = PIO_enddef(pio_file)   ! pio_sync_tests.F90.in:713
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:714)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:714
   ! pio_sync_tests.F90.in:715
    ! Write the variables out
    call PIO_write_darray(pio_file, pio_var1, wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:717
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:718)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:718
   ! pio_sync_tests.F90.in:719
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:721
   ! pio_sync_tests.F90.in:722
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_write)   ! pio_sync_tests.F90.in:723
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:724)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:724
   ! pio_sync_tests.F90.in:725
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_sync_tests.F90.in:726
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:727)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:727
   ! pio_sync_tests.F90.in:728
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_sync_tests.F90.in:729
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:730)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:730
   ! pio_sync_tests.F90.in:731
    ierr = PIO_inq_varid(pio_file, PIO_VAR3_NAME, pio_var3)   ! pio_sync_tests.F90.in:732
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var3 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:733)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:733
#else
    call PIO_syncfile(pio_file)   ! pio_sync_tests.F90.in:735
#endif
   ! pio_sync_tests.F90.in:737
    call PIO_write_darray(pio_file, pio_var2, wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:738
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:739)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:739
   ! pio_sync_tests.F90.in:740
    call PIO_write_darray(pio_file, pio_var3, wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:741
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:742)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:742
   ! pio_sync_tests.F90.in:743
   ! pio_sync_tests.F90.in:744
    ! The data written out for pio_var1 is already synced and should be
    ! available to read. Note that two writes above are potentially
    ! pending since we haven't synced it yet
   ! pio_sync_tests.F90.in:748
    rbuf = 0   ! pio_sync_tests.F90.in:749
    call PIO_read_darray(pio_file, pio_var1, rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:750
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:751)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:751
   ! pio_sync_tests.F90.in:752
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var1)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:753)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:753
   ! pio_sync_tests.F90.in:754
    ! Sync pio_var2 and pio_var3
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:757
   ! pio_sync_tests.F90.in:758
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_sync_tests.F90.in:759
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:760)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:760
   ! pio_sync_tests.F90.in:761
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_sync_tests.F90.in:762
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:763)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:763
   ! pio_sync_tests.F90.in:764
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_sync_tests.F90.in:765
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:766)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:766
   ! pio_sync_tests.F90.in:767
    ierr = PIO_inq_varid(pio_file, PIO_VAR3_NAME, pio_var3)   ! pio_sync_tests.F90.in:768
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var3 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:769)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:769
#else
    call PIO_syncfile(pio_file)   ! pio_sync_tests.F90.in:771
#endif
   ! pio_sync_tests.F90.in:773
    rbuf = 0   ! pio_sync_tests.F90.in:774
    call PIO_read_darray(pio_file, pio_var2, rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:775
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:776)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:776
   ! pio_sync_tests.F90.in:777
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var2)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:778)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:778
   ! pio_sync_tests.F90.in:779
    rbuf = 0   ! pio_sync_tests.F90.in:780
    call PIO_read_darray(pio_file, pio_var3, rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:781
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var3) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:782)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:782
   ! pio_sync_tests.F90.in:783
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var3)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:784)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:784
   ! pio_sync_tests.F90.in:785
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:786
   ! pio_sync_tests.F90.in:787
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_sync_tests.F90.in:788
  end do   ! pio_sync_tests.F90.in:789
   ! pio_sync_tests.F90.in:790
  if(allocated(iotypes)) then   ! pio_sync_tests.F90.in:791
    deallocate(iotypes)   ! pio_sync_tests.F90.in:792
    deallocate(iotype_descs)   ! pio_sync_tests.F90.in:793
  end if   ! pio_sync_tests.F90.in:794
   ! pio_sync_tests.F90.in:795
  call PIO_freedecomp(pio_tf_iosystem_, rd_iodesc)   ! pio_sync_tests.F90.in:796
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_sync_tests.F90.in:797
  deallocate(exp_val)   ! pio_sync_tests.F90.in:798
  deallocate(rbuf)   ! pio_sync_tests.F90.in:799
  deallocate(wbuf)   ! pio_sync_tests.F90.in:800
END SUBROUTINE nc_rd_while_pend_wr_1d_PIO_real_real_kind_fc_real___   ! pio_sync_tests.F90.in:801


SUBROUTINE nc_rd_while_pend_wr_1d_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_sync_tests.F90.in:628
  implicit none   ! pio_sync_tests.F90.in:629
  interface   ! pio_sync_tests.F90.in:630
    subroutine get_1d_bc_info(rank, sz, dims, start, count, force_rearrange)   ! pio_sync_tests.F90.in:631
      integer, intent(in) :: rank   ! pio_sync_tests.F90.in:632
      integer, intent(in) :: sz   ! pio_sync_tests.F90.in:633
      integer, dimension(1), intent(out) :: dims   ! pio_sync_tests.F90.in:634
      integer, dimension(:), allocatable, intent(out) :: start   ! pio_sync_tests.F90.in:635
      integer, dimension(:), allocatable, intent(out) :: count   ! pio_sync_tests.F90.in:636
      logical, intent(in) :: force_rearrange   ! pio_sync_tests.F90.in:637
    end subroutine get_1d_bc_info   ! pio_sync_tests.F90.in:638
  end interface   ! pio_sync_tests.F90.in:639
  type(var_desc_t)  :: pio_var1, pio_var2, pio_var3   ! pio_sync_tests.F90.in:640
  type(file_desc_t) :: pio_file   ! pio_sync_tests.F90.in:641
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_sync_tests.F90.in:642
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1'   ! pio_sync_tests.F90.in:643
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2'   ! pio_sync_tests.F90.in:644
  character(len=*), parameter :: PIO_VAR3_NAME = 'PIO_TF_test_var3'   ! pio_sync_tests.F90.in:645
  type(io_desc_t) :: wr_iodesc, rd_iodesc   ! pio_sync_tests.F90.in:646
  integer, dimension(:), allocatable :: compdof   ! pio_sync_tests.F90.in:647
  integer, dimension(:), allocatable :: start, count   ! pio_sync_tests.F90.in:648
  real(kind=fc_double), dimension(:), allocatable :: rbuf, wbuf, exp_val   ! pio_sync_tests.F90.in:649
  integer, dimension(1) :: dims   ! pio_sync_tests.F90.in:650
  integer :: pio_dim   ! pio_sync_tests.F90.in:651
  integer :: i, ierr, lsz   ! pio_sync_tests.F90.in:652
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_sync_tests.F90.in:654
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_sync_tests.F90.in:655
  integer :: num_iotypes   ! pio_sync_tests.F90.in:656
   ! pio_sync_tests.F90.in:657
  ! Set the decomposition for writing data - forcing rearrangement
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:659
         start, count, .true.)   ! pio_sync_tests.F90.in:660
  allocate(wbuf(count(1)))   ! pio_sync_tests.F90.in:661
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:662
  do i=1,count(1)   ! pio_sync_tests.F90.in:663
    wbuf(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:664
    compdof(i) = start(1) + i - 1   ! pio_sync_tests.F90.in:665
  end do   ! pio_sync_tests.F90.in:666
  if(allocated(start))then   ! pio_sync_tests.F90.in:667
    deallocate(start)   ! pio_sync_tests.F90.in:668
  end if   ! pio_sync_tests.F90.in:669
   ! pio_sync_tests.F90.in:670
  if(allocated(count))then   ! pio_sync_tests.F90.in:671
    deallocate(count)   ! pio_sync_tests.F90.in:672
  end if   ! pio_sync_tests.F90.in:673
   ! pio_sync_tests.F90.in:674
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof, wr_iodesc)   ! pio_sync_tests.F90.in:675
  deallocate(compdof)   ! pio_sync_tests.F90.in:676
   ! pio_sync_tests.F90.in:677
  ! Set the decomposition for reading data - different from the write decomp
  call get_1d_bc_info(pio_tf_world_rank_, pio_tf_world_sz_, dims,&   ! pio_sync_tests.F90.in:679
         start, count, .false.)   ! pio_sync_tests.F90.in:680
  allocate(rbuf(count(1)))   ! pio_sync_tests.F90.in:681
  allocate(compdof(count(1)))   ! pio_sync_tests.F90.in:682
  allocate(exp_val(count(1)))   ! pio_sync_tests.F90.in:683
  do i=1,count(1)   ! pio_sync_tests.F90.in:684
    compdof(i) = start(1) + i -1   ! pio_sync_tests.F90.in:685
    ! Expected value, after reading, is the same as the compdof
    exp_val(i) = compdof(i)   ! pio_sync_tests.F90.in:687
  end do   ! pio_sync_tests.F90.in:688
   ! pio_sync_tests.F90.in:689
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof, rd_iodesc)   ! pio_sync_tests.F90.in:690
  deallocate(compdof)   ! pio_sync_tests.F90.in:691
   ! pio_sync_tests.F90.in:692
  num_iotypes = 0   ! pio_sync_tests.F90.in:693
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_sync_tests.F90.in:694
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_sync_tests.F90.in:695
  do i=1,num_iotypes   ! pio_sync_tests.F90.in:696

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_sync_tests.F90.in:697
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_sync_tests.F90.in:698
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:699)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:699
   ! pio_sync_tests.F90.in:700
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_sync_tests.F90.in:701
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:702)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:702
   ! pio_sync_tests.F90.in:703
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_double, (/pio_dim/), pio_var1)   ! pio_sync_tests.F90.in:704
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:705)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:705
   ! pio_sync_tests.F90.in:706
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_double, (/pio_dim/), pio_var2)   ! pio_sync_tests.F90.in:707
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:708)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:708
   ! pio_sync_tests.F90.in:709
    ierr = PIO_def_var(pio_file, PIO_VAR3_NAME, PIO_double, (/pio_dim/), pio_var3)   ! pio_sync_tests.F90.in:710
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:711)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:711
   ! pio_sync_tests.F90.in:712
    ierr = PIO_enddef(pio_file)   ! pio_sync_tests.F90.in:713
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:714)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:714
   ! pio_sync_tests.F90.in:715
    ! Write the variables out
    call PIO_write_darray(pio_file, pio_var1, wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:717
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:718)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:718
   ! pio_sync_tests.F90.in:719
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:721
   ! pio_sync_tests.F90.in:722
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_write)   ! pio_sync_tests.F90.in:723
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:724)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:724
   ! pio_sync_tests.F90.in:725
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_sync_tests.F90.in:726
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:727)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:727
   ! pio_sync_tests.F90.in:728
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_sync_tests.F90.in:729
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:730)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:730
   ! pio_sync_tests.F90.in:731
    ierr = PIO_inq_varid(pio_file, PIO_VAR3_NAME, pio_var3)   ! pio_sync_tests.F90.in:732
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var3 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:733)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:733
#else
    call PIO_syncfile(pio_file)   ! pio_sync_tests.F90.in:735
#endif
   ! pio_sync_tests.F90.in:737
    call PIO_write_darray(pio_file, pio_var2, wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:738
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:739)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:739
   ! pio_sync_tests.F90.in:740
    call PIO_write_darray(pio_file, pio_var3, wr_iodesc, wbuf, ierr)   ! pio_sync_tests.F90.in:741
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:742)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:742
   ! pio_sync_tests.F90.in:743
   ! pio_sync_tests.F90.in:744
    ! The data written out for pio_var1 is already synced and should be
    ! available to read. Note that two writes above are potentially
    ! pending since we haven't synced it yet
   ! pio_sync_tests.F90.in:748
    rbuf = 0   ! pio_sync_tests.F90.in:749
    call PIO_read_darray(pio_file, pio_var1, rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:750
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var1) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:751)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:751
   ! pio_sync_tests.F90.in:752
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var1)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:753)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:753
   ! pio_sync_tests.F90.in:754
    ! Sync pio_var2 and pio_var3
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:757
   ! pio_sync_tests.F90.in:758
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_sync_tests.F90.in:759
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:760)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:760
   ! pio_sync_tests.F90.in:761
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_sync_tests.F90.in:762
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:763)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:763
   ! pio_sync_tests.F90.in:764
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_sync_tests.F90.in:765
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:766)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:766
   ! pio_sync_tests.F90.in:767
    ierr = PIO_inq_varid(pio_file, PIO_VAR3_NAME, pio_var3)   ! pio_sync_tests.F90.in:768
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var3 :" // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:769)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:769
#else
    call PIO_syncfile(pio_file)   ! pio_sync_tests.F90.in:771
#endif
   ! pio_sync_tests.F90.in:773
    rbuf = 0   ! pio_sync_tests.F90.in:774
    call PIO_read_darray(pio_file, pio_var2, rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:775
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var2) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:776)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:776
   ! pio_sync_tests.F90.in:777
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var2)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:778)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:778
   ! pio_sync_tests.F90.in:779
    rbuf = 0   ! pio_sync_tests.F90.in:780
    call PIO_read_darray(pio_file, pio_var3, rd_iodesc, rbuf, ierr)   ! pio_sync_tests.F90.in:781
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray (var3) : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:782)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:782
   ! pio_sync_tests.F90.in:783
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (var3)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_sync_tests.F90.in:784)"
      END IF
      RETURN
    END IF   ! pio_sync_tests.F90.in:784
   ! pio_sync_tests.F90.in:785
    call PIO_closefile(pio_file)   ! pio_sync_tests.F90.in:786
   ! pio_sync_tests.F90.in:787
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_sync_tests.F90.in:788
  end do   ! pio_sync_tests.F90.in:789
   ! pio_sync_tests.F90.in:790
  if(allocated(iotypes)) then   ! pio_sync_tests.F90.in:791
    deallocate(iotypes)   ! pio_sync_tests.F90.in:792
    deallocate(iotype_descs)   ! pio_sync_tests.F90.in:793
  end if   ! pio_sync_tests.F90.in:794
   ! pio_sync_tests.F90.in:795
  call PIO_freedecomp(pio_tf_iosystem_, rd_iodesc)   ! pio_sync_tests.F90.in:796
  call PIO_freedecomp(pio_tf_iosystem_, wr_iodesc)   ! pio_sync_tests.F90.in:797
  deallocate(exp_val)   ! pio_sync_tests.F90.in:798
  deallocate(rbuf)   ! pio_sync_tests.F90.in:799
  deallocate(wbuf)   ! pio_sync_tests.F90.in:800
END SUBROUTINE nc_rd_while_pend_wr_1d_PIO_double_real_kind_fc_double___   ! pio_sync_tests.F90.in:801
   ! pio_sync_tests.F90.in:801




  SUBROUTINE PIO_TF_Test_driver_
    USE pio_tutil
    IMPLICIT NONE
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_wr_rd_1d_bc_PIO_int_integer__"
    END IF
    CALL nc_mvar_wr_rd_1d_bc_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 1:",&
          "nc_mvar_wr_rd_1d_bc_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 1:",&
          "nc_mvar_wr_rd_1d_bc_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_wr_rd_1d_bc_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_mvar_wr_rd_1d_bc_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 2:",&
          "nc_mvar_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 2:",&
          "nc_mvar_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_wr_rd_1d_bc_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_mvar_wr_rd_1d_bc_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 3:",&
          "nc_mvar_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 3:",&
          "nc_mvar_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_wr_rd_1d_bc_PIO_int_integer__"
    END IF
    CALL nc_mvar_wr_rd_1d_bc_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 4:",&
          "nc_mvar_wr_rd_1d_bc_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 4:",&
          "nc_mvar_wr_rd_1d_bc_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_wr_rd_1d_bc_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_mvar_wr_rd_1d_bc_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 5:",&
          "nc_mvar_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 5:",&
          "nc_mvar_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_wr_rd_1d_bc_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_mvar_wr_rd_1d_bc_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 6:",&
          "nc_mvar_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 6:",&
          "nc_mvar_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_msync_1d_bc_PIO_int_integer__"
    END IF
    CALL nc_mvar_msync_1d_bc_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 7:",&
          "nc_mvar_msync_1d_bc_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 7:",&
          "nc_mvar_msync_1d_bc_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_msync_1d_bc_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_mvar_msync_1d_bc_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 8:",&
          "nc_mvar_msync_1d_bc_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 8:",&
          "nc_mvar_msync_1d_bc_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_msync_1d_bc_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_mvar_msync_1d_bc_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 9:",&
          "nc_mvar_msync_1d_bc_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 9:",&
          "nc_mvar_msync_1d_bc_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_wr_rd_1d_bc_PIO_int_integer__"
    END IF
    CALL nc_mvar_wr_rd_1d_bc_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 10:",&
          "nc_mvar_wr_rd_1d_bc_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 10:",&
          "nc_mvar_wr_rd_1d_bc_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_wr_rd_1d_bc_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_mvar_wr_rd_1d_bc_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 11:",&
          "nc_mvar_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 11:",&
          "nc_mvar_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_wr_rd_1d_bc_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_mvar_wr_rd_1d_bc_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 12:",&
          "nc_mvar_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 12:",&
          "nc_mvar_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_msync_1d_bc_PIO_int_integer__"
    END IF
    CALL nc_mvar_msync_1d_bc_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 13:",&
          "nc_mvar_msync_1d_bc_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 13:",&
          "nc_mvar_msync_1d_bc_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_msync_1d_bc_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_mvar_msync_1d_bc_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 14:",&
          "nc_mvar_msync_1d_bc_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 14:",&
          "nc_mvar_msync_1d_bc_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_msync_1d_bc_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_mvar_msync_1d_bc_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 15:",&
          "nc_mvar_msync_1d_bc_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 15:",&
          "nc_mvar_msync_1d_bc_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_mreg_wr_rd_1d_bc_PIO_int_integer__"
    END IF
    CALL nc_mvar_mreg_wr_rd_1d_bc_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 16:",&
          "nc_mvar_mreg_wr_rd_1d_bc_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 16:",&
          "nc_mvar_mreg_wr_rd_1d_bc_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_mreg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_mvar_mreg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 17:",&
          "nc_mvar_mreg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 17:",&
          "nc_mvar_mreg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_mreg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_mvar_mreg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 18:",&
          "nc_mvar_mreg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 18:",&
          "nc_mvar_mreg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_wr_rd_1d_bc_PIO_int_integer__"
    END IF
    CALL nc_mvar_wr_rd_1d_bc_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 19:",&
          "nc_mvar_wr_rd_1d_bc_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 19:",&
          "nc_mvar_wr_rd_1d_bc_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_wr_rd_1d_bc_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_mvar_wr_rd_1d_bc_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 20:",&
          "nc_mvar_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 20:",&
          "nc_mvar_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_wr_rd_1d_bc_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_mvar_wr_rd_1d_bc_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 21:",&
          "nc_mvar_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 21:",&
          "nc_mvar_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_msync_1d_bc_PIO_int_integer__"
    END IF
    CALL nc_mvar_msync_1d_bc_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 22:",&
          "nc_mvar_msync_1d_bc_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 22:",&
          "nc_mvar_msync_1d_bc_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_msync_1d_bc_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_mvar_msync_1d_bc_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 23:",&
          "nc_mvar_msync_1d_bc_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 23:",&
          "nc_mvar_msync_1d_bc_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_msync_1d_bc_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_mvar_msync_1d_bc_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 24:",&
          "nc_mvar_msync_1d_bc_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 24:",&
          "nc_mvar_msync_1d_bc_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_mreg_wr_rd_1d_bc_PIO_int_integer__"
    END IF
    CALL nc_mvar_mreg_wr_rd_1d_bc_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 25:",&
          "nc_mvar_mreg_wr_rd_1d_bc_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 25:",&
          "nc_mvar_mreg_wr_rd_1d_bc_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_mreg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_mvar_mreg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 26:",&
          "nc_mvar_mreg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 26:",&
          "nc_mvar_mreg_wr_rd_1d_bc_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_mvar_mreg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_mvar_mreg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 27:",&
          "nc_mvar_mreg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 27:",&
          "nc_mvar_mreg_wr_rd_1d_bc_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_rd_while_pend_wr_1d_PIO_int_integer__"
    END IF
    CALL nc_rd_while_pend_wr_1d_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 28:",&
          "nc_rd_while_pend_wr_1d_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 28:",&
          "nc_rd_while_pend_wr_1d_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_rd_while_pend_wr_1d_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_rd_while_pend_wr_1d_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 29:",&
          "nc_rd_while_pend_wr_1d_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 29:",&
          "nc_rd_while_pend_wr_1d_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_rd_while_pend_wr_1d_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_rd_while_pend_wr_1d_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 30:",&
          "nc_rd_while_pend_wr_1d_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 30:",&
          "nc_rd_while_pend_wr_1d_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
  END SUBROUTINE PIO_TF_Test_driver_


  PROGRAM PIO_TF_Test_main_
    USE pio_tutil
    IMPLICIT NONE
    INTEGER, PARAMETER :: NREARRS = 2
    INTEGER :: rearrs(NREARRS) = (/pio_rearr_subset,pio_rearr_box/)
    CHARACTER(LEN=PIO_TF_MAX_STR_LEN) :: rearrs_info(NREARRS) = (/"PIO_REARR_SUBSET","PIO_REARR_BOX   "/)
    INTEGER i, ierr

    pio_tf_nerrs_total_=0
    pio_tf_retval_utest_=0
    CALL MPI_Init(ierr)
    DO i=1,SIZE(rearrs)
      CALL PIO_TF_Init_(rearrs(i))
      IF (pio_tf_world_rank_ == 0) THEN
        WRITE(*,*) "PIO_TF: Testing : ", trim(rearrs_info(i))
      END IF
      CALL PIO_TF_Test_driver_()
      CALL PIO_TF_Finalize_()
    END DO
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_nerrs_total_ == 0) THEN
        IF (pio_tf_retval_utest_ == 0) THEN
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF: ",&
           "All tests", "---------", "PASSED"
        ELSE
          pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF: ",&
           "Test driver", "---------", "FAILED"
        END IF
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT2) "PIO_TF:[",&
          pio_tf_nerrs_total_,"] Tests",&
          "----- FAILED"
      END IF
    END IF
    CALL MPI_Finalize(ierr)
    IF (pio_tf_nerrs_total_ /= 0) THEN
      STOP 99
    END IF
  END PROGRAM
