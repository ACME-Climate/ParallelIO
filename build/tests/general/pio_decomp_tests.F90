! DON'T MODIFY THIS FILE, ALL YOUR CHANGES WILL BE LOST
! This file is generated by ../../../tests/general/util/pio_tf_f90gen.pl
! from /home/tkurc/codar/e3sm/pio_adios1/ParallelIO/tests/general/pio_decomp_tests.F90.in



SUBROUTINE nc_write_1d_darray_PIO_int_integer__
USE pio_tutil
   ! pio_decomp_tests.F90.in:2
  implicit none   ! pio_decomp_tests.F90.in:3
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_tests.F90.in:4
  type(var_desc_t)  :: pio_var   ! pio_decomp_tests.F90.in:5
  type(file_desc_t) :: pio_file   ! pio_decomp_tests.F90.in:6
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_tests.F90.in:7
  type(io_desc_t) :: iodesc   ! pio_decomp_tests.F90.in:8
  integer, dimension(VEC_LOCAL_SZ) :: compdof, compdof_rel_disps   ! pio_decomp_tests.F90.in:9
  integer, dimension(VEC_LOCAL_SZ) :: buf   ! pio_decomp_tests.F90.in:10
  integer, dimension(1) :: dims   ! pio_decomp_tests.F90.in:11
  integer :: pio_dim   ! pio_decomp_tests.F90.in:12
  integer :: i, ierr, lsz   ! pio_decomp_tests.F90.in:13
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests.F90.in:15
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests.F90.in:16
  integer :: num_iotypes   ! pio_decomp_tests.F90.in:17
   ! pio_decomp_tests.F90.in:18
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_tests.F90.in:19
    compdof_rel_disps(i) = i   ! pio_decomp_tests.F90.in:20
  end do   ! pio_decomp_tests.F90.in:21
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_tests.F90.in:22
  compdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_tests.F90.in:23
  buf = pio_tf_world_rank_;   ! pio_decomp_tests.F90.in:24
   ! pio_decomp_tests.F90.in:25
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof, iodesc)   ! pio_decomp_tests.F90.in:26
   ! pio_decomp_tests.F90.in:27
  num_iotypes = 0   ! pio_decomp_tests.F90.in:28
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests.F90.in:29
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_decomp_tests.F90.in:30
  do i=1,num_iotypes   ! pio_decomp_tests.F90.in:31

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_tests.F90.in:32
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_tests.F90.in:33
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:34)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:34
   ! pio_decomp_tests.F90.in:35
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_tests.F90.in:36
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:37)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:37
   ! pio_decomp_tests.F90.in:38
    ierr = PIO_def_var(pio_file, 'PIO_TF_test_var', PIO_int, (/pio_dim/), pio_var)   ! pio_decomp_tests.F90.in:39
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:40)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:40
   ! pio_decomp_tests.F90.in:41
    ierr = PIO_enddef(pio_file)   ! pio_decomp_tests.F90.in:42
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:43)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:43
   ! pio_decomp_tests.F90.in:44
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, iodesc, buf, ierr)   ! pio_decomp_tests.F90.in:46
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:47)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:47
   ! pio_decomp_tests.F90.in:48
    ! FIXME: Verify the written output
   ! pio_decomp_tests.F90.in:50
    call PIO_closefile(pio_file)   ! pio_decomp_tests.F90.in:51
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_decomp_tests.F90.in:52
  end do   ! pio_decomp_tests.F90.in:53
  if(allocated(iotypes)) then   ! pio_decomp_tests.F90.in:54
    deallocate(iotypes)   ! pio_decomp_tests.F90.in:55
    deallocate(iotype_descs)   ! pio_decomp_tests.F90.in:56
  end if   ! pio_decomp_tests.F90.in:57
   ! pio_decomp_tests.F90.in:58
  call PIO_freedecomp(pio_tf_iosystem_, iodesc)   ! pio_decomp_tests.F90.in:59
END SUBROUTINE nc_write_1d_darray_PIO_int_integer__   ! pio_decomp_tests.F90.in:60


SUBROUTINE nc_write_1d_darray_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_decomp_tests.F90.in:2
  implicit none   ! pio_decomp_tests.F90.in:3
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_tests.F90.in:4
  type(var_desc_t)  :: pio_var   ! pio_decomp_tests.F90.in:5
  type(file_desc_t) :: pio_file   ! pio_decomp_tests.F90.in:6
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_tests.F90.in:7
  type(io_desc_t) :: iodesc   ! pio_decomp_tests.F90.in:8
  integer, dimension(VEC_LOCAL_SZ) :: compdof, compdof_rel_disps   ! pio_decomp_tests.F90.in:9
  real(kind=fc_real), dimension(VEC_LOCAL_SZ) :: buf   ! pio_decomp_tests.F90.in:10
  integer, dimension(1) :: dims   ! pio_decomp_tests.F90.in:11
  integer :: pio_dim   ! pio_decomp_tests.F90.in:12
  integer :: i, ierr, lsz   ! pio_decomp_tests.F90.in:13
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests.F90.in:15
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests.F90.in:16
  integer :: num_iotypes   ! pio_decomp_tests.F90.in:17
   ! pio_decomp_tests.F90.in:18
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_tests.F90.in:19
    compdof_rel_disps(i) = i   ! pio_decomp_tests.F90.in:20
  end do   ! pio_decomp_tests.F90.in:21
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_tests.F90.in:22
  compdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_tests.F90.in:23
  buf = pio_tf_world_rank_;   ! pio_decomp_tests.F90.in:24
   ! pio_decomp_tests.F90.in:25
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof, iodesc)   ! pio_decomp_tests.F90.in:26
   ! pio_decomp_tests.F90.in:27
  num_iotypes = 0   ! pio_decomp_tests.F90.in:28
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests.F90.in:29
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_decomp_tests.F90.in:30
  do i=1,num_iotypes   ! pio_decomp_tests.F90.in:31

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_tests.F90.in:32
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_tests.F90.in:33
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:34)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:34
   ! pio_decomp_tests.F90.in:35
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_tests.F90.in:36
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:37)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:37
   ! pio_decomp_tests.F90.in:38
    ierr = PIO_def_var(pio_file, 'PIO_TF_test_var', PIO_real, (/pio_dim/), pio_var)   ! pio_decomp_tests.F90.in:39
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:40)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:40
   ! pio_decomp_tests.F90.in:41
    ierr = PIO_enddef(pio_file)   ! pio_decomp_tests.F90.in:42
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:43)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:43
   ! pio_decomp_tests.F90.in:44
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, iodesc, buf, ierr)   ! pio_decomp_tests.F90.in:46
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:47)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:47
   ! pio_decomp_tests.F90.in:48
    ! FIXME: Verify the written output
   ! pio_decomp_tests.F90.in:50
    call PIO_closefile(pio_file)   ! pio_decomp_tests.F90.in:51
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_decomp_tests.F90.in:52
  end do   ! pio_decomp_tests.F90.in:53
  if(allocated(iotypes)) then   ! pio_decomp_tests.F90.in:54
    deallocate(iotypes)   ! pio_decomp_tests.F90.in:55
    deallocate(iotype_descs)   ! pio_decomp_tests.F90.in:56
  end if   ! pio_decomp_tests.F90.in:57
   ! pio_decomp_tests.F90.in:58
  call PIO_freedecomp(pio_tf_iosystem_, iodesc)   ! pio_decomp_tests.F90.in:59
END SUBROUTINE nc_write_1d_darray_PIO_real_real_kind_fc_real___   ! pio_decomp_tests.F90.in:60


SUBROUTINE nc_write_1d_darray_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_decomp_tests.F90.in:2
  implicit none   ! pio_decomp_tests.F90.in:3
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_tests.F90.in:4
  type(var_desc_t)  :: pio_var   ! pio_decomp_tests.F90.in:5
  type(file_desc_t) :: pio_file   ! pio_decomp_tests.F90.in:6
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_tests.F90.in:7
  type(io_desc_t) :: iodesc   ! pio_decomp_tests.F90.in:8
  integer, dimension(VEC_LOCAL_SZ) :: compdof, compdof_rel_disps   ! pio_decomp_tests.F90.in:9
  real(kind=fc_double), dimension(VEC_LOCAL_SZ) :: buf   ! pio_decomp_tests.F90.in:10
  integer, dimension(1) :: dims   ! pio_decomp_tests.F90.in:11
  integer :: pio_dim   ! pio_decomp_tests.F90.in:12
  integer :: i, ierr, lsz   ! pio_decomp_tests.F90.in:13
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests.F90.in:15
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests.F90.in:16
  integer :: num_iotypes   ! pio_decomp_tests.F90.in:17
   ! pio_decomp_tests.F90.in:18
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_tests.F90.in:19
    compdof_rel_disps(i) = i   ! pio_decomp_tests.F90.in:20
  end do   ! pio_decomp_tests.F90.in:21
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_tests.F90.in:22
  compdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_tests.F90.in:23
  buf = pio_tf_world_rank_;   ! pio_decomp_tests.F90.in:24
   ! pio_decomp_tests.F90.in:25
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof, iodesc)   ! pio_decomp_tests.F90.in:26
   ! pio_decomp_tests.F90.in:27
  num_iotypes = 0   ! pio_decomp_tests.F90.in:28
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests.F90.in:29
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_decomp_tests.F90.in:30
  do i=1,num_iotypes   ! pio_decomp_tests.F90.in:31

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_tests.F90.in:32
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_tests.F90.in:33
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:34)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:34
   ! pio_decomp_tests.F90.in:35
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_tests.F90.in:36
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:37)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:37
   ! pio_decomp_tests.F90.in:38
    ierr = PIO_def_var(pio_file, 'PIO_TF_test_var', PIO_double, (/pio_dim/), pio_var)   ! pio_decomp_tests.F90.in:39
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:40)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:40
   ! pio_decomp_tests.F90.in:41
    ierr = PIO_enddef(pio_file)   ! pio_decomp_tests.F90.in:42
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:43)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:43
   ! pio_decomp_tests.F90.in:44
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, iodesc, buf, ierr)   ! pio_decomp_tests.F90.in:46
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:47)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:47
   ! pio_decomp_tests.F90.in:48
    ! FIXME: Verify the written output
   ! pio_decomp_tests.F90.in:50
    call PIO_closefile(pio_file)   ! pio_decomp_tests.F90.in:51
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_decomp_tests.F90.in:52
  end do   ! pio_decomp_tests.F90.in:53
  if(allocated(iotypes)) then   ! pio_decomp_tests.F90.in:54
    deallocate(iotypes)   ! pio_decomp_tests.F90.in:55
    deallocate(iotype_descs)   ! pio_decomp_tests.F90.in:56
  end if   ! pio_decomp_tests.F90.in:57
   ! pio_decomp_tests.F90.in:58
  call PIO_freedecomp(pio_tf_iosystem_, iodesc)   ! pio_decomp_tests.F90.in:59
END SUBROUTINE nc_write_1d_darray_PIO_double_real_kind_fc_double___   ! pio_decomp_tests.F90.in:60
   ! pio_decomp_tests.F90.in:60


! Write 1d array, although diff procs have different
! number of elements to write locally they all use
! the same buffer size (compdof size is different for
! each rank but buf size is the same)
! Odd procs write out VEC_LOCAL_SZ_ODD elements &
! even procs write out VEC_LOCAL_SZ_EVEN elements, but
! all procs use buf[MAX_VEC_SZ]
! eg:
! Elements in buffer on each proc with MAX_VEC_SZ = 2,
! [0 1] [2 X] [3 4] [5 X] ...
! The 'X'es in the buffer are not written out


SUBROUTINE nc_wr_1d_const_buf_sz_PIO_int_integer__
USE pio_tutil
   ! pio_decomp_tests.F90.in:74
  implicit none   ! pio_decomp_tests.F90.in:75
  integer, parameter :: MAX_VEC_SZ = 2   ! pio_decomp_tests.F90.in:76
  integer, parameter :: VEC_LOCAL_SZ_ODD = MAX_VEC_SZ - 1   ! pio_decomp_tests.F90.in:77
  integer, parameter :: VEC_LOCAL_SZ_EVEN = MAX_VEC_SZ   ! pio_decomp_tests.F90.in:78
  type(var_desc_t)  :: pio_var1, pio_var2   ! pio_decomp_tests.F90.in:79
  type(file_desc_t) :: pio_file   ! pio_decomp_tests.F90.in:80
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_tests.F90.in:81
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1'   ! pio_decomp_tests.F90.in:82
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2'   ! pio_decomp_tests.F90.in:83
  type(io_desc_t) :: iodesc   ! pio_decomp_tests.F90.in:84
  integer, dimension(:), allocatable :: compdof, compdof_rel_disps   ! pio_decomp_tests.F90.in:85
  integer :: compdof_rel_start   ! pio_decomp_tests.F90.in:86
  integer :: cdof_sz = VEC_LOCAL_SZ_ODD   ! pio_decomp_tests.F90.in:87
  integer, dimension(MAX_VEC_SZ) :: wbuf, rbuf   ! pio_decomp_tests.F90.in:88
  integer, dimension(1) :: dims   ! pio_decomp_tests.F90.in:89
  integer :: pio_dim   ! pio_decomp_tests.F90.in:90
  integer :: i, ierr, lsz   ! pio_decomp_tests.F90.in:91
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests.F90.in:93
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests.F90.in:94
  integer :: num_iotypes   ! pio_decomp_tests.F90.in:95
  logical :: is_even = .false.   ! pio_decomp_tests.F90.in:96
  integer :: nodd_procs, nodd_procs_bfr, neven_procs, neven_procs_bfr   ! pio_decomp_tests.F90.in:97
   ! pio_decomp_tests.F90.in:98
  nodd_procs = pio_tf_world_sz_ / 2   ! pio_decomp_tests.F90.in:99
  ! Number of odd procs before this rank
  nodd_procs_bfr = pio_tf_world_rank_ / 2   ! pio_decomp_tests.F90.in:101
  neven_procs = pio_tf_world_sz_ - nodd_procs   ! pio_decomp_tests.F90.in:102
  ! Number of even procs before this rank
  neven_procs_bfr = pio_tf_world_rank_ - nodd_procs_bfr   ! pio_decomp_tests.F90.in:104
   ! pio_decomp_tests.F90.in:105
  ! Odd procs write out VEC_LOCAL_SZ_ODD elements &
  ! even procs write out VEC_LOCAL_SZ_EVEN elements
  if(mod(pio_tf_world_rank_, 2) == 0) then   ! pio_decomp_tests.F90.in:108
    is_even = .true.   ! pio_decomp_tests.F90.in:109
    cdof_sz = VEC_LOCAL_SZ_EVEN   ! pio_decomp_tests.F90.in:110
  end if   ! pio_decomp_tests.F90.in:111
  allocate(compdof(cdof_sz))   ! pio_decomp_tests.F90.in:112
  allocate(compdof_rel_disps(cdof_sz))   ! pio_decomp_tests.F90.in:113
  wbuf = 0   ! pio_decomp_tests.F90.in:114
  do i=1,cdof_sz   ! pio_decomp_tests.F90.in:115
    compdof_rel_disps(i) = i   ! pio_decomp_tests.F90.in:116
    wbuf(i) = i   ! pio_decomp_tests.F90.in:117
  end do   ! pio_decomp_tests.F90.in:118
  ! Find out where compdof starts for this rank
  compdof_rel_start = nodd_procs_bfr * VEC_LOCAL_SZ_ODD +&   ! pio_decomp_tests.F90.in:120
                      neven_procs_bfr * VEC_LOCAL_SZ_EVEN   ! pio_decomp_tests.F90.in:121
  dims(1) = nodd_procs * VEC_LOCAL_SZ_ODD + neven_procs * VEC_LOCAL_SZ_EVEN   ! pio_decomp_tests.F90.in:122
  compdof = compdof_rel_start + compdof_rel_disps   ! pio_decomp_tests.F90.in:123
   ! pio_decomp_tests.F90.in:124
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof, iodesc)   ! pio_decomp_tests.F90.in:125
   ! pio_decomp_tests.F90.in:126
  deallocate(compdof)   ! pio_decomp_tests.F90.in:127
  deallocate(compdof_rel_disps)   ! pio_decomp_tests.F90.in:128
   ! pio_decomp_tests.F90.in:129
  num_iotypes = 0   ! pio_decomp_tests.F90.in:130
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests.F90.in:131
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_decomp_tests.F90.in:132
  do i=1,num_iotypes   ! pio_decomp_tests.F90.in:133

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_tests.F90.in:134
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_tests.F90.in:135
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:136)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:136
   ! pio_decomp_tests.F90.in:137
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_tests.F90.in:138
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:139)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:139
   ! pio_decomp_tests.F90.in:140
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_int, (/pio_dim/), pio_var1)   ! pio_decomp_tests.F90.in:141
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define first var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:142)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:142
   ! pio_decomp_tests.F90.in:143
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_int, (/pio_dim/), pio_var2)   ! pio_decomp_tests.F90.in:144
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define second var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:145)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:145
   ! pio_decomp_tests.F90.in:146
    ierr = PIO_enddef(pio_file)   ! pio_decomp_tests.F90.in:147
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:148)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:148
   ! pio_decomp_tests.F90.in:149
    ! Write first variable out
    call PIO_write_darray(pio_file, pio_var1, iodesc, wbuf, ierr)   ! pio_decomp_tests.F90.in:151
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write first darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:152)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:152
   ! pio_decomp_tests.F90.in:153
    ! Write second variable out
    call PIO_write_darray(pio_file, pio_var2, iodesc, wbuf, ierr)   ! pio_decomp_tests.F90.in:155
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write second darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:156)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:156
   ! pio_decomp_tests.F90.in:157
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_tests.F90.in:159
   ! pio_decomp_tests.F90.in:160
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_tests.F90.in:161
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:162)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:162
   ! pio_decomp_tests.F90.in:163
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_decomp_tests.F90.in:164
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:165)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:165
   ! pio_decomp_tests.F90.in:166
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_decomp_tests.F90.in:167
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:168)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:168
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_tests.F90.in:170
#endif
   ! pio_decomp_tests.F90.in:172
    rbuf = 0   ! pio_decomp_tests.F90.in:173
    call PIO_read_darray(pio_file, pio_var1, iodesc, rbuf, ierr)   ! pio_decomp_tests.F90.in:174
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read first darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:175)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:175
   ! pio_decomp_tests.F90.in:176
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (first var)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:177)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:177
   ! pio_decomp_tests.F90.in:178
    rbuf = 0   ! pio_decomp_tests.F90.in:179
    call PIO_read_darray(pio_file, pio_var2, iodesc, rbuf, ierr)   ! pio_decomp_tests.F90.in:180
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read second darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:181)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:181
   ! pio_decomp_tests.F90.in:182
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (second var)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:183)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:183
   ! pio_decomp_tests.F90.in:184
    call PIO_closefile(pio_file)   ! pio_decomp_tests.F90.in:185
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_decomp_tests.F90.in:186
  end do   ! pio_decomp_tests.F90.in:187
  if(allocated(iotypes)) then   ! pio_decomp_tests.F90.in:188
    deallocate(iotypes)   ! pio_decomp_tests.F90.in:189
    deallocate(iotype_descs)   ! pio_decomp_tests.F90.in:190
  end if   ! pio_decomp_tests.F90.in:191
  call PIO_freedecomp(pio_tf_iosystem_, iodesc)   ! pio_decomp_tests.F90.in:192
END SUBROUTINE nc_wr_1d_const_buf_sz_PIO_int_integer__   ! pio_decomp_tests.F90.in:193


SUBROUTINE nc_wr_1d_const_buf_sz_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_decomp_tests.F90.in:74
  implicit none   ! pio_decomp_tests.F90.in:75
  integer, parameter :: MAX_VEC_SZ = 2   ! pio_decomp_tests.F90.in:76
  integer, parameter :: VEC_LOCAL_SZ_ODD = MAX_VEC_SZ - 1   ! pio_decomp_tests.F90.in:77
  integer, parameter :: VEC_LOCAL_SZ_EVEN = MAX_VEC_SZ   ! pio_decomp_tests.F90.in:78
  type(var_desc_t)  :: pio_var1, pio_var2   ! pio_decomp_tests.F90.in:79
  type(file_desc_t) :: pio_file   ! pio_decomp_tests.F90.in:80
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_tests.F90.in:81
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1'   ! pio_decomp_tests.F90.in:82
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2'   ! pio_decomp_tests.F90.in:83
  type(io_desc_t) :: iodesc   ! pio_decomp_tests.F90.in:84
  integer, dimension(:), allocatable :: compdof, compdof_rel_disps   ! pio_decomp_tests.F90.in:85
  integer :: compdof_rel_start   ! pio_decomp_tests.F90.in:86
  integer :: cdof_sz = VEC_LOCAL_SZ_ODD   ! pio_decomp_tests.F90.in:87
  real(kind=fc_real), dimension(MAX_VEC_SZ) :: wbuf, rbuf   ! pio_decomp_tests.F90.in:88
  integer, dimension(1) :: dims   ! pio_decomp_tests.F90.in:89
  integer :: pio_dim   ! pio_decomp_tests.F90.in:90
  integer :: i, ierr, lsz   ! pio_decomp_tests.F90.in:91
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests.F90.in:93
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests.F90.in:94
  integer :: num_iotypes   ! pio_decomp_tests.F90.in:95
  logical :: is_even = .false.   ! pio_decomp_tests.F90.in:96
  integer :: nodd_procs, nodd_procs_bfr, neven_procs, neven_procs_bfr   ! pio_decomp_tests.F90.in:97
   ! pio_decomp_tests.F90.in:98
  nodd_procs = pio_tf_world_sz_ / 2   ! pio_decomp_tests.F90.in:99
  ! Number of odd procs before this rank
  nodd_procs_bfr = pio_tf_world_rank_ / 2   ! pio_decomp_tests.F90.in:101
  neven_procs = pio_tf_world_sz_ - nodd_procs   ! pio_decomp_tests.F90.in:102
  ! Number of even procs before this rank
  neven_procs_bfr = pio_tf_world_rank_ - nodd_procs_bfr   ! pio_decomp_tests.F90.in:104
   ! pio_decomp_tests.F90.in:105
  ! Odd procs write out VEC_LOCAL_SZ_ODD elements &
  ! even procs write out VEC_LOCAL_SZ_EVEN elements
  if(mod(pio_tf_world_rank_, 2) == 0) then   ! pio_decomp_tests.F90.in:108
    is_even = .true.   ! pio_decomp_tests.F90.in:109
    cdof_sz = VEC_LOCAL_SZ_EVEN   ! pio_decomp_tests.F90.in:110
  end if   ! pio_decomp_tests.F90.in:111
  allocate(compdof(cdof_sz))   ! pio_decomp_tests.F90.in:112
  allocate(compdof_rel_disps(cdof_sz))   ! pio_decomp_tests.F90.in:113
  wbuf = 0   ! pio_decomp_tests.F90.in:114
  do i=1,cdof_sz   ! pio_decomp_tests.F90.in:115
    compdof_rel_disps(i) = i   ! pio_decomp_tests.F90.in:116
    wbuf(i) = i   ! pio_decomp_tests.F90.in:117
  end do   ! pio_decomp_tests.F90.in:118
  ! Find out where compdof starts for this rank
  compdof_rel_start = nodd_procs_bfr * VEC_LOCAL_SZ_ODD +&   ! pio_decomp_tests.F90.in:120
                      neven_procs_bfr * VEC_LOCAL_SZ_EVEN   ! pio_decomp_tests.F90.in:121
  dims(1) = nodd_procs * VEC_LOCAL_SZ_ODD + neven_procs * VEC_LOCAL_SZ_EVEN   ! pio_decomp_tests.F90.in:122
  compdof = compdof_rel_start + compdof_rel_disps   ! pio_decomp_tests.F90.in:123
   ! pio_decomp_tests.F90.in:124
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof, iodesc)   ! pio_decomp_tests.F90.in:125
   ! pio_decomp_tests.F90.in:126
  deallocate(compdof)   ! pio_decomp_tests.F90.in:127
  deallocate(compdof_rel_disps)   ! pio_decomp_tests.F90.in:128
   ! pio_decomp_tests.F90.in:129
  num_iotypes = 0   ! pio_decomp_tests.F90.in:130
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests.F90.in:131
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_decomp_tests.F90.in:132
  do i=1,num_iotypes   ! pio_decomp_tests.F90.in:133

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_tests.F90.in:134
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_tests.F90.in:135
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:136)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:136
   ! pio_decomp_tests.F90.in:137
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_tests.F90.in:138
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:139)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:139
   ! pio_decomp_tests.F90.in:140
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_real, (/pio_dim/), pio_var1)   ! pio_decomp_tests.F90.in:141
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define first var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:142)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:142
   ! pio_decomp_tests.F90.in:143
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_real, (/pio_dim/), pio_var2)   ! pio_decomp_tests.F90.in:144
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define second var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:145)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:145
   ! pio_decomp_tests.F90.in:146
    ierr = PIO_enddef(pio_file)   ! pio_decomp_tests.F90.in:147
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:148)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:148
   ! pio_decomp_tests.F90.in:149
    ! Write first variable out
    call PIO_write_darray(pio_file, pio_var1, iodesc, wbuf, ierr)   ! pio_decomp_tests.F90.in:151
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write first darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:152)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:152
   ! pio_decomp_tests.F90.in:153
    ! Write second variable out
    call PIO_write_darray(pio_file, pio_var2, iodesc, wbuf, ierr)   ! pio_decomp_tests.F90.in:155
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write second darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:156)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:156
   ! pio_decomp_tests.F90.in:157
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_tests.F90.in:159
   ! pio_decomp_tests.F90.in:160
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_tests.F90.in:161
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:162)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:162
   ! pio_decomp_tests.F90.in:163
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_decomp_tests.F90.in:164
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:165)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:165
   ! pio_decomp_tests.F90.in:166
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_decomp_tests.F90.in:167
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:168)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:168
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_tests.F90.in:170
#endif
   ! pio_decomp_tests.F90.in:172
    rbuf = 0   ! pio_decomp_tests.F90.in:173
    call PIO_read_darray(pio_file, pio_var1, iodesc, rbuf, ierr)   ! pio_decomp_tests.F90.in:174
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read first darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:175)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:175
   ! pio_decomp_tests.F90.in:176
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (first var)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:177)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:177
   ! pio_decomp_tests.F90.in:178
    rbuf = 0   ! pio_decomp_tests.F90.in:179
    call PIO_read_darray(pio_file, pio_var2, iodesc, rbuf, ierr)   ! pio_decomp_tests.F90.in:180
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read second darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:181)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:181
   ! pio_decomp_tests.F90.in:182
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (second var)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:183)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:183
   ! pio_decomp_tests.F90.in:184
    call PIO_closefile(pio_file)   ! pio_decomp_tests.F90.in:185
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_decomp_tests.F90.in:186
  end do   ! pio_decomp_tests.F90.in:187
  if(allocated(iotypes)) then   ! pio_decomp_tests.F90.in:188
    deallocate(iotypes)   ! pio_decomp_tests.F90.in:189
    deallocate(iotype_descs)   ! pio_decomp_tests.F90.in:190
  end if   ! pio_decomp_tests.F90.in:191
  call PIO_freedecomp(pio_tf_iosystem_, iodesc)   ! pio_decomp_tests.F90.in:192
END SUBROUTINE nc_wr_1d_const_buf_sz_PIO_real_real_kind_fc_real___   ! pio_decomp_tests.F90.in:193


SUBROUTINE nc_wr_1d_const_buf_sz_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_decomp_tests.F90.in:74
  implicit none   ! pio_decomp_tests.F90.in:75
  integer, parameter :: MAX_VEC_SZ = 2   ! pio_decomp_tests.F90.in:76
  integer, parameter :: VEC_LOCAL_SZ_ODD = MAX_VEC_SZ - 1   ! pio_decomp_tests.F90.in:77
  integer, parameter :: VEC_LOCAL_SZ_EVEN = MAX_VEC_SZ   ! pio_decomp_tests.F90.in:78
  type(var_desc_t)  :: pio_var1, pio_var2   ! pio_decomp_tests.F90.in:79
  type(file_desc_t) :: pio_file   ! pio_decomp_tests.F90.in:80
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_tests.F90.in:81
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1'   ! pio_decomp_tests.F90.in:82
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2'   ! pio_decomp_tests.F90.in:83
  type(io_desc_t) :: iodesc   ! pio_decomp_tests.F90.in:84
  integer, dimension(:), allocatable :: compdof, compdof_rel_disps   ! pio_decomp_tests.F90.in:85
  integer :: compdof_rel_start   ! pio_decomp_tests.F90.in:86
  integer :: cdof_sz = VEC_LOCAL_SZ_ODD   ! pio_decomp_tests.F90.in:87
  real(kind=fc_double), dimension(MAX_VEC_SZ) :: wbuf, rbuf   ! pio_decomp_tests.F90.in:88
  integer, dimension(1) :: dims   ! pio_decomp_tests.F90.in:89
  integer :: pio_dim   ! pio_decomp_tests.F90.in:90
  integer :: i, ierr, lsz   ! pio_decomp_tests.F90.in:91
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests.F90.in:93
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests.F90.in:94
  integer :: num_iotypes   ! pio_decomp_tests.F90.in:95
  logical :: is_even = .false.   ! pio_decomp_tests.F90.in:96
  integer :: nodd_procs, nodd_procs_bfr, neven_procs, neven_procs_bfr   ! pio_decomp_tests.F90.in:97
   ! pio_decomp_tests.F90.in:98
  nodd_procs = pio_tf_world_sz_ / 2   ! pio_decomp_tests.F90.in:99
  ! Number of odd procs before this rank
  nodd_procs_bfr = pio_tf_world_rank_ / 2   ! pio_decomp_tests.F90.in:101
  neven_procs = pio_tf_world_sz_ - nodd_procs   ! pio_decomp_tests.F90.in:102
  ! Number of even procs before this rank
  neven_procs_bfr = pio_tf_world_rank_ - nodd_procs_bfr   ! pio_decomp_tests.F90.in:104
   ! pio_decomp_tests.F90.in:105
  ! Odd procs write out VEC_LOCAL_SZ_ODD elements &
  ! even procs write out VEC_LOCAL_SZ_EVEN elements
  if(mod(pio_tf_world_rank_, 2) == 0) then   ! pio_decomp_tests.F90.in:108
    is_even = .true.   ! pio_decomp_tests.F90.in:109
    cdof_sz = VEC_LOCAL_SZ_EVEN   ! pio_decomp_tests.F90.in:110
  end if   ! pio_decomp_tests.F90.in:111
  allocate(compdof(cdof_sz))   ! pio_decomp_tests.F90.in:112
  allocate(compdof_rel_disps(cdof_sz))   ! pio_decomp_tests.F90.in:113
  wbuf = 0   ! pio_decomp_tests.F90.in:114
  do i=1,cdof_sz   ! pio_decomp_tests.F90.in:115
    compdof_rel_disps(i) = i   ! pio_decomp_tests.F90.in:116
    wbuf(i) = i   ! pio_decomp_tests.F90.in:117
  end do   ! pio_decomp_tests.F90.in:118
  ! Find out where compdof starts for this rank
  compdof_rel_start = nodd_procs_bfr * VEC_LOCAL_SZ_ODD +&   ! pio_decomp_tests.F90.in:120
                      neven_procs_bfr * VEC_LOCAL_SZ_EVEN   ! pio_decomp_tests.F90.in:121
  dims(1) = nodd_procs * VEC_LOCAL_SZ_ODD + neven_procs * VEC_LOCAL_SZ_EVEN   ! pio_decomp_tests.F90.in:122
  compdof = compdof_rel_start + compdof_rel_disps   ! pio_decomp_tests.F90.in:123
   ! pio_decomp_tests.F90.in:124
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof, iodesc)   ! pio_decomp_tests.F90.in:125
   ! pio_decomp_tests.F90.in:126
  deallocate(compdof)   ! pio_decomp_tests.F90.in:127
  deallocate(compdof_rel_disps)   ! pio_decomp_tests.F90.in:128
   ! pio_decomp_tests.F90.in:129
  num_iotypes = 0   ! pio_decomp_tests.F90.in:130
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests.F90.in:131
  filename = "test_pio_decomp_simple_tests.testfile"   ! pio_decomp_tests.F90.in:132
  do i=1,num_iotypes   ! pio_decomp_tests.F90.in:133

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_tests.F90.in:134
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_tests.F90.in:135
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:136)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:136
   ! pio_decomp_tests.F90.in:137
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_tests.F90.in:138
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:139)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:139
   ! pio_decomp_tests.F90.in:140
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_double, (/pio_dim/), pio_var1)   ! pio_decomp_tests.F90.in:141
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define first var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:142)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:142
   ! pio_decomp_tests.F90.in:143
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_double, (/pio_dim/), pio_var2)   ! pio_decomp_tests.F90.in:144
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define second var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:145)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:145
   ! pio_decomp_tests.F90.in:146
    ierr = PIO_enddef(pio_file)   ! pio_decomp_tests.F90.in:147
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:148)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:148
   ! pio_decomp_tests.F90.in:149
    ! Write first variable out
    call PIO_write_darray(pio_file, pio_var1, iodesc, wbuf, ierr)   ! pio_decomp_tests.F90.in:151
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write first darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:152)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:152
   ! pio_decomp_tests.F90.in:153
    ! Write second variable out
    call PIO_write_darray(pio_file, pio_var2, iodesc, wbuf, ierr)   ! pio_decomp_tests.F90.in:155
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write second darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:156)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:156
   ! pio_decomp_tests.F90.in:157
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_tests.F90.in:159
   ! pio_decomp_tests.F90.in:160
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_tests.F90.in:161
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:162)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:162
   ! pio_decomp_tests.F90.in:163
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_decomp_tests.F90.in:164
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:165)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:165
   ! pio_decomp_tests.F90.in:166
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_decomp_tests.F90.in:167
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:168)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:168
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_tests.F90.in:170
#endif
   ! pio_decomp_tests.F90.in:172
    rbuf = 0   ! pio_decomp_tests.F90.in:173
    call PIO_read_darray(pio_file, pio_var1, iodesc, rbuf, ierr)   ! pio_decomp_tests.F90.in:174
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read first darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:175)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:175
   ! pio_decomp_tests.F90.in:176
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (first var)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:177)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:177
   ! pio_decomp_tests.F90.in:178
    rbuf = 0   ! pio_decomp_tests.F90.in:179
    call PIO_read_darray(pio_file, pio_var2, iodesc, rbuf, ierr)   ! pio_decomp_tests.F90.in:180
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read second darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:181)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:181
   ! pio_decomp_tests.F90.in:182
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, wbuf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val (second var)",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:183)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:183
   ! pio_decomp_tests.F90.in:184
    call PIO_closefile(pio_file)   ! pio_decomp_tests.F90.in:185
    call PIO_deletefile(pio_tf_iosystem_, filename);   ! pio_decomp_tests.F90.in:186
  end do   ! pio_decomp_tests.F90.in:187
  if(allocated(iotypes)) then   ! pio_decomp_tests.F90.in:188
    deallocate(iotypes)   ! pio_decomp_tests.F90.in:189
    deallocate(iotype_descs)   ! pio_decomp_tests.F90.in:190
  end if   ! pio_decomp_tests.F90.in:191
  call PIO_freedecomp(pio_tf_iosystem_, iodesc)   ! pio_decomp_tests.F90.in:192
END SUBROUTINE nc_wr_1d_const_buf_sz_PIO_double_real_kind_fc_double___   ! pio_decomp_tests.F90.in:193
   ! pio_decomp_tests.F90.in:193




SUBROUTINE nc_write_1d_reuse_decomp_PIO_int_integer__
USE pio_tutil
   ! pio_decomp_tests.F90.in:196
  implicit none   ! pio_decomp_tests.F90.in:197
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_tests.F90.in:198
  type(var_desc_t)  :: pio_var1_file1, pio_var2_file1, pio_var1_file2   ! pio_decomp_tests.F90.in:199
  type(file_desc_t) :: pio_file1, pio_file2   ! pio_decomp_tests.F90.in:200
  character(len=PIO_TF_MAX_STR_LEN) :: filename1, filename2   ! pio_decomp_tests.F90.in:201
  character(len=*), parameter :: PIO_VAR1_FILE1_NAME = 'PIO_TF_test_var1'   ! pio_decomp_tests.F90.in:202
  character(len=*), parameter :: PIO_VAR2_FILE1_NAME = 'PIO_TF_test_var2'   ! pio_decomp_tests.F90.in:203
  character(len=*), parameter :: PIO_VAR1_FILE2_NAME = 'PIO_TF_test_var1'   ! pio_decomp_tests.F90.in:204
  type(io_desc_t) :: iodesc   ! pio_decomp_tests.F90.in:205
  integer, dimension(VEC_LOCAL_SZ) :: compdof, compdof_rel_disps   ! pio_decomp_tests.F90.in:206
  integer, dimension(VEC_LOCAL_SZ) :: buf, rbuf   ! pio_decomp_tests.F90.in:207
  integer, dimension(1) :: dims   ! pio_decomp_tests.F90.in:208
  integer :: pio_dim_file1, pio_dim_file2   ! pio_decomp_tests.F90.in:209
  integer :: i, ierr, lsz   ! pio_decomp_tests.F90.in:210
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests.F90.in:212
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests.F90.in:213
  integer :: num_iotypes   ! pio_decomp_tests.F90.in:214
   ! pio_decomp_tests.F90.in:215
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_tests.F90.in:216
    compdof_rel_disps(i) = i   ! pio_decomp_tests.F90.in:217
  end do   ! pio_decomp_tests.F90.in:218
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_tests.F90.in:219
  compdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_tests.F90.in:220
  buf = pio_tf_world_rank_;   ! pio_decomp_tests.F90.in:221
   ! pio_decomp_tests.F90.in:222
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, compdof, iodesc)   ! pio_decomp_tests.F90.in:223
   ! pio_decomp_tests.F90.in:224
  num_iotypes = 0   ! pio_decomp_tests.F90.in:225
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests.F90.in:226
  filename1 = "test_pio_decomp_simple_tests.testfile1"   ! pio_decomp_tests.F90.in:227
  filename2 = "test_pio_decomp_simple_tests.testfile2"   ! pio_decomp_tests.F90.in:228
  do i=1,num_iotypes   ! pio_decomp_tests.F90.in:229

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_tests.F90.in:230
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file1, iotypes(i),&   ! pio_decomp_tests.F90.in:231
                            filename1, PIO_CLOBBER)    ! pio_decomp_tests.F90.in:232
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:233)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:233
   ! pio_decomp_tests.F90.in:234
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file2, iotypes(i),&   ! pio_decomp_tests.F90.in:235
                            filename2, PIO_CLOBBER)    ! pio_decomp_tests.F90.in:236
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:237)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:237
   ! pio_decomp_tests.F90.in:238
    ierr = PIO_def_dim(pio_file1, 'PIO_TF_test_dim', dims(1), pio_dim_file1)   ! pio_decomp_tests.F90.in:239
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:240)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:240
   ! pio_decomp_tests.F90.in:241
    ierr = PIO_def_dim(pio_file2, 'PIO_TF_test_dim', dims(1), pio_dim_file2)   ! pio_decomp_tests.F90.in:242
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:243)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:243
   ! pio_decomp_tests.F90.in:244
    ierr = PIO_def_var(pio_file1, PIO_VAR1_FILE1_NAME, PIO_int,&   ! pio_decomp_tests.F90.in:245
                          (/pio_dim_file1/), pio_var1_file1)   ! pio_decomp_tests.F90.in:246
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define first var : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:247)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:247
   ! pio_decomp_tests.F90.in:248
    ierr = PIO_def_var(pio_file1, PIO_VAR2_FILE1_NAME, PIO_int,&   ! pio_decomp_tests.F90.in:249
                          (/pio_dim_file1/), pio_var2_file1)   ! pio_decomp_tests.F90.in:250
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define second var : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:251)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:251
   ! pio_decomp_tests.F90.in:252
    ierr = PIO_def_var(pio_file2, PIO_VAR1_FILE2_NAME, PIO_int,&   ! pio_decomp_tests.F90.in:253
                          (/pio_dim_file2/), pio_var1_file2)   ! pio_decomp_tests.F90.in:254
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define first var : " // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:255)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:255
   ! pio_decomp_tests.F90.in:256
    ierr = PIO_enddef(pio_file1)   ! pio_decomp_tests.F90.in:257
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:258)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:258
   ! pio_decomp_tests.F90.in:259
    ierr = PIO_enddef(pio_file2)   ! pio_decomp_tests.F90.in:260
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:261)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:261
   ! pio_decomp_tests.F90.in:262
    ! Write the variables - file1
    call PIO_write_darray(pio_file1, pio_var1_file1, iodesc, buf, ierr)   ! pio_decomp_tests.F90.in:264
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write first darray : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:265)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:265
   ! pio_decomp_tests.F90.in:266
    call PIO_write_darray(pio_file1, pio_var2_file1, iodesc, buf, ierr)   ! pio_decomp_tests.F90.in:267
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write second darray : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:268)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:268
   ! pio_decomp_tests.F90.in:269
    ! Write the variables - file2
    call PIO_write_darray(pio_file2, pio_var1_file2, iodesc, buf, ierr)   ! pio_decomp_tests.F90.in:271
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write first darray : " // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:272)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:272
   ! pio_decomp_tests.F90.in:273
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file1)   ! pio_decomp_tests.F90.in:275
   ! pio_decomp_tests.F90.in:276
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file1, iotypes(i), filename1, PIO_nowrite)   ! pio_decomp_tests.F90.in:277
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:278)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:278
   ! pio_decomp_tests.F90.in:279
    ierr = PIO_inq_varid(pio_file1, PIO_VAR1_FILE1_NAME, pio_var1_file1)   ! pio_decomp_tests.F90.in:280
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 file1 :" // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:281)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:281
   ! pio_decomp_tests.F90.in:282
    ierr = PIO_inq_varid(pio_file1, PIO_VAR2_FILE1_NAME, pio_var2_file1)   ! pio_decomp_tests.F90.in:283
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 file1 :" // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:284)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:284
#else
    call PIO_syncfile(pio_file1)   ! pio_decomp_tests.F90.in:286
#endif
    rbuf = 0   ! pio_decomp_tests.F90.in:288
    call PIO_read_darray(pio_file1, pio_var1_file1, iodesc, rbuf, ierr)   ! pio_decomp_tests.F90.in:289
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read first darray : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:290)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:290
   ! pio_decomp_tests.F90.in:291
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, buf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:292)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:292
   ! pio_decomp_tests.F90.in:293
    rbuf = 0   ! pio_decomp_tests.F90.in:294
    call PIO_read_darray(pio_file1, pio_var2_file1, iodesc, rbuf, ierr)   ! pio_decomp_tests.F90.in:295
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read second darray : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:296)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:296
   ! pio_decomp_tests.F90.in:297
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, buf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:298)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:298
   ! pio_decomp_tests.F90.in:299
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file2)   ! pio_decomp_tests.F90.in:301
   ! pio_decomp_tests.F90.in:302
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file2, iotypes(i), filename2, PIO_nowrite)   ! pio_decomp_tests.F90.in:303
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:304)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:304
   ! pio_decomp_tests.F90.in:305
    ierr = PIO_inq_varid(pio_file2, PIO_VAR1_FILE2_NAME, pio_var1_file2)   ! pio_decomp_tests.F90.in:306
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 file2 :" // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:307)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:307
#else
    call PIO_syncfile(pio_file2)   ! pio_decomp_tests.F90.in:309
#endif
    rbuf = 0   ! pio_decomp_tests.F90.in:311
    call PIO_read_darray(pio_file2, pio_var1_file2, iodesc, rbuf, ierr)   ! pio_decomp_tests.F90.in:312
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read first darray : " // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:313)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:313
   ! pio_decomp_tests.F90.in:314
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, buf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:315)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:315
   ! pio_decomp_tests.F90.in:316
    call PIO_closefile(pio_file1)   ! pio_decomp_tests.F90.in:317
    call PIO_closefile(pio_file2)   ! pio_decomp_tests.F90.in:318
    call PIO_deletefile(pio_tf_iosystem_, filename1);   ! pio_decomp_tests.F90.in:319
    call PIO_deletefile(pio_tf_iosystem_, filename2);   ! pio_decomp_tests.F90.in:320
  end do   ! pio_decomp_tests.F90.in:321
  if(allocated(iotypes)) then   ! pio_decomp_tests.F90.in:322
    deallocate(iotypes)   ! pio_decomp_tests.F90.in:323
    deallocate(iotype_descs)   ! pio_decomp_tests.F90.in:324
  end if   ! pio_decomp_tests.F90.in:325
   ! pio_decomp_tests.F90.in:326
  call PIO_freedecomp(pio_tf_iosystem_, iodesc)   ! pio_decomp_tests.F90.in:327
END SUBROUTINE nc_write_1d_reuse_decomp_PIO_int_integer__   ! pio_decomp_tests.F90.in:328


SUBROUTINE nc_write_1d_reuse_decomp_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_decomp_tests.F90.in:196
  implicit none   ! pio_decomp_tests.F90.in:197
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_tests.F90.in:198
  type(var_desc_t)  :: pio_var1_file1, pio_var2_file1, pio_var1_file2   ! pio_decomp_tests.F90.in:199
  type(file_desc_t) :: pio_file1, pio_file2   ! pio_decomp_tests.F90.in:200
  character(len=PIO_TF_MAX_STR_LEN) :: filename1, filename2   ! pio_decomp_tests.F90.in:201
  character(len=*), parameter :: PIO_VAR1_FILE1_NAME = 'PIO_TF_test_var1'   ! pio_decomp_tests.F90.in:202
  character(len=*), parameter :: PIO_VAR2_FILE1_NAME = 'PIO_TF_test_var2'   ! pio_decomp_tests.F90.in:203
  character(len=*), parameter :: PIO_VAR1_FILE2_NAME = 'PIO_TF_test_var1'   ! pio_decomp_tests.F90.in:204
  type(io_desc_t) :: iodesc   ! pio_decomp_tests.F90.in:205
  integer, dimension(VEC_LOCAL_SZ) :: compdof, compdof_rel_disps   ! pio_decomp_tests.F90.in:206
  real(kind=fc_real), dimension(VEC_LOCAL_SZ) :: buf, rbuf   ! pio_decomp_tests.F90.in:207
  integer, dimension(1) :: dims   ! pio_decomp_tests.F90.in:208
  integer :: pio_dim_file1, pio_dim_file2   ! pio_decomp_tests.F90.in:209
  integer :: i, ierr, lsz   ! pio_decomp_tests.F90.in:210
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests.F90.in:212
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests.F90.in:213
  integer :: num_iotypes   ! pio_decomp_tests.F90.in:214
   ! pio_decomp_tests.F90.in:215
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_tests.F90.in:216
    compdof_rel_disps(i) = i   ! pio_decomp_tests.F90.in:217
  end do   ! pio_decomp_tests.F90.in:218
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_tests.F90.in:219
  compdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_tests.F90.in:220
  buf = pio_tf_world_rank_;   ! pio_decomp_tests.F90.in:221
   ! pio_decomp_tests.F90.in:222
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, compdof, iodesc)   ! pio_decomp_tests.F90.in:223
   ! pio_decomp_tests.F90.in:224
  num_iotypes = 0   ! pio_decomp_tests.F90.in:225
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests.F90.in:226
  filename1 = "test_pio_decomp_simple_tests.testfile1"   ! pio_decomp_tests.F90.in:227
  filename2 = "test_pio_decomp_simple_tests.testfile2"   ! pio_decomp_tests.F90.in:228
  do i=1,num_iotypes   ! pio_decomp_tests.F90.in:229

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_tests.F90.in:230
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file1, iotypes(i),&   ! pio_decomp_tests.F90.in:231
                            filename1, PIO_CLOBBER)    ! pio_decomp_tests.F90.in:232
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:233)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:233
   ! pio_decomp_tests.F90.in:234
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file2, iotypes(i),&   ! pio_decomp_tests.F90.in:235
                            filename2, PIO_CLOBBER)    ! pio_decomp_tests.F90.in:236
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:237)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:237
   ! pio_decomp_tests.F90.in:238
    ierr = PIO_def_dim(pio_file1, 'PIO_TF_test_dim', dims(1), pio_dim_file1)   ! pio_decomp_tests.F90.in:239
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:240)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:240
   ! pio_decomp_tests.F90.in:241
    ierr = PIO_def_dim(pio_file2, 'PIO_TF_test_dim', dims(1), pio_dim_file2)   ! pio_decomp_tests.F90.in:242
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:243)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:243
   ! pio_decomp_tests.F90.in:244
    ierr = PIO_def_var(pio_file1, PIO_VAR1_FILE1_NAME, PIO_real,&   ! pio_decomp_tests.F90.in:245
                          (/pio_dim_file1/), pio_var1_file1)   ! pio_decomp_tests.F90.in:246
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define first var : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:247)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:247
   ! pio_decomp_tests.F90.in:248
    ierr = PIO_def_var(pio_file1, PIO_VAR2_FILE1_NAME, PIO_real,&   ! pio_decomp_tests.F90.in:249
                          (/pio_dim_file1/), pio_var2_file1)   ! pio_decomp_tests.F90.in:250
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define second var : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:251)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:251
   ! pio_decomp_tests.F90.in:252
    ierr = PIO_def_var(pio_file2, PIO_VAR1_FILE2_NAME, PIO_real,&   ! pio_decomp_tests.F90.in:253
                          (/pio_dim_file2/), pio_var1_file2)   ! pio_decomp_tests.F90.in:254
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define first var : " // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:255)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:255
   ! pio_decomp_tests.F90.in:256
    ierr = PIO_enddef(pio_file1)   ! pio_decomp_tests.F90.in:257
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:258)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:258
   ! pio_decomp_tests.F90.in:259
    ierr = PIO_enddef(pio_file2)   ! pio_decomp_tests.F90.in:260
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:261)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:261
   ! pio_decomp_tests.F90.in:262
    ! Write the variables - file1
    call PIO_write_darray(pio_file1, pio_var1_file1, iodesc, buf, ierr)   ! pio_decomp_tests.F90.in:264
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write first darray : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:265)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:265
   ! pio_decomp_tests.F90.in:266
    call PIO_write_darray(pio_file1, pio_var2_file1, iodesc, buf, ierr)   ! pio_decomp_tests.F90.in:267
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write second darray : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:268)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:268
   ! pio_decomp_tests.F90.in:269
    ! Write the variables - file2
    call PIO_write_darray(pio_file2, pio_var1_file2, iodesc, buf, ierr)   ! pio_decomp_tests.F90.in:271
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write first darray : " // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:272)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:272
   ! pio_decomp_tests.F90.in:273
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file1)   ! pio_decomp_tests.F90.in:275
   ! pio_decomp_tests.F90.in:276
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file1, iotypes(i), filename1, PIO_nowrite)   ! pio_decomp_tests.F90.in:277
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:278)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:278
   ! pio_decomp_tests.F90.in:279
    ierr = PIO_inq_varid(pio_file1, PIO_VAR1_FILE1_NAME, pio_var1_file1)   ! pio_decomp_tests.F90.in:280
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 file1 :" // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:281)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:281
   ! pio_decomp_tests.F90.in:282
    ierr = PIO_inq_varid(pio_file1, PIO_VAR2_FILE1_NAME, pio_var2_file1)   ! pio_decomp_tests.F90.in:283
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 file1 :" // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:284)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:284
#else
    call PIO_syncfile(pio_file1)   ! pio_decomp_tests.F90.in:286
#endif
    rbuf = 0   ! pio_decomp_tests.F90.in:288
    call PIO_read_darray(pio_file1, pio_var1_file1, iodesc, rbuf, ierr)   ! pio_decomp_tests.F90.in:289
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read first darray : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:290)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:290
   ! pio_decomp_tests.F90.in:291
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, buf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:292)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:292
   ! pio_decomp_tests.F90.in:293
    rbuf = 0   ! pio_decomp_tests.F90.in:294
    call PIO_read_darray(pio_file1, pio_var2_file1, iodesc, rbuf, ierr)   ! pio_decomp_tests.F90.in:295
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read second darray : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:296)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:296
   ! pio_decomp_tests.F90.in:297
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, buf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:298)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:298
   ! pio_decomp_tests.F90.in:299
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file2)   ! pio_decomp_tests.F90.in:301
   ! pio_decomp_tests.F90.in:302
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file2, iotypes(i), filename2, PIO_nowrite)   ! pio_decomp_tests.F90.in:303
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:304)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:304
   ! pio_decomp_tests.F90.in:305
    ierr = PIO_inq_varid(pio_file2, PIO_VAR1_FILE2_NAME, pio_var1_file2)   ! pio_decomp_tests.F90.in:306
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 file2 :" // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:307)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:307
#else
    call PIO_syncfile(pio_file2)   ! pio_decomp_tests.F90.in:309
#endif
    rbuf = 0   ! pio_decomp_tests.F90.in:311
    call PIO_read_darray(pio_file2, pio_var1_file2, iodesc, rbuf, ierr)   ! pio_decomp_tests.F90.in:312
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read first darray : " // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:313)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:313
   ! pio_decomp_tests.F90.in:314
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, buf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:315)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:315
   ! pio_decomp_tests.F90.in:316
    call PIO_closefile(pio_file1)   ! pio_decomp_tests.F90.in:317
    call PIO_closefile(pio_file2)   ! pio_decomp_tests.F90.in:318
    call PIO_deletefile(pio_tf_iosystem_, filename1);   ! pio_decomp_tests.F90.in:319
    call PIO_deletefile(pio_tf_iosystem_, filename2);   ! pio_decomp_tests.F90.in:320
  end do   ! pio_decomp_tests.F90.in:321
  if(allocated(iotypes)) then   ! pio_decomp_tests.F90.in:322
    deallocate(iotypes)   ! pio_decomp_tests.F90.in:323
    deallocate(iotype_descs)   ! pio_decomp_tests.F90.in:324
  end if   ! pio_decomp_tests.F90.in:325
   ! pio_decomp_tests.F90.in:326
  call PIO_freedecomp(pio_tf_iosystem_, iodesc)   ! pio_decomp_tests.F90.in:327
END SUBROUTINE nc_write_1d_reuse_decomp_PIO_real_real_kind_fc_real___   ! pio_decomp_tests.F90.in:328


SUBROUTINE nc_write_1d_reuse_decomp_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_decomp_tests.F90.in:196
  implicit none   ! pio_decomp_tests.F90.in:197
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_tests.F90.in:198
  type(var_desc_t)  :: pio_var1_file1, pio_var2_file1, pio_var1_file2   ! pio_decomp_tests.F90.in:199
  type(file_desc_t) :: pio_file1, pio_file2   ! pio_decomp_tests.F90.in:200
  character(len=PIO_TF_MAX_STR_LEN) :: filename1, filename2   ! pio_decomp_tests.F90.in:201
  character(len=*), parameter :: PIO_VAR1_FILE1_NAME = 'PIO_TF_test_var1'   ! pio_decomp_tests.F90.in:202
  character(len=*), parameter :: PIO_VAR2_FILE1_NAME = 'PIO_TF_test_var2'   ! pio_decomp_tests.F90.in:203
  character(len=*), parameter :: PIO_VAR1_FILE2_NAME = 'PIO_TF_test_var1'   ! pio_decomp_tests.F90.in:204
  type(io_desc_t) :: iodesc   ! pio_decomp_tests.F90.in:205
  integer, dimension(VEC_LOCAL_SZ) :: compdof, compdof_rel_disps   ! pio_decomp_tests.F90.in:206
  real(kind=fc_double), dimension(VEC_LOCAL_SZ) :: buf, rbuf   ! pio_decomp_tests.F90.in:207
  integer, dimension(1) :: dims   ! pio_decomp_tests.F90.in:208
  integer :: pio_dim_file1, pio_dim_file2   ! pio_decomp_tests.F90.in:209
  integer :: i, ierr, lsz   ! pio_decomp_tests.F90.in:210
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_tests.F90.in:212
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_tests.F90.in:213
  integer :: num_iotypes   ! pio_decomp_tests.F90.in:214
   ! pio_decomp_tests.F90.in:215
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_tests.F90.in:216
    compdof_rel_disps(i) = i   ! pio_decomp_tests.F90.in:217
  end do   ! pio_decomp_tests.F90.in:218
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_tests.F90.in:219
  compdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_tests.F90.in:220
  buf = pio_tf_world_rank_;   ! pio_decomp_tests.F90.in:221
   ! pio_decomp_tests.F90.in:222
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, compdof, iodesc)   ! pio_decomp_tests.F90.in:223
   ! pio_decomp_tests.F90.in:224
  num_iotypes = 0   ! pio_decomp_tests.F90.in:225
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_tests.F90.in:226
  filename1 = "test_pio_decomp_simple_tests.testfile1"   ! pio_decomp_tests.F90.in:227
  filename2 = "test_pio_decomp_simple_tests.testfile2"   ! pio_decomp_tests.F90.in:228
  do i=1,num_iotypes   ! pio_decomp_tests.F90.in:229

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_tests.F90.in:230
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file1, iotypes(i),&   ! pio_decomp_tests.F90.in:231
                            filename1, PIO_CLOBBER)    ! pio_decomp_tests.F90.in:232
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:233)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:233
   ! pio_decomp_tests.F90.in:234
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file2, iotypes(i),&   ! pio_decomp_tests.F90.in:235
                            filename2, PIO_CLOBBER)    ! pio_decomp_tests.F90.in:236
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:237)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:237
   ! pio_decomp_tests.F90.in:238
    ierr = PIO_def_dim(pio_file1, 'PIO_TF_test_dim', dims(1), pio_dim_file1)   ! pio_decomp_tests.F90.in:239
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:240)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:240
   ! pio_decomp_tests.F90.in:241
    ierr = PIO_def_dim(pio_file2, 'PIO_TF_test_dim', dims(1), pio_dim_file2)   ! pio_decomp_tests.F90.in:242
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:243)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:243
   ! pio_decomp_tests.F90.in:244
    ierr = PIO_def_var(pio_file1, PIO_VAR1_FILE1_NAME, PIO_double,&   ! pio_decomp_tests.F90.in:245
                          (/pio_dim_file1/), pio_var1_file1)   ! pio_decomp_tests.F90.in:246
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define first var : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:247)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:247
   ! pio_decomp_tests.F90.in:248
    ierr = PIO_def_var(pio_file1, PIO_VAR2_FILE1_NAME, PIO_double,&   ! pio_decomp_tests.F90.in:249
                          (/pio_dim_file1/), pio_var2_file1)   ! pio_decomp_tests.F90.in:250
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define second var : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:251)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:251
   ! pio_decomp_tests.F90.in:252
    ierr = PIO_def_var(pio_file2, PIO_VAR1_FILE2_NAME, PIO_double,&   ! pio_decomp_tests.F90.in:253
                          (/pio_dim_file2/), pio_var1_file2)   ! pio_decomp_tests.F90.in:254
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define first var : " // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:255)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:255
   ! pio_decomp_tests.F90.in:256
    ierr = PIO_enddef(pio_file1)   ! pio_decomp_tests.F90.in:257
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:258)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:258
   ! pio_decomp_tests.F90.in:259
    ierr = PIO_enddef(pio_file2)   ! pio_decomp_tests.F90.in:260
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:261)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:261
   ! pio_decomp_tests.F90.in:262
    ! Write the variables - file1
    call PIO_write_darray(pio_file1, pio_var1_file1, iodesc, buf, ierr)   ! pio_decomp_tests.F90.in:264
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write first darray : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:265)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:265
   ! pio_decomp_tests.F90.in:266
    call PIO_write_darray(pio_file1, pio_var2_file1, iodesc, buf, ierr)   ! pio_decomp_tests.F90.in:267
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write second darray : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:268)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:268
   ! pio_decomp_tests.F90.in:269
    ! Write the variables - file2
    call PIO_write_darray(pio_file2, pio_var1_file2, iodesc, buf, ierr)   ! pio_decomp_tests.F90.in:271
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write first darray : " // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:272)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:272
   ! pio_decomp_tests.F90.in:273
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file1)   ! pio_decomp_tests.F90.in:275
   ! pio_decomp_tests.F90.in:276
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file1, iotypes(i), filename1, PIO_nowrite)   ! pio_decomp_tests.F90.in:277
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:278)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:278
   ! pio_decomp_tests.F90.in:279
    ierr = PIO_inq_varid(pio_file1, PIO_VAR1_FILE1_NAME, pio_var1_file1)   ! pio_decomp_tests.F90.in:280
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 file1 :" // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:281)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:281
   ! pio_decomp_tests.F90.in:282
    ierr = PIO_inq_varid(pio_file1, PIO_VAR2_FILE1_NAME, pio_var2_file1)   ! pio_decomp_tests.F90.in:283
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 file1 :" // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:284)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:284
#else
    call PIO_syncfile(pio_file1)   ! pio_decomp_tests.F90.in:286
#endif
    rbuf = 0   ! pio_decomp_tests.F90.in:288
    call PIO_read_darray(pio_file1, pio_var1_file1, iodesc, rbuf, ierr)   ! pio_decomp_tests.F90.in:289
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read first darray : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:290)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:290
   ! pio_decomp_tests.F90.in:291
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, buf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:292)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:292
   ! pio_decomp_tests.F90.in:293
    rbuf = 0   ! pio_decomp_tests.F90.in:294
    call PIO_read_darray(pio_file1, pio_var2_file1, iodesc, rbuf, ierr)   ! pio_decomp_tests.F90.in:295
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read second darray : " // trim(filename1),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:296)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:296
   ! pio_decomp_tests.F90.in:297
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, buf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:298)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:298
   ! pio_decomp_tests.F90.in:299
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file2)   ! pio_decomp_tests.F90.in:301
   ! pio_decomp_tests.F90.in:302
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file2, iotypes(i), filename2, PIO_nowrite)   ! pio_decomp_tests.F90.in:303
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:304)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:304
   ! pio_decomp_tests.F90.in:305
    ierr = PIO_inq_varid(pio_file2, PIO_VAR1_FILE2_NAME, pio_var1_file2)   ! pio_decomp_tests.F90.in:306
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 file2 :" // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:307)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:307
#else
    call PIO_syncfile(pio_file2)   ! pio_decomp_tests.F90.in:309
#endif
    rbuf = 0   ! pio_decomp_tests.F90.in:311
    call PIO_read_darray(pio_file2, pio_var1_file2, iodesc, rbuf, ierr)   ! pio_decomp_tests.F90.in:312
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read first darray : " // trim(filename2),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:313)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:313
   ! pio_decomp_tests.F90.in:314
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, buf)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_tests.F90.in:315)"
      END IF
      RETURN
    END IF   ! pio_decomp_tests.F90.in:315
   ! pio_decomp_tests.F90.in:316
    call PIO_closefile(pio_file1)   ! pio_decomp_tests.F90.in:317
    call PIO_closefile(pio_file2)   ! pio_decomp_tests.F90.in:318
    call PIO_deletefile(pio_tf_iosystem_, filename1);   ! pio_decomp_tests.F90.in:319
    call PIO_deletefile(pio_tf_iosystem_, filename2);   ! pio_decomp_tests.F90.in:320
  end do   ! pio_decomp_tests.F90.in:321
  if(allocated(iotypes)) then   ! pio_decomp_tests.F90.in:322
    deallocate(iotypes)   ! pio_decomp_tests.F90.in:323
    deallocate(iotype_descs)   ! pio_decomp_tests.F90.in:324
  end if   ! pio_decomp_tests.F90.in:325
   ! pio_decomp_tests.F90.in:326
  call PIO_freedecomp(pio_tf_iosystem_, iodesc)   ! pio_decomp_tests.F90.in:327
END SUBROUTINE nc_write_1d_reuse_decomp_PIO_double_real_kind_fc_double___   ! pio_decomp_tests.F90.in:328
   ! pio_decomp_tests.F90.in:328


  SUBROUTINE PIO_TF_Test_driver_
    USE pio_tutil
    IMPLICIT NONE
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_darray_PIO_int_integer__"
    END IF
    CALL nc_write_1d_darray_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 1:",&
          "nc_write_1d_darray_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 1:",&
          "nc_write_1d_darray_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_darray_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_write_1d_darray_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 2:",&
          "nc_write_1d_darray_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 2:",&
          "nc_write_1d_darray_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_darray_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_write_1d_darray_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 3:",&
          "nc_write_1d_darray_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 3:",&
          "nc_write_1d_darray_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_darray_PIO_int_integer__"
    END IF
    CALL nc_write_1d_darray_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 4:",&
          "nc_write_1d_darray_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 4:",&
          "nc_write_1d_darray_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_darray_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_write_1d_darray_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 5:",&
          "nc_write_1d_darray_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 5:",&
          "nc_write_1d_darray_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_darray_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_write_1d_darray_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 6:",&
          "nc_write_1d_darray_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 6:",&
          "nc_write_1d_darray_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_const_buf_sz_PIO_int_integer__"
    END IF
    CALL nc_wr_1d_const_buf_sz_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 7:",&
          "nc_wr_1d_const_buf_sz_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 7:",&
          "nc_wr_1d_const_buf_sz_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_const_buf_sz_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_1d_const_buf_sz_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 8:",&
          "nc_wr_1d_const_buf_sz_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 8:",&
          "nc_wr_1d_const_buf_sz_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_const_buf_sz_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_1d_const_buf_sz_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 9:",&
          "nc_wr_1d_const_buf_sz_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 9:",&
          "nc_wr_1d_const_buf_sz_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_darray_PIO_int_integer__"
    END IF
    CALL nc_write_1d_darray_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 10:",&
          "nc_write_1d_darray_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 10:",&
          "nc_write_1d_darray_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_darray_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_write_1d_darray_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 11:",&
          "nc_write_1d_darray_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 11:",&
          "nc_write_1d_darray_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_darray_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_write_1d_darray_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 12:",&
          "nc_write_1d_darray_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 12:",&
          "nc_write_1d_darray_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_const_buf_sz_PIO_int_integer__"
    END IF
    CALL nc_wr_1d_const_buf_sz_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 13:",&
          "nc_wr_1d_const_buf_sz_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 13:",&
          "nc_wr_1d_const_buf_sz_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_const_buf_sz_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_1d_const_buf_sz_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 14:",&
          "nc_wr_1d_const_buf_sz_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 14:",&
          "nc_wr_1d_const_buf_sz_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_const_buf_sz_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_1d_const_buf_sz_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 15:",&
          "nc_wr_1d_const_buf_sz_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 15:",&
          "nc_wr_1d_const_buf_sz_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_reuse_decomp_PIO_int_integer__"
    END IF
    CALL nc_write_1d_reuse_decomp_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 16:",&
          "nc_write_1d_reuse_decomp_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 16:",&
          "nc_write_1d_reuse_decomp_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_reuse_decomp_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_write_1d_reuse_decomp_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 17:",&
          "nc_write_1d_reuse_decomp_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 17:",&
          "nc_write_1d_reuse_decomp_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_write_1d_reuse_decomp_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_write_1d_reuse_decomp_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 18:",&
          "nc_write_1d_reuse_decomp_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 18:",&
          "nc_write_1d_reuse_decomp_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
  END SUBROUTINE PIO_TF_Test_driver_


  PROGRAM PIO_TF_Test_main_
    USE pio_tutil
    IMPLICIT NONE
    INTEGER, PARAMETER :: NREARRS = 2
    INTEGER :: rearrs(NREARRS) = (/pio_rearr_subset,pio_rearr_box/)
    CHARACTER(LEN=PIO_TF_MAX_STR_LEN) :: rearrs_info(NREARRS) = (/"PIO_REARR_SUBSET","PIO_REARR_BOX   "/)
    INTEGER i, ierr

    pio_tf_nerrs_total_=0
    pio_tf_retval_utest_=0
    CALL MPI_Init(ierr)
    DO i=1,SIZE(rearrs)
      CALL PIO_TF_Init_(rearrs(i))
      IF (pio_tf_world_rank_ == 0) THEN
        WRITE(*,*) "PIO_TF: Testing : ", trim(rearrs_info(i))
      END IF
      CALL PIO_TF_Test_driver_()
      CALL PIO_TF_Finalize_()
    END DO
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_nerrs_total_ == 0) THEN
        IF (pio_tf_retval_utest_ == 0) THEN
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF: ",&
           "All tests", "---------", "PASSED"
        ELSE
          pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF: ",&
           "Test driver", "---------", "FAILED"
        END IF
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT2) "PIO_TF:[",&
          pio_tf_nerrs_total_,"] Tests",&
          "----- FAILED"
      END IF
    END IF
    CALL MPI_Finalize(ierr)
    IF (pio_tf_nerrs_total_ /= 0) THEN
      STOP 99
    END IF
  END PROGRAM
