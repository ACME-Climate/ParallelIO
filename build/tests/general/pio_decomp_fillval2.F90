! DON'T MODIFY THIS FILE, ALL YOUR CHANGES WILL BE LOST
! This file is generated by ../../../tests/general/util/pio_tf_f90gen.pl
! from /home/tkurc/codar/e3sm/pio_adios1/ParallelIO/tests/general/pio_decomp_fillval2.F90.in

! nc write 1d array with fillvalues (the holes are explicitly specified)
! Each process writes out data with "rank + 1" holes, strided by 2


SUBROUTINE nc_wr_1d_mreg_exp_fval_PIO_int_integer__
USE pio_tutil
   ! pio_decomp_fillval2.F90.in:4
  implicit none   ! pio_decomp_fillval2.F90.in:5
  type(var_desc_t)  :: pio_var1, pio_var2   ! pio_decomp_fillval2.F90.in:6
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval2.F90.in:7
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval2.F90.in:8
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1'   ! pio_decomp_fillval2.F90.in:9
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2'   ! pio_decomp_fillval2.F90.in:10
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval2.F90.in:11
  integer, dimension(:), allocatable :: wcompdof, rcompdof, compdof_rel_disps   ! pio_decomp_fillval2.F90.in:12
  ! Compdof value to suggest that data point is a hole, this hole
  ! is usually filled with a fillvalue
  integer, parameter :: PIO_COMPDOF_FILLVAL = 0   ! pio_decomp_fillval2.F90.in:15
  integer, dimension(:), allocatable :: wbuf, rbuf, exp_val   ! pio_decomp_fillval2.F90.in:16
  ! The buffer fillvalue to be used when writing data
  integer, PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval2.F90.in:18
  integer, dimension(1) :: dims   ! pio_decomp_fillval2.F90.in:19
  integer :: pio_dim   ! pio_decomp_fillval2.F90.in:20
  integer :: i, j, ierr, lsz   ! pio_decomp_fillval2.F90.in:21
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval2.F90.in:23
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval2.F90.in:24
  integer :: num_iotypes   ! pio_decomp_fillval2.F90.in:25
   ! pio_decomp_fillval2.F90.in:26
  ! Stride for holes in data
  integer, parameter :: HSTRIDE = 2   ! pio_decomp_fillval2.F90.in:28
  integer :: num_local_holes, vec_local_sz   ! pio_decomp_fillval2.F90.in:29
   ! pio_decomp_fillval2.F90.in:30
  num_local_holes = pio_tf_world_rank_ + 1   ! pio_decomp_fillval2.F90.in:31
  vec_local_sz = pio_tf_world_sz_ * HSTRIDE   ! pio_decomp_fillval2.F90.in:32
   ! pio_decomp_fillval2.F90.in:33
  allocate(wcompdof(vec_local_sz))   ! pio_decomp_fillval2.F90.in:34
  allocate(rcompdof(vec_local_sz))   ! pio_decomp_fillval2.F90.in:35
  allocate(compdof_rel_disps(vec_local_sz))   ! pio_decomp_fillval2.F90.in:36
  do i=1,vec_local_sz   ! pio_decomp_fillval2.F90.in:37
    compdof_rel_disps(i) = i   ! pio_decomp_fillval2.F90.in:38
  end do   ! pio_decomp_fillval2.F90.in:39
  dims(1) = vec_local_sz * pio_tf_world_sz_   ! pio_decomp_fillval2.F90.in:40
  rcompdof = vec_local_sz * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval2.F90.in:41
  wcompdof = vec_local_sz * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval2.F90.in:42
   ! pio_decomp_fillval2.F90.in:43
  allocate(wbuf(vec_local_sz))   ! pio_decomp_fillval2.F90.in:44
  allocate(rbuf(vec_local_sz))   ! pio_decomp_fillval2.F90.in:45
  allocate(exp_val(vec_local_sz))   ! pio_decomp_fillval2.F90.in:46
  wbuf = wcompdof   ! pio_decomp_fillval2.F90.in:47
  exp_val = wcompdof   ! pio_decomp_fillval2.F90.in:48
  rbuf = 0   ! pio_decomp_fillval2.F90.in:49
   ! pio_decomp_fillval2.F90.in:50
  ! For hole indices we expect (BUF_FILLVAL == -2)
  ! holes are strided by HSTRIDE
  do i=1,num_local_holes   ! pio_decomp_fillval2.F90.in:53
    j = (i - 1) * HSTRIDE + 1   ! pio_decomp_fillval2.F90.in:54
    wcompdof(j) = PIO_COMPDOF_FILLVAL   ! pio_decomp_fillval2.F90.in:55
    exp_val(j) = BUF_FILLVAL   ! pio_decomp_fillval2.F90.in:56
  end do   ! pio_decomp_fillval2.F90.in:57
   ! pio_decomp_fillval2.F90.in:58
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, wcompdof, wiodesc)   ! pio_decomp_fillval2.F90.in:59
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, rcompdof, riodesc)   ! pio_decomp_fillval2.F90.in:60
   ! pio_decomp_fillval2.F90.in:61
  deallocate(compdof_rel_disps)   ! pio_decomp_fillval2.F90.in:62
  deallocate(rcompdof)   ! pio_decomp_fillval2.F90.in:63
  deallocate(wcompdof)   ! pio_decomp_fillval2.F90.in:64
   ! pio_decomp_fillval2.F90.in:65
  num_iotypes = 0   ! pio_decomp_fillval2.F90.in:66
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval2.F90.in:67
  do i=1,num_iotypes   ! pio_decomp_fillval2.F90.in:68
   ! pio_decomp_fillval2.F90.in:69
    write(filename,'(a,i1)') "test_pio_decomp_fillval_tests.testfile",i   ! pio_decomp_fillval2.F90.in:70
   ! pio_decomp_fillval2.F90.in:71

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval2.F90.in:72
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval2.F90.in:73
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:74)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:74
   ! pio_decomp_fillval2.F90.in:75
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval2.F90.in:76
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:77)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:77
   ! pio_decomp_fillval2.F90.in:78
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_int,&   ! pio_decomp_fillval2.F90.in:79
                        (/pio_dim/), pio_var1)   ! pio_decomp_fillval2.F90.in:80
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:81)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:81
   ! pio_decomp_fillval2.F90.in:82
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_int,&   ! pio_decomp_fillval2.F90.in:83
                        (/pio_dim/), pio_var2)   ! pio_decomp_fillval2.F90.in:84
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:85)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:85
   ! pio_decomp_fillval2.F90.in:86
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval2.F90.in:87
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:88)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:88
   ! pio_decomp_fillval2.F90.in:89
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var1, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval2.F90.in:91
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:92)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:92
   ! pio_decomp_fillval2.F90.in:93
    call PIO_write_darray(pio_file, pio_var2, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval2.F90.in:94
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:95)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:95
   ! pio_decomp_fillval2.F90.in:96
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:98
   ! pio_decomp_fillval2.F90.in:99
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval2.F90.in:100
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:101)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:101
   ! pio_decomp_fillval2.F90.in:102
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_decomp_fillval2.F90.in:103
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:104)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:104
   ! pio_decomp_fillval2.F90.in:105
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_decomp_fillval2.F90.in:106
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:107)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:107
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval2.F90.in:109
#endif
   ! pio_decomp_fillval2.F90.in:111
    rbuf = 0   ! pio_decomp_fillval2.F90.in:112
    call PIO_read_darray(pio_file, pio_var1, riodesc, rbuf, ierr)   ! pio_decomp_fillval2.F90.in:113
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:114)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:114
   ! pio_decomp_fillval2.F90.in:115
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:116)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:116
   ! pio_decomp_fillval2.F90.in:117
    rbuf = 0   ! pio_decomp_fillval2.F90.in:118
    call PIO_read_darray(pio_file, pio_var2, riodesc, rbuf, ierr)   ! pio_decomp_fillval2.F90.in:119
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:120)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:120
   ! pio_decomp_fillval2.F90.in:121
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:122)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:122
   ! pio_decomp_fillval2.F90.in:123
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:124
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval2.F90.in:125
  end do   ! pio_decomp_fillval2.F90.in:126
  if(allocated(iotypes)) then   ! pio_decomp_fillval2.F90.in:127
    deallocate(iotypes)   ! pio_decomp_fillval2.F90.in:128
    deallocate(iotype_descs)   ! pio_decomp_fillval2.F90.in:129
  end if   ! pio_decomp_fillval2.F90.in:130
   ! pio_decomp_fillval2.F90.in:131
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval2.F90.in:132
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval2.F90.in:133
   ! pio_decomp_fillval2.F90.in:134
  deallocate(exp_val)   ! pio_decomp_fillval2.F90.in:135
  deallocate(rbuf)   ! pio_decomp_fillval2.F90.in:136
  deallocate(wbuf)   ! pio_decomp_fillval2.F90.in:137
   ! pio_decomp_fillval2.F90.in:138
END SUBROUTINE nc_wr_1d_mreg_exp_fval_PIO_int_integer__   ! pio_decomp_fillval2.F90.in:139


SUBROUTINE nc_wr_1d_mreg_exp_fval_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_decomp_fillval2.F90.in:4
  implicit none   ! pio_decomp_fillval2.F90.in:5
  type(var_desc_t)  :: pio_var1, pio_var2   ! pio_decomp_fillval2.F90.in:6
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval2.F90.in:7
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval2.F90.in:8
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1'   ! pio_decomp_fillval2.F90.in:9
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2'   ! pio_decomp_fillval2.F90.in:10
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval2.F90.in:11
  integer, dimension(:), allocatable :: wcompdof, rcompdof, compdof_rel_disps   ! pio_decomp_fillval2.F90.in:12
  ! Compdof value to suggest that data point is a hole, this hole
  ! is usually filled with a fillvalue
  integer, parameter :: PIO_COMPDOF_FILLVAL = 0   ! pio_decomp_fillval2.F90.in:15
  real(kind=fc_real), dimension(:), allocatable :: wbuf, rbuf, exp_val   ! pio_decomp_fillval2.F90.in:16
  ! The buffer fillvalue to be used when writing data
  real(kind=fc_real), PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval2.F90.in:18
  integer, dimension(1) :: dims   ! pio_decomp_fillval2.F90.in:19
  integer :: pio_dim   ! pio_decomp_fillval2.F90.in:20
  integer :: i, j, ierr, lsz   ! pio_decomp_fillval2.F90.in:21
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval2.F90.in:23
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval2.F90.in:24
  integer :: num_iotypes   ! pio_decomp_fillval2.F90.in:25
   ! pio_decomp_fillval2.F90.in:26
  ! Stride for holes in data
  integer, parameter :: HSTRIDE = 2   ! pio_decomp_fillval2.F90.in:28
  integer :: num_local_holes, vec_local_sz   ! pio_decomp_fillval2.F90.in:29
   ! pio_decomp_fillval2.F90.in:30
  num_local_holes = pio_tf_world_rank_ + 1   ! pio_decomp_fillval2.F90.in:31
  vec_local_sz = pio_tf_world_sz_ * HSTRIDE   ! pio_decomp_fillval2.F90.in:32
   ! pio_decomp_fillval2.F90.in:33
  allocate(wcompdof(vec_local_sz))   ! pio_decomp_fillval2.F90.in:34
  allocate(rcompdof(vec_local_sz))   ! pio_decomp_fillval2.F90.in:35
  allocate(compdof_rel_disps(vec_local_sz))   ! pio_decomp_fillval2.F90.in:36
  do i=1,vec_local_sz   ! pio_decomp_fillval2.F90.in:37
    compdof_rel_disps(i) = i   ! pio_decomp_fillval2.F90.in:38
  end do   ! pio_decomp_fillval2.F90.in:39
  dims(1) = vec_local_sz * pio_tf_world_sz_   ! pio_decomp_fillval2.F90.in:40
  rcompdof = vec_local_sz * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval2.F90.in:41
  wcompdof = vec_local_sz * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval2.F90.in:42
   ! pio_decomp_fillval2.F90.in:43
  allocate(wbuf(vec_local_sz))   ! pio_decomp_fillval2.F90.in:44
  allocate(rbuf(vec_local_sz))   ! pio_decomp_fillval2.F90.in:45
  allocate(exp_val(vec_local_sz))   ! pio_decomp_fillval2.F90.in:46
  wbuf = wcompdof   ! pio_decomp_fillval2.F90.in:47
  exp_val = wcompdof   ! pio_decomp_fillval2.F90.in:48
  rbuf = 0   ! pio_decomp_fillval2.F90.in:49
   ! pio_decomp_fillval2.F90.in:50
  ! For hole indices we expect (BUF_FILLVAL == -2)
  ! holes are strided by HSTRIDE
  do i=1,num_local_holes   ! pio_decomp_fillval2.F90.in:53
    j = (i - 1) * HSTRIDE + 1   ! pio_decomp_fillval2.F90.in:54
    wcompdof(j) = PIO_COMPDOF_FILLVAL   ! pio_decomp_fillval2.F90.in:55
    exp_val(j) = BUF_FILLVAL   ! pio_decomp_fillval2.F90.in:56
  end do   ! pio_decomp_fillval2.F90.in:57
   ! pio_decomp_fillval2.F90.in:58
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, wcompdof, wiodesc)   ! pio_decomp_fillval2.F90.in:59
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, rcompdof, riodesc)   ! pio_decomp_fillval2.F90.in:60
   ! pio_decomp_fillval2.F90.in:61
  deallocate(compdof_rel_disps)   ! pio_decomp_fillval2.F90.in:62
  deallocate(rcompdof)   ! pio_decomp_fillval2.F90.in:63
  deallocate(wcompdof)   ! pio_decomp_fillval2.F90.in:64
   ! pio_decomp_fillval2.F90.in:65
  num_iotypes = 0   ! pio_decomp_fillval2.F90.in:66
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval2.F90.in:67
  do i=1,num_iotypes   ! pio_decomp_fillval2.F90.in:68
   ! pio_decomp_fillval2.F90.in:69
    write(filename,'(a,i1)') "test_pio_decomp_fillval_tests.testfile",i   ! pio_decomp_fillval2.F90.in:70
   ! pio_decomp_fillval2.F90.in:71

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval2.F90.in:72
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval2.F90.in:73
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:74)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:74
   ! pio_decomp_fillval2.F90.in:75
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval2.F90.in:76
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:77)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:77
   ! pio_decomp_fillval2.F90.in:78
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_real,&   ! pio_decomp_fillval2.F90.in:79
                        (/pio_dim/), pio_var1)   ! pio_decomp_fillval2.F90.in:80
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:81)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:81
   ! pio_decomp_fillval2.F90.in:82
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_real,&   ! pio_decomp_fillval2.F90.in:83
                        (/pio_dim/), pio_var2)   ! pio_decomp_fillval2.F90.in:84
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:85)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:85
   ! pio_decomp_fillval2.F90.in:86
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval2.F90.in:87
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:88)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:88
   ! pio_decomp_fillval2.F90.in:89
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var1, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval2.F90.in:91
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:92)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:92
   ! pio_decomp_fillval2.F90.in:93
    call PIO_write_darray(pio_file, pio_var2, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval2.F90.in:94
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:95)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:95
   ! pio_decomp_fillval2.F90.in:96
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:98
   ! pio_decomp_fillval2.F90.in:99
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval2.F90.in:100
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:101)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:101
   ! pio_decomp_fillval2.F90.in:102
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_decomp_fillval2.F90.in:103
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:104)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:104
   ! pio_decomp_fillval2.F90.in:105
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_decomp_fillval2.F90.in:106
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:107)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:107
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval2.F90.in:109
#endif
   ! pio_decomp_fillval2.F90.in:111
    rbuf = 0   ! pio_decomp_fillval2.F90.in:112
    call PIO_read_darray(pio_file, pio_var1, riodesc, rbuf, ierr)   ! pio_decomp_fillval2.F90.in:113
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:114)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:114
   ! pio_decomp_fillval2.F90.in:115
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:116)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:116
   ! pio_decomp_fillval2.F90.in:117
    rbuf = 0   ! pio_decomp_fillval2.F90.in:118
    call PIO_read_darray(pio_file, pio_var2, riodesc, rbuf, ierr)   ! pio_decomp_fillval2.F90.in:119
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:120)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:120
   ! pio_decomp_fillval2.F90.in:121
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:122)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:122
   ! pio_decomp_fillval2.F90.in:123
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:124
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval2.F90.in:125
  end do   ! pio_decomp_fillval2.F90.in:126
  if(allocated(iotypes)) then   ! pio_decomp_fillval2.F90.in:127
    deallocate(iotypes)   ! pio_decomp_fillval2.F90.in:128
    deallocate(iotype_descs)   ! pio_decomp_fillval2.F90.in:129
  end if   ! pio_decomp_fillval2.F90.in:130
   ! pio_decomp_fillval2.F90.in:131
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval2.F90.in:132
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval2.F90.in:133
   ! pio_decomp_fillval2.F90.in:134
  deallocate(exp_val)   ! pio_decomp_fillval2.F90.in:135
  deallocate(rbuf)   ! pio_decomp_fillval2.F90.in:136
  deallocate(wbuf)   ! pio_decomp_fillval2.F90.in:137
   ! pio_decomp_fillval2.F90.in:138
END SUBROUTINE nc_wr_1d_mreg_exp_fval_PIO_real_real_kind_fc_real___   ! pio_decomp_fillval2.F90.in:139


SUBROUTINE nc_wr_1d_mreg_exp_fval_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_decomp_fillval2.F90.in:4
  implicit none   ! pio_decomp_fillval2.F90.in:5
  type(var_desc_t)  :: pio_var1, pio_var2   ! pio_decomp_fillval2.F90.in:6
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval2.F90.in:7
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval2.F90.in:8
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1'   ! pio_decomp_fillval2.F90.in:9
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2'   ! pio_decomp_fillval2.F90.in:10
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval2.F90.in:11
  integer, dimension(:), allocatable :: wcompdof, rcompdof, compdof_rel_disps   ! pio_decomp_fillval2.F90.in:12
  ! Compdof value to suggest that data point is a hole, this hole
  ! is usually filled with a fillvalue
  integer, parameter :: PIO_COMPDOF_FILLVAL = 0   ! pio_decomp_fillval2.F90.in:15
  real(kind=fc_double), dimension(:), allocatable :: wbuf, rbuf, exp_val   ! pio_decomp_fillval2.F90.in:16
  ! The buffer fillvalue to be used when writing data
  real(kind=fc_double), PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval2.F90.in:18
  integer, dimension(1) :: dims   ! pio_decomp_fillval2.F90.in:19
  integer :: pio_dim   ! pio_decomp_fillval2.F90.in:20
  integer :: i, j, ierr, lsz   ! pio_decomp_fillval2.F90.in:21
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval2.F90.in:23
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval2.F90.in:24
  integer :: num_iotypes   ! pio_decomp_fillval2.F90.in:25
   ! pio_decomp_fillval2.F90.in:26
  ! Stride for holes in data
  integer, parameter :: HSTRIDE = 2   ! pio_decomp_fillval2.F90.in:28
  integer :: num_local_holes, vec_local_sz   ! pio_decomp_fillval2.F90.in:29
   ! pio_decomp_fillval2.F90.in:30
  num_local_holes = pio_tf_world_rank_ + 1   ! pio_decomp_fillval2.F90.in:31
  vec_local_sz = pio_tf_world_sz_ * HSTRIDE   ! pio_decomp_fillval2.F90.in:32
   ! pio_decomp_fillval2.F90.in:33
  allocate(wcompdof(vec_local_sz))   ! pio_decomp_fillval2.F90.in:34
  allocate(rcompdof(vec_local_sz))   ! pio_decomp_fillval2.F90.in:35
  allocate(compdof_rel_disps(vec_local_sz))   ! pio_decomp_fillval2.F90.in:36
  do i=1,vec_local_sz   ! pio_decomp_fillval2.F90.in:37
    compdof_rel_disps(i) = i   ! pio_decomp_fillval2.F90.in:38
  end do   ! pio_decomp_fillval2.F90.in:39
  dims(1) = vec_local_sz * pio_tf_world_sz_   ! pio_decomp_fillval2.F90.in:40
  rcompdof = vec_local_sz * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval2.F90.in:41
  wcompdof = vec_local_sz * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval2.F90.in:42
   ! pio_decomp_fillval2.F90.in:43
  allocate(wbuf(vec_local_sz))   ! pio_decomp_fillval2.F90.in:44
  allocate(rbuf(vec_local_sz))   ! pio_decomp_fillval2.F90.in:45
  allocate(exp_val(vec_local_sz))   ! pio_decomp_fillval2.F90.in:46
  wbuf = wcompdof   ! pio_decomp_fillval2.F90.in:47
  exp_val = wcompdof   ! pio_decomp_fillval2.F90.in:48
  rbuf = 0   ! pio_decomp_fillval2.F90.in:49
   ! pio_decomp_fillval2.F90.in:50
  ! For hole indices we expect (BUF_FILLVAL == -2)
  ! holes are strided by HSTRIDE
  do i=1,num_local_holes   ! pio_decomp_fillval2.F90.in:53
    j = (i - 1) * HSTRIDE + 1   ! pio_decomp_fillval2.F90.in:54
    wcompdof(j) = PIO_COMPDOF_FILLVAL   ! pio_decomp_fillval2.F90.in:55
    exp_val(j) = BUF_FILLVAL   ! pio_decomp_fillval2.F90.in:56
  end do   ! pio_decomp_fillval2.F90.in:57
   ! pio_decomp_fillval2.F90.in:58
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, wcompdof, wiodesc)   ! pio_decomp_fillval2.F90.in:59
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, rcompdof, riodesc)   ! pio_decomp_fillval2.F90.in:60
   ! pio_decomp_fillval2.F90.in:61
  deallocate(compdof_rel_disps)   ! pio_decomp_fillval2.F90.in:62
  deallocate(rcompdof)   ! pio_decomp_fillval2.F90.in:63
  deallocate(wcompdof)   ! pio_decomp_fillval2.F90.in:64
   ! pio_decomp_fillval2.F90.in:65
  num_iotypes = 0   ! pio_decomp_fillval2.F90.in:66
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval2.F90.in:67
  do i=1,num_iotypes   ! pio_decomp_fillval2.F90.in:68
   ! pio_decomp_fillval2.F90.in:69
    write(filename,'(a,i1)') "test_pio_decomp_fillval_tests.testfile",i   ! pio_decomp_fillval2.F90.in:70
   ! pio_decomp_fillval2.F90.in:71

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval2.F90.in:72
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval2.F90.in:73
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:74)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:74
   ! pio_decomp_fillval2.F90.in:75
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval2.F90.in:76
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:77)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:77
   ! pio_decomp_fillval2.F90.in:78
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_double,&   ! pio_decomp_fillval2.F90.in:79
                        (/pio_dim/), pio_var1)   ! pio_decomp_fillval2.F90.in:80
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:81)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:81
   ! pio_decomp_fillval2.F90.in:82
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_double,&   ! pio_decomp_fillval2.F90.in:83
                        (/pio_dim/), pio_var2)   ! pio_decomp_fillval2.F90.in:84
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:85)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:85
   ! pio_decomp_fillval2.F90.in:86
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval2.F90.in:87
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:88)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:88
   ! pio_decomp_fillval2.F90.in:89
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var1, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval2.F90.in:91
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:92)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:92
   ! pio_decomp_fillval2.F90.in:93
    call PIO_write_darray(pio_file, pio_var2, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval2.F90.in:94
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:95)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:95
   ! pio_decomp_fillval2.F90.in:96
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:98
   ! pio_decomp_fillval2.F90.in:99
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval2.F90.in:100
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:101)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:101
   ! pio_decomp_fillval2.F90.in:102
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_decomp_fillval2.F90.in:103
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:104)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:104
   ! pio_decomp_fillval2.F90.in:105
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_decomp_fillval2.F90.in:106
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:107)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:107
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval2.F90.in:109
#endif
   ! pio_decomp_fillval2.F90.in:111
    rbuf = 0   ! pio_decomp_fillval2.F90.in:112
    call PIO_read_darray(pio_file, pio_var1, riodesc, rbuf, ierr)   ! pio_decomp_fillval2.F90.in:113
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:114)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:114
   ! pio_decomp_fillval2.F90.in:115
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:116)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:116
   ! pio_decomp_fillval2.F90.in:117
    rbuf = 0   ! pio_decomp_fillval2.F90.in:118
    call PIO_read_darray(pio_file, pio_var2, riodesc, rbuf, ierr)   ! pio_decomp_fillval2.F90.in:119
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:120)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:120
   ! pio_decomp_fillval2.F90.in:121
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:122)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:122
   ! pio_decomp_fillval2.F90.in:123
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:124
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval2.F90.in:125
  end do   ! pio_decomp_fillval2.F90.in:126
  if(allocated(iotypes)) then   ! pio_decomp_fillval2.F90.in:127
    deallocate(iotypes)   ! pio_decomp_fillval2.F90.in:128
    deallocate(iotype_descs)   ! pio_decomp_fillval2.F90.in:129
  end if   ! pio_decomp_fillval2.F90.in:130
   ! pio_decomp_fillval2.F90.in:131
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval2.F90.in:132
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval2.F90.in:133
   ! pio_decomp_fillval2.F90.in:134
  deallocate(exp_val)   ! pio_decomp_fillval2.F90.in:135
  deallocate(rbuf)   ! pio_decomp_fillval2.F90.in:136
  deallocate(wbuf)   ! pio_decomp_fillval2.F90.in:137
   ! pio_decomp_fillval2.F90.in:138
END SUBROUTINE nc_wr_1d_mreg_exp_fval_PIO_double_real_kind_fc_double___   ! pio_decomp_fillval2.F90.in:139
   ! pio_decomp_fillval2.F90.in:139


! nc write 1d array with fillvalues (the holes are implicitly specified)
! Each process writes out data with "rank + 1" holes, strided by 2


SUBROUTINE nc_wr_1d_mreg_imp_fval_PIO_int_integer__
USE pio_tutil
   ! pio_decomp_fillval2.F90.in:144
  implicit none   ! pio_decomp_fillval2.F90.in:145
  type(var_desc_t)  :: pio_var1, pio_var2   ! pio_decomp_fillval2.F90.in:146
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval2.F90.in:147
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval2.F90.in:148
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1'   ! pio_decomp_fillval2.F90.in:149
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2'   ! pio_decomp_fillval2.F90.in:150
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval2.F90.in:151
  integer, dimension(:), allocatable :: wcompdof, rcompdof   ! pio_decomp_fillval2.F90.in:152
  integer, dimension(:), allocatable :: rcompdof_rel_disps   ! pio_decomp_fillval2.F90.in:153
  integer, dimension(:), allocatable :: wbuf, rbuf, exp_val   ! pio_decomp_fillval2.F90.in:154
  ! The buffer fillvalue to be used when writing data
  integer, PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval2.F90.in:156
  integer, dimension(1) :: dims   ! pio_decomp_fillval2.F90.in:157
  integer :: pio_dim   ! pio_decomp_fillval2.F90.in:158
  integer :: i, j, ierr, lsz   ! pio_decomp_fillval2.F90.in:159
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval2.F90.in:161
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval2.F90.in:162
  integer :: num_iotypes   ! pio_decomp_fillval2.F90.in:163
   ! pio_decomp_fillval2.F90.in:164
  ! Stride for holes in data
  integer, parameter :: HSTRIDE = 2   ! pio_decomp_fillval2.F90.in:166
  integer :: num_local_holes, vec_local_rsz, vec_local_wsz   ! pio_decomp_fillval2.F90.in:167
   ! pio_decomp_fillval2.F90.in:168
  ! Data written out by each process has "rank + 1" holes
  num_local_holes = pio_tf_world_rank_ + 1   ! pio_decomp_fillval2.F90.in:170
  vec_local_rsz = pio_tf_world_sz_ * HSTRIDE   ! pio_decomp_fillval2.F90.in:171
  vec_local_wsz = vec_local_rsz - num_local_holes   ! pio_decomp_fillval2.F90.in:172
   ! pio_decomp_fillval2.F90.in:173
  allocate(wcompdof(vec_local_wsz))   ! pio_decomp_fillval2.F90.in:174
  allocate(rcompdof(vec_local_rsz))   ! pio_decomp_fillval2.F90.in:175
  allocate(rcompdof_rel_disps(vec_local_rsz))   ! pio_decomp_fillval2.F90.in:176
  do i=1,vec_local_rsz   ! pio_decomp_fillval2.F90.in:177
    rcompdof_rel_disps(i) = i   ! pio_decomp_fillval2.F90.in:178
  end do   ! pio_decomp_fillval2.F90.in:179
  dims(1) = vec_local_rsz * pio_tf_world_sz_   ! pio_decomp_fillval2.F90.in:180
   ! pio_decomp_fillval2.F90.in:181
  ! We read more than we write (for procs with holes)
  rcompdof = vec_local_rsz * pio_tf_world_rank_ + rcompdof_rel_disps   ! pio_decomp_fillval2.F90.in:183
   ! pio_decomp_fillval2.F90.in:184
  ! Since holes are implicit - only specifying valid write compdofs
  ! holes are strided by HSTRIDE
  j = 1   ! pio_decomp_fillval2.F90.in:187
  do i=1,num_local_holes   ! pio_decomp_fillval2.F90.in:188
    wcompdof(j) = vec_local_rsz * pio_tf_world_rank_ + i * HSTRIDE   ! pio_decomp_fillval2.F90.in:189
    j = j + 1   ! pio_decomp_fillval2.F90.in:190
  end do   ! pio_decomp_fillval2.F90.in:191
  do i=num_local_holes*HSTRIDE+1,vec_local_rsz   ! pio_decomp_fillval2.F90.in:192
    wcompdof(j) = vec_local_rsz * pio_tf_world_rank_ + i   ! pio_decomp_fillval2.F90.in:193
    j = j + 1   ! pio_decomp_fillval2.F90.in:194
  end do   ! pio_decomp_fillval2.F90.in:195
   ! pio_decomp_fillval2.F90.in:196
  allocate(wbuf(vec_local_wsz))   ! pio_decomp_fillval2.F90.in:197
  allocate(rbuf(vec_local_rsz))   ! pio_decomp_fillval2.F90.in:198
  allocate(exp_val(vec_local_rsz))   ! pio_decomp_fillval2.F90.in:199
  wbuf = wcompdof   ! pio_decomp_fillval2.F90.in:200
  exp_val = rcompdof   ! pio_decomp_fillval2.F90.in:201
  rbuf = 0   ! pio_decomp_fillval2.F90.in:202
   ! pio_decomp_fillval2.F90.in:203
  ! For hole indices we expect (BUF_FILLVAL == -2)
  ! holes are strided by HSTRIDE
  do i=1,num_local_holes   ! pio_decomp_fillval2.F90.in:206
    j = (i - 1) * HSTRIDE + 1   ! pio_decomp_fillval2.F90.in:207
    exp_val(j) = BUF_FILLVAL   ! pio_decomp_fillval2.F90.in:208
  end do   ! pio_decomp_fillval2.F90.in:209
   ! pio_decomp_fillval2.F90.in:210
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, wcompdof, wiodesc)   ! pio_decomp_fillval2.F90.in:211
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, rcompdof, riodesc)   ! pio_decomp_fillval2.F90.in:212
   ! pio_decomp_fillval2.F90.in:213
  deallocate(rcompdof_rel_disps)   ! pio_decomp_fillval2.F90.in:214
  deallocate(rcompdof)   ! pio_decomp_fillval2.F90.in:215
  deallocate(wcompdof)   ! pio_decomp_fillval2.F90.in:216
   ! pio_decomp_fillval2.F90.in:217
  num_iotypes = 0   ! pio_decomp_fillval2.F90.in:218
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval2.F90.in:219
  do i=1,num_iotypes   ! pio_decomp_fillval2.F90.in:220
   ! pio_decomp_fillval2.F90.in:221
    write(filename,'(a,i1)') "test_pio_decomp_fillval_tests.testfile",i   ! pio_decomp_fillval2.F90.in:222
   ! pio_decomp_fillval2.F90.in:223

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval2.F90.in:224
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval2.F90.in:225
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:226)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:226
   ! pio_decomp_fillval2.F90.in:227
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval2.F90.in:228
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:229)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:229
   ! pio_decomp_fillval2.F90.in:230
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_int,&   ! pio_decomp_fillval2.F90.in:231
                        (/pio_dim/), pio_var1)   ! pio_decomp_fillval2.F90.in:232
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:233)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:233
   ! pio_decomp_fillval2.F90.in:234
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_int,&   ! pio_decomp_fillval2.F90.in:235
                        (/pio_dim/), pio_var2)   ! pio_decomp_fillval2.F90.in:236
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:237)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:237
   ! pio_decomp_fillval2.F90.in:238
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval2.F90.in:239
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:240)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:240
   ! pio_decomp_fillval2.F90.in:241
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var1, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval2.F90.in:243
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:244)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:244
   ! pio_decomp_fillval2.F90.in:245
    call PIO_write_darray(pio_file, pio_var2, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval2.F90.in:246
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:247)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:247
   ! pio_decomp_fillval2.F90.in:248
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:250
   ! pio_decomp_fillval2.F90.in:251
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval2.F90.in:252
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:253)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:253
   ! pio_decomp_fillval2.F90.in:254
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_decomp_fillval2.F90.in:255
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:256)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:256
   ! pio_decomp_fillval2.F90.in:257
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_decomp_fillval2.F90.in:258
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:259)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:259
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval2.F90.in:261
#endif
   ! pio_decomp_fillval2.F90.in:263
    rbuf = 0   ! pio_decomp_fillval2.F90.in:264
    call PIO_read_darray(pio_file, pio_var1, riodesc, rbuf, ierr)   ! pio_decomp_fillval2.F90.in:265
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:266)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:266
   ! pio_decomp_fillval2.F90.in:267
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:268)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:268
   ! pio_decomp_fillval2.F90.in:269
    rbuf = 0   ! pio_decomp_fillval2.F90.in:270
    call PIO_read_darray(pio_file, pio_var2, riodesc, rbuf, ierr)   ! pio_decomp_fillval2.F90.in:271
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:272)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:272
   ! pio_decomp_fillval2.F90.in:273
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:274)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:274
   ! pio_decomp_fillval2.F90.in:275
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:276
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval2.F90.in:277
  end do   ! pio_decomp_fillval2.F90.in:278
  if(allocated(iotypes)) then   ! pio_decomp_fillval2.F90.in:279
    deallocate(iotypes)   ! pio_decomp_fillval2.F90.in:280
    deallocate(iotype_descs)   ! pio_decomp_fillval2.F90.in:281
  end if   ! pio_decomp_fillval2.F90.in:282
   ! pio_decomp_fillval2.F90.in:283
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval2.F90.in:284
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval2.F90.in:285
   ! pio_decomp_fillval2.F90.in:286
  deallocate(exp_val)   ! pio_decomp_fillval2.F90.in:287
  deallocate(rbuf)   ! pio_decomp_fillval2.F90.in:288
  deallocate(wbuf)   ! pio_decomp_fillval2.F90.in:289
   ! pio_decomp_fillval2.F90.in:290
END SUBROUTINE nc_wr_1d_mreg_imp_fval_PIO_int_integer__   ! pio_decomp_fillval2.F90.in:291


SUBROUTINE nc_wr_1d_mreg_imp_fval_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_decomp_fillval2.F90.in:144
  implicit none   ! pio_decomp_fillval2.F90.in:145
  type(var_desc_t)  :: pio_var1, pio_var2   ! pio_decomp_fillval2.F90.in:146
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval2.F90.in:147
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval2.F90.in:148
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1'   ! pio_decomp_fillval2.F90.in:149
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2'   ! pio_decomp_fillval2.F90.in:150
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval2.F90.in:151
  integer, dimension(:), allocatable :: wcompdof, rcompdof   ! pio_decomp_fillval2.F90.in:152
  integer, dimension(:), allocatable :: rcompdof_rel_disps   ! pio_decomp_fillval2.F90.in:153
  real(kind=fc_real), dimension(:), allocatable :: wbuf, rbuf, exp_val   ! pio_decomp_fillval2.F90.in:154
  ! The buffer fillvalue to be used when writing data
  real(kind=fc_real), PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval2.F90.in:156
  integer, dimension(1) :: dims   ! pio_decomp_fillval2.F90.in:157
  integer :: pio_dim   ! pio_decomp_fillval2.F90.in:158
  integer :: i, j, ierr, lsz   ! pio_decomp_fillval2.F90.in:159
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval2.F90.in:161
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval2.F90.in:162
  integer :: num_iotypes   ! pio_decomp_fillval2.F90.in:163
   ! pio_decomp_fillval2.F90.in:164
  ! Stride for holes in data
  integer, parameter :: HSTRIDE = 2   ! pio_decomp_fillval2.F90.in:166
  integer :: num_local_holes, vec_local_rsz, vec_local_wsz   ! pio_decomp_fillval2.F90.in:167
   ! pio_decomp_fillval2.F90.in:168
  ! Data written out by each process has "rank + 1" holes
  num_local_holes = pio_tf_world_rank_ + 1   ! pio_decomp_fillval2.F90.in:170
  vec_local_rsz = pio_tf_world_sz_ * HSTRIDE   ! pio_decomp_fillval2.F90.in:171
  vec_local_wsz = vec_local_rsz - num_local_holes   ! pio_decomp_fillval2.F90.in:172
   ! pio_decomp_fillval2.F90.in:173
  allocate(wcompdof(vec_local_wsz))   ! pio_decomp_fillval2.F90.in:174
  allocate(rcompdof(vec_local_rsz))   ! pio_decomp_fillval2.F90.in:175
  allocate(rcompdof_rel_disps(vec_local_rsz))   ! pio_decomp_fillval2.F90.in:176
  do i=1,vec_local_rsz   ! pio_decomp_fillval2.F90.in:177
    rcompdof_rel_disps(i) = i   ! pio_decomp_fillval2.F90.in:178
  end do   ! pio_decomp_fillval2.F90.in:179
  dims(1) = vec_local_rsz * pio_tf_world_sz_   ! pio_decomp_fillval2.F90.in:180
   ! pio_decomp_fillval2.F90.in:181
  ! We read more than we write (for procs with holes)
  rcompdof = vec_local_rsz * pio_tf_world_rank_ + rcompdof_rel_disps   ! pio_decomp_fillval2.F90.in:183
   ! pio_decomp_fillval2.F90.in:184
  ! Since holes are implicit - only specifying valid write compdofs
  ! holes are strided by HSTRIDE
  j = 1   ! pio_decomp_fillval2.F90.in:187
  do i=1,num_local_holes   ! pio_decomp_fillval2.F90.in:188
    wcompdof(j) = vec_local_rsz * pio_tf_world_rank_ + i * HSTRIDE   ! pio_decomp_fillval2.F90.in:189
    j = j + 1   ! pio_decomp_fillval2.F90.in:190
  end do   ! pio_decomp_fillval2.F90.in:191
  do i=num_local_holes*HSTRIDE+1,vec_local_rsz   ! pio_decomp_fillval2.F90.in:192
    wcompdof(j) = vec_local_rsz * pio_tf_world_rank_ + i   ! pio_decomp_fillval2.F90.in:193
    j = j + 1   ! pio_decomp_fillval2.F90.in:194
  end do   ! pio_decomp_fillval2.F90.in:195
   ! pio_decomp_fillval2.F90.in:196
  allocate(wbuf(vec_local_wsz))   ! pio_decomp_fillval2.F90.in:197
  allocate(rbuf(vec_local_rsz))   ! pio_decomp_fillval2.F90.in:198
  allocate(exp_val(vec_local_rsz))   ! pio_decomp_fillval2.F90.in:199
  wbuf = wcompdof   ! pio_decomp_fillval2.F90.in:200
  exp_val = rcompdof   ! pio_decomp_fillval2.F90.in:201
  rbuf = 0   ! pio_decomp_fillval2.F90.in:202
   ! pio_decomp_fillval2.F90.in:203
  ! For hole indices we expect (BUF_FILLVAL == -2)
  ! holes are strided by HSTRIDE
  do i=1,num_local_holes   ! pio_decomp_fillval2.F90.in:206
    j = (i - 1) * HSTRIDE + 1   ! pio_decomp_fillval2.F90.in:207
    exp_val(j) = BUF_FILLVAL   ! pio_decomp_fillval2.F90.in:208
  end do   ! pio_decomp_fillval2.F90.in:209
   ! pio_decomp_fillval2.F90.in:210
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, wcompdof, wiodesc)   ! pio_decomp_fillval2.F90.in:211
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, rcompdof, riodesc)   ! pio_decomp_fillval2.F90.in:212
   ! pio_decomp_fillval2.F90.in:213
  deallocate(rcompdof_rel_disps)   ! pio_decomp_fillval2.F90.in:214
  deallocate(rcompdof)   ! pio_decomp_fillval2.F90.in:215
  deallocate(wcompdof)   ! pio_decomp_fillval2.F90.in:216
   ! pio_decomp_fillval2.F90.in:217
  num_iotypes = 0   ! pio_decomp_fillval2.F90.in:218
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval2.F90.in:219
  do i=1,num_iotypes   ! pio_decomp_fillval2.F90.in:220
   ! pio_decomp_fillval2.F90.in:221
    write(filename,'(a,i1)') "test_pio_decomp_fillval_tests.testfile",i   ! pio_decomp_fillval2.F90.in:222
   ! pio_decomp_fillval2.F90.in:223

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval2.F90.in:224
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval2.F90.in:225
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:226)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:226
   ! pio_decomp_fillval2.F90.in:227
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval2.F90.in:228
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:229)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:229
   ! pio_decomp_fillval2.F90.in:230
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_real,&   ! pio_decomp_fillval2.F90.in:231
                        (/pio_dim/), pio_var1)   ! pio_decomp_fillval2.F90.in:232
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:233)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:233
   ! pio_decomp_fillval2.F90.in:234
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_real,&   ! pio_decomp_fillval2.F90.in:235
                        (/pio_dim/), pio_var2)   ! pio_decomp_fillval2.F90.in:236
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:237)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:237
   ! pio_decomp_fillval2.F90.in:238
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval2.F90.in:239
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:240)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:240
   ! pio_decomp_fillval2.F90.in:241
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var1, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval2.F90.in:243
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:244)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:244
   ! pio_decomp_fillval2.F90.in:245
    call PIO_write_darray(pio_file, pio_var2, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval2.F90.in:246
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:247)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:247
   ! pio_decomp_fillval2.F90.in:248
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:250
   ! pio_decomp_fillval2.F90.in:251
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval2.F90.in:252
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:253)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:253
   ! pio_decomp_fillval2.F90.in:254
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_decomp_fillval2.F90.in:255
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:256)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:256
   ! pio_decomp_fillval2.F90.in:257
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_decomp_fillval2.F90.in:258
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:259)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:259
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval2.F90.in:261
#endif
   ! pio_decomp_fillval2.F90.in:263
    rbuf = 0   ! pio_decomp_fillval2.F90.in:264
    call PIO_read_darray(pio_file, pio_var1, riodesc, rbuf, ierr)   ! pio_decomp_fillval2.F90.in:265
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:266)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:266
   ! pio_decomp_fillval2.F90.in:267
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:268)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:268
   ! pio_decomp_fillval2.F90.in:269
    rbuf = 0   ! pio_decomp_fillval2.F90.in:270
    call PIO_read_darray(pio_file, pio_var2, riodesc, rbuf, ierr)   ! pio_decomp_fillval2.F90.in:271
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:272)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:272
   ! pio_decomp_fillval2.F90.in:273
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:274)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:274
   ! pio_decomp_fillval2.F90.in:275
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:276
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval2.F90.in:277
  end do   ! pio_decomp_fillval2.F90.in:278
  if(allocated(iotypes)) then   ! pio_decomp_fillval2.F90.in:279
    deallocate(iotypes)   ! pio_decomp_fillval2.F90.in:280
    deallocate(iotype_descs)   ! pio_decomp_fillval2.F90.in:281
  end if   ! pio_decomp_fillval2.F90.in:282
   ! pio_decomp_fillval2.F90.in:283
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval2.F90.in:284
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval2.F90.in:285
   ! pio_decomp_fillval2.F90.in:286
  deallocate(exp_val)   ! pio_decomp_fillval2.F90.in:287
  deallocate(rbuf)   ! pio_decomp_fillval2.F90.in:288
  deallocate(wbuf)   ! pio_decomp_fillval2.F90.in:289
   ! pio_decomp_fillval2.F90.in:290
END SUBROUTINE nc_wr_1d_mreg_imp_fval_PIO_real_real_kind_fc_real___   ! pio_decomp_fillval2.F90.in:291


SUBROUTINE nc_wr_1d_mreg_imp_fval_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_decomp_fillval2.F90.in:144
  implicit none   ! pio_decomp_fillval2.F90.in:145
  type(var_desc_t)  :: pio_var1, pio_var2   ! pio_decomp_fillval2.F90.in:146
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval2.F90.in:147
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval2.F90.in:148
  character(len=*), parameter :: PIO_VAR1_NAME = 'PIO_TF_test_var1'   ! pio_decomp_fillval2.F90.in:149
  character(len=*), parameter :: PIO_VAR2_NAME = 'PIO_TF_test_var2'   ! pio_decomp_fillval2.F90.in:150
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval2.F90.in:151
  integer, dimension(:), allocatable :: wcompdof, rcompdof   ! pio_decomp_fillval2.F90.in:152
  integer, dimension(:), allocatable :: rcompdof_rel_disps   ! pio_decomp_fillval2.F90.in:153
  real(kind=fc_double), dimension(:), allocatable :: wbuf, rbuf, exp_val   ! pio_decomp_fillval2.F90.in:154
  ! The buffer fillvalue to be used when writing data
  real(kind=fc_double), PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval2.F90.in:156
  integer, dimension(1) :: dims   ! pio_decomp_fillval2.F90.in:157
  integer :: pio_dim   ! pio_decomp_fillval2.F90.in:158
  integer :: i, j, ierr, lsz   ! pio_decomp_fillval2.F90.in:159
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval2.F90.in:161
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval2.F90.in:162
  integer :: num_iotypes   ! pio_decomp_fillval2.F90.in:163
   ! pio_decomp_fillval2.F90.in:164
  ! Stride for holes in data
  integer, parameter :: HSTRIDE = 2   ! pio_decomp_fillval2.F90.in:166
  integer :: num_local_holes, vec_local_rsz, vec_local_wsz   ! pio_decomp_fillval2.F90.in:167
   ! pio_decomp_fillval2.F90.in:168
  ! Data written out by each process has "rank + 1" holes
  num_local_holes = pio_tf_world_rank_ + 1   ! pio_decomp_fillval2.F90.in:170
  vec_local_rsz = pio_tf_world_sz_ * HSTRIDE   ! pio_decomp_fillval2.F90.in:171
  vec_local_wsz = vec_local_rsz - num_local_holes   ! pio_decomp_fillval2.F90.in:172
   ! pio_decomp_fillval2.F90.in:173
  allocate(wcompdof(vec_local_wsz))   ! pio_decomp_fillval2.F90.in:174
  allocate(rcompdof(vec_local_rsz))   ! pio_decomp_fillval2.F90.in:175
  allocate(rcompdof_rel_disps(vec_local_rsz))   ! pio_decomp_fillval2.F90.in:176
  do i=1,vec_local_rsz   ! pio_decomp_fillval2.F90.in:177
    rcompdof_rel_disps(i) = i   ! pio_decomp_fillval2.F90.in:178
  end do   ! pio_decomp_fillval2.F90.in:179
  dims(1) = vec_local_rsz * pio_tf_world_sz_   ! pio_decomp_fillval2.F90.in:180
   ! pio_decomp_fillval2.F90.in:181
  ! We read more than we write (for procs with holes)
  rcompdof = vec_local_rsz * pio_tf_world_rank_ + rcompdof_rel_disps   ! pio_decomp_fillval2.F90.in:183
   ! pio_decomp_fillval2.F90.in:184
  ! Since holes are implicit - only specifying valid write compdofs
  ! holes are strided by HSTRIDE
  j = 1   ! pio_decomp_fillval2.F90.in:187
  do i=1,num_local_holes   ! pio_decomp_fillval2.F90.in:188
    wcompdof(j) = vec_local_rsz * pio_tf_world_rank_ + i * HSTRIDE   ! pio_decomp_fillval2.F90.in:189
    j = j + 1   ! pio_decomp_fillval2.F90.in:190
  end do   ! pio_decomp_fillval2.F90.in:191
  do i=num_local_holes*HSTRIDE+1,vec_local_rsz   ! pio_decomp_fillval2.F90.in:192
    wcompdof(j) = vec_local_rsz * pio_tf_world_rank_ + i   ! pio_decomp_fillval2.F90.in:193
    j = j + 1   ! pio_decomp_fillval2.F90.in:194
  end do   ! pio_decomp_fillval2.F90.in:195
   ! pio_decomp_fillval2.F90.in:196
  allocate(wbuf(vec_local_wsz))   ! pio_decomp_fillval2.F90.in:197
  allocate(rbuf(vec_local_rsz))   ! pio_decomp_fillval2.F90.in:198
  allocate(exp_val(vec_local_rsz))   ! pio_decomp_fillval2.F90.in:199
  wbuf = wcompdof   ! pio_decomp_fillval2.F90.in:200
  exp_val = rcompdof   ! pio_decomp_fillval2.F90.in:201
  rbuf = 0   ! pio_decomp_fillval2.F90.in:202
   ! pio_decomp_fillval2.F90.in:203
  ! For hole indices we expect (BUF_FILLVAL == -2)
  ! holes are strided by HSTRIDE
  do i=1,num_local_holes   ! pio_decomp_fillval2.F90.in:206
    j = (i - 1) * HSTRIDE + 1   ! pio_decomp_fillval2.F90.in:207
    exp_val(j) = BUF_FILLVAL   ! pio_decomp_fillval2.F90.in:208
  end do   ! pio_decomp_fillval2.F90.in:209
   ! pio_decomp_fillval2.F90.in:210
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, wcompdof, wiodesc)   ! pio_decomp_fillval2.F90.in:211
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, rcompdof, riodesc)   ! pio_decomp_fillval2.F90.in:212
   ! pio_decomp_fillval2.F90.in:213
  deallocate(rcompdof_rel_disps)   ! pio_decomp_fillval2.F90.in:214
  deallocate(rcompdof)   ! pio_decomp_fillval2.F90.in:215
  deallocate(wcompdof)   ! pio_decomp_fillval2.F90.in:216
   ! pio_decomp_fillval2.F90.in:217
  num_iotypes = 0   ! pio_decomp_fillval2.F90.in:218
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval2.F90.in:219
  do i=1,num_iotypes   ! pio_decomp_fillval2.F90.in:220
   ! pio_decomp_fillval2.F90.in:221
    write(filename,'(a,i1)') "test_pio_decomp_fillval_tests.testfile",i   ! pio_decomp_fillval2.F90.in:222
   ! pio_decomp_fillval2.F90.in:223

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval2.F90.in:224
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval2.F90.in:225
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:226)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:226
   ! pio_decomp_fillval2.F90.in:227
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval2.F90.in:228
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:229)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:229
   ! pio_decomp_fillval2.F90.in:230
    ierr = PIO_def_var(pio_file, PIO_VAR1_NAME, PIO_double,&   ! pio_decomp_fillval2.F90.in:231
                        (/pio_dim/), pio_var1)   ! pio_decomp_fillval2.F90.in:232
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:233)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:233
   ! pio_decomp_fillval2.F90.in:234
    ierr = PIO_def_var(pio_file, PIO_VAR2_NAME, PIO_double,&   ! pio_decomp_fillval2.F90.in:235
                        (/pio_dim/), pio_var2)   ! pio_decomp_fillval2.F90.in:236
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:237)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:237
   ! pio_decomp_fillval2.F90.in:238
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval2.F90.in:239
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:240)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:240
   ! pio_decomp_fillval2.F90.in:241
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var1, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval2.F90.in:243
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:244)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:244
   ! pio_decomp_fillval2.F90.in:245
    call PIO_write_darray(pio_file, pio_var2, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval2.F90.in:246
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:247)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:247
   ! pio_decomp_fillval2.F90.in:248
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:250
   ! pio_decomp_fillval2.F90.in:251
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval2.F90.in:252
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:253)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:253
   ! pio_decomp_fillval2.F90.in:254
    ierr = PIO_inq_varid(pio_file, PIO_VAR1_NAME, pio_var1)   ! pio_decomp_fillval2.F90.in:255
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var1 " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:256)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:256
   ! pio_decomp_fillval2.F90.in:257
    ierr = PIO_inq_varid(pio_file, PIO_VAR2_NAME, pio_var2)   ! pio_decomp_fillval2.F90.in:258
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var2 " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:259)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:259
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval2.F90.in:261
#endif
   ! pio_decomp_fillval2.F90.in:263
    rbuf = 0   ! pio_decomp_fillval2.F90.in:264
    call PIO_read_darray(pio_file, pio_var1, riodesc, rbuf, ierr)   ! pio_decomp_fillval2.F90.in:265
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:266)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:266
   ! pio_decomp_fillval2.F90.in:267
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:268)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:268
   ! pio_decomp_fillval2.F90.in:269
    rbuf = 0   ! pio_decomp_fillval2.F90.in:270
    call PIO_read_darray(pio_file, pio_var2, riodesc, rbuf, ierr)   ! pio_decomp_fillval2.F90.in:271
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:272)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:272
   ! pio_decomp_fillval2.F90.in:273
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:274)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:274
   ! pio_decomp_fillval2.F90.in:275
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:276
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval2.F90.in:277
  end do   ! pio_decomp_fillval2.F90.in:278
  if(allocated(iotypes)) then   ! pio_decomp_fillval2.F90.in:279
    deallocate(iotypes)   ! pio_decomp_fillval2.F90.in:280
    deallocate(iotype_descs)   ! pio_decomp_fillval2.F90.in:281
  end if   ! pio_decomp_fillval2.F90.in:282
   ! pio_decomp_fillval2.F90.in:283
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval2.F90.in:284
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval2.F90.in:285
   ! pio_decomp_fillval2.F90.in:286
  deallocate(exp_val)   ! pio_decomp_fillval2.F90.in:287
  deallocate(rbuf)   ! pio_decomp_fillval2.F90.in:288
  deallocate(wbuf)   ! pio_decomp_fillval2.F90.in:289
   ! pio_decomp_fillval2.F90.in:290
END SUBROUTINE nc_wr_1d_mreg_imp_fval_PIO_double_real_kind_fc_double___   ! pio_decomp_fillval2.F90.in:291
   ! pio_decomp_fillval2.F90.in:291


! A test that writes out val with only one data point/value
! All procs, except the last proc, only writes out fillvalues
! the last proc, writes out 1 value that is not a fillvalue and
! the rest all fillvalues.


SUBROUTINE nc_wr_1d_one_val_PIO_int_integer__
USE pio_tutil
   ! pio_decomp_fillval2.F90.in:298
  implicit none   ! pio_decomp_fillval2.F90.in:299
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_fillval2.F90.in:300
  type(var_desc_t)  :: pio_var   ! pio_decomp_fillval2.F90.in:301
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval2.F90.in:302
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval2.F90.in:303
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_fillval2.F90.in:304
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval2.F90.in:305
  integer, dimension(VEC_LOCAL_SZ) :: wcompdof, rcompdof, compdof_rel_disps   ! pio_decomp_fillval2.F90.in:306
  ! Compdof value to suggest that data point is a hole, this hole
  ! is usually filled with a fillvalue
  integer, parameter :: PIO_COMPDOF_FILLVAL = 0   ! pio_decomp_fillval2.F90.in:309
  integer, dimension(VEC_LOCAL_SZ) :: wbuf, rbuf, exp_val   ! pio_decomp_fillval2.F90.in:310
  ! The buffer fillvalue to be used when writing data
  integer, PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval2.F90.in:312
  integer, dimension(1) :: dims   ! pio_decomp_fillval2.F90.in:313
  integer :: pio_dim   ! pio_decomp_fillval2.F90.in:314
  integer :: i, ierr, lsz   ! pio_decomp_fillval2.F90.in:315
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval2.F90.in:317
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval2.F90.in:318
  integer :: num_iotypes   ! pio_decomp_fillval2.F90.in:319
  logical :: is_last_proc = .false.   ! pio_decomp_fillval2.F90.in:320
   ! pio_decomp_fillval2.F90.in:321
  if(pio_tf_world_rank_ == pio_tf_world_sz_ - 1) then   ! pio_decomp_fillval2.F90.in:322
    is_last_proc = .true.   ! pio_decomp_fillval2.F90.in:323
  end if   ! pio_decomp_fillval2.F90.in:324
   ! pio_decomp_fillval2.F90.in:325
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval2.F90.in:326
    compdof_rel_disps(i) = i   ! pio_decomp_fillval2.F90.in:327
  end do   ! pio_decomp_fillval2.F90.in:328
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_fillval2.F90.in:329
  rcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval2.F90.in:330
  wcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval2.F90.in:331
   ! pio_decomp_fillval2.F90.in:332
  wbuf = wcompdof   ! pio_decomp_fillval2.F90.in:333
  exp_val = wcompdof   ! pio_decomp_fillval2.F90.in:334
  rbuf = 0   ! pio_decomp_fillval2.F90.in:335
   ! pio_decomp_fillval2.F90.in:336
  ! All indices have fillvalues by default
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval2.F90.in:338
    wcompdof(i) = PIO_COMPDOF_FILLVAL   ! pio_decomp_fillval2.F90.in:339
    exp_val(i) = BUF_FILLVAL   ! pio_decomp_fillval2.F90.in:340
  end do   ! pio_decomp_fillval2.F90.in:341
   ! pio_decomp_fillval2.F90.in:342
  ! Only the last proc has a valid data value
  if(is_last_proc) then   ! pio_decomp_fillval2.F90.in:344
    wcompdof(VEC_LOCAL_SZ) = VEC_LOCAL_SZ * pio_tf_world_rank_ + VEC_LOCAL_SZ   ! pio_decomp_fillval2.F90.in:345
    exp_val(VEC_LOCAL_SZ) = wcompdof(VEC_LOCAL_SZ)   ! pio_decomp_fillval2.F90.in:346
  end if    ! pio_decomp_fillval2.F90.in:347
   ! pio_decomp_fillval2.F90.in:348
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, wcompdof, wiodesc)   ! pio_decomp_fillval2.F90.in:349
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, rcompdof, riodesc)   ! pio_decomp_fillval2.F90.in:350
   ! pio_decomp_fillval2.F90.in:351
  num_iotypes = 0   ! pio_decomp_fillval2.F90.in:352
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval2.F90.in:353
  do i=1,num_iotypes   ! pio_decomp_fillval2.F90.in:354
   ! pio_decomp_fillval2.F90.in:355
    write(filename,'(a,i1)') "test_pio_decomp_fillval_tests.testfile",i   ! pio_decomp_fillval2.F90.in:356
   ! pio_decomp_fillval2.F90.in:357

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval2.F90.in:358
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval2.F90.in:359
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:360)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:360
   ! pio_decomp_fillval2.F90.in:361
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval2.F90.in:362
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:363)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:363
   ! pio_decomp_fillval2.F90.in:364
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_int, (/pio_dim/), pio_var)   ! pio_decomp_fillval2.F90.in:365
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:366)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:366
   ! pio_decomp_fillval2.F90.in:367
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval2.F90.in:368
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:369)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:369
   ! pio_decomp_fillval2.F90.in:370
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval2.F90.in:372
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:373)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:373
   ! pio_decomp_fillval2.F90.in:374
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:376
   ! pio_decomp_fillval2.F90.in:377
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval2.F90.in:378
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:379)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:379
   ! pio_decomp_fillval2.F90.in:380
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_fillval2.F90.in:381
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:382)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:382
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval2.F90.in:384
#endif
   ! pio_decomp_fillval2.F90.in:386
    rbuf = 0   ! pio_decomp_fillval2.F90.in:387
    call PIO_read_darray(pio_file, pio_var, riodesc, rbuf, ierr)   ! pio_decomp_fillval2.F90.in:388
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:389)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:389
   ! pio_decomp_fillval2.F90.in:390
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:391)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:391
   ! pio_decomp_fillval2.F90.in:392
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:393
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval2.F90.in:394
  end do   ! pio_decomp_fillval2.F90.in:395
  if(allocated(iotypes)) then   ! pio_decomp_fillval2.F90.in:396
    deallocate(iotypes)   ! pio_decomp_fillval2.F90.in:397
    deallocate(iotype_descs)   ! pio_decomp_fillval2.F90.in:398
  end if   ! pio_decomp_fillval2.F90.in:399
   ! pio_decomp_fillval2.F90.in:400
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval2.F90.in:401
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval2.F90.in:402
END SUBROUTINE nc_wr_1d_one_val_PIO_int_integer__   ! pio_decomp_fillval2.F90.in:403


SUBROUTINE nc_wr_1d_one_val_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_decomp_fillval2.F90.in:298
  implicit none   ! pio_decomp_fillval2.F90.in:299
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_fillval2.F90.in:300
  type(var_desc_t)  :: pio_var   ! pio_decomp_fillval2.F90.in:301
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval2.F90.in:302
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval2.F90.in:303
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_fillval2.F90.in:304
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval2.F90.in:305
  integer, dimension(VEC_LOCAL_SZ) :: wcompdof, rcompdof, compdof_rel_disps   ! pio_decomp_fillval2.F90.in:306
  ! Compdof value to suggest that data point is a hole, this hole
  ! is usually filled with a fillvalue
  integer, parameter :: PIO_COMPDOF_FILLVAL = 0   ! pio_decomp_fillval2.F90.in:309
  real(kind=fc_real), dimension(VEC_LOCAL_SZ) :: wbuf, rbuf, exp_val   ! pio_decomp_fillval2.F90.in:310
  ! The buffer fillvalue to be used when writing data
  real(kind=fc_real), PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval2.F90.in:312
  integer, dimension(1) :: dims   ! pio_decomp_fillval2.F90.in:313
  integer :: pio_dim   ! pio_decomp_fillval2.F90.in:314
  integer :: i, ierr, lsz   ! pio_decomp_fillval2.F90.in:315
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval2.F90.in:317
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval2.F90.in:318
  integer :: num_iotypes   ! pio_decomp_fillval2.F90.in:319
  logical :: is_last_proc = .false.   ! pio_decomp_fillval2.F90.in:320
   ! pio_decomp_fillval2.F90.in:321
  if(pio_tf_world_rank_ == pio_tf_world_sz_ - 1) then   ! pio_decomp_fillval2.F90.in:322
    is_last_proc = .true.   ! pio_decomp_fillval2.F90.in:323
  end if   ! pio_decomp_fillval2.F90.in:324
   ! pio_decomp_fillval2.F90.in:325
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval2.F90.in:326
    compdof_rel_disps(i) = i   ! pio_decomp_fillval2.F90.in:327
  end do   ! pio_decomp_fillval2.F90.in:328
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_fillval2.F90.in:329
  rcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval2.F90.in:330
  wcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval2.F90.in:331
   ! pio_decomp_fillval2.F90.in:332
  wbuf = wcompdof   ! pio_decomp_fillval2.F90.in:333
  exp_val = wcompdof   ! pio_decomp_fillval2.F90.in:334
  rbuf = 0   ! pio_decomp_fillval2.F90.in:335
   ! pio_decomp_fillval2.F90.in:336
  ! All indices have fillvalues by default
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval2.F90.in:338
    wcompdof(i) = PIO_COMPDOF_FILLVAL   ! pio_decomp_fillval2.F90.in:339
    exp_val(i) = BUF_FILLVAL   ! pio_decomp_fillval2.F90.in:340
  end do   ! pio_decomp_fillval2.F90.in:341
   ! pio_decomp_fillval2.F90.in:342
  ! Only the last proc has a valid data value
  if(is_last_proc) then   ! pio_decomp_fillval2.F90.in:344
    wcompdof(VEC_LOCAL_SZ) = VEC_LOCAL_SZ * pio_tf_world_rank_ + VEC_LOCAL_SZ   ! pio_decomp_fillval2.F90.in:345
    exp_val(VEC_LOCAL_SZ) = wcompdof(VEC_LOCAL_SZ)   ! pio_decomp_fillval2.F90.in:346
  end if    ! pio_decomp_fillval2.F90.in:347
   ! pio_decomp_fillval2.F90.in:348
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, wcompdof, wiodesc)   ! pio_decomp_fillval2.F90.in:349
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, rcompdof, riodesc)   ! pio_decomp_fillval2.F90.in:350
   ! pio_decomp_fillval2.F90.in:351
  num_iotypes = 0   ! pio_decomp_fillval2.F90.in:352
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval2.F90.in:353
  do i=1,num_iotypes   ! pio_decomp_fillval2.F90.in:354
   ! pio_decomp_fillval2.F90.in:355
    write(filename,'(a,i1)') "test_pio_decomp_fillval_tests.testfile",i   ! pio_decomp_fillval2.F90.in:356
   ! pio_decomp_fillval2.F90.in:357

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval2.F90.in:358
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval2.F90.in:359
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:360)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:360
   ! pio_decomp_fillval2.F90.in:361
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval2.F90.in:362
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:363)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:363
   ! pio_decomp_fillval2.F90.in:364
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_real, (/pio_dim/), pio_var)   ! pio_decomp_fillval2.F90.in:365
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:366)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:366
   ! pio_decomp_fillval2.F90.in:367
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval2.F90.in:368
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:369)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:369
   ! pio_decomp_fillval2.F90.in:370
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval2.F90.in:372
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:373)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:373
   ! pio_decomp_fillval2.F90.in:374
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:376
   ! pio_decomp_fillval2.F90.in:377
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval2.F90.in:378
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:379)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:379
   ! pio_decomp_fillval2.F90.in:380
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_fillval2.F90.in:381
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:382)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:382
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval2.F90.in:384
#endif
   ! pio_decomp_fillval2.F90.in:386
    rbuf = 0   ! pio_decomp_fillval2.F90.in:387
    call PIO_read_darray(pio_file, pio_var, riodesc, rbuf, ierr)   ! pio_decomp_fillval2.F90.in:388
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:389)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:389
   ! pio_decomp_fillval2.F90.in:390
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:391)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:391
   ! pio_decomp_fillval2.F90.in:392
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:393
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval2.F90.in:394
  end do   ! pio_decomp_fillval2.F90.in:395
  if(allocated(iotypes)) then   ! pio_decomp_fillval2.F90.in:396
    deallocate(iotypes)   ! pio_decomp_fillval2.F90.in:397
    deallocate(iotype_descs)   ! pio_decomp_fillval2.F90.in:398
  end if   ! pio_decomp_fillval2.F90.in:399
   ! pio_decomp_fillval2.F90.in:400
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval2.F90.in:401
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval2.F90.in:402
END SUBROUTINE nc_wr_1d_one_val_PIO_real_real_kind_fc_real___   ! pio_decomp_fillval2.F90.in:403


SUBROUTINE nc_wr_1d_one_val_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_decomp_fillval2.F90.in:298
  implicit none   ! pio_decomp_fillval2.F90.in:299
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_fillval2.F90.in:300
  type(var_desc_t)  :: pio_var   ! pio_decomp_fillval2.F90.in:301
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval2.F90.in:302
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval2.F90.in:303
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_fillval2.F90.in:304
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval2.F90.in:305
  integer, dimension(VEC_LOCAL_SZ) :: wcompdof, rcompdof, compdof_rel_disps   ! pio_decomp_fillval2.F90.in:306
  ! Compdof value to suggest that data point is a hole, this hole
  ! is usually filled with a fillvalue
  integer, parameter :: PIO_COMPDOF_FILLVAL = 0   ! pio_decomp_fillval2.F90.in:309
  real(kind=fc_double), dimension(VEC_LOCAL_SZ) :: wbuf, rbuf, exp_val   ! pio_decomp_fillval2.F90.in:310
  ! The buffer fillvalue to be used when writing data
  real(kind=fc_double), PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval2.F90.in:312
  integer, dimension(1) :: dims   ! pio_decomp_fillval2.F90.in:313
  integer :: pio_dim   ! pio_decomp_fillval2.F90.in:314
  integer :: i, ierr, lsz   ! pio_decomp_fillval2.F90.in:315
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval2.F90.in:317
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval2.F90.in:318
  integer :: num_iotypes   ! pio_decomp_fillval2.F90.in:319
  logical :: is_last_proc = .false.   ! pio_decomp_fillval2.F90.in:320
   ! pio_decomp_fillval2.F90.in:321
  if(pio_tf_world_rank_ == pio_tf_world_sz_ - 1) then   ! pio_decomp_fillval2.F90.in:322
    is_last_proc = .true.   ! pio_decomp_fillval2.F90.in:323
  end if   ! pio_decomp_fillval2.F90.in:324
   ! pio_decomp_fillval2.F90.in:325
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval2.F90.in:326
    compdof_rel_disps(i) = i   ! pio_decomp_fillval2.F90.in:327
  end do   ! pio_decomp_fillval2.F90.in:328
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_fillval2.F90.in:329
  rcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval2.F90.in:330
  wcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval2.F90.in:331
   ! pio_decomp_fillval2.F90.in:332
  wbuf = wcompdof   ! pio_decomp_fillval2.F90.in:333
  exp_val = wcompdof   ! pio_decomp_fillval2.F90.in:334
  rbuf = 0   ! pio_decomp_fillval2.F90.in:335
   ! pio_decomp_fillval2.F90.in:336
  ! All indices have fillvalues by default
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval2.F90.in:338
    wcompdof(i) = PIO_COMPDOF_FILLVAL   ! pio_decomp_fillval2.F90.in:339
    exp_val(i) = BUF_FILLVAL   ! pio_decomp_fillval2.F90.in:340
  end do   ! pio_decomp_fillval2.F90.in:341
   ! pio_decomp_fillval2.F90.in:342
  ! Only the last proc has a valid data value
  if(is_last_proc) then   ! pio_decomp_fillval2.F90.in:344
    wcompdof(VEC_LOCAL_SZ) = VEC_LOCAL_SZ * pio_tf_world_rank_ + VEC_LOCAL_SZ   ! pio_decomp_fillval2.F90.in:345
    exp_val(VEC_LOCAL_SZ) = wcompdof(VEC_LOCAL_SZ)   ! pio_decomp_fillval2.F90.in:346
  end if    ! pio_decomp_fillval2.F90.in:347
   ! pio_decomp_fillval2.F90.in:348
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, wcompdof, wiodesc)   ! pio_decomp_fillval2.F90.in:349
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, rcompdof, riodesc)   ! pio_decomp_fillval2.F90.in:350
   ! pio_decomp_fillval2.F90.in:351
  num_iotypes = 0   ! pio_decomp_fillval2.F90.in:352
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval2.F90.in:353
  do i=1,num_iotypes   ! pio_decomp_fillval2.F90.in:354
   ! pio_decomp_fillval2.F90.in:355
    write(filename,'(a,i1)') "test_pio_decomp_fillval_tests.testfile",i   ! pio_decomp_fillval2.F90.in:356
   ! pio_decomp_fillval2.F90.in:357

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval2.F90.in:358
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval2.F90.in:359
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:360)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:360
   ! pio_decomp_fillval2.F90.in:361
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval2.F90.in:362
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:363)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:363
   ! pio_decomp_fillval2.F90.in:364
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_double, (/pio_dim/), pio_var)   ! pio_decomp_fillval2.F90.in:365
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:366)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:366
   ! pio_decomp_fillval2.F90.in:367
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval2.F90.in:368
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:369)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:369
   ! pio_decomp_fillval2.F90.in:370
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval2.F90.in:372
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:373)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:373
   ! pio_decomp_fillval2.F90.in:374
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:376
   ! pio_decomp_fillval2.F90.in:377
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval2.F90.in:378
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:379)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:379
   ! pio_decomp_fillval2.F90.in:380
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_fillval2.F90.in:381
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:382)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:382
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval2.F90.in:384
#endif
   ! pio_decomp_fillval2.F90.in:386
    rbuf = 0   ! pio_decomp_fillval2.F90.in:387
    call PIO_read_darray(pio_file, pio_var, riodesc, rbuf, ierr)   ! pio_decomp_fillval2.F90.in:388
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:389)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:389
   ! pio_decomp_fillval2.F90.in:390
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:391)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:391
   ! pio_decomp_fillval2.F90.in:392
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:393
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval2.F90.in:394
  end do   ! pio_decomp_fillval2.F90.in:395
  if(allocated(iotypes)) then   ! pio_decomp_fillval2.F90.in:396
    deallocate(iotypes)   ! pio_decomp_fillval2.F90.in:397
    deallocate(iotype_descs)   ! pio_decomp_fillval2.F90.in:398
  end if   ! pio_decomp_fillval2.F90.in:399
   ! pio_decomp_fillval2.F90.in:400
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval2.F90.in:401
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval2.F90.in:402
END SUBROUTINE nc_wr_1d_one_val_PIO_double_real_kind_fc_double___   ! pio_decomp_fillval2.F90.in:403
   ! pio_decomp_fillval2.F90.in:403


! A test where all odd procs write only fillvalues
! - even procs write non-fillvalues


SUBROUTINE nc_wr_1d_odd_fval_PIO_int_integer__
USE pio_tutil
   ! pio_decomp_fillval2.F90.in:408
  implicit none   ! pio_decomp_fillval2.F90.in:409
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_fillval2.F90.in:410
  type(var_desc_t)  :: pio_var   ! pio_decomp_fillval2.F90.in:411
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval2.F90.in:412
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval2.F90.in:413
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_fillval2.F90.in:414
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval2.F90.in:415
  integer, dimension(VEC_LOCAL_SZ) :: wcompdof, rcompdof, compdof_rel_disps   ! pio_decomp_fillval2.F90.in:416
  ! Compdof value to suggest that data point is a hole, this hole
  ! is usually filled with a fillvalue
  integer, parameter :: PIO_COMPDOF_FILLVAL = 0   ! pio_decomp_fillval2.F90.in:419
  integer, dimension(VEC_LOCAL_SZ) :: wbuf, rbuf, exp_val   ! pio_decomp_fillval2.F90.in:420
  ! The buffer fillvalue to be used when writing data
  integer, PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval2.F90.in:422
  integer, dimension(1) :: dims   ! pio_decomp_fillval2.F90.in:423
  integer :: pio_dim   ! pio_decomp_fillval2.F90.in:424
  integer :: i, ierr, lsz   ! pio_decomp_fillval2.F90.in:425
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval2.F90.in:427
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval2.F90.in:428
  integer :: num_iotypes   ! pio_decomp_fillval2.F90.in:429
  logical :: is_odd_proc = .false.   ! pio_decomp_fillval2.F90.in:430
   ! pio_decomp_fillval2.F90.in:431
  if(mod(pio_tf_world_rank_, 2) /= 0) then   ! pio_decomp_fillval2.F90.in:432
    is_odd_proc = .true.   ! pio_decomp_fillval2.F90.in:433
  end if   ! pio_decomp_fillval2.F90.in:434
   ! pio_decomp_fillval2.F90.in:435
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval2.F90.in:436
    compdof_rel_disps(i) = i   ! pio_decomp_fillval2.F90.in:437
  end do   ! pio_decomp_fillval2.F90.in:438
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_fillval2.F90.in:439
  rcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval2.F90.in:440
  wcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval2.F90.in:441
   ! pio_decomp_fillval2.F90.in:442
  wbuf = wcompdof   ! pio_decomp_fillval2.F90.in:443
  exp_val = wcompdof   ! pio_decomp_fillval2.F90.in:444
  rbuf = 0   ! pio_decomp_fillval2.F90.in:445
   ! pio_decomp_fillval2.F90.in:446
  ! All odd procs write only fillvalues
  if(is_odd_proc) then   ! pio_decomp_fillval2.F90.in:448
    do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval2.F90.in:449
      wcompdof(i) = PIO_COMPDOF_FILLVAL   ! pio_decomp_fillval2.F90.in:450
      exp_val(i) = BUF_FILLVAL   ! pio_decomp_fillval2.F90.in:451
    end do   ! pio_decomp_fillval2.F90.in:452
  end if   ! pio_decomp_fillval2.F90.in:453
   ! pio_decomp_fillval2.F90.in:454
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, wcompdof, wiodesc)   ! pio_decomp_fillval2.F90.in:455
  call PIO_initdecomp(pio_tf_iosystem_, PIO_int, dims, rcompdof, riodesc)   ! pio_decomp_fillval2.F90.in:456
   ! pio_decomp_fillval2.F90.in:457
  num_iotypes = 0   ! pio_decomp_fillval2.F90.in:458
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval2.F90.in:459
  do i=1,num_iotypes   ! pio_decomp_fillval2.F90.in:460
   ! pio_decomp_fillval2.F90.in:461
    write(filename,'(a,i1)') "test_pio_decomp_fillval_tests.testfile",i   ! pio_decomp_fillval2.F90.in:462
   ! pio_decomp_fillval2.F90.in:463

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_int : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval2.F90.in:464
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval2.F90.in:465
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:466)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:466
   ! pio_decomp_fillval2.F90.in:467
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval2.F90.in:468
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:469)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:469
   ! pio_decomp_fillval2.F90.in:470
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_int, (/pio_dim/), pio_var)   ! pio_decomp_fillval2.F90.in:471
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:472)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:472
   ! pio_decomp_fillval2.F90.in:473
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval2.F90.in:474
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:475)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:475
   ! pio_decomp_fillval2.F90.in:476
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval2.F90.in:478
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:479)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:479
   ! pio_decomp_fillval2.F90.in:480
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:482
   ! pio_decomp_fillval2.F90.in:483
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval2.F90.in:484
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:485)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:485
   ! pio_decomp_fillval2.F90.in:486
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_fillval2.F90.in:487
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:488)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:488
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval2.F90.in:490
#endif
   ! pio_decomp_fillval2.F90.in:492
    rbuf = 0   ! pio_decomp_fillval2.F90.in:493
    call PIO_read_darray(pio_file, pio_var, riodesc, rbuf, ierr)   ! pio_decomp_fillval2.F90.in:494
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:495)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:495
   ! pio_decomp_fillval2.F90.in:496
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:497)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:497
   ! pio_decomp_fillval2.F90.in:498
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:499
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval2.F90.in:500
  end do   ! pio_decomp_fillval2.F90.in:501
  if(allocated(iotypes)) then   ! pio_decomp_fillval2.F90.in:502
    deallocate(iotypes)   ! pio_decomp_fillval2.F90.in:503
    deallocate(iotype_descs)   ! pio_decomp_fillval2.F90.in:504
  end if   ! pio_decomp_fillval2.F90.in:505
   ! pio_decomp_fillval2.F90.in:506
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval2.F90.in:507
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval2.F90.in:508
END SUBROUTINE nc_wr_1d_odd_fval_PIO_int_integer__   ! pio_decomp_fillval2.F90.in:509


SUBROUTINE nc_wr_1d_odd_fval_PIO_real_real_kind_fc_real___
USE pio_tutil
   ! pio_decomp_fillval2.F90.in:408
  implicit none   ! pio_decomp_fillval2.F90.in:409
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_fillval2.F90.in:410
  type(var_desc_t)  :: pio_var   ! pio_decomp_fillval2.F90.in:411
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval2.F90.in:412
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval2.F90.in:413
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_fillval2.F90.in:414
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval2.F90.in:415
  integer, dimension(VEC_LOCAL_SZ) :: wcompdof, rcompdof, compdof_rel_disps   ! pio_decomp_fillval2.F90.in:416
  ! Compdof value to suggest that data point is a hole, this hole
  ! is usually filled with a fillvalue
  integer, parameter :: PIO_COMPDOF_FILLVAL = 0   ! pio_decomp_fillval2.F90.in:419
  real(kind=fc_real), dimension(VEC_LOCAL_SZ) :: wbuf, rbuf, exp_val   ! pio_decomp_fillval2.F90.in:420
  ! The buffer fillvalue to be used when writing data
  real(kind=fc_real), PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval2.F90.in:422
  integer, dimension(1) :: dims   ! pio_decomp_fillval2.F90.in:423
  integer :: pio_dim   ! pio_decomp_fillval2.F90.in:424
  integer :: i, ierr, lsz   ! pio_decomp_fillval2.F90.in:425
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval2.F90.in:427
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval2.F90.in:428
  integer :: num_iotypes   ! pio_decomp_fillval2.F90.in:429
  logical :: is_odd_proc = .false.   ! pio_decomp_fillval2.F90.in:430
   ! pio_decomp_fillval2.F90.in:431
  if(mod(pio_tf_world_rank_, 2) /= 0) then   ! pio_decomp_fillval2.F90.in:432
    is_odd_proc = .true.   ! pio_decomp_fillval2.F90.in:433
  end if   ! pio_decomp_fillval2.F90.in:434
   ! pio_decomp_fillval2.F90.in:435
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval2.F90.in:436
    compdof_rel_disps(i) = i   ! pio_decomp_fillval2.F90.in:437
  end do   ! pio_decomp_fillval2.F90.in:438
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_fillval2.F90.in:439
  rcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval2.F90.in:440
  wcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval2.F90.in:441
   ! pio_decomp_fillval2.F90.in:442
  wbuf = wcompdof   ! pio_decomp_fillval2.F90.in:443
  exp_val = wcompdof   ! pio_decomp_fillval2.F90.in:444
  rbuf = 0   ! pio_decomp_fillval2.F90.in:445
   ! pio_decomp_fillval2.F90.in:446
  ! All odd procs write only fillvalues
  if(is_odd_proc) then   ! pio_decomp_fillval2.F90.in:448
    do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval2.F90.in:449
      wcompdof(i) = PIO_COMPDOF_FILLVAL   ! pio_decomp_fillval2.F90.in:450
      exp_val(i) = BUF_FILLVAL   ! pio_decomp_fillval2.F90.in:451
    end do   ! pio_decomp_fillval2.F90.in:452
  end if   ! pio_decomp_fillval2.F90.in:453
   ! pio_decomp_fillval2.F90.in:454
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, wcompdof, wiodesc)   ! pio_decomp_fillval2.F90.in:455
  call PIO_initdecomp(pio_tf_iosystem_, PIO_real, dims, rcompdof, riodesc)   ! pio_decomp_fillval2.F90.in:456
   ! pio_decomp_fillval2.F90.in:457
  num_iotypes = 0   ! pio_decomp_fillval2.F90.in:458
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval2.F90.in:459
  do i=1,num_iotypes   ! pio_decomp_fillval2.F90.in:460
   ! pio_decomp_fillval2.F90.in:461
    write(filename,'(a,i1)') "test_pio_decomp_fillval_tests.testfile",i   ! pio_decomp_fillval2.F90.in:462
   ! pio_decomp_fillval2.F90.in:463

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_real : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval2.F90.in:464
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval2.F90.in:465
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:466)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:466
   ! pio_decomp_fillval2.F90.in:467
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval2.F90.in:468
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:469)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:469
   ! pio_decomp_fillval2.F90.in:470
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_real, (/pio_dim/), pio_var)   ! pio_decomp_fillval2.F90.in:471
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:472)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:472
   ! pio_decomp_fillval2.F90.in:473
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval2.F90.in:474
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:475)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:475
   ! pio_decomp_fillval2.F90.in:476
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval2.F90.in:478
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:479)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:479
   ! pio_decomp_fillval2.F90.in:480
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:482
   ! pio_decomp_fillval2.F90.in:483
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval2.F90.in:484
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:485)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:485
   ! pio_decomp_fillval2.F90.in:486
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_fillval2.F90.in:487
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:488)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:488
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval2.F90.in:490
#endif
   ! pio_decomp_fillval2.F90.in:492
    rbuf = 0   ! pio_decomp_fillval2.F90.in:493
    call PIO_read_darray(pio_file, pio_var, riodesc, rbuf, ierr)   ! pio_decomp_fillval2.F90.in:494
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:495)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:495
   ! pio_decomp_fillval2.F90.in:496
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:497)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:497
   ! pio_decomp_fillval2.F90.in:498
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:499
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval2.F90.in:500
  end do   ! pio_decomp_fillval2.F90.in:501
  if(allocated(iotypes)) then   ! pio_decomp_fillval2.F90.in:502
    deallocate(iotypes)   ! pio_decomp_fillval2.F90.in:503
    deallocate(iotype_descs)   ! pio_decomp_fillval2.F90.in:504
  end if   ! pio_decomp_fillval2.F90.in:505
   ! pio_decomp_fillval2.F90.in:506
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval2.F90.in:507
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval2.F90.in:508
END SUBROUTINE nc_wr_1d_odd_fval_PIO_real_real_kind_fc_real___   ! pio_decomp_fillval2.F90.in:509


SUBROUTINE nc_wr_1d_odd_fval_PIO_double_real_kind_fc_double___
USE pio_tutil
   ! pio_decomp_fillval2.F90.in:408
  implicit none   ! pio_decomp_fillval2.F90.in:409
  integer, parameter :: VEC_LOCAL_SZ = 7   ! pio_decomp_fillval2.F90.in:410
  type(var_desc_t)  :: pio_var   ! pio_decomp_fillval2.F90.in:411
  type(file_desc_t) :: pio_file   ! pio_decomp_fillval2.F90.in:412
  character(len=PIO_TF_MAX_STR_LEN) :: filename   ! pio_decomp_fillval2.F90.in:413
  character(len=*), parameter :: PIO_VAR_NAME = 'PIO_TF_test_var'   ! pio_decomp_fillval2.F90.in:414
  type(io_desc_t) :: wiodesc, riodesc   ! pio_decomp_fillval2.F90.in:415
  integer, dimension(VEC_LOCAL_SZ) :: wcompdof, rcompdof, compdof_rel_disps   ! pio_decomp_fillval2.F90.in:416
  ! Compdof value to suggest that data point is a hole, this hole
  ! is usually filled with a fillvalue
  integer, parameter :: PIO_COMPDOF_FILLVAL = 0   ! pio_decomp_fillval2.F90.in:419
  real(kind=fc_double), dimension(VEC_LOCAL_SZ) :: wbuf, rbuf, exp_val   ! pio_decomp_fillval2.F90.in:420
  ! The buffer fillvalue to be used when writing data
  real(kind=fc_double), PARAMETER :: BUF_FILLVAL = -2   ! pio_decomp_fillval2.F90.in:422
  integer, dimension(1) :: dims   ! pio_decomp_fillval2.F90.in:423
  integer :: pio_dim   ! pio_decomp_fillval2.F90.in:424
  integer :: i, ierr, lsz   ! pio_decomp_fillval2.F90.in:425
  ! iotypes = valid io types
  integer, dimension(:), allocatable :: iotypes   ! pio_decomp_fillval2.F90.in:427
  character(len=PIO_TF_MAX_STR_LEN), dimension(:), allocatable :: iotype_descs   ! pio_decomp_fillval2.F90.in:428
  integer :: num_iotypes   ! pio_decomp_fillval2.F90.in:429
  logical :: is_odd_proc = .false.   ! pio_decomp_fillval2.F90.in:430
   ! pio_decomp_fillval2.F90.in:431
  if(mod(pio_tf_world_rank_, 2) /= 0) then   ! pio_decomp_fillval2.F90.in:432
    is_odd_proc = .true.   ! pio_decomp_fillval2.F90.in:433
  end if   ! pio_decomp_fillval2.F90.in:434
   ! pio_decomp_fillval2.F90.in:435
  do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval2.F90.in:436
    compdof_rel_disps(i) = i   ! pio_decomp_fillval2.F90.in:437
  end do   ! pio_decomp_fillval2.F90.in:438
  dims(1) = VEC_LOCAL_SZ * pio_tf_world_sz_   ! pio_decomp_fillval2.F90.in:439
  rcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval2.F90.in:440
  wcompdof = VEC_LOCAL_SZ * pio_tf_world_rank_ + compdof_rel_disps   ! pio_decomp_fillval2.F90.in:441
   ! pio_decomp_fillval2.F90.in:442
  wbuf = wcompdof   ! pio_decomp_fillval2.F90.in:443
  exp_val = wcompdof   ! pio_decomp_fillval2.F90.in:444
  rbuf = 0   ! pio_decomp_fillval2.F90.in:445
   ! pio_decomp_fillval2.F90.in:446
  ! All odd procs write only fillvalues
  if(is_odd_proc) then   ! pio_decomp_fillval2.F90.in:448
    do i=1,VEC_LOCAL_SZ   ! pio_decomp_fillval2.F90.in:449
      wcompdof(i) = PIO_COMPDOF_FILLVAL   ! pio_decomp_fillval2.F90.in:450
      exp_val(i) = BUF_FILLVAL   ! pio_decomp_fillval2.F90.in:451
    end do   ! pio_decomp_fillval2.F90.in:452
  end if   ! pio_decomp_fillval2.F90.in:453
   ! pio_decomp_fillval2.F90.in:454
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, wcompdof, wiodesc)   ! pio_decomp_fillval2.F90.in:455
  call PIO_initdecomp(pio_tf_iosystem_, PIO_double, dims, rcompdof, riodesc)   ! pio_decomp_fillval2.F90.in:456
   ! pio_decomp_fillval2.F90.in:457
  num_iotypes = 0   ! pio_decomp_fillval2.F90.in:458
  call PIO_TF_Get_nc_iotypes(iotypes, iotype_descs, num_iotypes)   ! pio_decomp_fillval2.F90.in:459
  do i=1,num_iotypes   ! pio_decomp_fillval2.F90.in:460
   ! pio_decomp_fillval2.F90.in:461
    write(filename,'(a,i1)') "test_pio_decomp_fillval_tests.testfile",i   ! pio_decomp_fillval2.F90.in:462
   ! pio_decomp_fillval2.F90.in:463

    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_log_level_ >= 0) THEN
        WRITE(*,"(A)",ADVANCE="NO") "PIO_TF: "
        WRITE(*,*)  "Testing : PIO_double : ", iotype_descs(i)
      END IF
    END IF   ! pio_decomp_fillval2.F90.in:464
    ierr = PIO_createfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_CLOBBER)    ! pio_decomp_fillval2.F90.in:465
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not create file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:466)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:466
   ! pio_decomp_fillval2.F90.in:467
    ierr = PIO_def_dim(pio_file, 'PIO_TF_test_dim', dims(1), pio_dim)   ! pio_decomp_fillval2.F90.in:468
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a dim : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:469)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:469
   ! pio_decomp_fillval2.F90.in:470
    ierr = PIO_def_var(pio_file, PIO_VAR_NAME, PIO_double, (/pio_dim/), pio_var)   ! pio_decomp_fillval2.F90.in:471
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to define a var : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:472)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:472
   ! pio_decomp_fillval2.F90.in:473
    ierr = PIO_enddef(pio_file)   ! pio_decomp_fillval2.F90.in:474
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to end redef mode : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:475)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:475
   ! pio_decomp_fillval2.F90.in:476
    ! Write the variable out
    call PIO_write_darray(pio_file, pio_var, wiodesc, wbuf, ierr, BUF_FILLVAL)   ! pio_decomp_fillval2.F90.in:478
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to write darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:479)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:479
   ! pio_decomp_fillval2.F90.in:480
#ifdef PIO_TEST_CLOSE_OPEN_FOR_SYNC
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:482
   ! pio_decomp_fillval2.F90.in:483
    ierr = PIO_openfile(pio_tf_iosystem_, pio_file, iotypes(i), filename, PIO_nowrite)   ! pio_decomp_fillval2.F90.in:484
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not reopen file " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:485)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:485
   ! pio_decomp_fillval2.F90.in:486
    ierr = PIO_inq_varid(pio_file, PIO_VAR_NAME, pio_var)   ! pio_decomp_fillval2.F90.in:487
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Could not inq var " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:488)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:488
#else
    call PIO_syncfile(pio_file)   ! pio_decomp_fillval2.F90.in:490
#endif
   ! pio_decomp_fillval2.F90.in:492
    rbuf = 0   ! pio_decomp_fillval2.F90.in:493
    call PIO_read_darray(pio_file, pio_var, riodesc, rbuf, ierr)   ! pio_decomp_fillval2.F90.in:494
    
    IF (.NOT. (PIO_TF_Passert_((ierr) == PIO_NOERR, pio_tf_comm_))) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Function failed:",&
           "Failed to read darray : " // trim(filename),&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:495)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:495
   ! pio_decomp_fillval2.F90.in:496
    
    IF (.NOT. PIO_TF_Check_val_(rbuf, exp_val)) THEN
      pio_tf_retval_utest_ = -1
      IF (pio_tf_world_rank_ == 0) THEN
        PRINT *, "PIO_TF: PIO Check failed:",&
           "Got wrong val",&
          ":", __FILE__, ":", __LINE__,&
          "(pio_decomp_fillval2.F90.in:497)"
      END IF
      RETURN
    END IF   ! pio_decomp_fillval2.F90.in:497
   ! pio_decomp_fillval2.F90.in:498
    call PIO_closefile(pio_file)   ! pio_decomp_fillval2.F90.in:499
    call PIO_deletefile(pio_tf_iosystem_, filename)   ! pio_decomp_fillval2.F90.in:500
  end do   ! pio_decomp_fillval2.F90.in:501
  if(allocated(iotypes)) then   ! pio_decomp_fillval2.F90.in:502
    deallocate(iotypes)   ! pio_decomp_fillval2.F90.in:503
    deallocate(iotype_descs)   ! pio_decomp_fillval2.F90.in:504
  end if   ! pio_decomp_fillval2.F90.in:505
   ! pio_decomp_fillval2.F90.in:506
  call PIO_freedecomp(pio_tf_iosystem_, riodesc)   ! pio_decomp_fillval2.F90.in:507
  call PIO_freedecomp(pio_tf_iosystem_, wiodesc)   ! pio_decomp_fillval2.F90.in:508
END SUBROUTINE nc_wr_1d_odd_fval_PIO_double_real_kind_fc_double___   ! pio_decomp_fillval2.F90.in:509
   ! pio_decomp_fillval2.F90.in:509


  SUBROUTINE PIO_TF_Test_driver_
    USE pio_tutil
    IMPLICIT NONE
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_exp_fval_PIO_int_integer__"
    END IF
    CALL nc_wr_1d_mreg_exp_fval_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 1:",&
          "nc_wr_1d_mreg_exp_fval_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 1:",&
          "nc_wr_1d_mreg_exp_fval_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_exp_fval_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_1d_mreg_exp_fval_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 2:",&
          "nc_wr_1d_mreg_exp_fval_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 2:",&
          "nc_wr_1d_mreg_exp_fval_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_exp_fval_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_1d_mreg_exp_fval_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 3:",&
          "nc_wr_1d_mreg_exp_fval_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 3:",&
          "nc_wr_1d_mreg_exp_fval_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_exp_fval_PIO_int_integer__"
    END IF
    CALL nc_wr_1d_mreg_exp_fval_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 4:",&
          "nc_wr_1d_mreg_exp_fval_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 4:",&
          "nc_wr_1d_mreg_exp_fval_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_exp_fval_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_1d_mreg_exp_fval_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 5:",&
          "nc_wr_1d_mreg_exp_fval_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 5:",&
          "nc_wr_1d_mreg_exp_fval_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_exp_fval_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_1d_mreg_exp_fval_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 6:",&
          "nc_wr_1d_mreg_exp_fval_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 6:",&
          "nc_wr_1d_mreg_exp_fval_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_imp_fval_PIO_int_integer__"
    END IF
    CALL nc_wr_1d_mreg_imp_fval_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 7:",&
          "nc_wr_1d_mreg_imp_fval_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 7:",&
          "nc_wr_1d_mreg_imp_fval_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_imp_fval_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_1d_mreg_imp_fval_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 8:",&
          "nc_wr_1d_mreg_imp_fval_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 8:",&
          "nc_wr_1d_mreg_imp_fval_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_imp_fval_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_1d_mreg_imp_fval_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 9:",&
          "nc_wr_1d_mreg_imp_fval_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 9:",&
          "nc_wr_1d_mreg_imp_fval_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_exp_fval_PIO_int_integer__"
    END IF
    CALL nc_wr_1d_mreg_exp_fval_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 10:",&
          "nc_wr_1d_mreg_exp_fval_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 10:",&
          "nc_wr_1d_mreg_exp_fval_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_exp_fval_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_1d_mreg_exp_fval_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 11:",&
          "nc_wr_1d_mreg_exp_fval_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 11:",&
          "nc_wr_1d_mreg_exp_fval_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_exp_fval_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_1d_mreg_exp_fval_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 12:",&
          "nc_wr_1d_mreg_exp_fval_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 12:",&
          "nc_wr_1d_mreg_exp_fval_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_imp_fval_PIO_int_integer__"
    END IF
    CALL nc_wr_1d_mreg_imp_fval_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 13:",&
          "nc_wr_1d_mreg_imp_fval_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 13:",&
          "nc_wr_1d_mreg_imp_fval_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_imp_fval_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_1d_mreg_imp_fval_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 14:",&
          "nc_wr_1d_mreg_imp_fval_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 14:",&
          "nc_wr_1d_mreg_imp_fval_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_imp_fval_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_1d_mreg_imp_fval_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 15:",&
          "nc_wr_1d_mreg_imp_fval_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 15:",&
          "nc_wr_1d_mreg_imp_fval_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_one_val_PIO_int_integer__"
    END IF
    CALL nc_wr_1d_one_val_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 16:",&
          "nc_wr_1d_one_val_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 16:",&
          "nc_wr_1d_one_val_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_one_val_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_1d_one_val_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 17:",&
          "nc_wr_1d_one_val_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 17:",&
          "nc_wr_1d_one_val_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_one_val_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_1d_one_val_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 18:",&
          "nc_wr_1d_one_val_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 18:",&
          "nc_wr_1d_one_val_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_exp_fval_PIO_int_integer__"
    END IF
    CALL nc_wr_1d_mreg_exp_fval_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 19:",&
          "nc_wr_1d_mreg_exp_fval_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 19:",&
          "nc_wr_1d_mreg_exp_fval_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_exp_fval_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_1d_mreg_exp_fval_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 20:",&
          "nc_wr_1d_mreg_exp_fval_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 20:",&
          "nc_wr_1d_mreg_exp_fval_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_exp_fval_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_1d_mreg_exp_fval_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 21:",&
          "nc_wr_1d_mreg_exp_fval_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 21:",&
          "nc_wr_1d_mreg_exp_fval_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_imp_fval_PIO_int_integer__"
    END IF
    CALL nc_wr_1d_mreg_imp_fval_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 22:",&
          "nc_wr_1d_mreg_imp_fval_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 22:",&
          "nc_wr_1d_mreg_imp_fval_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_imp_fval_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_1d_mreg_imp_fval_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 23:",&
          "nc_wr_1d_mreg_imp_fval_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 23:",&
          "nc_wr_1d_mreg_imp_fval_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_mreg_imp_fval_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_1d_mreg_imp_fval_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 24:",&
          "nc_wr_1d_mreg_imp_fval_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 24:",&
          "nc_wr_1d_mreg_imp_fval_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_one_val_PIO_int_integer__"
    END IF
    CALL nc_wr_1d_one_val_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 25:",&
          "nc_wr_1d_one_val_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 25:",&
          "nc_wr_1d_one_val_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_one_val_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_1d_one_val_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 26:",&
          "nc_wr_1d_one_val_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 26:",&
          "nc_wr_1d_one_val_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_one_val_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_1d_one_val_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 27:",&
          "nc_wr_1d_one_val_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 27:",&
          "nc_wr_1d_one_val_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_odd_fval_PIO_int_integer__"
    END IF
    CALL nc_wr_1d_odd_fval_PIO_int_integer__()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 28:",&
          "nc_wr_1d_odd_fval_PIO_int_integer__","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 28:",&
          "nc_wr_1d_odd_fval_PIO_int_integer__","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_odd_fval_PIO_real_real_kind_fc_real___"
    END IF
    CALL nc_wr_1d_odd_fval_PIO_real_real_kind_fc_real___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 29:",&
          "nc_wr_1d_odd_fval_PIO_real_real_kind_fc_real___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 29:",&
          "nc_wr_1d_odd_fval_PIO_real_real_kind_fc_real___","-----------", "FAILED"
      END IF
    END IF
    pio_tf_retval_utest_ = 0
    IF (pio_tf_world_rank_ == 0) THEN
      PRINT *, "PIO_TF: Starting nc_wr_1d_odd_fval_PIO_double_real_kind_fc_double___"
    END IF
    CALL nc_wr_1d_odd_fval_PIO_double_real_kind_fc_double___()
    IF (pio_tf_retval_utest_ /= 0) THEN
      pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
    END IF
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_retval_utest_ == 0) THEN
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 30:",&
          "nc_wr_1d_odd_fval_PIO_double_real_kind_fc_double___","-----------", "PASSED"
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF:Test 30:",&
          "nc_wr_1d_odd_fval_PIO_double_real_kind_fc_double___","-----------", "FAILED"
      END IF
    END IF
  END SUBROUTINE PIO_TF_Test_driver_


  PROGRAM PIO_TF_Test_main_
    USE pio_tutil
    IMPLICIT NONE
    INTEGER, PARAMETER :: NREARRS = 2
    INTEGER :: rearrs(NREARRS) = (/pio_rearr_subset,pio_rearr_box/)
    CHARACTER(LEN=PIO_TF_MAX_STR_LEN) :: rearrs_info(NREARRS) = (/"PIO_REARR_SUBSET","PIO_REARR_BOX   "/)
    INTEGER i, ierr

    pio_tf_nerrs_total_=0
    pio_tf_retval_utest_=0
    CALL MPI_Init(ierr)
    DO i=1,SIZE(rearrs)
      CALL PIO_TF_Init_(rearrs(i))
      IF (pio_tf_world_rank_ == 0) THEN
        WRITE(*,*) "PIO_TF: Testing : ", trim(rearrs_info(i))
      END IF
      CALL PIO_TF_Test_driver_()
      CALL PIO_TF_Finalize_()
    END DO
    IF (pio_tf_world_rank_ == 0) THEN
      IF (pio_tf_nerrs_total_ == 0) THEN
        IF (pio_tf_retval_utest_ == 0) THEN
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF: ",&
           "All tests", "---------", "PASSED"
        ELSE
          pio_tf_nerrs_total_ = pio_tf_nerrs_total_ + 1
          WRITE(*,PIO_TF_TEST_RES_FMT) "PIO_TF: ",&
           "Test driver", "---------", "FAILED"
        END IF
      ELSE
        WRITE(*,PIO_TF_TEST_RES_FMT2) "PIO_TF:[",&
          pio_tf_nerrs_total_,"] Tests",&
          "----- FAILED"
      END IF
    END IF
    CALL MPI_Finalize(ierr)
    IF (pio_tf_nerrs_total_ /= 0) THEN
      STOP 99
    END IF
  END PROGRAM
